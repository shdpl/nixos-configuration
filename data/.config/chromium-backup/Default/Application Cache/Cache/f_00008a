define("Shared/Utils/StringEx",["require","exports"],(function(n,t){"use strict";function i(n,t,i){return typeof n!="string"||typeof t!="string"?!1:(i===u.IgnoreCase&&(n=n.toUpperCase(),t=t.toUpperCase()),n===t)}function r(n){var t={};return n.split(",").forEach((function(n){var i=n.split(":");i.length===2&&(t[i[0]]=i[1])})),t}t.equals=i;t.convertToStringMap=r,(function(n){n[n.IgnoreCase=0]="IgnoreCase"})(t.StringComparison||(t.StringComparison={}));var u=t.StringComparison}));define("Shared/Utils/ResourceIdUtility",["require","exports","f"],(function(n,t,i){"use strict";return (function(){function n(){}return n.getDescription=function(t){return"{0} ({1})".format(n.getName(t),n.getType(t))},n.getName=function(n){var t;return t=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(n),t.resources.join("/")},n.getType=function(n){var t;return t=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(n),t.types.join("/")},n.getShortText=function(n){var r,u,t,o,f,e;if(i.ViewModels.Services.
ResourceTypes.isResourceId(n)){for(r=[],u=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(n),t=0;t<u.types.length;t++)r.push(u.types[t]),r.push(u.resources[t]);return"..."+r.join("/")}if(i.ViewModels.Services.ResourceTypes.isResourceGroupId(n))return o=i.ViewModels.Services.ResourceTypes.parseResourceGroupDescriptor(n),"..."+o.resourceGroup;if(f=n.split("/"),f.length>3)for(e=0;e<3;e++)f.shift();return"..."+f.join("/")},n.getResourceGroupId=function(n){var t=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(n);return"/subscriptions/{0}/resourceGroups/{1}".format(t.subscription,t.resourceGroup)},n.getProvider=function(n){var t=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(n);return t.provider},n.getDisplayName=function(n,t){var r=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(n);return t?"{0} ({1})".format(r.resource,t.compositeDisplayName.lowerSingular):"{0} ({1})".format(r.resource,r.type)},n})()}));define("Shared/Utils/AuthorizationUtility",
["require","exports","f","./ResourceIdUtility"],(function(n,t,i,r){"use strict";return (function(){function n(){}return n.getPermissionsForConfigScaleSetting=function(n){var u=r.getResourceGroupId(n),t=[];return t.push(i.Base.Security.hasPermission(n,["./read"])),t.push(i.Base.Security.hasPermission(u,["Microsoft.Insights/autoscaleSettings/read"])),t},n.verifyResourceReadPermissions=function(n,t,r){i.Base.Security.hasPermission(n,[t]).then((function(n){n||r.unauthorized()}),(function(){}))},n.verifyUserPermissionToResourceOrResourceGroup=function(n,t){var r=Q.defer();return i.Base.Security.hasPermission(n,[t]).then((function(n){r.resolve(n)})).catch((function(){r.resolve(!1)})),r.promise},n})()}));define("Usages/Constants",["require","exports"],(function(){"use strict";return (function(){function n(){}return n.DataUris={listUsageMetricsUri:"{0}/insights/api/Insights/ListUsageMetrics"},n.UsageLimits={Unlimited:-1,UsageWarningLimit:80},n})()}));define("Usages/Parts/Constants",["require","exports"],(function(
){"use strict";return (function(){function n(){}return n.maxMetricPointsAllowed=1e3,n.ApiVersion={mdmMetric:"2016-06-01",mdmMetricDefinitions:"2016-03-01"},n.ProviderName={microsoftClassicCompute:"Microsoft.ClassicCompute"},n.IECFormatName={bytesIECFormat:"bytesiecformat",bytesPerSecondIECFormat:"bytespersecondiecformat"},n.MetricAggregation={none:"None",average:"Average",minimum:"Minimum",maximum:"Maximum",total:"Total",last:"Last"},n.DataUris={listMetricDefinitions:"/api/Insights/ListMetricDefinitions",getMetricDefinition:"/api/Insights/GetMetricDefinition",getMetricHistory:"/api/Insights/GetMetricHistory",getMetricHistoryCollection:"/api/Insights/GetMetricHistoryCollection",getMdmMetricDefinitions:"{baseUrl}/subscriptions/{subscription}/resourceGroups/{resourceGroup}/providers/{provider}/{type}/{resource}/providers/Microsoft.Insights/metricdefinitions?api-version={apiVersion}",getMdmMetricHistory:"{0}{1}/providers/Microsoft.Insights/metrics?api-version={2}&$filter={3}",getMdmMetricHistoryCollectionBatch:
"{0}/providers/Microsoft.Insights/metrics?api-version={1}&$filter={2}"},n.MetricUnit={Percent:"Percent",Count:"Count",Seconds:"Seconds",Milliseconds:"Milliseconds",Bytes:"Bytes",BytesPerSecond:"BytesPerSecond",CountPerSecond:"CountPerSecond"},n.ChartColors={metricColors:["azc-color-g0","azc-color-h0","azc-color-i0","azc-color-a1","azc-color-b1","azc-color-c1","azc-color-d1","azc-color-e1","azc-color-f1","azc-color-g1"]},n.MetricDefinitionAggregationTypeToMetricRuleAggregationTypeMap={Average:4,Last:4,Minimum:2,Maximum:3,Total:5},n.MetricHashColor=["a0","b0","c0","d0","e0","f0","g0","h0","i0","j0","a1","b1","c1","d1","e1","f1","g1","h1","i1","j1","a2","b2","c2","d2","e2","f2","g2","h2","i2","j2"],n.MetricChartColorPrefix="msportalfx-bgcolor-",n.ColorTints=["s2","t1","s1","t2"],n.ColorMapping={themeMain:"g0",themeWarning:"b0",themeError:"d0",themeSuccess:"j0"},n.MetricChartColorSchema={CpuTime:"g1",Requests:"g0",BytesReceived:"b2",BytesSent:"c2",Http2xx:"j0",Http3xx:"a1",Http401:"b1",Http403:
"c1",Http404:"b0",Http406:"d1",Http4xx:"d0",Http5xx:"c0",MemoryWorkingSet:"e1",AverageMemoryWorkingSet:"e0",AverageResponseTime:"i1",CpuPercentage:"g1",MemoryPercentage:"e0",DiskQueueLength:"h1",HttpQueueLength:"f1","Total Requests":"g0",Http400:"d0","Throttled Requests":"b0","Internal Server Error":"c0","Service Unavailable":"c1","Average Requests per Second":"h0",TotalIngress:"b2",TotalEgress:"c2",TotalRequests:"g0",TotalBillableRequests:"h2",Availability:"a0",AverageE2ELatency:"i1",Success:"j0",Capacity:"h1",cachehits:"h2",cachemisses:"d1",getcommands:"j1",setcommands:"i0",evictedkeys:"a1",expiredkeys:"b1",percentProcessorTime:"g1",usedmemory:"e0",totalcommandsprocessed:"h1",cacheWrite:"b2",cacheRead:"c2",blocked_by_firewall:"b1",deadlock:"a1",connection_failed:"d0",connection_successful:"j0",throttling:"b0",cpu_percent:"g1",physical_data_read_percent:"j1",log_write_percent:"e2",storage:"h1",dtu_consumption_percent:"h2","\\Processor(_Total)\\% Processor Time":"g1","\\Processor(_Total)\\% Interrupt Time":
"d1","\\Processor(_Total)\\% Privileged Time":"a1","\\Processor(_Total)\\% User Time":"f2","\\Memory\\Committed Bytes":"e1","\\Memory\\Available Bytes":"f0","\\Memory\\% Committed Bytes In Use":"e0","\\Process(_Total)\\% Processor Time":"g2","\\Process(_Total)\\Working Set":"e2","\\PhysicalDisk(_Total)\\Disk Read Bytes/sec":"j1","\\PhysicalDisk(_Total)\\Disk Write Bytes/sec":"i0","\\ASP.NET\\Request Wait Time":"i1","\\ASP.NET Applications(__Total__)\\Requests/Sec":"g0","\\ASP.NET Applications(__Total__)\\Errors Total/Sec":"d0","\\ASP.NET Applications(__Total__)\\Requests In Application Queue":"f1","Percentage CPU":"g1","Network In":"b2","Network Out":"c2","Disk Read Bytes/sec":"j1","Disk Write Bytes/sec":"i0",SuccessfulRuns:"j1",FailedRuns:"d0",networkBytesWrittenPerSecond:"b2",networkBytesReadPerSecond:"c2",connectedclients:"g0","Calls per Second":"h0","Errors per Second":"d0","Response Time in Seconds":"i1","External Time in Seconds":"e2",RunsStarted:"f1",RunsCompleted:"g0",RunsSucceeded:
"j1",RunsFailed:"d0",RunsCancelled:"b0",RunLatency:"e2",RunSuccessLatency:"i1",RunRate:"h0",RunSuccessPercentage:"a0",RunThrottledEvents:"b1"},n.oneMinuteInSeconds=60,n.fiveMinuteInSeconds=300,n.oneHourInSeconds=3600,n.twoHoursInSeconds=7200,n.oneDayInSeconds=86400,n.thirtyDaysInSeconds=2592e3,n.oneEightyDaysInSeconds=15552e3,n.hoursInOneDay=24,n.BladeNames={metricsDetailsBlade:"MetricsDetailsBlade",diagnosticsConfigurationUpdateBlade:"DiagnosticsConfigurationUpdateBlade",metricsChartConfigurationBlade:"MetricsChartConfigurationBlade"},n})()}));define("Usages/Parts/Resources",["require","exports","ClientResources"],(function(n,t,i){"use strict";var r=i.Metrics.Units;return (function(){function n(){}return n.zettaBytesLong=r.zettaBytesLong,n.zettaBytes=r.zettaBytes,n.yottaBytesLong=r.yottaBytesLong,n.yottaBytes=r.yottaBytes,n.teraBytesLong=r.teraBytesLong,n.teraBytes=r.teraBytes,n.petaBytesLong=r.petaBytesLong,n.petaBytes=r.petaBytes,n.megaBytesLong=r.megaBytesLong,n.megaBytes=r.megaBytes,n.
kiloBytesLong=r.kiloBytesLong,n.kiloBytes=r.kiloBytes,n.gigaBytesLong=r.gigaBytesLong,n.gigaBytes=r.gigaBytes,n.exaBytesLong=r.exaBytesLong,n.exaBytes=r.exaBytes,n.bytesLong=r.bytesLong,n.bytes=r.bytes,n.genericErrorMessage=i.Metrics.genericErrorMessage,n.fieldMustBeUnique=r.fieldMustBeUnique,n})()}));define("Usages/Parts/Formatters",["require","exports","./Resources"],(function(n,t,i){"use strict";return (function(){function n(){}return n.getFileSizeFormat=function(t,i,r,u){var e=1e3;r&&(e=1024);var o=i&&$.map(n.sizeSuffixes,(function(n){return n.name})).indexOf(i)||0,f=o,s=t||0;return u=isNaN(u)?n.DefaultPrecision:u,t&&t>=e&&(f=Math.floor(Math.log(t)/Math.log(e)),s=t/Math.pow(e,f),f=o+f,f=f<n.sizeSuffixes.length?f:n.sizeSuffixes.length-1),{value:n._roundNumber(s,u),unitName:n.sizeSuffixes[f].name,unitDisplayName:n.sizeSuffixes[f].localizedName,unitLongDisplayName:n.sizeSuffixes[f].localizedLongName,conversionFactor:n.sizeSuffixes[f].conversionFactor,conversionValue:Math.pow(e,o-f)}},n._roundNumber=
function(n,t){return n%1!=0?parseFloat(n.toFixed(t)):n},n.sizeSuffixes=[{name:"B",localizedName:i.bytes,localizedLongName:i.bytesLong,conversionFactor:""},{name:"KB",localizedName:i.kiloBytes,localizedLongName:i.kiloBytesLong,conversionFactor:"k"},{name:"MB",localizedName:i.megaBytes,localizedLongName:i.megaBytesLong,conversionFactor:"M"},{name:"GB",localizedName:i.gigaBytes,localizedLongName:i.gigaBytesLong,conversionFactor:"g"},{name:"TB",localizedName:i.teraBytes,localizedLongName:i.teraBytesLong,conversionFactor:"T"},{name:"PT",localizedName:i.petaBytes,localizedLongName:i.petaBytesLong,conversionFactor:"P"},{name:"EB",localizedName:i.exaBytes,localizedLongName:i.exaBytesLong,conversionFactor:"E"},{name:"ZB",localizedName:i.zettaBytes,localizedLongName:i.zettaBytesLong,conversionFactor:"Z"},{name:"YB",localizedName:i.yottaBytes,localizedLongName:i.yottaBytesLong,conversionFactor:"Y"}],n.DefaultPrecision=2,n})()}));define("Usages/Parts/MetricFormatter",["require","exports","f","./Constants",
"ClientResources","./Formatters","../../Shared/Utils/StringEx"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function c(n,t,i){var r=f.getFileSizeFormat(n,"B",i,t);return{value:r.value,unitName:"bytes/sec",unitDisplayName:u.Metrics.perSecond.format(r.unitDisplayName),unitLongDisplayName:u.Metrics.perSecond.format(r.unitLongDisplayName),conversionFactor:r.conversionFactor,conversionValue:r.conversionValue}}var l=(function(){function n(){}return n})(),h;n.FormattedUnit=l;h=(function(){function n(){}return n})();n.TransformedUnit=h;var t={bytes:function(n,t,i){return f.getFileSizeFormat(n,"B",i,t)},kilobytes:function(n,t,i){return f.getFileSizeFormat(n,"KB",i,t)},mbytes:function(n,t,i){return f.getFileSizeFormat(n,"MB",i,t)},gbytes:function(n,t,i){return f.getFileSizeFormat(n,"GB",i,t)},tbytes:function(n,t,i){return f.getFileSizeFormat(n,"TB",i,t)},bytespersecond:c,"bytes/sec":c,milliseconds:function(n,i){var f=u.Metrics.metricUnitMillisecondsShort,e=u.Metrics.metricUnitMilliseconds,
r;return n>=1e3?(r=t.seconds(n/1e3,i),r.conversionValue=r.conversionValue/1e3,r):{value:n?parseInt(n.toFixed(i),10):n,unitName:"milliseconds",unitDisplayName:f,unitLongDisplayName:e,conversionFactor:"",conversionValue:1}},seconds:function(n,i){var e,r;if(n<1)return e=t.milliseconds(n*1e3,i),e.conversionFactor="ms",e.conversionValue=1e3,e;var o="seconds",l=0,s=u.Metrics.metricUnitSecondsShort,h=u.Metrics.metricUnitSeconds,c="",f=1;return n>=60&&(r=n/60,r>1&&r<60?(o="minutes",s=u.Metrics.metricUnitMinutesShort,h=u.Metrics.metricUnitMinutes,c="m",f=f/60,n=r):r>=60&&r<1440?(o="hours",s=u.Metrics.metricUnitHoursShort,h=u.Metrics.metricUnitHours,c="h",f=f/3600,n=r/60):r>=1440&&(o="days",s=u.Metrics.metricUnitDaysShort,h=u.Metrics.metricUnitDays,c="d",f=f/86400,n=r/1440)),n%1!=0&&(l=i),{value:n?parseFloat(n.toFixed(l)):n,unitName:o,unitDisplayName:s,unitLongDisplayName:h,conversionFactor:c,conversionValue:f}},percent:function(n,t){var i=0;return n%1!=0&&(i=t),{value:n?parseFloat(n.toFixed(i)):
n,unitName:"%",unitDisplayName:u.Metrics.metricUnitPercent,unitLongDisplayName:u.Metrics.metricUnitPercent,conversionFactor:"",conversionValue:1}},countpersecond:function(n,t){var i=n,r="",f=1,e=0;return n>=1e3&&(i=n/1e3,r="k",f=1/1e3),i%1!=0&&(e=t),{value:i?parseFloat(i.toFixed(e)):i,unitName:"countpersecond",unitDisplayName:u.Metrics.perSecond.format(r),unitLongDisplayName:u.Metrics.perSecond.format(r),conversionFactor:r,conversionValue:f}},count:function(n,t){var i=n,r="",u=1,f=0;return n>=1e3&&(i=n/1e3,r="k",u=1/1e3),i%1!=0&&(f=t),{value:i?parseFloat(i.toFixed(f)):i,unitName:"count",unitDisplayName:r,unitLongDisplayName:r,conversionFactor:r,conversionValue:u}}},o={terabytes:"tbytes",tb:"tbytes",gigabytes:"gbytes",gb:"gbytes",megabytes:"mbytes",mb:"mbytes",kb:"kilobytes",percentage:"percent","%":"percent",sec:"seconds"},s={bytes:{valueFromBaseUnit:1,unitName:"bytes",fxUnit:i.UnitConversion.Unit.Bytes_SI},bytespersecond:{valueFromBaseUnit:1,unitName:"bytes/sec",fxUnit:i.UnitConversion.
Unit.BytesPerSecond_SI},bytesiecformat:{valueFromBaseUnit:1,unitName:"bytes",fxUnit:i.UnitConversion.Unit.Bytes},bytespersecondiecformat:{valueFromBaseUnit:1,unitName:"bytes/sec",fxUnit:i.UnitConversion.Unit.BytesPerSecond},count:{valueFromBaseUnit:1,unitName:"count",fxUnit:i.UnitConversion.Unit.Count},countpersecond:{valueFromBaseUnit:1,unitName:"count/sec",fxUnit:i.UnitConversion.Unit.CountPerSecond},percent:{valueFromBaseUnit:1,unitName:"percent",fxUnit:i.UnitConversion.Unit.Percentage},seconds:{valueFromBaseUnit:1,unitName:"seconds",fxUnit:i.UnitConversion.Unit.Seconds}},a={b:"B",kb:"KiB",mb:"MiB",gb:"GiB",tb:"TiB",pb:"PiB",eb:"EiB",zb:"ZiB",yb:"YiB","b/s":"B/s","kb/s":"KiB/s","mb/s":"MiB/s","gb/s":"GiB/s","tb/s":"TiB/s","pb/s":"PiB/s","eb/s":"EiB/s","zb/s":"ZiB/s","yb/s":"YiB/s"},v=(function(){function n(){}return n.Format=function(n,i,r,e){var s=i?i.toLowerCase():"",h,c;return e=isNaN(e)?f.DefaultPrecision:e,t[s]?h=t[s](n,e,r):o[s]?h=t[o[s]](n,e,r):(c=u[s]||i,h={value:n?Number(n.toFixed(
e)):n,unitName:i,unitDisplayName:c,unitLongDisplayName:c,conversionFactor:"",conversionValue:1}),h},n.GetFxUnit=function(n,t){t===void 0&&(t=!1);var u=n?n.toLowerCase():"",f=i.UnitConversion.Unit.None;return t&&(e.equals(u,r.MetricUnit.Bytes,e.StringComparison.IgnoreCase)?u=r.IECFormatName.bytesIECFormat:e.equals(u,r.MetricUnit.BytesPerSecond,e.StringComparison.IgnoreCase)&&(u=r.IECFormatName.bytesPerSecondIECFormat)),s[u]?f=s[u].fxUnit:o[u]&&(f=s[o[u]].fxUnit),f},n.GetDisplayUnit=function(n,t,i){return t===void 0&&(t=!1),i===void 0&&(i=!1),!t||i?n:a[n.toLowerCase()]||n},n})();n.MetricFormatter=v})(o||(o={})),o}));define("Usages/Parts/UsageGaugeBasePart",["require","exports","f","o","./MetricFormatter","../Constants","../../Shared/Utils/AuthorizationUtility","ClientResources","../../Shared/Utils/StringEx"],(function(n,t,i,r,u,f,e,o,s){"use strict";var c=u.MetricFormatter,h=o.Usages,l=i.ViewModels.Parts.QuotaGauge;return (function(n){function t(t,i,r){n.call(this);this.resourceId=ko.observable(
);this.usageMetricName=ko.observable();this.options=ko.observable();this._useIECFormat=!1;this._displaySIUnit=!1;this._container=t;this._dataView=r.usagesData.getUsageDataView();this._dataView.onLoaded(this.onDataLoaded.bind(this));this._container.registerForDispose(this._dataView);this.instanceQuota(f.UsageLimits.UsageWarningLimit);this.maximum(100);this.captionDisplayFormat("");this.valueDisplayFormat("{0}%");this._container.partTitle(h.usageGaugePartDefaultTitle)}return __extends(t,n),t.prototype.onInputsSet=function(n){var f=this,t,r,u;return(this._useIECFormat=n.options?!!n.options.useIECFormat:!1,this._displaySIUnit=n.options?!!n.options.displaySIUnit:!1,this._noDataMessage=h.noDataMessage,n.options&&n.options.noDataMessage&&(this._noDataMessage=n.options.noDataMessage),this._disabledMessage=h.disabledMessage,n.options&&n.options.disabledMessage&&(this._disabledMessage=n.options.disabledMessage),t=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(n.resourceId),r=t.subscription,
u=t.resource,this.resourceId(n.resourceId),this.usageMetricName(n.usageMetricName),this.options(n.options),e.verifyResourceReadPermissions(this.resourceId(),"microsoft.insights/alertrules/read",this._container),this._container.assetName(u),n.options&&n.options.isDisabled)?(this._container.noDataMessage(this._disabledMessage),null):(i.Base.Security.hasPermission(n.resourceId,["./read"]).then((function(n){n||f._container.unauthorized()}),(function(){})),this._dataView.setQuery({subscriptionId:r,resourceId:n.resourceId}))},t.prototype.onDataLoaded=function(n){var t=this;this._updateUsageResults(n.usageResults());this._usageSubscription&&(this._usageSubscription.dispose(),this._usageSubscription=null);n.usageResults.subscribe(this._container,(function(n){t._updateUsageResults(n)}))},t.prototype._updateUsageResults=function(n){var i=this,t=n.first((function(n){return s.equals(n.name(),i.usageMetricName(),s.StringComparison.IgnoreCase)}));n.length===0?this._container.noDataMessage(this._noDataMessage):
t&&this._updateUsageResult(t)},t.prototype._updateUsageResult=function(n){var e=c.Format(n.currentValue(),n.unit(),this._useIECFormat),o=c.Format(n.limit(),n.unit(),this._useIECFormat),s,i,u,r;this._container.partTitle(n.displayName());this._container.noDataMessage(null);this.instance(t._convertToPercent(n.currentValue(),n.limit()));s={value:ko.observable(e.value.toString()),caption:ko.observable(h.usagePartCaptionCurrent),unit:ko.observable(c.GetDisplayUnit(e.unitDisplayName,this._useIECFormat,this._displaySIUnit)),metricColorBarKind:ko.observable(l.MetricColorBarKind.CurrentValue)};i={value:ko.observable(o.value.toString()),caption:ko.observable(h.usagePartCaptionThreshold),unit:ko.observable(c.GetDisplayUnit(o.unitDisplayName,this._useIECFormat,this._displaySIUnit)),metricColorBarKind:ko.observable(l.MetricColorBarKind.None)};n.limit()===f.UsageLimits.Unlimited&&(i.value(h.usageQuotaUnlimited),i.unit(""));u=[s,i];n.nextResetTime&&n.nextResetTime()&&(r=new Date(Date.parse(n.nextResetTime(
))),r&&r.getUTCFullYear()<9999&&u.push(this._getResetMetric(r)));this.metrics(u)},t._convertToPercent=function(n,t){return t>0?Math.round(n/t*1e4)/100:0},t.prototype._getResetMetric=function(n){var i=new Date,r=(n.getTime()-i.getTime())/1e3,t=c.Format(r,"seconds");return{value:ko.observable(t.value.toString()),caption:ko.observable(h.usagePartCaptionResets),unit:ko.observable(t.unitDisplayName),metricColorBarKind:ko.observable(l.MetricColorBarKind.None)}},t})(l.ViewModel)}))