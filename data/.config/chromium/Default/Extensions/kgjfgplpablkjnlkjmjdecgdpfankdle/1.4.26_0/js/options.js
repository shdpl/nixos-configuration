$(function(){function ct(n,t,i){var r=$("#content_success_msg"),u;t=t||r;i=i||5e3;t.html(n);u=(parseInt($(document.body).outerWidth(!0))-r.outerWidth(!0))/2;t===r&&t.css("left",u);l&&window.clearTimeout(l);t.fadeIn("slow");l=window.setTimeout(function(){t.fadeOut("slow")},i)}function p(){var t=$("#setting_schedule_meeting_with_pmi").prop("checked")||!1,n=$(".video .control-row div:not(.haslock), .audio .control-row div:not(.haslock), .options .controls>div:not(.pmi):not(.haslock)");t?(n.addClass("disabled"),n.find("input").prop("disabled",!0)):(n.removeClass("disabled"),n.find("input").prop("disabled",!1))}function lt(){var n=$("#setting_option_signedin").prop("checked")||!1;n?$(".watermark").show():$(".watermark").hide()}function w(){var t=$("#setting_option_needpassword").prop("checked")||!1,n=$(".password-type");t?n.show():n.hide()}function b(){var n=$("#setting_option_signedin").prop("checked")||!1;n?$("#domainField").show():$("#domainField").hide()}function a(){var n=!0;return $("#setting_option_signedin").is(":visible")&&$("#setting_option_signedin").prop("checked")&&(vt($("#enforce_loginSD_info").val())?($("#enforce_loginSD_info").parent().removeClass("has-error"),$("#enforce_loginSD_info").next().hide()):($("#enforce_loginSD_info").parent().addClass("has-error"),$("#enforce_loginSD_info").focus().next().show(),n=!1)),n}function v(){var n=!0;return $("#alternative_host").is(":visible")&&$("#alternative_host").val()!=""&&(yt($("#alternative_host").val())?($("#alternative_host").parent().removeClass("has-error"),$("#alternative_host").next().hide()):($("#alternative_host").parent().addClass("has-error"),$("#alternative_host").focus().next().show(),$("#alternative_host").next().text("Enter valid email addresses. Separate multiple domains by semicolon"),n=!1)),n}function i(n,t){var i=chrome.i18n.getMessage(n);return t&&(i=t[n].message),i}function at(){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState==4)try{var t=JSON.parse(n.responseText);$(".content-header>p").text(i("setting_h1",t));$(".video > span").text(i("setting_video",t));$(".video .control-row .video-label").first().text(i("setting_video_host",t));$(".video .control-row .video-label").last().text(i("setting_video_participant",t));$(".video #option_video_host_on").next().text(i("setting_video_on",t));$(".video #option_video_participant_on").next().text(i("setting_video_on",t));$(".video #option_video_host_off").next().text(i("setting_video_off",t));$(".video #option_video_participant_off").next().text(i("setting_video_off",t));$(".audio > span").text(i("setting_audio",t));$(".audio #option_audio_telephony").next().text(i("setting_audio_tel",t));$(".audio #option_audio_voip").next().text(i("setting_audio_voip",t));$(".options > span").text(i("setting_opts",t));$(".options #setting_option_needpassword").next().text(i("setting_opts_requirepwd",t));$(".options #setting_option_needpassword").next().text(i("setting_opts_requirepwd",t));$(".options #setting_option_jbh").next().text(i("setting_opts_jbh",t));$(".options #setting_option_jbh").next().text(i("setting_opts_jbh",t));$(".altnativehost > span").text(i("setting_opts_althost",t))}catch(r){}};n.open("GET",chrome.extension.getURL("/_locales/"+COMMON.getValue("zoom_locale")+"/messages.json"),!0);n.send()}function vt(n){var t=$.trim(n).split(/[;,\n\r]+/),i;if(""==t)return!0;valid=!0;for(i in t)n=$.trim(t[i]),valid=valid&&ht("a@"+n);return valid===!0}function yt(n){var t=$.trim(n).split(/[;,\n\r]+/),i,r;if(""==t)return!0;valid=!0;for(i in t)r=$.trim(t[i]),valid=valid&&ht(r);return valid===!0}function ht(n){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(n)}var l,r,n,t,k,d,e,g,nt,tt,it,rt,ut,ft,et,s,h,c,ot,u,f,y,o,st;$("#setting_schedule_meeting_with_pmi").change(function(){p()});$("#setting_option_signedin").change(function(){lt()});$("#setting_option_needpassword").change(function(){w()});$("#setting_option_signedin").change(function(){b()});$("#setting_recording_type").change(function(){var n=$("#setting_recording_type").prop("checked")||!1;n?$(".recording-radio").show():$(".recording-radio").hide()});$(".schedule-for").change(function(){var n=$(".video .control-row div:not(.haslock), .audio .control-row div:not(.haslock), .options .controls>div:not(.pmi):not(.haslock)");return n.find("input").prop("disabled",!1),n.removeClass("disabled"),$(this).val()===""?($(".options>.controls>div.pmi").show(),$("#setting_schedule_meeting_with_pmi").trigger("change")):$(".options>.controls>div.pmi").hide(),!1});$("#enforce_loginSD_info").keyup(function(){var n=$(this),t=n.val();return t.length>0?window.setTimeout(function(){a()},500):($("#enforce_loginSD_info").parent().removeClass("has-error"),$("#enforce_loginSD_info").next().hide()),!1});$("#alternative_host").keyup(function(){var n=$(this),t=n.val();return t.length>0?window.setTimeout(function(){v()},500):($("#alternative_host").parent().removeClass("has-error"),$("#alternative_host").next().hide()),!1});$(".topnav").delegate("li[data-tab]","click",function(n){a()&&v()&&($(this).hasClass("active")||($(".topnav > li").removeClass("active"),$(this).addClass("active"),$(".content-body > form >div.tab-pane").hide(),$(".content-body > form >div."+$(this).data("tab")).show()),n.preventDefault(),n.stopPropagation())});r='<a class="locked_by_admin" href="javascript:;" aria-describedby="locktip" title="The setting is locked and cannot be changed. All of your meetings will use this setting."><i><\/i><span class="sr-only">Locked Option<\/span><\/a>';at();n=COMMON.getZoomData();n&&n.audiopac||$(".content-header > .topnav").hide();n&&(t=n.lockedoptions);k=COMMON.getValue("zoom_config_video_host")||"on";d=COMMON.getValue("zoom_config_video_participants")||"on";$("[name=option_video_host][value="+k+"]").prop({checked:!0});$("[name=option_video_participants][value="+d+"]").prop({checked:!0});t&&t.hostVideo_locked&&($("[name=option_video_host]").prop("disabled",!0),$(".video .video-controls-label:first").append(r).addClass("haslock"));t&&t.pVideo_locked&&($("[name=option_video_participants]").prop("disabled",!0),$(".video .video-controls-label:last").append(r).addClass("haslock"));e=COMMON.getValue("zoom_config_audio")||"both";n&&!n.option_has3rd&&($(".audio>div.controls #option_audio_3rd").parent().remove(),"other"==e&&(e="both"),$("#option_audio_both").next().text("Both"));n&&n.option_noboth&&($(".audio>div.controls #option_audio_both").parent().remove(),"both"==e&&(e="telephony"));$("[name=option_audio][value="+e+"]").prop({checked:!0});t&&t.audio_locked&&($("[name=option_audio]").prop("disabled",!0),$(".audio .controls[role=group]").append(r).addClass("haslock"));g=!!COMMON.getValue("zoom_config_has_password");nt=COMMON.getValue("zoom_config_pwdtype")||"1";$("#setting_option_needpassword").prop("checked",g);$("[name=option_password_type][value="+nt+"]").prop({checked:!0});tt=!!COMMON.getValue("zoom_config_jbh");$("#setting_option_jbh").prop("checked",tt);t&&t.jbh_locked&&($(".jbh input").prop("disabled",!0),$(".control-row.jbh").append(r).addClass("haslock"));it=!!COMMON.getValue("zoom_config_mute_upon_entry");$("#setting_option_uponentry").prop("checked",it);n&&n.PMI&&$(".options .pmi_number").text(n.PMI);rt=!!COMMON.getValue("zoom_config_pmi");$("#setting_schedule_meeting_with_pmi").prop("checked",rt);n&&n.forcelogin&&n.forcelogin.support?(ut=n.forcelogin,ut.domain_login?$(".control-row .simple").remove():($(".control-row .domain").remove(),$("#domainField").remove()),$("#setting_option_signedin").prop("checked",!!COMMON.getValue("zoom_config_signedin")),$("#enforce_loginSD_info").val(COMMON.getValue("zoom_config_domaininfo")||""),t&&(t.simple_login_locked||t.domain_login_locked)&&($(".signedin > label").append(r).parent().addClass("haslock"),$(".signedin label>input").prop("disabled",!0),t.domain_login_locked&&$("#domainField input").prop("disabled",!0)),$("#setting_option_signedin").is(":visible")&&!$("#setting_option_signedin").prop("checked")&&$("#setting_option_watermark").parents("div.control-row").hide()):($("#setting_option_signedin").parents("div.control-row").remove(),$("#setting_option_watermark").parents("div.control-row").remove());n&&n.option_enable_watermark?(ft=!!COMMON.getValue("zoom_config_watermark"),$("#setting_option_watermark").prop("checked",ft),t&&t.watermark_locked&&($("#setting_option_watermark").prop("checked",!0).prop("disabled",!0),$(".control-row.watermark").append(r).addClass("haslock"))):$("#setting_option_watermark").parents("div.control-row").remove();n&&!n.option_haspublic_cal?$("#setting_option_public_cal").parents("div.control-row").remove():(et=!!COMMON.getValue("zoom_config_public_cal"),$("#setting_option_public_cal").prop("checked",et),t&&t.public_cal_locked&&($(".control-row.pubcalendar").append(r).addClass("haslock"),$("#setting_option_public_cal").prop("disabled",!0)));n&&n.recording&&n.recording.option_recording&&($("div.recording").removeClass("hideme"),s=COMMON.getValue("zoom_config_rectype")||0,1==s||2==s?$("#setting_recording_type").prop("checked",!0):$("#setting_recording_type").prop("checked",!1),n.recording.option_local_recording&&n.recording.option_cloud_recording?($("#setting_recording_type").prop("checked")||$(".recording-radio").hide(),2==s?$("[name=option_rec_type][value="+s+"]").prop({checked:!0}):$("[name=option_rec_type][value=1]").prop({checked:!0})):n.recording.option_local_recording?($("#setting_recording_type").next().append(" on the local computer"),$(".recording-radio").remove()):($("#setting_recording_type").next().append(" in the cloud"),$(".recording-radio").remove()),t&&t.autoRecordLocked&&($(".recording input").prop("disabled",!0),$(".recording > label").append(r).parent().addClass("haslock")));h=COMMON.getValue("zoom_config_schedule_for");n&&n.assistants&&(c=n.assistants);c&&c.length>0?(ot=$(".schedule-for")[0],$.each(c,function(n,t){ot[n+1]=new Option(t.name,t.id);t.id==h&&$(".schedule-for").val(h)})):$(".schedule").hide();h&&h==$(".schedule-for").val()&&$(".options>.controls>div.pmi").hide();n?n.alt_hosts===undefined?$(".altnativehost").hide():n.alt_hosts&&$("#alternative_host").val(COMMON.getValue("zoom_config_althost")||""):$(".altnativehost").hide();$("#fixed_popup").prop("checked",!!COMMON.getValue("zoom_config_fixed_popup"));u=parseInt(COMMON.getValue("zoom_config_pacindex")||"1",10);(isNaN(u)||u<1||u>2)&&(u=1,COMMON.saveValue("zoom_config_pacindex","1"));n&&n.audiopac&&(f=n.audiopac);f&&f.option_pac_enable&&(y=u-1,f.acclist.length<2&&($("#option_pac_acc2").parent().remove(),y=0,u=1),$("[name=option_pac][value="+u+"]").prop("checked",!0),o=f.acclist[y],st=$(".pac").find(".pac-toll-numbers"),$.each(o.toll_numbers,function(n,t){st.append("<label>"+t+"<\/label>")}),$(".pac").find(".pac-mtg-number").text(o.meeting_number),o.did_numbers&&o.did_numbers!=""?$(".pac").find(".pac-did-numbers").html("<label>"+o.did_numbers+"<\/label>"):$(".pac").find(".pac-did-numbers").parent().hide());COMMON.getValue("zoom_config_fte")&&parseInt(COMMON.getValue("zoom_options_tabid"))>0?($("#setting_submit").text("Save and Continue"),$("#setting_cancel").hide()):($("#setting_submit").text("Save Changes"),$("#setting_cancel").show());p();w();b();$("[name=option_pac]").change(function(){var i=parseInt($(this).val(),10)-1,n,t;f&&f.option_pac_enable&&(n=f.acclist[i],t=$(".pac").find(".pac-toll-numbers").empty(),$.each(n.toll_numbers,function(n,i){t.append("<label>"+i+"<\/label>")}),$(".pac").find(".pac-mtg-number").text(n.meeting_number),n.did_numbers&&n.did_numbers!=""?($(".pac").find(".pac-did-numbers").html("<label>"+n.did_numbers+"<\/label>"),$(".pac").find(".pac-did-numbers").parent().show()):$(".pac").find(".pac-did-numbers").parent().hide())});$("#setting_submit").click(function(){var t,i,n;return($(".topnav").is(":visible")&&$(".topnav li:last-child").hasClass("active")&&$(".topnav li:first-child").click(),COMMON.saveValue("zoom_config_schedule_for",$(".schedule-for").val()),COMMON.saveValue("zoom_config_pmi",$("#setting_schedule_meeting_with_pmi").is(":visible")&&$("#setting_schedule_meeting_with_pmi").prop("checked")),COMMON.saveValue("zoom_config_has_password",$("#setting_option_needpassword").prop("checked")),COMMON.saveValue("zoom_config_jbh",$("#setting_option_jbh").prop("checked")),COMMON.saveValue("zoom_config_mute_upon_entry",$("#setting_option_uponentry").prop("checked")),COMMON.saveValue("zoom_config_public_cal",$("#setting_option_public_cal").is(":visible")&&$("#setting_option_public_cal").prop("checked")),COMMON.saveValue("zoom_config_video_host",$("[name=option_video_host]:checked").val()),COMMON.saveValue("zoom_config_video_participants",$("[name=option_video_participants]:checked").val()),COMMON.saveValue("zoom_config_audio",$("[name=option_audio]:checked").val()),COMMON.saveValue("zoom_config_pacindex",$("[name=option_pac]:checked").val()),COMMON.saveValue("zoom_config_pwdtype",$("#setting_option_needpassword").prop("checked")?$("[name=option_password_type]:checked").val():"1"),COMMON.saveValue("zoom_config_watermark",$("#setting_option_watermark").is(":visible")&&$("#setting_option_watermark").prop("checked")),t=-1,i=COMMON.getZoomData(),$("#setting_recording_type").is(":visible")&&(t=$("#setting_recording_type").prop("checked")?i.recording.option_local_recording&&i.recording.option_cloud_recording?$("[name=option_rec_type]:checked").val():i.recording.option_local_recording?1:2:0),COMMON.saveValue("zoom_config_rectype",t),COMMON.saveValue("zoom_config_signedin",$("#setting_option_signedin").is(":visible")&&$("#setting_option_signedin").prop("checked")),$("#setting_option_signedin").prop("checked")&&COMMON.saveValue("zoom_config_domaininfo",$("#enforce_loginSD_info").val()),COMMON.saveValue("zoom_config_fixed_popup",$("#fixed_popup").is(":visible")&&$("#fixed_popup").prop("checked")),n={},n.zoom_config_schedule_for=$(".schedule-for").val(),n.zoom_config_pmi=$("#setting_schedule_meeting_with_pmi").is(":visible")&&$("#setting_schedule_meeting_with_pmi").prop("checked"),n.zoom_config_has_password=$("#setting_option_needpassword").prop("checked"),n.zoom_config_jbh=$("#setting_option_jbh").prop("checked"),n.public_cal=$("#setting_option_public_cal").is(":visible")&&$("#setting_option_public_cal").prop("checked"),n.mute_upon_entry=$("#setting_option_uponentry").prop("checked"),n.zoom_config_video_host=$("[name=option_video_host]:checked").val(),n.zoom_config_video_participants=$("[name=option_video_participants]:checked").val(),n.zoom_config_audio=$("[name=option_audio]:checked").val(),n.zoom_config_pacindex=$("[name=option_pac]:checked").val(),n.zoom_config_pwdtype=$("#setting_option_needpassword").prop("checked")?$("[name=option_password_type]:checked").val():"1",n.record_type=t,n.zoom_config_watermark=$("#setting_option_watermark").is(":visible")&&$("#setting_option_watermark").prop("checked"),n.zoom_config_signedin=$("#setting_option_signedin").is(":visible")&&$("#setting_option_signedin").prop("checked"),n.zoom_config_domaininfo=$("#setting_option_signedin").prop("checked")?$("#enforce_loginSD_info").val():"",n.zoom_config_alternativehost=$("#alternative_host").val(),n.zoom_config_fixed_popup=$("#fixed_popup").is(":visible")&&$("#fixed_popup").prop("checked"),!a()||!v())?!1:(COMMON.getValue("zoom_config_fte")&&parseInt(COMMON.getValue("zoom_options_tabid"))>0?COMMON.saveZoomSetting(n,function(){COMMON.saveValue("zoom_config_fte",!1);COMMON.saveValue("zoom_config_althost",$("#alternative_host").val());chrome.tabs.update(parseInt(COMMON.getValue("zoom_options_tabid")),{url:COMMON.getGoogleCalendarUrl()},function(){})},function(n){$("#alternative_host").parent().addClass("has-error");$("#alternative_host").focus().next().text(n.errorMessage);$("#alternative_host").focus().next().show()}):COMMON.saveZoomSetting(n,function(){COMMON.saveValue("zoom_config_althost",$("#alternative_host").val());ct("Your settings have been saved.")},function(n){$("#alternative_host").parent().addClass("has-error");$("#alternative_host").focus().next().text(n.errorMessage);$("#alternative_host").focus().next().show()}),!1)});$("#setting_cancel").click(function(){return chrome.tabs.getCurrent(function(n){chrome.tabs.remove(n.id,function(){})}),!1});$(":checkbox").click(function(){$(this).attr("checked",!$(this).attr("checked"))});$(":radio").click(function(){var n=$(this).attr("name");$("[name="+n+"]").not(this).attr("checked",!1);$(this).attr("checked",!0)});COMMON.checkPoint(function(){})})