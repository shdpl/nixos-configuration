(function(){ComboBox=function(n,t){var f,r,i,o,e,u,s;if((this.edit=document.getElementById(n),!this.edit)||(f=document.getElementById(n).parentNode.getElementsByTagName("DIV"),f.length==0||f[0].className!="dropdownlist"))return null;for(this.dropdownlist=f[0],this.comboBoxDiv=this.dropdownlist.parentNode.parentNode.getElementsByTagName("DIV")[0],this.isOpen=!1,this.switchOpen=function(){i.isOpen?(i.dropdownlist.style.display="none",i.comboBoxDiv.className="combobox",setTimeout(function(){i.isOpen=!1},150)):(i.dropdownlist.style.display="block",i.comboBoxDiv.className="combobox combobox_active",setTimeout(function(){i.isOpen=!0;i.edit.focus()},150))},r=this,r.fnChange=null,t&&t.onChange&&(r.fnChange=t.onChange),this.currentitem=null,this.currentitemindex=null,this.visiblecount=0,i=this,o=document.getElementById(n).parentNode.getElementsByTagName("SPAN"),o[0].onclick=function(){i.edit.click()},this.edit.onfocus=function(){i.isOpen||i.switchOpen()},this.edit.onclick=function(){i.switchOpen()},this.edit.onblur=function(){e&&i.isOpen&&i.switchOpen(!0)},e=!0,i.dropdownlist.onmousedown=function(){return e=!1,!1},i.dropdownlist.onmouseup=function(){return setTimeout(function(){e=!0},150),!1},this.listitems=this.dropdownlist.getElementsByTagName("A"),u=0;u<this.listitems.length;u++)s=u,this.listitems[u].onclick=function(){var n=this.innerHTML;return n=n.replace(/\<b\>/ig,""),n=n.replace(/\<\/b\>/ig,""),i.edit.value=n,r.fnChange&&r.fnChange.apply(r,[n]),i.switchOpen(),!1},this.listitems[u].onmouseover=function(){for(var n=0;n<i.listitems.length;n++)this==i.listitems[n]&&(i.currentitem&&(i.currentitem.className=i.currentitem.className.replace(/light/g,"")),i.currentitem=i.listitems[n],i.currentitemindex=n,i.currentitem.className+=" light")};this.edit.onkeydown=function(n){var t,r;if(n=n||window.event,n.keyCode==13)return!1;if(n.keyCode==38){if(t=0,i.visiblecount>0){i.visiblecount==1&&(i.currentitemindex=i.listitems.length-1);do i.currentitemindex--,t++;while(i.currentitemindex>0&&i.listitems[i.currentitemindex].style.display=="none");i.currentitemindex<0&&(i.currentitemindex=i.listitems.length-1);i.currentitem&&(i.currentitem.className=i.currentitem.className.replace(/light/g,""));i.currentitem=i.listitems[i.currentitemindex];i.currentitem.className+=" light";i.currentitem.scrollIntoView(!1)}return n.cancelBubble=!0,navigator.appName!="Microsoft Internet Explorer"&&(n.preventDefault(),n.stopPropagation()),!1}if(n.keyCode==40){if(r=0,i.visiblecount>0){do i.currentitemindex++;while(i.currentitemindex<i.listitems.length&&i.listitems[i.currentitemindex].style.display=="none");i.currentitemindex>=i.listitems.length&&(i.currentitemindex=0);i.currentitem&&(i.currentitem.className=i.currentitem.className.replace(/light/g,""));i.currentitem=i.listitems[i.currentitemindex];i.currentitem.className+=" light";i.currentitem.scrollIntoView(!1)}return n.cancelBubble=!0,navigator.appName!="Microsoft Internet Explorer"&&(n.preventDefault(),n.stopPropagation()),!1}};this.edit.onkeyup=function(n){if(n=n||window.event,n.keyCode==9||n.keyCode==40||n.keyCode==38){i.visiblecount==0&&(i.visiblecount=i.listitems.length);return}if(n.keyCode==13){if(i.visiblecount!=0){var t=i.currentitem.innerHTML;i.edit.value=t}if(r.fnChange)r.fnChange.apply(r,[t]);else return i.switchOpen(),n.cancelBubble=!0,!1}}}})()