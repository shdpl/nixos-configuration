FxImpl.setupRequire({bundles:{"***0MsPortalImpl/Init":["Fx/Feedback","Fx/Pinner","FxHubs/CloudNameCommon","FxHubs/HubsSettingsSchema","FxHubs/Permissions","FxHubs/ResourceProvider","FxHubs/RpcEndPoints"],"**0MsPortalImpl/Init":["Viva.Controls/Util/Viva.Util.Private","Viva.Controls/Util/Viva.Util","_generated/Less/MsPortalImpl.Controls/Controls/Base.css","Viva.Controls/Controls/Base/Viva.Image","Viva.Controls/Controls/Base/Viva.KnockoutExtensions","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.CssSelectorParser","_generated/Less/MsPortalImpl/Themes/Themes.Reset.css","_generated/Less/MsPortalImpl/Themes/Themes.Blue.css","_generated/Less/MsPortalImpl/Themes/Themes.LightMode.css","_generated/Less/MsPortalImpl/Themes/Themes.Reset.Colors.css","MsPortalImpl/Base/Themes","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.KnockoutBindingSanitizer","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer",
"MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl.Controls/Controls/Base/OptionsBase","MsPortalImpl.Controls/Controls/Base/Loadable","_generated/Less/Viva.Controls/Controls/Base/Viva.Base.css","Viva.Controls/Controls/Base/Viva.Base","Viva.Controls/Util/Viva.Positioning","_generated/Less/Viva.Controls/Controls/Viva.Balloon.css","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","Viva.Controls/Controls/Viva.Balloon","MsPortalImpl.Controls/Controls/Balloon","MsPortalImpl.Controls/Controls/Base/WidgetBindingHandler","Viva.Controls/Util/Viva.DateUtil","MsPortalImpl/Base/Base.KeyboardHelper","Viva.Controls/Controls/Base/Viva.Validators","Viva.Controls/Controls/Base/Viva.EditableControl","Viva.Controls/Controls/Base/Viva.ValidatableControl","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Generated/SvgStartupDefinitions",
"MsPortalImpl/Widgets/Widgets.Common","_generated/Less/Viva.Controls/Controls/Forms/Viva.Button.css","Viva.Controls/Controls/Base/Viva.ValueUpdateTrigger","Viva.Controls/Controls/Base/Viva.TypableControl","_generated/Less/Viva.Controls/Controls/Forms/Viva.TextBox.css","Viva.Controls/Controls/Forms/Viva.TextBox","MsPortalImpl/Base/Base.Selectable2.ClickContext","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Base/Telemetry","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Selectable2.Common","MsPortalImpl/UI/Compositions/UI.Composition.Pipeline","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.Events","MsPortalImpl/Services/Services.PortalIdentity","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Extension/AddCloudName","MsPortalImpl/ViewModels/ViewModels.BladeCaller",
"MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.BreadCrumb.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css",
"_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Base/Base.Router","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Base/Languages","MsPortalImpl/Services/Services.AssetTypes.Utils","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/UI/Compositions/UI.Composition.CloudName","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/Widgets/Widgets.CommandBarBase",
"MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","_generated/Templates/WidgetsContextMenu","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/Interactions/Interactions.FocusHandler","_generated/Templates/PartError","_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css","MsPortalImpl/Widgets/Widgets.PartError","_generated/Templates/Part","_generated/Less/MsPortalImpl/Parts/Parts.Part.css","_generated/Less/MsPortalImpl/CustomPart.css","_generated/Less/MsPortalImpl/CustomForm.css","MsPortalImpl/Parts/Parts","MsPortalImpl/Interactions/Interactions.RightClick","_generated/Templates/WidgetsTileActionBar","MsPortalImpl/Widgets/Widgets.TileActionBar","_generated/Templates/WidgetsTile","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer",
"MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/Parts/Parts.Error","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","_generated/Templates/WidgetsDropMenu","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.FlowLayout","_generated/Templates/WidgetsStartboard","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Services/Services.SettingsProcessor","MsPortalImpl/Services/Services.GeneralSettings"],"*0MsPortalImpl/Init":["MsPortalImpl.Controls/Controls/ResourceFilterHelper","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Base/Base.CustomControlsBladeHost","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Base/Base.GenericPopup","MsPortalImpl/Base/Base.HierarchyMap","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Controls/ControlBindings.Async","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Controls/ControlBindings",
"_generated/Less/MsPortalImpl/Widgets/CopyField.css","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand","MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/ClaimsIdentity","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.Permissions","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/Compositions/UI.Composition.JourneySettingSerializer","MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Dashboard/DashboardRepository","MsPortalImpl/UI/Dashboard/ArmDashboardRepository","MsPortalImpl/UI/Dashboard/DashboardCompressor","MsPortalImpl/UI/Dashboard/PrivateDashboardRepository",
"MsPortalImpl/UI/Dashboard/DashboardClient","MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository","_generated/Templates/WidgetsAvatarMenu","_generated/Templates/WidgetsAvatarMenuButton","MsPortalImpl/Widgets/Widgets.AvatarMenu","MsPortalImpl/Widgets/Widgets.BreadCrumbViewModel","_generated/Templates/WidgetsBreadCrumb","_generated/Templates/WidgetsBreadCrumbOverFlow","MsPortalImpl/Widgets/Widgets.BreadCrumb","_generated/Templates/WidgetsJourneysMenu","_generated/Templates/WidgetsJourneysMenuButton","MsPortalImpl/Widgets/Widgets.JourneysMenu","_generated/Templates/WidgetsTopBar","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/UI/Dashboard/DashboardManager","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop","_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css","MsPortalImpl/UI/UI.DesktopModeManager","MsPortalImpl/UI/Compositions/UI.Composition.Services",
"MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager","_generated/Less/MsPortalImpl/Base/Base.Images.css","_generated/Less/MsPortalImpl/Widgets/HighContrastMode.css","_generated/Less/MsPortalImpl/Themes/Themes.Universal.css","_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Interactions/Interactions.ContextMenuTouch","MsPortalImpl/Widgets/Widgets.ContextPane","_generated/Templates/WidgetsHelpMenu","_generated/Templates/WidgetsHelpMenuButton","MsPortalImpl/Widgets/Widgets.HelpMenu","_generated/Templates/WidgetsNotificationMenu","_generated/Templates/WidgetsNotificationMenuButton","MsPortalImpl/Widgets/Widgets.ToastViewModel","_generated/Templates/WidgetsToast","MsPortalImpl/Widgets/Widgets.Toast","MsPortalImpl/Widgets/Widgets.NotificationMenu","_generated/Templates/WidgetsPanorama","MsPortalImpl/Widgets/Widgets.Panorama",
"_generated/Templates/WidgetsSearch","MsPortalImpl/Widgets/Widgets.Search","_generated/Templates/WidgetsSideBar","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Services/Services.FileUploadInitialization","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/_generated/Common/Relex.Channel","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/ExtensionMetadataSource","MsPortalImpl/GalleryPackage/GalleryPackageLoader","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css","MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Services/Services.AzureStorage","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Services.Controller","MsPortalImpl/Services/Services.FileUploadEndpointRegistration","MsPortalImpl/Services/Services.GalleryEndpoints","MsPortalImpl/Services/Services.FavoritesSettings",
"_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/Services/Services.PortalTips","MsPortalImpl/Services/Services.SharedSettings","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.ShellProvisioner","MsPortalImpl/Services/Services.TelemetrySharing","MsPortalImpl/Services/Services.Util","MsPortalImpl/UI/Hubs/ViewModels/UI.Hubs.Common","MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration","MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks","MsPortalImpl/UI/UI.NpsHelper","MsPortalImpl/UI/Hubs/UI.ResourceMapManagerRpc","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration","MsPortalImpl/UI/UI.StatusHandler","MsPortalImpl/UI/UI.ViewTimeTelemetry","_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css","MsPortalImpl/Parts/Parts.ButtonPart","_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",
"MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration","_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css","MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog","_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css","MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup","_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css","MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.Initialize","MsPortalImpl/Init"],"**1MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2":["Viva.Controls/Util/Viva.TemplateEngine","MsPortalImpl/Base/Base.Timers","_generated/Less/Viva.Controls/Util/Viva.Resize.css","Viva.Controls/Util/Viva.Resize","MsPortalImpl/UI/Commands/UI.Commands.Base","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ActionHandler","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ExtensibleControl",
"MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Base","MsPortalImpl/Base/Base.FeatureDetection"],"*1MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2":["MsPortalImpl.Controls/Controls/Controls.ContextMenuHelpers","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Focus","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Formatters","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Selection","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Formatters.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Base","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Plugins","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Impl","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.ContextMenu.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.ContextMenu","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Scrolling.css",
"MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Scrolling","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Focus.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Focus","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Selection.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Selection","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Sorting.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Sorting","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Resizing.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Resizing","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2"],"**3MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1":["Viva.Controls/Controls/Base/Viva.ExtensibleControl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters.Helpers","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Formatters.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.PercentFormatter.css",
"Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.FocusableRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow","_generated/Less/Viva.Controls/Controls/Forms/Viva.CheckBox.css","Viva.Controls/Controls/Forms/Viva.CheckBox","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid1.Formatters.css","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Formatter","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SelectableRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.EditableRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.EditableRow","MsPortalImpl.Controls/Controls/Base/Formatters","_generated/Less/Viva.Controls/Controls/Viva.DockedBalloon.css",
"Viva.Controls/Controls/Viva.DockedBalloon","Viva.Controls/Controls/Forms/Viva.Button","MsPortalImpl.Controls/Fields/Base/LabelAndBalloonWidget","_generated/Less/Viva.Controls/Controls/Base/Viva.ValidationPlacements.css","Viva.Controls/Controls/Base/ValidationPlacements/Viva.Base","Viva.Controls/Controls/Base/ValidationPlacements/Viva.Css","Viva.Controls/Controls/Base/ValidationPlacements/Viva.DockedBalloon","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SelectableRowActivate.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRowActivate","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.SelectableRow","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.RightClickableRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.RightClickableRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ContextMenuShortcut.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ContextMenuShortcut","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ContextMenuShortcut",
"MsPortalImpl/Controls/Helpers/Validation","_generated/Less/MsPortalImpl.Controls/Fields/Fields.css","MsPortalImpl.Controls/Fields/Base/Field","MsPortalImpl.Controls/Fields/TextField","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.EditableRow","_generated/Less/Viva.Controls/Controls/Forms/Viva.SearchBox.css","Viva.Controls/Controls/Forms/Viva.SearchBox","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Filterable.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Filterable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Filterable","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRowHover","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRowHover","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FormatterHtmlBindings","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Groupable.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Groupable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Groupable","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Hierarchical.css",
"Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Hierarchical","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Hierarchical","_generated/Less/Viva.Controls/Controls/Viva.Pager.css","Viva.Controls/Controls/Viva.Pager","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Pageable.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Pageable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Pageable","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ReorderRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ReorderRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ReorderRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ResizableColumn.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ResizableColumn","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ResizableColumn","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Scrollable.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Scrollable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Scrollable",
"_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SortableColumn.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SortableColumn","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.SortableColumn","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1"],"**MsPortalImpl/Generated/SvgDefinitions":["MsPortalImpl/Generated/SvgDefinitions"],"*_generated/Templates/WidgetsPortal":["_generated/Templates/WidgetsPortal"],"*_generated/Templates/SplashScreen":["_generated/Templates/SplashScreen"],"*_generated/Templates/AttachmentControlIcon":["_generated/Templates/AttachmentControlIcon"],"*_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css":["_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Reset.ColorsAlt.css":["_generated/Less/MsPortalImpl/Themes/Themes.Reset.ColorsAlt.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Light.css":["_generated/Less/MsPortalImpl/Themes/Themes.Light.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.DarkMode.css":
["_generated/Less/MsPortalImpl/Themes/Themes.DarkMode.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Dark.css":["_generated/Less/MsPortalImpl/Themes/Themes.Dark.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.BlueAlt.css":["_generated/Less/MsPortalImpl/Themes/Themes.BlueAlt.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Blades.Light.css":["_generated/Less/MsPortalImpl/Themes/Themes.Blades.Light.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Blades.DarkMode.css":["_generated/Less/MsPortalImpl/Themes/Themes.Blades.DarkMode.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Blades.Dark.css":["_generated/Less/MsPortalImpl/Themes/Themes.Blades.Dark.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Blades.BlueAlt.css":["_generated/Less/MsPortalImpl/Themes/Themes.Blades.BlueAlt.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Blades.Azure.css":["_generated/Less/MsPortalImpl/Themes/Themes.Blades.Azure.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Azure.css":["_generated/Less/MsPortalImpl/Themes/Themes.Azure.css"],
"*_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Reordering.css":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Reordering.css"],"*_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Grouping.css":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Grouping.css"],"*_generated/Less/CoBrand/Site.css":["_generated/Less/CoBrand/Site.css"],"*_generated/Less/CoBrand/rtl/Site.css":["_generated/Less/CoBrand/rtl/Site.css"],"*_generated/Content/Scripts/_oss/monaco-editor/min/vs/editor/editor.main.css":["_generated/Content/Scripts/_oss/monaco-editor/min/vs/editor/editor.main.css"],"*Viva.Controls/Controls/Viva.MouseCompanion":["_generated/Less/Viva.Controls/Controls/Viva.MouseCompanion.css","Viva.Controls/Controls/Viva.MouseCompanion"],"*Viva.Controls/Controls/Viva.Command":["Viva.Controls/Controls/Viva.Command"],"**Viva.Controls/Controls/Visualization/Viva.SvgBase":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.SvgBase.css"],
"*Viva.Controls/Controls/Visualization/Viva.SvgBase":["Viva.Controls/Controls/Visualization/Viva.SvgBase"],"*Viva.Controls/Controls/Visualization/Viva.SparkLine":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.SparkLine.css","Viva.Controls/Controls/Visualization/Viva.SparkLine"],"**Viva.Controls/Controls/Visualization/Viva.BarGauge":["Viva.Controls/Controls/Visualization/Viva.GaugeBase"],"*Viva.Controls/Controls/Visualization/Viva.BarGauge":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.BarGauge.css","Viva.Controls/Controls/Visualization/Viva.BarGauge"],"*Viva.Controls/Controls/Visualization/Graph/GraphEntitiesAddition":["Viva.Controls/Controls/Visualization/Graph/GraphEntitiesAddition"],"*Viva.Controls/Controls/Visualization/Graph/Commands/ICommand":["Viva.Controls/Controls/Visualization/Graph/Commands/ICommand"],"*Viva.Controls/Controls/Toolbars/Viva.ToolbarGroupType":["Viva.Controls/Controls/Toolbars/Viva.ToolbarGroupType"],"**Viva.Controls/Controls/Forms/Viva.Password.StrengthIndicator":
["_generated/Less/Viva.Controls/Controls/Forms/Viva.Password.css","Viva.Controls/Controls/Forms/Viva.Password"],"*Viva.Controls/Controls/Forms/Viva.Password.StrengthIndicator":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.ColorBar.css","Viva.Controls/Controls/Visualization/Viva.ColorBar","Viva.Controls/Controls/Forms/Viva.Password.StrengthIndicator"],"*Viva.Controls/Controls/Forms/Viva.CommandButton":["_generated/Less/Viva.Controls/Controls/Forms/Viva.CommandButton.css","Viva.Controls/Controls/Forms/Viva.CommandButton"],"*Viva.Controls/Controls/Base/Viva.Sanitizer":["Viva.Controls/Controls/Base/Viva.Sanitizer"],"*MsPortalImpl/Widgets/Widgets.SharedOptionsInit":["MsPortalImpl/Widgets/Widgets.SharedOptionsInit"],"**MsPortalImpl/Widgets/Widgets.ShareDashboardPane":["MsPortalImpl/UI/UI.PartGalleryDataClient"],"*MsPortalImpl/Widgets/Widgets.ShareDashboardPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.ShareDashboardPane.css","MsPortalImpl/Widgets/Widgets.ShareDashboardPane"],
"*MsPortalImpl/Widgets/Widgets.SettingsPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.SettingsPane.css","MsPortalImpl/Widgets/Widgets.SettingsPane"],"*MsPortalImpl/Widgets/Widgets.SearchDefered":["_generated/Less/MsPortalImpl/Widgets/Widgets.SearchDefered.css","MsPortalImpl/Widgets/Widgets.SearchDefered"],"*MsPortalImpl/Widgets/Widgets.Nps":["MsPortalImpl/Widgets/Widgets.Nps"],"*MsPortalImpl/Widgets/Widgets.NotificationsPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationsPane.css","MsPortalImpl/Widgets/Widgets.NotificationsPane"],"*MsPortalImpl/Widgets/Widgets.KeyboardShortcutsPane":["MsPortalImpl/Widgets/Widgets.KeyboardShortcutsPane"],"*MsPortalImpl/Widgets/Widgets.FilterPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.FilterPane.css","MsPortalImpl/Widgets/Widgets.FilterPane"],"*MsPortalImpl/Widgets/Widgets.FeedbackPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.FeedbackPane.css","MsPortalImpl/Widgets/Widgets.FeedbackPane"],"*MsPortalImpl/Widgets/Widgets.DebugHub.Performance.Timeline":
["_generated/Less/MsPortalImpl/Widgets/Widgets.DebugHub.Performance.Timeline.css","MsPortalImpl/Widgets/Widgets.DebugHub.Performance.Timeline"],"*MsPortalImpl/Widgets/Widgets.Console":["_generated/Less/MsPortalImpl/Widgets/Widgets.Console.css","MsPortalImpl/Widgets/Widgets.Console"],"*MsPortalImpl/ViewModels/ViewModels.Forms":["MsPortalImpl/ViewModels/ViewModels.Forms"],"*MsPortalImpl/UI/UI.Portal.Actions":["MsPortalImpl/UI/UI.Portal.Actions"],"**MsPortalImpl/UI/UI.PartGalleryManager":["Viva.Controls/Controls/Base/Viva.ItemList","_generated/Less/Viva.Controls/Controls/Forms/Viva.DropDown.css","Viva.Controls/Controls/Forms/Viva.GroupDropDown"],"*MsPortalImpl/UI/UI.PartGalleryManager":["MsPortalImpl/Interactions/Interactions.PartGalleryDragDrop","MsPortalImpl/UI/UI.PartGalleryHelper","MsPortalImpl/Widgets/Widgets.PartGalleryPivots","_generated/Less/MsPortalImpl/Widgets/Widgets.PartGallery.css","MsPortalImpl/Widgets/Widgets.PartGallery","MsPortalImpl/UI/UI.PartGalleryPivotControllers","MsPortalImpl/UI/UI.PartGalleryManager"],
"*MsPortalImpl/UI/UI.DragDropCompositionManager":["MsPortalImpl/UI/UI.DragDropCompositionManager"],"*MsPortalImpl/UI/UI.Desktop.Actions":["MsPortalImpl/UI/Compositions/UI.Composition.Util","MsPortalImpl/UI/UI.Desktop.Actions"],"*MsPortalImpl/UI/UI.BladeLauncher":["MsPortalImpl/UI/UI.BladeLauncher"],"*MsPortalImpl/UI/UI.AssetBladeLauncher":["MsPortalImpl/UI/UI.AssetBladeLauncher"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.SettingsPart":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.SettingsPart"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleSelectionBlade":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleSelectionBlade"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleGrid":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleGrid"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageSelectionBlade":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageSelectionBlade"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageGrid":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageGrid"],
"**MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.DiagnosticsPart":["MsPortalImpl/Base/Base.ImageHelper"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.DiagnosticsPart":["MsPortalImpl/UI/Hubs/UI.HubsDiagnostics","MsPortalImpl/Services/Services.AssetTypes.Diagnostics","MsPortalImpl/Base/Base.DiagnosticsPopup","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.DiagnosticsPart"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.Blade":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.Blade"],"**MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.PinnedPart":["MsPortalImpl/UI/Hubs/UI.BrowseManagerDelayed"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.PinnedPart":["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.PinnedPart"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Part":["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Part"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Blade":["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Blade"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseAll.Part":
["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseAll.Part"],"*MsPortalImpl/UI/Hubs/UI.ResourceMapManager":["MsPortalImpl/UI/Hubs/UI.ResourceMapManager"],"*MsPortalImpl/UI/Hubs/UI.CreateManager":["MsPortalImpl/UI/Hubs/UI.CreateManager"],"*MsPortalImpl/UI/Dashboard/SessionDashboardRepository":["MsPortalImpl/UI/Dashboard/SessionDashboardRepository"],"*MsPortalImpl/UI/Dashboard/BrowseDashboardsPane":["_generated/Less/MsPortalImpl/Widgets/BrowseDashboardsPane.css","MsPortalImpl/UI/Dashboard/BrowseDashboardsPane"],"**MsPortalImpl/UI/Compositions/UI.Composition.Journey":["MsPortalImpl/Base/Base.Router.Blade","_generated/Less/MsPortalImpl/Themes/Themes.Blades.Blue.css","_generated/Less/MsPortalImpl/Themes/Themes.Blades.LightMode.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Blade.css","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Helpers","MsPortalImpl/UI/Compositions/UI.Composition.BladeInvocationHandler","_generated/Templates/WidgetsBladeContent","_generated/Templates/WidgetsCommandBar",
"_generated/Templates/WidgetsCommandBarItem","_generated/Less/MsPortalImpl/Widgets/Widgets.CommandBar.css","MsPortalImpl/Widgets/Widgets.CommandBar","_generated/Templates/WidgetsLens","_generated/Less/MsPortalImpl/Widgets/Widgets.Lens.css","MsPortalImpl/Widgets/Widgets.Lens","MsPortalImpl/Widgets/Widgets.StackLayout","MsPortalImpl/Widgets/Widgets.BladeContent","_generated/Templates/WidgetsBlade","MsPortalImpl/Widgets/Widgets.Blade","_generated/Less/MsPortalImpl/Widgets/Widgets.Journey.css","MsPortalImpl/Widgets/Widgets.Journey","MsPortalImpl/UI/Compositions/UI.Composition.DelayedBladeManager","MsPortalImpl/UI/Compositions/UI.Composition.SelectableSetBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableSet2Binder","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener","MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar"],"*MsPortalImpl/UI/Compositions/UI.Composition.Journey":["MsPortalImpl/UI/Commands/UI.Commands.Blade","MsPortalImpl/UI/Commands/UI.CommandBarManager",
"MsPortalImpl/UI/Compositions/UI.Composition.DefinitionChangeMonitor","MsPortalImpl/UI/Compositions/UI.Composition.Blade.Actions","MsPortalImpl/UI/Compositions/UI.Composition.Lens","MsPortalImpl/UI/Compositions/UI.Composition.Blade","MsPortalImpl/UI/Compositions/UI.Composition.BladePair","MsPortalImpl/UI/Compositions/UI.Composition.Journey"],"*MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuV2":["MsPortalImpl/UI/Commands/UI.Commands.Lists","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer.DemandLoad","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuV2"],"*MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Selectable2":["MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Selectable2"],"*MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.PendingBlade":["MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.PendingBlade"],"*MsPortalImpl/UI/Compositions/UI.Composition.BladeActionBar":["_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.ActionBarBase.css",
"MsPortalImpl/Controls/ActionBars/Controls.ActionBarBase","MsPortalImpl/Controls/ActionBars/Controls.ErrorInfoBoxActionBar","_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.CreateActionBar.css","MsPortalImpl/Controls/ActionBars/Controls.CreateActionBar","MsPortalImpl/Controls/ActionBars/Controls.DeleteActionBar","MsPortalImpl/Controls/ActionBars/Controls.FilterActionBar","MsPortalImpl/Controls/ActionBars/Controls.FormActionBar","_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.GenericActionBar.css","MsPortalImpl/Controls/ActionBars/Controls.GenericActionBar","_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.PickerActionBar.css","MsPortalImpl/Controls/ActionBars/Controls.PickerActionBar","_generated/Less/MsPortalImpl/Widgets/Widgets.BladeActionBar.css","MsPortalImpl/Widgets/Widgets.BladeActionBar","MsPortalImpl/UI/Compositions/UI.Composition.BladeActionBar"],"*MsPortalImpl/Services/Services.PortalPrefetch":["MsPortalImpl/Services/Services.PortalPrefetch"],"**MsPortalImpl/Services/Services.IntuneAppFileUpload":
["MsPortalImpl/Services/Services.FileUploadSettings","MsPortalImpl/Services/Services.FileUpload"],"*MsPortalImpl/Services/Services.IntuneAppFileUpload":["MsPortalImpl/Services/Services.IntuneAppEncrypt","MsPortalImpl/Services/Services.IntuneAppFileUpload"],"*MsPortalImpl/Services/Services.AssetTypesDelayed":["MsPortalImpl/Services/Services.AssetTypesDelayed"],"*MsPortalImpl/Services/BrowseCuration/oms":["MsPortalImpl/Services/BrowseCuration/oms"],"*MsPortalImpl/Services/BrowseCuration/intune-edu":["MsPortalImpl/Services/BrowseCuration/intune-edu"],"*MsPortalImpl/Services/BrowseCuration/endpoint":["MsPortalImpl/Services/BrowseCuration/endpoint"],"*MsPortalImpl/Services/BrowseCuration/aad":["MsPortalImpl/Services/BrowseCuration/default","MsPortalImpl/Services/BrowseCuration/aad"],"*MsPortalImpl/Parts/Parts.SingleValueGauge":["_generated/Less/MsPortalImpl/Parts/Parts.SingleValueGauge.css","MsPortalImpl/Parts/Parts.SingleValueGauge"],"**MsPortalImpl/Parts/Parts.ResourceSummary":["_generated/Less/MsPortalImpl/Parts/Parts.Properties.css"],
"*MsPortalImpl/Parts/Parts.ResourceSummary":["MsPortalImpl/Parts/Parts.Properties","_generated/Less/MsPortalImpl/Parts/Parts.ResourceSummary.css","MsPortalImpl/Parts/Parts.ResourceSummary"],"*MsPortalImpl/Parts/Parts.QuotaGauge":["_generated/Less/MsPortalImpl/Parts/Parts.QuotaGauge.css","MsPortalImpl/Parts/Parts.QuotaGauge"],"*MsPortalImpl/Parts/Parts.QuickStart":["_generated/Less/MsPortalImpl/Parts/Parts.QuickStart.css","MsPortalImpl/Parts/Parts.QuickStart"],"*MsPortalImpl/Parts/Parts.Provisioning":["_generated/Less/MsPortalImpl/Parts/Parts.Provisioning.css","MsPortalImpl/Parts/Parts.Provisioning"],"*MsPortalImpl/Parts/Parts.InfoList":["_generated/Less/MsPortalImpl/Parts/Parts.InfoList.css","MsPortalImpl/Parts/Parts.InfoList"],"***MsPortalImpl/Parts/Parts.Frame":["Fx/Composition/ViewModelBase","Fx/Composition/PartBase","Fx/Composition/FramePart"],"*MsPortalImpl/Parts/Parts.Frame":["_generated/Less/MsPortalImpl/Parts/Parts.Frame.css","MsPortalImpl/Parts/Parts.Frame"],"***MsPortalImpl/Parts/Parts.Donut":
["Fx/Controls/Legend"],"**MsPortalImpl/Parts/Parts.Donut":["Viva.Controls/Controls/Base/Viva.CompositeControl","Viva.Controls/Controls/Forms/Viva.ComboDropBase","_generated/Less/Viva.Controls/Controls/Viva.SingleSetting.css","Viva.Controls/Controls/Viva.SingleSetting","_generated/Less/Viva.Controls/Controls/Forms/Viva.MultiSelectDropDown.css","Viva.Controls/Controls/Forms/Viva.MultiSelectDropDown","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Gauge.css","Viva.Controls/Controls/Visualization/Viva.Gauge","_generated/Less/Viva.Controls/Controls/Visualization/Viva.UsageGauge.css","Viva.Controls/Controls/Visualization/Viva.UsageGauge","_generated/Less/Viva.Controls/Controls/Visualization/Viva.QuotaGauge.css","Viva.Controls/Controls/Visualization/Viva.QuotaGauge","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Donut.css","Viva.Controls/Controls/Visualization/Viva.Donut"],"*MsPortalImpl/Parts/Parts.Donut":["_generated/Less/MsPortalImpl/Parts/Parts.Donut.css","MsPortalImpl/Parts/Parts.Donut"],
"*MsPortalImpl/Parts/Parts.CustomControlsPart":["MsPortalImpl/Controls/CustomControlDialogHost","_generated/Less/MsPortalImpl/Parts/Parts.CustomControlsPart.css","MsPortalImpl/Parts/Parts.CustomControlsPart"],"*MsPortalImpl/Parts/Parts.CollectionSummary":["_generated/Less/MsPortalImpl/Parts/Parts.CollectionSummary.css","MsPortalImpl/Parts/Parts.CollectionSummary"],"**MsPortalImpl/Parts/Parts.Chart":["MsPortalImpl.Controls/Controls/Visualization/ChartViewModelConversionHelper"],"*MsPortalImpl/Parts/Parts.Chart":["_generated/Less/MsPortalImpl/Parts/Parts.Chart.css","MsPortalImpl/Parts/Parts.Chart"],"*MsPortalImpl/Parts/Parts.Asset":["_generated/Less/MsPortalImpl/Parts/Parts.Asset.css","MsPortalImpl/Parts/Parts.Asset"],"*MsPortalImpl/Interactions/Interactions.MousePanning":["MsPortalImpl/Interactions/Interactions.MousePanning"],"*MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize":["MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize"],"*MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource":
["MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource"],"*MsPortalImpl/ExtensionHostInit":["MsPortalImpl/ExtensionHostInit"],"*MsPortalImpl/Extension/PinBladeInferred":["MsPortalImpl/Extension/PinBladeInferred"],"*MsPortalImpl/Extension/ExtensionPatch":["MsPortalImpl/Extension/ExtensionPatch"],"***MsPortalImpl/Controls/Forms/IntuneAppFileUpload":["Fx/Internal/Controls/IntuneAppFileUpload"],"**MsPortalImpl/Controls/Forms/IntuneAppFileUpload":["MsPortalImpl/Services/Services.FileUploadManager","MsPortalImpl/Controls/Helpers/Validators","_generated/Less/MsPortalImpl/Controls/Forms/AsyncFileUpload.css"],"*MsPortalImpl/Controls/Forms/IntuneAppFileUpload":["MsPortalImpl/Services/Services.IntuneAppCfbParser","MsPortalImpl/Services/Services.IntuneAppParse","MsPortalImpl/Controls/Forms/IntuneAppFileUpload"],"**MsPortalImpl/Controls/Forms/GroupDropDown":["MsPortalImpl.Controls/Controls/Base/ViewModelBase"],"*MsPortalImpl/Controls/Forms/GroupDropDown":["_generated/Less/MsPortalImpl/Controls/Forms/GroupDropDown.css",
"MsPortalImpl/Controls/Forms/GroupDropDown"],"**MsPortalImpl/Controls/Forms/Controls.TokenComboBox":["_generated/Less/Viva.Controls/Controls/Forms/Viva.EditableCombo.css","Viva.Controls/Controls/Forms/Viva.EditableCombo","_generated/Less/Viva.Controls/Controls/Forms/Viva.FilterCombo.css","Viva.Controls/Controls/Forms/Viva.FilterCombo"],"*MsPortalImpl/Controls/Forms/Controls.TokenComboBox":["MsPortalImpl/Base/Base.Text","MsPortalImpl/Controls/Forms/TokenParsing","_generated/Less/MsPortalImpl/Controls/Forms/Controls.TokenComboBox.css","MsPortalImpl/Controls/Forms/Controls.TokenComboBox"],"*MsPortalImpl/Controls/Forms/Controls.FileUpload":["_generated/Less/Viva.Controls/Controls/Forms/Viva.FileUpload2.css","Viva.Controls/Controls/Forms/Viva.FileUpload2","MsPortalImpl/Controls/Forms/Controls.FileUpload"],"*MsPortalImpl/Controls/Forms/AsyncFileUpload":["MsPortalImpl/Controls/Forms/AsyncFileUpload"],"***MsPortalImpl/Controls/CustomControlHost":["Fx/Internal/Composition/CustomControl"],"*MsPortalImpl/Controls/CustomControlHost":
["MsPortalImpl/Controls/CustomControlHost"],"*MsPortalImpl/Controls/Controls.Wizard":["_generated/Less/MsPortalImpl/Controls/Controls.Wizard.css","MsPortalImpl/Controls/Controls.Wizard"],"*MsPortalImpl/Controls/Controls.PickerV3":["_generated/Less/MsPortalImpl/Controls/Controls.PickerV3.css","MsPortalImpl/Controls/Controls.PickerV3"],"*MsPortalImpl/Controls/Controls.Picker":["_generated/Less/MsPortalImpl/Controls/Controls.Picker.css","MsPortalImpl/Controls/Controls.Picker"],"*MsPortalImpl/Controls/Controls.Notice":["_generated/Less/MsPortalImpl/Controls/Controls.Notice.css","MsPortalImpl/Controls/Controls.Notice"],"*MsPortalImpl/Controls/Controls.InfoBox":["_generated/Less/MsPortalImpl/Controls/Controls.HotSpot.css","MsPortalImpl/Controls/Controls.HotSpot","_generated/Less/MsPortalImpl/Controls/Controls.InfoBox.css","MsPortalImpl/Controls/Controls.InfoBox"],"*MsPortalImpl/Controls/Controls.HeroBanner":["_generated/Less/MsPortalImpl/Controls/Controls.HeroBanner.css","MsPortalImpl/Controls/Controls.HeroBanner"],
"**MsPortalImpl/Controls/Controls.FileDownloadButton":["Viva.Controls/Controls/Toolbars/Viva.ToolbarItemType","Viva.Controls/Controls/Toolbars/Viva.ToolbarItem","_generated/Less/Viva.Controls/Controls/Toolbars/Viva.ToolbarButton.css","Viva.Controls/Controls/Toolbars/Viva.ToolbarButton","Viva.Controls/Controls/Toolbars/Viva.ExecutableButtonBase","_generated/Less/Viva.Controls/Controls/Toolbars/Viva.CommandButton.css","Viva.Controls/Controls/Toolbars/Viva.CommandButton"],"*MsPortalImpl/Controls/Controls.FileDownloadButton":["MsPortalImpl/Commands/Commands.FileDownloadCommand","_generated/Less/MsPortalImpl/Controls/Controls.FileDownloadButton.css","MsPortalImpl/Controls/Controls.FileDownloadButton"],"*MsPortalImpl/Controls/Controls.Essentials":["_generated/Less/MsPortalImpl/Controls/Controls.Essentials.css","MsPortalImpl/Controls/Controls.Essentials"],"*MsPortalImpl/Controls/Controls.DeleteAssetConfirmation":["MsPortalImpl/Controls/Controls.DeleteAssetConfirmation"],"***MsPortalImpl/ControlHostInit":
["Fx/Internal/Composition/CustomControlUtil"],"*MsPortalImpl/ControlHostInit":["MsPortalImpl/Base/Base.KnockoutExtensions.Controls","MsPortalImpl/Controls/CustomControlDialog","MsPortalImpl/Controls/CustomControlUtil","_generated/Less/MsPortalImpl/ControlHost.css","MsPortalImpl/ControlHostInit"],"*MsPortalImpl/Base/Template":["MsPortalImpl/Base/Template"],"*MsPortalImpl/Base/Base.Selectable2.Pipeline":["MsPortalImpl/Base/Base.Selectable2.Pipeline"],"*MsPortalImpl/Base/Base.SafeMarkup":["MsPortalImpl/Base/Base.SafeMarkup"],"*MsPortalImpl/Base/Base.PartGallery":["MsPortalImpl/Base/Base.PartGallery"],"*MsPortalImpl/Base/Base.DebugInfo":["_generated/Templates/ConsoleErrorInfo","MsPortalImpl/Widgets/Widgets.DebugHub.Performance","_generated/Less/MsPortalImpl/Widgets/Widgets.DebugHub.css","MsPortalImpl/Widgets/Widgets.DebugContextPane","_generated/Less/MsPortalImpl/Base/Base.DebugInfo.css","MsPortalImpl/Base/Base.DebugInfo"],"*MsPortalImpl.Controls/Fields/TriStateCheckBox":["MsPortalImpl.Controls/Fields/TriStateCheckBox"],
"**MsPortalImpl.Controls/Fields/TimePickerField":["Viva.Controls/Controls/Forms/Viva.TimePicker"],"*MsPortalImpl.Controls/Fields/TimePickerField":["MsPortalImpl.Controls/Fields/TimePickerField"],"*MsPortalImpl.Controls/Fields/StringListField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.StringList.css","Viva.Controls/Controls/Forms/Viva.StringList","_generated/Less/MsPortalImpl.Controls/Controls/Forms/StringList.css","MsPortalImpl.Controls/Fields/StringListField"],"*MsPortalImpl.Controls/Fields/Splitter":["_generated/Less/Viva.Controls/Controls/Forms/Viva.Splitter.css","Viva.Controls/Controls/Forms/Viva.Splitter","MsPortalImpl.Controls/Fields/Splitter"],"**MsPortalImpl.Controls/Fields/SliderField":["MsPortalImpl.Controls/Fields/Base/SliderBaseField","_generated/Less/Viva.Controls/Controls/Forms/Viva.Slider.css","Viva.Controls/Controls/Base/Viva.SliderBase","Viva.Controls/Controls/Forms/Viva.Slider"],"*MsPortalImpl.Controls/Fields/SliderField":["MsPortalImpl.Controls/Fields/SliderField"],
"**MsPortalImpl.Controls/Fields/SelectorField":["MsPortalImpl.Controls/Controls/Base/ValidatableControl","_generated/Less/MsPortalImpl.Controls/Fields/Selector.css","_generated/Less/MsPortalImpl.Controls/Fields/CreatorAndSelector.css","MsPortalImpl.Controls/Controls/Forms/SelectorBase"],"*MsPortalImpl.Controls/Fields/SelectorField":["MsPortalImpl.Controls/Controls/Forms/Selector","MsPortalImpl.Controls/Fields/SelectorField"],"*MsPortalImpl.Controls/Fields/SectionField":["MsPortalImpl.Controls/Fields/SectionField"],"*MsPortalImpl.Controls/Fields/Section":["_generated/Less/MsPortalImpl.Controls/Fields/Section.css","MsPortalImpl.Controls/Fields/Section"],"**MsPortalImpl.Controls/Fields/RangeSliderField":["Viva.Controls/Controls/Forms/Viva.RangeSlider"],"*MsPortalImpl.Controls/Fields/RangeSliderField":["MsPortalImpl.Controls/Fields/RangeSliderField"],"*MsPortalImpl.Controls/Fields/PasswordField":["MsPortalImpl.Controls/Fields/PasswordField"],"*MsPortalImpl.Controls/Fields/OptionsGroupField":
["_generated/Less/Viva.Controls/Controls/Forms/Viva.OptionPicker.css","Viva.Controls/Controls/Forms/Viva.OptionPicker","MsPortalImpl.Controls/Fields/OptionsGroupField"],"*MsPortalImpl.Controls/Fields/OAuthButtonField":["MsPortalImpl/Commands/Commands.OAuthCommand","MsPortalImpl.Controls/Fields/OAuthButtonField"],"*MsPortalImpl.Controls/Fields/NumericTextBoxField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.NumericTextBox.css","Viva.Controls/Controls/Forms/Viva.NumericTextBox","MsPortalImpl.Controls/Fields/NumericTextBoxField"],"*MsPortalImpl.Controls/Fields/MultiselectDropDownField":["MsPortalImpl.Controls/Fields/MultiselectDropDownField"],"*MsPortalImpl.Controls/Fields/MultiLineTextField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.MultiLineTextBox.css","Viva.Controls/Controls/Forms/Viva.MultiLineTextBox","MsPortalImpl.Controls/Fields/MultiLineTextField"],"*MsPortalImpl.Controls/Fields/HtmlEditorField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.ContentEditable.css",
"Viva.Controls/Controls/Forms/Viva.ContentEditable","MsPortalImpl.Controls/Fields/HtmlEditorField"],"*MsPortalImpl.Controls/Fields/FilterComboField":["MsPortalImpl.Controls/Fields/FilterComboField"],"*MsPortalImpl.Controls/Fields/DurationPickerField":["_generated/Less/MsPortalImpl.Controls/Fields/DurationPicker.css","MsPortalImpl.Controls/Fields/DurationPickerField"],"*MsPortalImpl.Controls/Fields/DropDownField":["MsPortalImpl.Controls/Fields/DropDownField"],"*MsPortalImpl.Controls/Fields/DayPickerField":["_generated/Less/MsPortalImpl.Controls/Fields/DayPicker.css","MsPortalImpl.Controls/Fields/DayPickerField"],"**MsPortalImpl.Controls/Fields/DateTimeRangePickerField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.DatePanel.css","Viva.Controls/Controls/Forms/Viva.DatePanel","Viva.Controls/Util/Viva.ArrayUtil","_generated/Less/Viva.Controls/Controls/Forms/Viva.DatePicker.css","Viva.Controls/Controls/Forms/Viva.DatePicker","_generated/Less/Viva.Controls/Controls/Forms/Viva.DateTimePicker.css",
"Viva.Controls/Controls/Forms/Viva.DateTimePicker"],"*MsPortalImpl.Controls/Fields/DateTimeRangePickerField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.DateTimeRangePicker.css","Viva.Controls/Controls/Forms/Viva.DateTimeRangePicker","MsPortalImpl.Controls/Fields/DateTimeRangePickerField"],"*MsPortalImpl.Controls/Fields/DateTimePickerField":["MsPortalImpl.Controls/Fields/DateTimePickerField"],"**MsPortalImpl.Controls/Fields/DateTimeComboField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.DateTimeCombo.css","Viva.Controls/Controls/Forms/Viva.DateTimeCombo"],"*MsPortalImpl.Controls/Fields/DateTimeComboField":["MsPortalImpl.Controls/Fields/DateTimeComboField"],"*MsPortalImpl.Controls/Fields/DatePickerField":["MsPortalImpl.Controls/Fields/DatePickerField"],"*MsPortalImpl.Controls/Fields/CustomValueSliderField":["MsPortalImpl.Controls/Fields/CustomValueSliderField"],"*MsPortalImpl.Controls/Fields/CustomRangeSlider":["MsPortalImpl.Controls/Fields/CustomRangeSlider"],"*MsPortalImpl.Controls/Fields/CustomHtmlField":
["MsPortalImpl.Controls/Fields/CustomHtmlField"],"**MsPortalImpl.Controls/Fields/CreatorAndSelectorFieldV2":["MsPortalImpl.Controls/Controls/Forms/CreatorAndSelector"],"*MsPortalImpl.Controls/Fields/CreatorAndSelectorFieldV2":["MsPortalImpl.Controls/Fields/CreatorAndSelectorFieldV2"],"*MsPortalImpl.Controls/Fields/CreatorAndSelectorField":["MsPortalImpl.Controls/Fields/CreatorAndSelectorField"],"*MsPortalImpl.Controls/Fields/CheckBoxField":["MsPortalImpl.Controls/Fields/CheckBoxField"],"*MsPortalImpl.Controls/Controls/Visualization/StepGauge":["Viva.Controls/Controls/Visualization/Viva.StepGauge","MsPortalImpl.Controls/Controls/Visualization/StepGauge"],"*MsPortalImpl.Controls/Controls/Visualization/SingleValueGauge":["Viva.Controls/Controls/Visualization/Viva.SingleValueGauge","MsPortalImpl.Controls/Controls/Visualization/SingleValueGauge"],"*MsPortalImpl.Controls/Controls/Visualization/QuotaGauge":["MsPortalImpl.Controls/Controls/Visualization/QuotaGauge"],"***MsPortalImpl.Controls/Controls/Visualization/PairedTimeline":
["Fx/Controls/PairedTimelineBadges","Fx/Controls/RangeSelection","Fx/Controls/PairedTimeline"],"**MsPortalImpl.Controls/Controls/Visualization/PairedTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/List.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.List.FocusableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.List.GroupableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.List.SelectableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.FocusableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.GroupableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.SelectableExtension.css","Viva.Controls/Controls/Lists/List1/Viva.List","Viva.Controls/Controls/Lists/List1/Viva.List.Focusable","Viva.Controls/Controls/Lists/List1/Viva.List.Selectable","Viva.Controls/Controls/Lists/List1/Viva.List.Groupable",
"Viva.Controls/Controls/Lists/List1/Viva.List.ContextMenu","_generated/Less/MsPortalImpl.Controls/Controls/Lists/ListView.css","MsPortalImpl.Controls/Controls/Lists/List1/ListView","Viva.Controls/Util/Viva.Hatching","_generated/Less/Viva.Controls/Controls/Visualization/Viva.ChartBase.css","Viva.Controls/Controls/Visualization/Viva.ChartBase"],"*MsPortalImpl.Controls/Controls/Visualization/PairedTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Visualization/RangeSelection.css","MsPortalImpl.Controls/Controls/Visualization/RangeSelection","_generated/Less/MsPortalImpl.Controls/Controls/Visualization/PairedTimelineBadges.css","MsPortalImpl.Controls/Controls/Visualization/PairedTimelineBadges","_generated/Less/MsPortalImpl.Controls/Controls/Visualization/PairedTimeline.css","MsPortalImpl.Controls/Controls/Visualization/PairedTimeline"],"*MsPortalImpl.Controls/Controls/Visualization/Metrics":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.Metrics.css","Viva.Controls/Controls/Visualization/Viva.Metrics",
"MsPortalImpl.Controls/Controls/Visualization/Metrics"],"*MsPortalImpl.Controls/Controls/Visualization/MapV2":["MsPortalImpl.Controls/Controls/Visualization/MapV2"],"*MsPortalImpl.Controls/Controls/Visualization/Map":["Viva.Controls/Controls/Visualization/Viva.MapCoordinateConverter","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Map.css","Viva.Controls/Controls/Visualization/Viva.Map","Viva.Controls/Controls/Visualization/Viva.Hexagon","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Map.HexagonLayoutExtension.css","Viva.Controls/Controls/Visualization/Viva.Map.HexagonLayoutExtension","MsPortalImpl.Controls/Controls/Visualization/Map"],"*MsPortalImpl.Controls/Controls/Visualization/Legend":["_generated/Less/MsPortalImpl.Controls/Controls/Visualization/Legend.css","MsPortalImpl.Controls/Controls/Visualization/Legend"],"*MsPortalImpl.Controls/Controls/Visualization/Graph":["Viva.Controls/Controls/Visualization/Graph/GraphEntityViewModel","Viva.Controls/Controls/Visualization/Graph/GraphViewModel",
"Viva.Controls/Controls/Visualization/Graph/GraphWidget.Constants","Viva.Controls/Controls/Visualization/Graph/Animation","Viva.Controls/Controls/Visualization/Graph/MouseCapture","Viva.Controls/Controls/Visualization/Graph/Geometry","Viva.Controls/Controls/Visualization/Graph/Commands/MoveNodes","Viva.Controls/Controls/Visualization/Graph/SvgUtils","_generated/Less/Viva.Controls/Controls/Visualization/Graph.css","_generated/Less/Viva.Controls/Controls/Visualization/Graph.Skins.css","Viva.Controls/Controls/Visualization/Graph/GraphWidget","MsPortalImpl.Controls/Controls/Visualization/Graph"],"*MsPortalImpl.Controls/Controls/Visualization/Gauge":["MsPortalImpl.Controls/Controls/Visualization/Gauge"],"**MsPortalImpl.Controls/Controls/Visualization/Donut":["_generated/Less/MsPortalImpl/Controls/LoadingAndNoData.css","MsPortalImpl/Controls/Helpers/LoadingAndNoData"],"*MsPortalImpl.Controls/Controls/Visualization/Donut":["MsPortalImpl.Controls/Controls/Visualization/Donut"],"*MsPortalImpl.Controls/Controls/Visualization/CsmTopology":
["_generated/Less/MsPortalImpl.Controls/Controls/Visualization/CsmTopology.css","MsPortalImpl.Controls/Controls/Visualization/CsmTopology"],"*MsPortalImpl.Controls/Controls/Visualization/Chart":["Viva.Controls/Controls/Visualization/Viva.ChartViewImpl","Viva.Controls/Controls/Visualization/Viva.StackedChartViewImpl","Viva.Controls/Controls/Visualization/Viva.StackedAreaChartViewImpl","Viva.Controls/Controls/Visualization/Viva.ScatterChartViewImpl","Viva.Controls/Controls/Visualization/Viva.LineChartViewImpl","Viva.Controls/Controls/Visualization/Viva.AreaChartViewImpl","Viva.Controls/Controls/Visualization/Viva.BarChartViewImpl","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Chart.css","Viva.Controls/Controls/Visualization/Viva.Chart","_generated/Less/MsPortalImpl.Controls/Controls/Visualization/Chart.css","MsPortalImpl.Controls/Controls/Visualization/Chart"],"*MsPortalImpl.Controls/Controls/Toolbars/Toolbar":["Viva.Controls/Controls/Toolbars/Viva.ToolbarGroup","Viva.Controls/Controls/Toolbars/Viva.ToolbarOptionsGroup",
"_generated/Less/Viva.Controls/Controls/Toolbars/Viva.Toolbar.css","_generated/Less/Viva.Controls/Controls/Toolbars/Viva.ToggleCommandButton.css","Viva.Controls/Controls/Toolbars/Viva.ToggleCommandButton","Viva.Controls/Controls/Toolbars/Viva.ClickableLink","Viva.Controls/Controls/Toolbars/Viva.OpenLinkButton","Viva.Controls/Controls/Toolbars/Viva.Toolbar","_generated/Less/MsPortalImpl.Controls/Controls/Toolbars/Toolbar.css","MsPortalImpl.Controls/Controls/Toolbars/Toolbar"],"**MsPortalImpl.Controls/Controls/TextBlock":["_generated/Less/MsPortalImpl.Controls/Controls/TextBlock.css"],"*MsPortalImpl.Controls/Controls/TextBlock":["MsPortalImpl.Controls/Controls/TextBlock"],"*MsPortalImpl.Controls/Controls/TerminalEmulator":["_generated/Less/MsPortalImpl.Controls/Controls/TerminalEmulator.css","MsPortalImpl.Controls/Controls/TerminalEmulator"],"*MsPortalImpl.Controls/Controls/SpecComparisonTable":["_generated/Less/MsPortalImpl.Controls/Controls/SpecComparisonTable.css","MsPortalImpl.Controls/Controls/SpecComparisonTable"],
"*MsPortalImpl.Controls/Controls/SingleSetting":["MsPortalImpl.Controls/Controls/SingleSetting"],"*MsPortalImpl.Controls/Controls/SimpleButton":["_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css","MsPortalImpl.Controls/Controls/SimpleButton"],"*MsPortalImpl.Controls/Controls/Settings":["_generated/Less/Viva.Controls/Controls/Viva.Settings.css","Viva.Controls/Controls/Viva.Settings","MsPortalImpl.Controls/Controls/Settings"],"*MsPortalImpl.Controls/Controls/SearchBox":["_generated/Less/MsPortalImpl.Controls/Controls/SearchBox.css","MsPortalImpl.Controls/Controls/SearchBox"],"**MsPortalImpl.Controls/Controls/Scrollbar":["_generated/Less/Viva.Controls/Controls/Viva.Scrollbar.css","Viva.Controls/Controls/Viva.Scrollbar"],"*MsPortalImpl.Controls/Controls/Scrollbar":["MsPortalImpl.Controls/Controls/Scrollbar"],"*MsPortalImpl.Controls/Controls/ResourceFilter":["_generated/Less/MsPortalImpl.Controls/Controls/ResourceFilter.css","MsPortalImpl.Controls/Controls/ResourceFilter"],"*MsPortalImpl.Controls/Controls/PreviewTag":
["MsPortalImpl.Controls/Controls/PreviewTag"],"*MsPortalImpl.Controls/Controls/PartPinner":["_generated/Less/MsPortalImpl.Controls/Controls/PartPinner.css","MsPortalImpl.Controls/Controls/PartPinner"],"*MsPortalImpl.Controls/Controls/MarkdownHtmlToReact":["MsPortalImpl.Controls/Controls/MarkdownHtmlToReact"],"***MsPortalImpl.Controls/Controls/Markdown":["Fx/Controls/Video"],"*MsPortalImpl.Controls/Controls/Markdown":["MsPortalImpl.Controls/Controls/Video","_generated/Less/MsPortalImpl.Controls/Controls/Markdown.css","MsPortalImpl.Controls/Controls/Markdown"],"**MsPortalImpl.Controls/Controls/LogStream":["MsPortalImpl.Controls/Controls/Controls.CommandHelpers","_generated/Less/Viva.Controls/Controls/Viva.TextStream.css","Viva.Controls/Controls/Viva.TextStream","_generated/Less/Viva.Controls/Controls/Viva.LogStream.css","Viva.Controls/Controls/Viva.LogStream"],"*MsPortalImpl.Controls/Controls/LogStream":["_generated/Less/MsPortalImpl.Controls/Controls/LogStream.css","MsPortalImpl.Controls/Controls/LogStream"],
"*MsPortalImpl.Controls/Controls/Lists/Tree1/TreeView":["_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.FocusableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.LoadByContinuationToken.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.OnDemandLoadableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.RightClickable.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.Selectable.css","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Focusable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Selectable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.OnDemandLoadable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.RightClickable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.LoadByContinuationToken","MsPortalImpl.Controls/Controls/Lists/Tree1/TreeView"],"***MsPortalImpl.Controls/Controls/Lists/Menu":
["Fx/Controls/HotSpot"],"*MsPortalImpl.Controls/Controls/Lists/Menu":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Menu.css","MsPortalImpl.Controls/Controls/Lists/Menu"],"*MsPortalImpl.Controls/Controls/Lists/List1/Gallery":["MsPortalImpl.Controls/Controls/Lists/List1/Gallery"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Search":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Search.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Search"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Paging":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Paging.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Paging"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Hierarchical":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Hierarchical.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Hierarchical"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Editing":
["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Editing.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Editing"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.DemandLoading":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.DemandLoading.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.DemandLoading"],"*MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ContextMenu":["MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ContextMenu"],"*MsPortalImpl.Controls/Controls/IFrameV2":["_generated/Less/MsPortalImpl.Controls/Controls/IFrameV2.css","MsPortalImpl.Controls/Controls/IFrameV2"],"*MsPortalImpl.Controls/Controls/IFrame":["_generated/Less/MsPortalImpl.Controls/Controls/IFrame.css","MsPortalImpl.Controls/Controls/IFrame"],"***MsPortalImpl.Controls/Controls/HeatMap":["Fx/Controls/Batch/HeatMap"],"*MsPortalImpl.Controls/Controls/HeatMap":["_generated/Less/MsPortalImpl.Controls/Controls/HeatMap.css",
"MsPortalImpl.Controls/Controls/HeatMap"],"*MsPortalImpl.Controls/Controls/Forms/TextBox":["MsPortalImpl.Controls/Controls/Forms/TextBox"],"*MsPortalImpl.Controls/Controls/Forms/Obsolete.GroupDropDown":["MsPortalImpl.Controls/Controls/Forms/Obsolete.GroupDropDown"],"*MsPortalImpl.Controls/Controls/Forms/FileUpload":["_generated/Less/MsPortalImpl.Controls/Controls/Forms/ProgressOverlay.css","Viva.Controls/Controls/Visualization/Viva.Progress","_generated/Less/MsPortalImpl.Controls/Controls/Visualization/ProgressBar.css","MsPortalImpl.Controls/Controls/Visualization/ProgressBar","_generated/Less/Viva.Controls/Controls/Forms/Viva.FileUpload.css","Viva.Controls/Controls/Forms/Viva.FileUpload","_generated/Less/MsPortalImpl.Controls/Controls/Forms/FileUpload.css","MsPortalImpl.Controls/Controls/Forms/FileUpload"],"*MsPortalImpl.Controls/Controls/Forms/DateTimeCombo":["MsPortalImpl.Controls/Controls/Forms/EditableCombo","MsPortalImpl.Controls/Controls/Forms/DateTimeCombo"],"*MsPortalImpl.Controls/Controls/Forms/CopyableLabel":
["_generated/Less/MsPortalImpl.Controls/Controls/DockedBalloon.css","MsPortalImpl.Controls/Controls/DockedBalloon","_generated/Less/MsPortalImpl.Controls/Controls/Forms/CopyableLabel.css","MsPortalImpl.Controls/Controls/Forms/CopyableLabel"],"*MsPortalImpl.Controls/Controls/Forms/Button":["_generated/Less/MsPortalImpl.Controls/Controls/Forms/Button.css","MsPortalImpl.Controls/Controls/Forms/Button"],"**MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiscussionThread.css","MsPortalImpl.Controls/Controls/Documents/DiscussionThread"],"*MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline.css","MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline"],"*MsPortalImpl.Controls/Controls/Documents/DiffList":["_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiffView.css","MsPortalImpl.Controls/Controls/Documents/DiffView","_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiffList.css",
"MsPortalImpl.Controls/Controls/Documents/DiffList"],"*MsPortalImpl.Controls/Controls/Documents/DiffEditor":["MsPortalImpl.Controls/Controls/Documents/Editor.Extension","_generated/Less/MsPortalImpl.Controls/Controls/Documents/Editor.DiscussionExtension.css","MsPortalImpl.Controls/Controls/Documents/Editor.DiscussionExtension","_generated/Less/MsPortalImpl.Controls/Controls/Documents/Editor.css","MsPortalImpl.Controls/Controls/Documents/Editor","MsPortalImpl.Controls/Controls/Documents/DiffEditor"],"*MsPortalImpl.Controls/Controls/Data/QueryBuilder":["_generated/Less/MsPortalImpl.Controls/Controls/Data/QueryBuilder.css","_generated/Less/Viva.Controls/Controls/Forms/Viva.CommandLink.css","Viva.Controls/Controls/Forms/Viva.CommandLink","MsPortalImpl.Controls/Controls/Data/QueryBuilder"],"*MsPortalImpl.Controls/Controls/ConsoleV2":["_generated/Less/MsPortalImpl.Controls/Controls/ConsoleV2.css","MsPortalImpl.Controls/Controls/ConsoleV2"],"*MsPortalImpl.Controls/Controls/Console":["_generated/Less/Viva.Controls/Controls/Viva.Console.css",
"Viva.Controls/Controls/Viva.Console","_generated/Less/MsPortalImpl.Controls/Controls/Console.css","MsPortalImpl.Controls/Controls/Console"],"*MsPortalImpl.Controls/Controls/AzureMediaPlayer":["MsPortalImpl.Controls/Controls/AzureMediaPlayer"],"*FxHubs/Dashboard":["FxHubs/Dashboard"],"*FxHubs/BrowseCuration":["FxHubs/BrowseCuration"],"*FxHubs/BrowseCollectionResourceItem":["FxHubs/BrowseCollectionResourceItem"],"*Fx/Specs/DropDown":["Fx/Specs/DropDown"],"**Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/BaseProjection","Fx/Internal/Data/MapProjection","Fx/Internal/Data/QueryBaseNavigator"],"*Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/QueryListNavigator"],"*Fx/Internal/Data/QueryDemandLoadNavigator":["Fx/Internal/Utils/KnockoutArrayUtils","Fx/Internal/Data/PageMapProjection","Fx/Internal/Data/QueryDemandLoadNavigator"],"*Fx/Internal/Data/OData":["Fx/Internal/Data/OData"],"*Fx/Internal/Data/LifetimeMapProjection":["Fx/Internal/Data/LifetimeMapProjection"],"*Fx/Internal/Data/Expressions":
["Fx/Internal/Data/Expressions"],"**Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/ClientFilters","Fx/Internal/Data/SortProjection","Fx/Internal/Data/FilterProjection","Fx/Internal/Data/PageProjection","Fx/Internal/Data/ArrayBaseNavigator"],"*Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/ArrayListNavigator"],"*Fx/Internal/Data/ArrayDemandLoadNavigator":["Fx/Internal/Data/ContinuationProjection","Fx/Internal/Data/ArrayDemandLoadNavigator"],"*Fx/Internal/Controls/Grid2/Grid2":["Fx/Internal/Controls/Grid2/ViewModels.Grid2.Base","Fx/Internal/Controls/Grid2/ViewModels.Grid2.ContextMenu","Fx/Internal/Controls/Grid2/ViewModels.Grid2.DemandLoading","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Editing","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Focus","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hover","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Grouping","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hierarchical","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Paging","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Reordering",
"Fx/Internal/Controls/Grid2/ViewModels.Grid2.Resizing","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Scrolling","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Search","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Selection","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Sorting","Fx/Internal/Controls/Grid2/Grid2"],"*Fx/Internal/Composition/ViewModelAdapters":["Fx/Internal/Composition/ViewModelAdapters"],"*Fx/Internal/Composition/MenuBlade":["Fx/Internal/Composition/MenuBlade"],"*Fx/Internal/Commands/ListCommand":["Fx/Internal/Commands/ListCommand"],"*Fx/Controls/Validations":["Fx/Controls/Validations"],"**Fx/Controls/TriStateCheckBox":["Fx/Internal/Controls/FormsBase"],"*Fx/Controls/TriStateCheckBox":["Fx/Controls/TriStateCheckBox"],"*Fx/Controls/Toolbar/MoveResourceToolbarButton":["Fx/Controls/Toolbar/MoveResourceToolbarButton"],"*Fx/Controls/TimePicker":["Fx/Controls/TimePicker"],"*Fx/Controls/TextBox":["Fx/Controls/TextBox"],"*Fx/Controls/TabControl":["Fx/Controls/TabControl"],"*Fx/Controls/Slider":
["Fx/Controls/Slider"],"*Fx/Controls/Section":["Fx/Controls/Section"],"*Fx/Controls/RangeSlider":["Fx/Controls/RangeSlider"],"*Fx/Controls/RadioButtons":["Fx/Controls/RadioButtons"],"*Fx/Controls/PasswordBox":["Fx/Controls/PasswordBox"],"*Fx/Controls/OptionsGroup":["Fx/Controls/OptionsGroup"],"*Fx/Controls/NumericTextBox":["Fx/Controls/NumericTextBox"],"*Fx/Controls/MultiLineTextBox":["Fx/Controls/MultiLineTextBox"],"*Fx/Controls/FormBase":["Fx/Controls/FormBase"],"*Fx/Controls/FileUpload":["Fx/Controls/FileUpload"],"*Fx/Controls/Essentials":["Fx/Controls/Essentials"],"*Fx/Controls/DurationPicker":["Fx/Controls/DurationPicker"],"*Fx/Controls/DropDown":["Fx/Controls/DropDown"],"*Fx/Controls/DayPicker":["Fx/Controls/DayPicker"],"*Fx/Controls/DateTimeRangePicker":["Fx/Controls/DateTimeRangePicker"],"*Fx/Controls/DateTimePicker":["Fx/Controls/DateTimePicker"],"*Fx/Controls/DatePicker":["Fx/Controls/DatePicker"],"*Fx/Controls/CustomHtml":["Fx/Controls/CustomHtml"],"*Fx/Controls/CustomControl/FormField":
["Fx/Controls/CustomControl/FormField"],"*Fx/Controls/CheckBox":["Fx/Controls/CheckBox"],"*Fx/Controls/Button":["Fx/Controls/Button"],"*Fx/Composition/TemplatePart":["Fx/Composition/TemplatePart"],"**Fx/Composition/TemplateBlade":["Fx/Composition/BladeBase"],"*Fx/Composition/TemplateBlade":["Fx/Composition/TemplateBlade"],"*Fx/Composition/Permissions":["Fx/Composition/Permissions"],"*Fx/Composition/Pdl/Blade":["Fx/Composition/Pdl/Blade"],"*Fx/Composition/Part":["Fx/Composition/Part"],"*Fx/Composition/MenuBlade":["Fx/Controls/Menu","Fx/Composition/Pdl/MenuBlade","Fx/Composition/MenuBlade"],"*Fx/Composition/FrameBlade":["Fx/Composition/FrameBlade"],"*Fx/Composition/DataContext":["Fx/Composition/DataContext"],"*Fx/Composition/CustomControl/FormField":["Fx/Composition/CustomControl/FormField"],"*Fx/Composition/CustomControl":["Fx/Composition/CustomControl"],"*Fx/Composition/Blade":["Fx/Composition/Blade"],"*Fx/Base/Base.Net.Batch":["Fx/Base/Base.Net.Batch"],"*Fx/Assets/Assets":["Fx/Assets/Assets"]}},
{bundles:{"***0MsPortalImpl/Init":["Fx/Feedback","Fx/Pinner","FxHubs/CloudNameCommon","FxHubs/HubsSettingsSchema","FxHubs/Permissions","FxHubs/ResourceProvider","FxHubs/RpcEndPoints"],"***MsPortalImpl/Parts/Parts.Frame":["Fx/Composition/ViewModelBase","Fx/Composition/PartBase","Fx/Composition/FramePart"],"***MsPortalImpl/Parts/Parts.Donut":["Fx/Controls/Legend"],"***MsPortalImpl/Controls/Forms/IntuneAppFileUpload":["Fx/Internal/Controls/IntuneAppFileUpload"],"***MsPortalImpl/Controls/CustomControlHost":["Fx/Internal/Composition/CustomControl"],"***MsPortalImpl/ControlHostInit":["Fx/Internal/Composition/CustomControlUtil"],"***MsPortalImpl.Controls/Controls/Visualization/PairedTimeline":["Fx/Controls/PairedTimelineBadges","Fx/Controls/RangeSelection","Fx/Controls/PairedTimeline"],"***MsPortalImpl.Controls/Controls/Markdown":["Fx/Controls/Video"],"***MsPortalImpl.Controls/Controls/Lists/Menu":["Fx/Controls/HotSpot"],"***MsPortalImpl.Controls/Controls/HeatMap":["Fx/Controls/Batch/HeatMap"],
"*FxHubs/Dashboard":["FxHubs/Dashboard"],"*FxHubs/BrowseCuration":["FxHubs/BrowseCuration"],"*FxHubs/BrowseCollectionResourceItem":["FxHubs/BrowseCollectionResourceItem"],"*Fx/Specs/DropDown":["Fx/Specs/DropDown"],"**Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/BaseProjection","Fx/Internal/Data/MapProjection","Fx/Internal/Data/QueryBaseNavigator"],"*Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/QueryListNavigator"],"*Fx/Internal/Data/QueryDemandLoadNavigator":["Fx/Internal/Utils/KnockoutArrayUtils","Fx/Internal/Data/PageMapProjection","Fx/Internal/Data/QueryDemandLoadNavigator"],"*Fx/Internal/Data/OData":["Fx/Internal/Data/OData"],"*Fx/Internal/Data/LifetimeMapProjection":["Fx/Internal/Data/LifetimeMapProjection"],"*Fx/Internal/Data/Expressions":["Fx/Internal/Data/Expressions"],"**Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/ClientFilters","Fx/Internal/Data/SortProjection","Fx/Internal/Data/FilterProjection","Fx/Internal/Data/PageProjection","Fx/Internal/Data/ArrayBaseNavigator"],
"*Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/ArrayListNavigator"],"*Fx/Internal/Data/ArrayDemandLoadNavigator":["Fx/Internal/Data/ContinuationProjection","Fx/Internal/Data/ArrayDemandLoadNavigator"],"*Fx/Internal/Controls/Grid2/Grid2":["Fx/Internal/Controls/Grid2/ViewModels.Grid2.Base","Fx/Internal/Controls/Grid2/ViewModels.Grid2.ContextMenu","Fx/Internal/Controls/Grid2/ViewModels.Grid2.DemandLoading","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Editing","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Focus","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hover","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Grouping","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hierarchical","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Paging","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Reordering","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Resizing","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Scrolling","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Search","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Selection",
"Fx/Internal/Controls/Grid2/ViewModels.Grid2.Sorting","Fx/Internal/Controls/Grid2/Grid2"],"*Fx/Internal/Composition/ViewModelAdapters":["Fx/Internal/Composition/ViewModelAdapters"],"*Fx/Internal/Composition/MenuBlade":["Fx/Internal/Composition/MenuBlade"],"*Fx/Internal/Commands/ListCommand":["Fx/Internal/Commands/ListCommand"],"*Fx/Controls/Validations":["Fx/Controls/Validations"],"**Fx/Controls/TriStateCheckBox":["Fx/Internal/Controls/FormsBase"],"*Fx/Controls/TriStateCheckBox":["Fx/Controls/TriStateCheckBox"],"*Fx/Controls/Toolbar/MoveResourceToolbarButton":["Fx/Controls/Toolbar/MoveResourceToolbarButton"],"*Fx/Controls/TimePicker":["Fx/Controls/TimePicker"],"*Fx/Controls/TextBox":["Fx/Controls/TextBox"],"*Fx/Controls/TabControl":["Fx/Controls/TabControl"],"*Fx/Controls/Slider":["Fx/Controls/Slider"],"*Fx/Controls/Section":["Fx/Controls/Section"],"*Fx/Controls/RangeSlider":["Fx/Controls/RangeSlider"],"*Fx/Controls/RadioButtons":["Fx/Controls/RadioButtons"],"*Fx/Controls/PasswordBox":
["Fx/Controls/PasswordBox"],"*Fx/Controls/OptionsGroup":["Fx/Controls/OptionsGroup"],"*Fx/Controls/NumericTextBox":["Fx/Controls/NumericTextBox"],"*Fx/Controls/MultiLineTextBox":["Fx/Controls/MultiLineTextBox"],"*Fx/Controls/FormBase":["Fx/Controls/FormBase"],"*Fx/Controls/FileUpload":["Fx/Controls/FileUpload"],"*Fx/Controls/Essentials":["Fx/Controls/Essentials"],"*Fx/Controls/DurationPicker":["Fx/Controls/DurationPicker"],"*Fx/Controls/DropDown":["Fx/Controls/DropDown"],"*Fx/Controls/DayPicker":["Fx/Controls/DayPicker"],"*Fx/Controls/DateTimeRangePicker":["Fx/Controls/DateTimeRangePicker"],"*Fx/Controls/DateTimePicker":["Fx/Controls/DateTimePicker"],"*Fx/Controls/DatePicker":["Fx/Controls/DatePicker"],"*Fx/Controls/CustomHtml":["Fx/Controls/CustomHtml"],"*Fx/Controls/CustomControl/FormField":["Fx/Controls/CustomControl/FormField"],"*Fx/Controls/CheckBox":["Fx/Controls/CheckBox"],"*Fx/Controls/Button":["Fx/Controls/Button"],"*Fx/Composition/TemplatePart":["Fx/Composition/TemplatePart"],
"**Fx/Composition/TemplateBlade":["Fx/Composition/BladeBase"],"*Fx/Composition/TemplateBlade":["Fx/Composition/TemplateBlade"],"*Fx/Composition/Permissions":["Fx/Composition/Permissions"],"*Fx/Composition/Pdl/Blade":["Fx/Composition/Pdl/Blade"],"*Fx/Composition/Part":["Fx/Composition/Part"],"*Fx/Composition/MenuBlade":["Fx/Controls/Menu","Fx/Composition/Pdl/MenuBlade","Fx/Composition/MenuBlade"],"*Fx/Composition/FrameBlade":["Fx/Composition/FrameBlade"],"*Fx/Composition/DataContext":["Fx/Composition/DataContext"],"*Fx/Composition/CustomControl/FormField":["Fx/Composition/CustomControl/FormField"],"*Fx/Composition/CustomControl":["Fx/Composition/CustomControl"],"*Fx/Composition/Blade":["Fx/Composition/Blade"],"*Fx/Base/Base.Net.Batch":["Fx/Base/Base.Net.Batch"],"*Fx/Assets/Assets":["Fx/Assets/Assets"]}});define("MsPortalImpl.Controls/Controls/ResourceFilterHelper",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function o(n){t.getOrSet(n.cloudName,[
]).push(n)}function c(n){if(n){var i=t.get(n.cloudName),r=i&&i.first((function(t){return t.id===n.id}));r&&i.remove(r);i.length?t.set(n.cloudName,i):t.set(n.cloudName,[])}}function l(){return n.Internal.assetTypeService.assetTypes().forEach((function(n){o(n)})),t}function a(t,i){n.Internal.assetTypeService=t;t.assetTypes.subscribeArrayChanges(e,(function(n){o(n)}),(function(n){c(n)}));i.registerForDispose(e)}function v(n){var r=u.get(n),e,o;return r||(r=h(),u.set(n,r),e=t.get(n)?t:l(),o=(e.get(n)||[]).filter((function(n){var t=n.assetTypeManifest.browseType;return t===f.ResourceType||t===f.InstanceLink})).map((function(n){return{name:n.compositeDisplayName.plural,key:n.id}})),r(i.stableSort(o,(function(n,t){return n.name.localeCompareIgnoreCase(t.name)})))),r}var f=i.Extension.BrowseType,s=r.TriggerableLifetimeManager,e=new s,h=ko.observable,t,u;n.Internal={};t=r.getCloudMap();u=r.getCloudMap();n.initialize=a;n.getResourceTypes=v})(u||(u={})),u}));define("MsPortalImpl/Services/Services.SelectedSubscriptions",
["require","exports","f","i","a","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){function nt(){h=r.getCloudMap();t=r.getCloudMap()}function tt(t){var i=(t||[]).map((function(n){return n.subscriptionId})).join(";");n.userSettingsManager.setSetting(g,b,i)}function at(n,t){var r=(n.state||"").toLowerCase(),u=(t.state||"").toLowerCase(),i;if(r!==u){if(r===k)return 1;if(u===k)return-1}return i=n.displayName.localeCompareIgnoreCase(t.displayName),i===0&&(i=n.subscriptionId.localeCompareIgnoreCase(t.subscriptionId)),i}function l(n,t){var r=n||[],i=[],u;return t&&t.length&&(u=c.Utilities.convertArrayToMap(t,(function(n){return n})),i=r.filter((function(n){return!!u[n.subscriptionId]}))),(i.length?i:r).stableSort(at)}function vt(t){nt();n.userSettingsManager=t;ut.getSelectedSubscriptionsEndPoint.register(u.client,null,(function(n,t){return t.srcWindowId!==y.Shell&&t.srcWindowId!==p.getHubsWindowId(
)&&(n=p.getDescriptor(t.srcWindowId).cloudName),it(n)}));n.selectedSubsUpdateTriggered.subscribe(lt,(function(n){et.pingSelectedSubscriptionsListEndPoint.invoke(u.client,ht,n)}))}function it(i){var r=h.get(i),f;return r?Q(r):(t.get(i)||(f=Q(a.getAllSubscriptions(u.client,i)).then((function(t){return n.userSettingsManager.querySetting(g,b).then((function(n){var f=(n||"").split(";"),r=l(t,f),u;return r.length>s&&(r=r.slice(0,s),tt(r),u=t.length,ot.publish({status:st.Information,title:d.cappedTitleFmt.format(s,u),description:d.cappedFmt.format(s,u),uri:"#menu/settings"})),h.set(i,r),r}))})),t.set(i,f.catch((function(n){return t.set(i,null),Q.reject(n)})))),t.get(i))}function yt(t,i){return a.getAllSubscriptions(u.client,i).then((function(r){var u=l(r,t);h.set(i,u);n.selectedSubsUpdateTriggered({cloudName:i,selectedSubscriptions:u});tt(u.length===r.length?[]:u)}))}var a=r.Azure,rt=f.Keys,v=r,ut=v.Azure,c=i.Base,y=c.Constants,u=c.Rpc.Internal,ft=v.TriggerableLifetimeManager,et=e.SelectedSubscriptions,
p=r.Extension,w=i.Hubs.Notifications,ot=w.ClientNotification,st=w.NotificationStatus,b=rt.subscriptionsSelected,k="disabled",ht=y.ExtensionNames.Hubs,s=40,d=o.SubscriptionsNotification,g=6,ct=ko.observable,lt=new ft,t,h;n.selectedSubsUpdateTriggered=ct();n.resetState=nt;n.getValidSelectedSubscriptions=l;n.init=vt;n.getSelectedSubscriptions=it;n.setSelectedSubscriptions=yt})(s||(s={})),s}));define("MsPortalImpl/Base/Base.CustomControlsBladeHost",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function f(n){return new t.ProxiedObjectTypeDefinition(n)}var u=i.Base,t=u.Rpc.Internal,r=t.FuncEndPointDefinition;n.CustomControlsBladeHostContainer="CustomControlsBladeHostContainer";n.customControlsState=new t.ProxiedObjectTypeDefinition("CustomControlsSharedObservables");n.initializeEndpoint=new r("InitializeCustomControlsBlade");n.getControlDefinitionEndpoint=new r("GetControlDefinitionForCustomControlsBlade");n.getViewModelDefinitionFactory=f})(r||(r={})),r}));define(
"MsPortalImpl/Services/Services.Settings",["require","exports","f","o","FxHubs/HubsSettingsSchema","./Services.Settings.Schema","MsPortalImpl/Resources/ImplScriptResources","./Services.Storage"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function b(n){return function(t){this[t]=n}}function ft(){var n={};return f.generalSettingsKeys.forEach(b(!0),n),n}function yt(){return i.map(h,i.identity)}function pt(n){return c[n+1e3]}function wt(n){return h[n]}function bt(n){var t={manager:new p.InMemorySettingsManagerImpl,stores:[8,9,13,]};return p.createUserSettingsManager(new p.UserSettingsManagerImpl(n),[t])}function kt(n,t){if(!t||!t.length)return Q({});var i=t.map(n.queryStore,n);return Q.all(i).then((function(n){var i={};return n.forEach((function(n,r){i[t[r]]=n})),i}))}var s=i.Base,it=s.Constants,rt=s.Diagnostics,l=i.Hubs.Notifications.NotificationStatus,ut=s.Net2,et=window,k=et.fx,u=e.Services.Settings,w=k.environment,d=i.isFeatureEnabled,ot=d("inmemorysettings"),a=w.version,
g=s.getVersionFromString(a),v=w.settingsBaseUri+"{0}"+w.settingsUriQuery,st=v.format("/Update"),ht=v.format("/Select"),ct=v.format("/Clear"),lt=v.format("/ClearAll"),y=rt.createLog(n),nt=f.settingsVersionSettingKey,at=ft(),tt=k.early,vt=tt&&tt.preloadSettings,h,c,p;g.revision=0;h={General:0,Blade:1,Part:2,LensState:3,Startboard:4,SharedPart:5,HubsExtension:6,CrossTenant:7,JourneySession:8,EditScopeSession:9,Favorites:10,DashboardInventory:11,FileUpload:12};c=[];i.forEachKey(h,(function(n,t){c[t]=n})),(function(){for(var t,i,n=0;n<100;n++)t="Dashboard"+n,i=n+1e3,h[t]=i,c[i]=t})();t.getAllStoreIds=yt;t.getDashboardStoreName=pt;t.getDashboardStoreId=wt;t.createUserSettingsManager=bt;t.queryStores=kt,(function(n){function kt(n,t,i){return new k(new w(new v(p.createWithWriteDeleteBufferTimeout(n,i),t)))}function e(n){var t=c[n];if(!t)throw new Error("Invalid store: "+n);return t}function rt(n){var i={},t;return n.keys.forEach(b(null),i),t={},t[n.store]=i,t}function dt(n,t){var u=i.merge(n,t),r={
settingsToSet:{},settingsToDelete:{}};return r=u.reduce((function(n,t){return h(n.settingsToSet,n.settingsToDelete,t.settingsToSet),h(n.settingsToDelete,n.settingsToSet,t.settingsToDelete),n}),r),[r]}function h(n,t,r){r&&i.forEachKey(r,(function(u){var f=parseInt(u),o=r[f],e;n&&(n[f]||(n[f]={}),ft(o,n[f]));t&&(e=t[f],e&&(et(o,e),i.isEmpty(e)&&delete t[f]))}))}function ft(n,t){i.forEachKey(n,(function(n,i){t[n]=i}))}function et(n,t){i.forEachKey(n,(function(n){delete t[n]}))}function yt(n,t,i){var r={};return r[t]=i,{store:n,settings:r}}function gt(n){return!!at[n]}function pt(n){return Q.all(n)}function tt(n){return JSON.parse(JSON.stringify(n))}var f,t,wt,v,bt,p,w,k;n.createUserSettingsManager=kt;n.getSettingStoreName=e;n.convertSettingQueryToDictionary=rt;n.updateDictionary=h;n.updateSettingsDictionary=ft;n.sanitizeSettingsDictionary=et;f=(function(){function n(){this._eventsTriggered=ko.observableArray()}return r.defineProperty(n.prototype,"eventsTriggered",{get:function(){var n=this._baseManager;
return n?n.eventsTriggered:this._eventsTriggered},enumerable:!0,configurable:!0}),n.prototype._fireEvent=function(n,t,i){var r={status:i,title:n,description:t,timestamp:new Date,cloudName:it.DefaultCloudName};this.eventsTriggered.push(r)},n.prototype._fireError=function(n){this._fireEvent(u.useInMemorySettings,n||u.settingsCallFailed,l.Error)},n})();n.SettingsManagerVeryBase=f;t=(function(n){function t(t){n.call(this);this._baseManager=t}return __extends(t,n),t.prototype.flushSettings=function(){return this._baseManager?this._baseManager.flushSettings():Q()},t.prototype.dispose=function(){this._baseManager&&(this._baseManager.dispose(),this._baseManager=null)},t})(f);n.SettingsManagerBase=t;wt=(function(n){function t(){n.apply(this,arguments);this._maps={}}return __extends(t,n),t.prototype.setSettings=function(n){var t=n.settings,r;t&&(r=this._getMap(n.store),i.forEachKey(t,(function(n,t){r.set(n,JSON.stringify(t))})))},t.prototype.queryStore=function(n){var i=this._getMap(n),t={};return i.forEach(
(function(n,i){t[i]=JSON.parse(n)})),Q(t)},t.prototype.deleteSettings=function(n){if(n.keys){var t=this._getMap(n.store);n.keys.forEach((function(n){t.delete(n)}))}},t.prototype.clearSettings=function(){return this._maps={},Q()},t.prototype._getMap=function(n){return this._maps[n]=this._maps[n]||new i.Map},t})(t);n.InMemorySettingsManagerImpl=wt;v=(function(n){function t(t,i){n.call(this,t);this._initialize(i)}return __extends(t,n),t.prototype.queryStore=function(n){return this._getManager(n).queryStore(n)},t.prototype.deleteSettings=function(n){this._getManager(n.store).deleteSettings(n)},t.prototype.setSettings=function(n,t){this._getManager(n.store).setSettings(n,t)},t.prototype.clearSettings=function(){var n=this._managers.map((function(n){return n.clearSettings()}));return pt(n)},t.prototype._initialize=function(n){var t=this;this._managersDictionary={};this._managers=[this._baseManager];n&&n.forEach((function(n){t._managers.push(n.manager);n.stores.forEach((function(i){t._managersDictionary[
i]=n.manager}))}))},t.prototype._getManager=function(n){return this._managersDictionary[n]||this._baseManager},t})(t);n.RoutingSettingsManager=v;bt=(function(n){function t(t,i){i===void 0&&(i=vt);n.call(this);this._didSettingsCallFail=!1;this._storageService=t;this._preloadStores=i}return __extends(t,n),t.prototype._ajax=function(n,t){var i=this;return ut.ajaxExtended({uri:n,headers:{"x-ms-user-settings-session":this._storageService.getValue(o.ComponentName.UserSettingsService,"x-ms-user-settings-session",1)||""},type:"POST",dataType:"json",data:t&&JSON.stringify(t),contentType:"application/json;charset=utf-8",performRetry:!0}).then((function(n){return i._storageService.setValue(o.ComponentName.UserSettingsService,"x-ms-user-settings-session",n.jqXHR.getResponseHeader("x-ms-user-settings-session"),1),n}))},t.prototype.queryStore=function(n){var i=this,t=e(n),r,f;return this._didSettingsCallFail?(y.error("Failed to query store '"+t+"'.",1),Q({})):(r=this._popPreloadPromise(t),r)?r.catch((function(
r){return y.error(r,1,"Failed to preload store '"+t+"'."),i.queryStore(n)})):(f=Date.now(),this._ajax(ht,[t]).then((function(n){var r=n&&n.content&&n.content[t]||{},i=Date.now()-f;return i>5e3&&y.warning("Request to store '"+t+"' took more than 5s to complete.\n                                                        Request time: "+i+"ms.\n                                                        Response size: "+(n&&n.jqXHR&&n.jqXHR.responseText.length)),r}),(function(){return i._didSettingsCallFail=!0,i._fireEvent(u.useInMemorySettings,u.querySettingsCallFailed,l.Error),Q({})})))},t.prototype.clearSettings=function(){var n=this;return this._clearPreloadPromises(),this._ajax(d("clearallusersettings")?lt:ct).catch((function(){n._fireError(u.clearSettingsCallFailed)}))},t.prototype.updateSettings=function(n){var t=this;if(this._didSettingsCallFail)return Q();var r=!1,u=function(n){var u={};return i.forEachKey(n||{},(function(n,i){var f=e(n);u[f]=i;t._popPreloadPromise(f);r=!0})),u},f={save:u(n.settingsToSet),
remove:u(n.settingsToDelete)};return r?this._ajax(st,f).catch((function(n){t._didSettingsCallFail=!0;throw n;})):Q()},t.prototype._popPreloadPromise=function(n){var t=this._preloadStores,i;return t&&(i=t[n],i)?(t[n]=null,Q(i)):null},t.prototype._clearPreloadPromises=function(){var n=this._preloadStores;return n&&i.forEachKey(n,(function(t){n[t]=null})),null},t})(f);n.UserSettingsManagerImpl=bt;p=(function(n){function t(t,i,r,u){var f=this;n.call(this,null);this._primitiveSettingsManager=t;this._sequencer=i(dt,(function(n){return f._executeMethod(n[0])}),r,!0,{optionalDataInterval:u})}return __extends(t,n),t.createWithWriteDeleteBufferTimeout=function(n,i,r){var u=i!==undefined?i:5e3,f=r!==undefined?r:3e5;return new t(n,function(n,t,i,r,u){return new s.Debouncer(n,t,i,r,u)},u,f)},t.prototype.queryStore=function(n){return this._primitiveSettingsManager.queryStore(n)},t.prototype.setSettings=function(n,t){if(!i.isEmpty(n.settings)){var r={};r[n.store]=n.settings;this._sequencer.execute([{settingsToSet:
r,settingsToDelete:{}}],t===1)}},t.prototype.deleteSettings=function(n,t){n.keys&&n.keys.length&&this._sequencer.execute([{settingsToDelete:rt(n),settingsToSet:{}}],t===1)},r.defineProperty(t.prototype,"eventsTriggered",{get:function(){return this._primitiveSettingsManager.eventsTriggered},enumerable:!0,configurable:!0}),t.prototype.flushSettings=function(){return this._sequencer.flush()},t.prototype.clearSettings=function(){var t=this,n=Q.defer();return this.flushSettings().finally((function(){t._primitiveSettingsManager.clearSettings().finally((function(){n.resolve()}))})),n.promise},t.prototype.dispose=function(){this.flushSettings();n.prototype.dispose.call(this)},t.prototype._executeMethod=function(n){return this._primitiveSettingsManager.updateSettings(n)},t})(t);n.SequencingSettingsManager=p;w=(function(n){function t(t){n.call(this,t);this._cache={};this._cachedStores={};this._activeQueryPromises={};this._activeUpdatePromises={};this._isSettingsVersionChecked=!1;this._isSettingsVersionVerified=
!1;this._uniqueId=1}return __extends(t,n),t.prototype.queryStore=function(n){var i=this,t,r;return this._belongsToCache(n)?Q(this._getSettingsFromCache(n)):(t=this._activeQueryPromises,r=t[n]||this._canCallBaseManager().then((function(r){if(r&&!i._belongsToCache(n)){if(t[n])return t[n];var u=i._baseManager.queryStore(n).then((function(t){i._updateCaches(n,t)}));return t[n]=u,u}})),r.then((function(){return i._getSettingsFromCache(n)})).finally((function(){t[n]=null})))},t.prototype.setSettings=function(n,t,i){this._execute(this._setSettingsInternal,n,t,i)},t.prototype._setSettingsInternal=function(n,t,i,r){var f=this,u=this._writeSettingsToCache(n,!0);r?(this._baseManager.setSettings(u,t),this._resolveSetPromise(i)):this._executeIfBaseManagerCallIsAllowed((function(){f._baseManager.setSettings(u,t)}),i)},t.prototype._resolveSetPromise=function(n){this._activeUpdatePromises[n].resolve();delete this._activeUpdatePromises[n]},t.prototype._execute=function(n,t,i,r){var o=this,e=this._uniqueId++,u,f;
this._activeUpdatePromises[e]=Q.defer();t&&(u=t.store,f=[t,i,e,r],this._belongsToCache(u)?n.apply(this,f):this.queryStore(u).then((function(){n.apply(o,f)})))},t.prototype.deleteSettings=function(n,t){this._execute(this._deleteSettingsInternal,n,t)},t.prototype._deleteSettingsInternal=function(n,t,i){var r=this;this._deleteSettingsFromCache(n);this._executeIfBaseManagerCallIsAllowed((function(){r._baseManager.deleteSettings(n,t)}),i)},t.prototype.clearSettings=function(){var t=this,i=this._baseManager?this._baseManager.clearSettings():Q(),n=Q.defer();return this.flushSettings().finally((function(){i.finally((function(){t._cache={};n.resolve()}))})),n.promise},t.prototype.flushSettings=function(){var t=this,n=r.keys(this._activeUpdatePromises).map((function(n){return t._activeUpdatePromises[parseInt(n)].promise}));return n&&n.length?pt(n).finally((function(){return t._baseManager.flushSettings()})):this._baseManager.flushSettings()},t.prototype._updateCaches=function(n,t){this._cachedStores[n]=!0;this.
_writeSettingsToCache({store:n,settings:t})},t.prototype._canCallBaseManager=function(){return this._isSettingsVersionChecked?Q(this._isSettingsVersionVerified):(this._settingsVerificationPromise||(this._settingsVerificationPromise=this._verifySettings()),this._settingsVerificationPromise)},t.prototype._verifySettings=function(){var n=this,t=0;return ot||!this._baseManager?(this._fireEvent(u.useInMemorySettings,this._baseManager?u.inMemorySettingsMode:u.noBaseManager,l.Warning),this._isSettingsVersionVerified=!1,this._isSettingsVersionChecked=!0,Q(!1)):this._baseManager.queryStore(t).then((function(i){var r=i[nt],f;return r?(f=s.getVersionFromString(r),f.revision=0,n._isSettingsVersionVerified=g.compareTo(f)>=0):n._isSettingsVersionVerified=!0,n._isSettingsVersionChecked=!0,n._isSettingsVersionVerified?(n._updateCaches(t,i),n.setSettings(yt(t,nt,a),0,!0),n._processGeneralSettings(i),!0):(n._fireEvent(u.useInMemorySettings,u.portalVersionMismatch.format(r,a),l.Warning),y.error("Current version '"+
a+"' does not match with the version '"+r+"' saved in user settings",3),!1)}))},t.prototype._executeIfBaseManagerCallIsAllowed=function(n,t){if(!this._isSettingsVersionChecked)throw new Error("_canCallBaseManagerSync has been called before completing async verification.");this._isSettingsVersionVerified&&n();this._resolveSetPromise(t)},t.prototype._deleteSettingsFromCache=function(n){var t=this._cache[n.store];n.keys&&t&&n.keys.forEach((function(n){delete t[n]}))},t.prototype._getSettingsFromCache=function(n){return this._cache[n]||(this._cache[n]={}),this._cache[n]},t.prototype._belongsToCache=function(n){return!!this._cachedStores[n]},t.prototype._writeSettingsToCache=function(n,t){var r,u;return n?(r=this._cache[n.store],r||(r=this._cache[n.store]={}),u={},i.forEachKey(n.settings,(function(n,i){t&&(r[n]===i||JSON.stringify(r[n])===JSON.stringify(i))||(r[n]=i,u[n]=i)})),{store:n.store,settings:u}):null},t.prototype._processGeneralSettings=function(n){var t=[];i.forEachKey(n,(function(n){gt(
n)||t.push(n)}));this.deleteSettings({store:0,keys:t})},t})(t);n.CachingSettingsManagerImpl=w;k=(function(n){function t(t){n.call(this,t)}return __extends(t,n),t.prototype.queryStore=function(n,t){return this._baseManager.queryStore(n).then((function(n){return t?n:tt(n)}))},t.prototype.querySettings=function(n){return n.keys&&n.keys.length>0?this.queryStore(n.store,!0).then((function(t){var i={},r;return t&&(r=n.keys.filter((function(n){return n in t})),r.forEach((function(n){i[n]=t[n]}))),tt(i)})):this.queryStore(n.store)},t.prototype.querySetting=function(n,t){return this.querySettings({store:n,keys:[t]}).then((function(n){if(n){var i=n[t];return i===undefined?null:i}return null}))},t.prototype.setSettings=function(n,t){this._baseManager.setSettings(tt(n),t)},t.prototype.setSetting=function(n,t,i,r){this.setSettings(yt(n,t,i),r)},t.prototype.deleteSettings=function(n,t){this._baseManager.deleteSettings(n,t)},t.prototype.clearSettings=function(){return this._baseManager.clearSettings()},t})(t);n.ExtendedSettingsManager=
k})(p=t.Internal||(t.Internal={}))})(s||(s={})),s}));define("MsPortalImpl/Base/Base.GenericPopup",["require","exports","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i){"use strict";var r;return (function(n){function r(n){var f=t.open("about:blank","_blank","location=no,toolbar=no,menubar=no");if(f){var e=f.document,r=e.body,u=i.DiagnosticsPopup.loading;return r.textContent=u,n.provideText().then((function(n){var i=Q.defer(),f=0,o=t.setInterval((function(){if(f++,f>100||r.textContent===u){t.clearInterval(o);i.resolve();var s=e.createElement("pre");s.className="fxs-popup-diagnostics";s.textContent=n;r.textContent="";r.appendChild(s)}else r.textContent=u}),100);return i}))}}var t=window;n.showPopup=r})(r||(r={})),r}));define("MsPortalImpl/Base/Base.HierarchyMap",["require","exports","f","a"],(function(){"use strict";var n;return (function(n){var r=ko.observableArray,t=JSON.parse,i=JSON.stringify,u=(function(){function n(){}return n.prototype.toJSON=function(n){return i(n)},n.prototype.fromJSON=
function(n){return t(n)},n})(),f=(function(){function n(n,i){this._observable=r();this._separator="##-##";this._serializer=n||new u;i&&this._fromJSON(typeof i=="string"?t(i):i)}return n.prototype.itemExists=function(n){return this._getItemIndex(n)>=0},n.prototype.addItem=function(n,t){if(n&&n.length){if(n.some((function(n){return!n})))throw new Error("All paths segments must be non-empty strings.");else if(this.itemExists(n))throw new Error("Cannot add two items with the same path '"+i(n)+"'.");}else throw new Error("Path must include at least one segment.");this._observable.push({path:n,_pathKey:n.join(this._separator),value:t})},n.prototype.removeItem=function(n){var t=this._getItemIndex(n);t>=0&&this._removeItemsAt(t,1)},n.prototype.removeItemsInPath=function(n){this._removeItemsWithPath(n,!0)},n.prototype.removeItemsUnderPath=function(n){this._removeItemsWithPath(n,!1)},n.prototype.empty=function(){this._removeItemsAt(0)},n.prototype._getItemIndex=function(n){var t=n.join(this._separator);
return this._observable.peek().firstIndex((function(n){return n._pathKey===t}))},n.prototype.getItem=function(n){var t=this._getItemIndex(n);return t>=0?this._observable.peek()[t]:null},n.prototype.getItems=function(){return this._observable.peek()},n.prototype.getItemsInPath=function(n){return this._getItemsWithPath(n,!0)},n.prototype.getItemsUnderPath=function(n){return this._getItemsWithPath(n,!1)},n.prototype.getObservable=function(){return this._observable},n.prototype.toJSON=function(){var t=this,n=this._observable,r=ko.isObservable(n)?n.peek():n;return{items:i(r,(function(n,i){switch(n){case"value":return t._serializer.toJSON(i);case"_pathKey":return}return i}))}},n.prototype._removeItemsAt=function(){var n=this._observable;n.splice.apply(n,arguments)},n.prototype._fromJSON=function(n){var e=this,i=this._observable.peek(),o=i.length,r,f,u;for(t(n.items,(function(n,t){return n===""&&t&&t.forEach((function(n){n.value=e._serializer.fromJSON(n.value);i.push(n)})),t})),r=o,f=i.length;r<f;r++)
u=i[r],u._pathKey=(u.path||[]).join(this._separator);this._observable(i)},n.prototype._removeItemsWithPath=function(n,t){var i=[];this._getItemsWithPath(n,t,(function(n,t){return!n&&i.push(t)}));this._observable(i)},n.prototype._getItemsWithPath=function(n,t,i){var r=n.join(this._separator);return this._observable.peek().filter((function(u){var f=u._pathKey.startsWith(r)&&(t||u.path.length>n.length);return i&&i(f,u),f}))},n})();n.SerializableHierarchyMap=f})(n||(n={})),n}));define("MsPortalImpl/Base/Base.KnockoutExtensions",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(){var n=i.Base.EventTypes;ko.bindingHandlers.commands={update:function(t,i){var u=$(t),r=i(),f,e;if(r&&r.group){u.on(n.fxcontextmenurequest,f=function(t){var f,i;f=ko.unwrap(r.viewModel);i=$.Event(n.fxrightclick);i.clientX=t.clientX;i.clientY=t.clientY;u.trigger(i,{commandGroup:r.group,viewModel:f,entityType:2});t.preventDefault();t.stopPropagation()});ko.utils.domNodeDisposal.addDisposeCallback(t,
e=function(){u.off(n.fxcontextmenurequest,f)})}}}})(r||(r={})),r}));define("MsPortalImpl/Controls/ControlBindings.Async",["require","exports","../Widgets/Widgets.Common"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,t,i,r){f.push({name:t,moduleId:n+i,initOptions:r})}function t(n,t,i){e("MsPortalImpl.Controls/",n,t,i)}function r(n,t,i){e("MsPortalImpl/Controls/",n,t,i)}function o(t){n.portalControlBindings.forEach((function(n){ko.bindingHandlers[n.name]=i.getAsyncBindingHandler(n.moduleId,n.initOptions,t)}))}var f=[],u={controlsDescendantBindings:!1};t("pcButton","Controls/Forms/Button",u);t("pcChart","Controls/Visualization/Chart");t("pcCheckBoxField","Fields/CheckBoxField");t("pcConsole","Controls/Console");t("pcConsoleV2","Controls/ConsoleV2");t("pcCopyableLabel","Controls/Forms/CopyableLabel");t("pcCreatorAndSelector","Fields/CreatorAndSelectorField");t("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2");t("pcCsmTopology","Controls/Visualization/CsmTopology");
t("pcCustomHtmlField","Fields/CustomHtmlField");t("pcCustomValueSlider","Fields/CustomValueSliderField");t("pcCustomRangeSlider","Fields/CustomRangeSlider");t("pcDatePickerField","Fields/DatePickerField");t("pcDateTimeCombo","Controls/Forms/DateTimeCombo");t("pcDateTimeComboField","Fields/DateTimeComboField");t("pcDateTimePickerField","Fields/DateTimePickerField");t("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField");t("pcDayPickerField","Fields/DayPickerField");t("pcDiffEditor","Controls/Documents/DiffEditor");t("pcDiffList","Controls/Documents/DiffList");t("pcDiffView","Controls/Documents/DiffView");t("pcDiscussionTimeline","Controls/Documents/DiscussionTimeline");t("pcDockedBalloon","Controls/DockedBalloon");t("pcDonut","Controls/Visualization/Donut");t("pcDropDownField","Fields/DropDownField");t("pcDurationPickerField","Fields/DurationPickerField");t("pcEditor","Controls/Documents/Editor");t("pcFileUpload","Controls/Forms/FileUpload");t("pcFilterComboField","Fields/FilterComboField");
t("pcFormSection","Fields/SectionField",u);t("pcGallery","Controls/Lists/List1/Gallery");t("pcGauge","Controls/Visualization/Gauge");t("pcGraph","Controls/Visualization/Graph");t("pcGrid","Controls/Lists/Grid1/Grid1");t("pcGrid2","Controls/Lists/Grid2/Controls.Grid2");t("pcGroupDropDown","Controls/Forms/Obsolete.GroupDropDown");t("pcHeatMap","Controls/HeatMap");t("pcHtmlEditorField","Fields/HtmlEditorField");t("pcIFrame","Controls/IFrame");t("pcIFrame2","Controls/IFrameV2");t("pcLegend","Controls/Visualization/Legend");t("pcListView","Controls/Lists/List1/ListView");t("pcLogStream","Controls/LogStream");t("pcMap","Controls/Visualization/Map");t("pcMapV2","Controls/Visualization/MapV2");t("pcMediaPlayer","Controls/AzureMediaPlayer");t("pcMenu","Controls/Lists/Menu");t("pcMetrics","Controls/Visualization/Metrics");t("pcMultiLineTextField","Fields/MultiLineTextField");t("pcMultiselectDropDownField","Fields/MultiselectDropDownField");t("pcNumericTextBoxField","Fields/NumericTextBoxField");
t("pcOAuthButtonField","Fields/OAuthButtonField");t("pcOptionsGroupField","Fields/OptionsGroupField");t("pcPairedTimeline","Controls/Visualization/PairedTimeline");t("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges");t("pcPartPinner","Controls/PartPinner");t("pcPasswordField","Fields/PasswordField");t("pcPreviewTag","Controls/PreviewTag");t("pcProgressBar","Controls/Visualization/ProgressBar");t("pcQueryBuilder","Controls/Data/QueryBuilder");t("pcQuotaGauge","Controls/Visualization/QuotaGauge");t("pcRangeSliderField","Fields/RangeSliderField");t("pcScrollbar","Controls/Scrollbar",u);t("pcSearchBox","Controls/SearchBox");t("pcResourceFilter","Controls/ResourceFilter");t("pcSection","Fields/Section");t("pcSelector","Controls/Forms/Selector");t("pcSelectorField","Fields/SelectorField");t("pcSettings","Controls/Settings");t("pcSimpleButton","Controls/SimpleButton");t("pcSingleSetting","Controls/SingleSetting");t("pcSingleValueGauge","Controls/Visualization/SingleValueGauge");
t("pcSliderField","Fields/SliderField");t("pcSpecComparisonTable","Controls/SpecComparisonTable");t("pcSplitter","Fields/Splitter",u);t("pcStepGauge","Controls/Visualization/StepGauge");t("pcStringListField","Fields/StringListField");t("pcTerminalEmulator","Controls/TerminalEmulator");t("pcTextBlock","Controls/TextBlock");t("pcTextBox","Controls/Forms/TextBox");t("pcTextField","Fields/TextField");t("pcTimePickerField","Fields/TimePickerField");t("pcToolbar","Controls/Toolbars/Toolbar");t("pcTreeView","Controls/Lists/Tree1/TreeView");t("pcTriStateCheckBox","Fields/TriStateCheckBox");t("pcMarkdown","Controls/Markdown");t("pcVideo","Controls/Video");r("pcAsyncFileUpload","Forms/AsyncFileUpload");r("pcCustomControl","CustomControlHost");r("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation");r("pcEssentials","Controls.Essentials");r("pcFileDownloadButton","Controls.FileDownloadButton");r("pcFileUploadWidget","Forms/Controls.FileUpload");r("pcGroupDropDownField","Forms/GroupDropDown");
r("pcHeroBanner","Controls.HeroBanner");r("pcHotSpot","Controls.HotSpot",u);r("pcInfoBox","Controls.InfoBox");r("pcNotice","Controls.Notice");r("pcPicker","Controls.Picker");r("pcPickerV3","Controls.PickerV3");r("pcTokenComboBox","Forms/Controls.TokenComboBox");r("pcWizard","Controls.Wizard");r("pcIntuneAppFileUpload","Forms/IntuneAppFileUpload");n.portalControlBindings=f;n.initialize=o})(r||(r={})),r}));define("MsPortalImpl/Services/Services.PortalIdleState",["require","exports","f"],(function(){"use strict";var n;return (function(n){function r(){return new t.PortalIdleStateServiceImpl(window,i)}var t,i;(function(n){var t=(function(){function n(n,t){var i=this;this._win=n;this._defaultPollMS=t;this._state=0;this._handleId=1;this._iteration=0;this._actions=[];this._win.addEventListener("blur",this._blurFunc=function(){i._state=1;i._processCallbacks(i._defaultPollMS)});this._win.addEventListener("focus",this._focusFunc=function(){i.signalBusy()})}return n.prototype.dispose=function(){var n=this.
_win;return n?(this._win=null,n.removeEventListener("blur",this._blurFunc),n.removeEventListener("focus",this._focusFunc),this._state=0,!0):!1},n.prototype.addCallbacks=function(n){var t=this._handleId++;return this._actions.push({key:t,value:n}),t},n.prototype.removeCallbacks=function(n){var t=this._actions,i=t.firstIndex((function(t){return n===t.key}));return i!==-1?(t.splice(i,1),!0):!1},n.prototype.signalBusy=function(){this._state===1&&(this._state=2,this._processCallbacks(5e3))},n.prototype.signalIdle=function(){this._state=1;this._processCallbacks(0)},n.prototype._processCallbacks=function(n){var t=this,i=this._timeoutHandle;i&&this._win.clearTimeout(i);this._timeoutHandle=this._win.setTimeout((function(){t._timeoutHandle=null;try{t._processIteration()}finally{t._state!==0&&t._processCallbacks(t._defaultPollMS)}}),n)},n.prototype._processIteration=function(){var f=this,t,n;switch(this._state){case 2:this._state=0;t=function(n){n.onBusy(new Date)};break;case 1:this._state=1;t=function(
n){n.onIdle(new Date)};break;default:case 0:return}var i=function(n){var i=f._actions[n];i&&t(i.value)},r=this._actions.length,u=this._iteration%r;for(this._iteration++,n=u;n<r;n++)i(n);for(n=0;n<u;n++)i(n)},n})();n.PortalIdleStateServiceImpl=t})(t=n.Internal||(n.Internal={}));i=18e5;n.createInstance=r})(n||(n={})),n}));define("MsPortalImpl/Controls/ControlBindings",["require","exports"],(function(){"use strict";var n;return (function(){function n(n,i){t[n]=i}function u(n,t){var i=ko.unwrap(n()),u;if(i){if(u=t[i.controlType],!u)throw new Error("Unsupported ControlType in formControl binding handler: "+i.controlType+".");return r[u]}}function f(n,t,i,r,f,e){var s=u(t,e),o;if(s)return o=$(n),o.attr("data-formelement",o.attr("data-bind")),s.init(n,t,i,r,f)}function e(n,t,i,r,f,e){if(n){var o=u(t,e);if(o)return o.update(n,t,i,r,f)}}var r=ko.bindingHandlers,t={},i;n(20,"pcArtifactLinks");n(106,"pcAsyncFileUpload");n(16,"pcAttachment");n(38,"pcButton");n(63,"pcChart");n(7,"pcCheckBoxField");n(75,
"pcConsole");n(90,"pcConsoleV2");n(40,"pcCopyableLabel");n(83,"pcCreatorAndSelector");n(85,"pcCreatorAndSelectorV2");n(64,"pcCsmTopology");n(117,"pcCustomControl");n(23,"pcCustomHtmlField");n(91,"pcCustomValueSlider");n(111,"pcCustomRangeSlider");n(25,"pcDatePickerField");n(14,"pcDateTimeComboField");n(26,"pcDateTimePickerField");n(27,"pcDateTimeRangePickerField");n(92,"pcDayPickerField");n(76,"pcDeleteAssetConfirmation");n(33,"pcDiffEditor");n(34,"pcDiffList");n(35,"pcDiffView");n(36,"pcDiscussionTimeline");n(32,"pcDockedBalloon");n(65,"pcDonut");n(3,"pcDropDownField");n(99,"pcDurationPickerField");n(15,"pcSection");n(37,"pcEditor");n(120,"pcEssentials");n(82,"pcFileDownloadButton");n(28,"pcFileUpload");n(81,"pcFileUploadWidget");n(12,"pcFilterComboField");n(55,"pcGallery");n(66,"pcGauge");n(67,"pcGraph");n(103,"pcGrid2");n(98,"pcGroupDropDownField");n(77,"pcHeroBanner");n(19,"pcHistory");n(84,"pcHotSpot");n(18,"pcHtmlEditorField");n(108,"pcIFrame");n(113,"pcIFrame2");n(78,"pcInfoBox");
n(121,"pcIntuneAppFileUpload");n(118,"pcLegend");n(88,"pcHotSpot");n(87,"pcInfoBox");n(104,"pcList2");n(58,"pcLogStream");n(68,"pcMap");n(96,"pcMapV2");n(109,"pcMediaPlayer");n(115,"pcMenu");n(69,"pcMetrics");n(13,"pcMultiLineTextField");n(8,"pcMultiselectDropDownField");n(79,"pcNotice");n(10,"pcNumericTextBoxField");n(29,"pcOAuthButtonField");n(4,"pcOptionsGroupField");n(70,"pcPairedTimeline");n(94,"pcPairedTimelineBadges");n(5,"pcPasswordField");n(39,"pcCheckBox");n(41,"pcDateTimeCombo");n(42,"pcDropDown");n(43,"pcFilterCombo");n(54,"pcGrid");n(44,"pcGroupDropDown");n(56,"pcListView");n(110,"pcMarkdown");n(45,"pcMultiLineTextBox");n(46,"pcMultiselectDropDown");n(47,"pcNumericTextBox");n(48,"pcOptionPicker");n(49,"pcPassword");n(50,"pcRangeSlider");n(51,"pcSelector");n(52,"pcSlider");n(53,"pcTextBox");n(57,"pcTreeView");n(112,"pcPartPinner");n(80,"pcPicker");n(89,"pcPreviewTag");n(71,"pcProgressBar");n(31,"pcQueryBuilder");n(72,"pcQuotaGauge");n(9,"pcRangeSliderField");n(59,"pcScrollbar");
n(93,"pcSearchBox");n(114,"pcResourceFilter");n(1,"pcFormSection");n(11,"pcSelectorField");n(60,"pcSettings");n(100,"pcSimpleButton");n(97,"pcChart");n(61,"pcSingleSetting");n(73,"pcSingleValueGauge");n(6,"pcSliderField");n(95,"pcSpecComparisonTable");n(21,"pcSplitter");n(74,"pcStepGauge");n(17,"pcStringListField");n(102,"pcTerminalEmulator");n(101,"pcTextBlock");n(2,"pcTextField");n(24,"pcTimePickerField");n(30,"pcTokenComboBox");n(62,"pcToolbar");n(105,"pcTree2");n(22,"pcTriStateCheckBox");n(116,"pcVideo");n(107,"pcWizard");n(119,"pcHeatMap");i={};[20,16,7,83,85,23,91,111,25,14,26,27,92,3,99,15,120,81,12,98,19,18,108,113,110,13,8,10,29,4,5,89,9,1,11,6,21,17,2,112,24,30,22].forEach((function(n){return i[n]=t[n]}));r.pcControl={init:function(n,i,r,u,e){return f(n,i,r,u,e,t)},update:function(n,i,r,u,f){return e(n,i,r,u,f,t)}};r.formElement={init:function(n,t,r,u,e){return f(n,t,r,u,e,i)},update:function(n,t,r,u,f){return e(n,t,r,u,f,i)}}})(n||(n={})),n}));define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",
["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield-container .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:0;margin:0;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{padding:0}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}")})
);define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","f","i","../../_generated/Less/MsPortalImpl/Widgets/CopyField.css"],(function(n,t,i,r){"use strict";var u;return (function(t){function v(n,t){var i=f(n),e=i.css("position"),o;if(n&&n.offsetParent&&(!e||e.toLowerCase()!==c&&e.toLowerCase()!==l)){var w=i.attr("class"),nt=i.attr("data-bind"),r=i,v="Element : "+w+"; ";for(o=0;o<5&&r&&r.parent&&r.parent()&&r.parent().length;++o)r=r.parent(),v=v+("Parent["+o+"] : "+r.attr("class")+"; ");b.error("The position of the target element of copy binding is '"+e+"'. It needs to be '"+c+"' or '"+l+"' to position the copy UI correctly. Classes:'"+w+"'. DataBind:'"+nt+"'. ParentClasses: '"+v+"'")}var s,y,p=function(){s&&s.dispose();s=null;clearTimeout(y);y=null},k=function(){y=setTimeout((function(){p();s=new a(n,t())}),d)},g=function(){p()};i.mouseenter(k).mouseleave(g);h.domNodeDisposal.addDisposeCallback(n,(function(){p();i.off(u.mouseenter,k);i.off(u.mouseleave,g)}))}var y=r.TriggerableLifetimeManager,
o=i.Base,p=o.Diagnostics,u=o.EventTypes,w=i.ViewModels.Controls,f=jQuery,b=p.createLog(n),e="fxs-copyfield",k=e+"-container",s=e+"-copied",d=400,h=ko.utils,c="relative",l="absolute",a=(function(){function n(n,t){var o=f(n),l=this._lifespan=new y,r=f('<div class="'+e+'-wrapper" data-bind="stopBindings: true"><\/div>'),a=f('<div data-bind="pcCopyableLabel: $data" class="'+e+'"><\/div>'),c;a.appendTo(r);r.appendTo(o);c=new w.Forms.CopyableLabel.ViewModel(l);c.disabled(!0);ko.reactor(l,(function(){var n=ko.unwrap(t);c.value(n);o.toggleClass(k,!i.isNullOrWhiteSpace(n))}));ko.applyBindingsToDescendants(c,r[0]);l.registerForDispose([o.setEvents([u.fxcopybuttonclick,function(){o.addClass(s)}],[u.mouseleave,function(){o.removeClass(s)}]),function(){r&&(h.cleanDescendantNodes(r),r.remove())}])}return n.prototype.dispose=function(){this._lifespan.dispose()},n})();t.CopyField=a;t.initializeCopyBinding=v;ko.bindingHandlers.copy={init:function(n,t){v(n,t)}}})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",
["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../UI.NotificationManager"],(function(n,t,i,r,u){"use strict";var f;return (function(t){var o=i.Azure.ResourceManager,s=i.Base,a=s.Diagnostics,v=i.Services.Gallery,h=v.Constants,e=r.Gallery.Notifications,f=a.createLog(n),c=h.GalleryParametersKey,y=h.GalleryOptionsKey,p=i.Hubs.Notifications.NotificationStatus.Error,l=s.Utilities.clone,w=ko.observable,b=(function(){function n(n){this.status=w();this._cloudName=n}return n.prototype.execute=function(t){var s;if("data"in t&&"options"in t){if(s=t.data,c in s.outputParameters){var i=s.outputParameters[c],r=t.options[y],u=r&&r.launchingContext||{},h=this._getGalleryItemId(r.galleryItem);if(h||(f.warning("GalleryItemId should not be null."),h=i.deploymentName),u=l(u,!0),u.oldCreateApi=!0,u.galleryItemId||(u.galleryItemId=h),this._validateOptions(i,r,s)){var v=l(s.outputParameters[i.selectedTemplateId],!0),p=n._findPropInObject(i.selectedTemplateId,r.deploymentTemplateFileUris),
w={subscriptionId:i.subscriptionId,deploymentName:i.deploymentName||r.deploymentName,resourceGroupName:i.resourceGroupName,resourceGroupLocation:i.resourceGroupLocation,resourceProviders:JSON.parse(i.resourceProviders||null),parameters:v,templateLinkUri:!i.templateJson&&p||undefined,templateJson:i.templateJson,deploymentMode:1,launchingContext:u,cloudName:this._cloudName},a=new Date;return o.Deployments.deployTemplate(w).then((function(n){var t;return n.deploymentStatusCode===o.DeploymentStatusCode.Success?(t=new Date(n&&n.timestamp&&n.timestamp.valueOf()),t.getTime()<=a.getTime()&&(t=new Date(a.getTime()+1)),{correlationId:n.correlationId,timestamp:t}):Q.reject()}),(function(){return Q.reject()}))}return this._notify(e.createArgumentsValidationFailedMessage),Q.reject()}return this._notify(e.createOptionsNotSpecifiedMessage),f.error("Create options are not specified in the output parameters."),Q.reject()}return this._notify(e.createCommandMissingArgumentsMessage),f.error("The data or the options needed by the deployment command are not specified."),
Q.reject()},n.prototype._validateOptions=function(t,i,r){var u="CsmCommand was rejected because ";if(t){if(!t.templateJson&&!t.selectedTemplateId)return f.error(u+"neither the templateJson or the selectedTemplateId were specified in galleryParameters."),!1;if(!!t.templateJson)try{JSON.parse(t.templateJson)}catch(e){return f.error(u+"the templateJson specified in galleryParameters was malformed."),!1}if(!t.subscriptionId)return f.error(u+"subscriptionId not specified in galleryParameters."),!1;if(!t.resourceGroupName)return f.error(u+"resourceGroupName not specified in galleryParameters."),!1;if(!t.resourceGroupLocation)return f.error(u+"resourceGroupLocation not specified in galleryParameters."),!1;if(i){if("subscriptionId"in i&&i.subscriptionId!==t.subscriptionId)return f.error(u+"subscriptionId was changed in the create process."),!1;if("resourceGroupName"in i&&i.resourceGroupName!==t.resourceGroupName)return f.error(u+"resourceGroupName was changed in the create process."),!1;if("resourceGroupLocation"in
i&&i.resourceGroupLocation!==t.resourceGroupLocation)return f.error(u+"resourceGroupLocation was changed in the create process."),!1}}else return f.error(u+"galleryParameters were not specified."),!1;if(i){if(i.deploymentTemplateFileUris){if(!t.templateJson&&!n._findPropInObject(t.selectedTemplateId,i.deploymentTemplateFileUris))return f.error(u+"the templateJson was not defined and the selectedTemplateId is not defined in the deploymentTemplateFileUris."),!1}else return f.error(u+"deploymentTemplateFileUris not specified."),!1;if(!("deploymentName"in i))return f.error(u+"deploymentName not specified."),!1}else return f.error(u+"configurationOptions were not specified."),!1;return r?!0:(f.error(u+"create outputs were not specified."),!1)},n._findPropInObject=function(n,t){n=n.toLowerCase();for(var i in t)if(t.hasOwnProperty(i)&&n===(i+"").toLowerCase())return t[i];return null},n.prototype._notify=function(n){var t={title:e.createResourceFailedLabel,description:n,status:p};u.getNotificationManager(
).addClientNotification(t)},n.prototype._getGalleryItemId=function(n){var t=n&&n.id,r=n.launchingContext,i;return t=r&&r.galleryItemId||t,t&&(i=t.split("."),i.length>1&&(t="{0}.{1}".format(i[0],i[1]))),t},n.prototype._deployTemplate=function(n){var t=new Date;return o.deployTemplate(n).then((function(n){var i=n&&n.timestamp&&new Date(n.timestamp.valueOf());return i&&i.getTime()<=t.getTime()&&(i=new Date(t.getTime()+1)),{correlationId:n.correlationId,timestamp:i}}))},n})();t.CsmCommand=b})(f||(f={})),f}));define("MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector",["require","exports","f","i","o","../Extension/Extension.Definition.Locator","../UI/Hubs/ViewModels/UI.Gallery.CsmCommand","../Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function g(){return u||(u=i.require("MsPortalImpl/UI/Hubs/UI.CreateManager")),u}function nt(n,t){ko.bindingHandlers.fxParameterCollector={init:function(){return{controlsDescendantBindings:!1}},update:function(
i,r,u,f,e){var o=ko.unwrap(r()),h=e.$data.cloudName||d();o&&new s(k(i),o,n,t,h)}}}var l=f.Locator,a=r.Extension.CloudName,v=i.Base.Constants.ExtensionNames.Hubs,y=i.Base.Diagnostics,p=i.Base.Utilities,w=i.Parts.PartSize,h=i.Resources.Strings.Part.Provisioning,b=y.createLog(n),k=jQuery,d=ko.observable,u,c=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(o.ViewModel),s;t.ViewModel=c;s=(function(n){function t(t,i,r,u,f){var o,s,y;n.call(this,t,i||new c);o=i.privatePcPrBI;o.triggerProvisioningInStartboardPart.subscribe(this.lifetimeManager,(function(n){var t;if(n){var i=o.provisioningPartExtensionName(),u=o.provisioningPartName(),e=l.forExtension(i,f.peek()).withPartType(u);i===v&&(n=p.clone(n,!0),a.addToModel(f.peek(),n));r.addPartToStartBoard({originPartLocator:e,model:n,modelContainsSensitiveData:!0,initialSize:w.Normal});t=r.getActiveJourney();t&&o.forceDiscardJourney()&&r.forceDiscardJourney(t.id)}}));s=function(){var n=new e.CsmCommand(f.peek());o.provisioningCommand(
n)};o.triggerProvisioningCommand.subscribe(this.lifetimeManager,s);o.triggerProvisioningCommand.peek()&&ko.ignoreDependencies(s);o.provisioningAttempted.subscribe(this.lifetimeManager,(function(n){if(n){var t=r.getActiveJourney();t&&o.forceDiscardJourney()&&r.forceDiscardJourney(t.id)}}));y=function(n){n&&(n.galleryParameters?g().then((function(t){return t.processResourceGroupChange(u,n.galleryParameters,n.configurationOptions,n.deploymentResponse,f.peek()).then((function(){o.provisioningCompleted({succeeded:!0})}),(function(n){o.provisioningCompleted({succeeded:!1,statusUnavailable:n===h.deploymentStatusUnavailable,pollingFailed:n===h.pollingFailed,errorMessage:n})}))})):b.error("galleryParameters should be specified in the provisioningStarted object."))};o.provisioningStarted.subscribe(this.lifetimeManager,(function(n){y(n)}));y(o.provisioningStarted())}return __extends(t,n),t})(o.Widget);t.Widget=s;t.initialize=nt})(s||(s={})),s}));define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",
["require","exports","f","o","a","./Base.KnockoutTemplateSanitizer"],(function(n,t,i,r,u,f){"use strict";var e;return (function(){function o(n,t){var i=ko.unwrap(n()),r=a(i,t);return function(){return r}}function a(n,t){var i;if(n&&typeof n=="object")return i={},r.getOwnPropertyNames(n).forEach((function(r){h.isSerializableProperty(r)&&(f.isAllowedCssClassName(r)?i[r]=n[r]:r&&t.push(r))})),i;var e=String(n||""),o=e.split(" "),s=u.prototype.map.call(o,(function(n){return n=String(n||""),f.isAllowedCssClassName(n)?n:(n&&t.push(n),"")}));return s.join(" ")}function v(n,t){var i=n.getAttribute("data-bind")||"None",r=l.format(String(n.tagName),i,t.join(", "));c.error(r)}var s=i.Base.Diagnostics,h=i.Base.Utilities,c=s.createLog(n),l="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",e=ko.bindingHandlers,t=e.css;e.sanitizedCss={init:function(n,i,r,u,f){if(t.init){var e=o(i,[]);return t.init(n,e,r,u,f)}return null},update:function(
n,i,r,u,f){var e=[],s=o(i,e);return e.length&&v(n,e),t.update(n,s,r,u,f)}}})(e||(e={})),e}));define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","f","a","../Services/Services.Storage"],(function(n,t,i,r,u){"use strict";var f;return (function(t){function s(n,t){var i=Q.defer(),r=new FileReader,u="data:image/jpeg;base64,";return r.onload=function(n){for(var r=n.target.result,f="",o=new Uint8Array(r),e=0;e<o.byteLength;e++)f+=String.fromCharCode(o[e]);try{atob(f);r=u+f}catch(s){r=s.code===5?u+btoa(f):t}i.resolve(r)},r.onerror=function(n){o.error("Error {0} occured while reading user's thumbnail photo".format(n.target.error));i.resolve(t)},r.readAsArrayBuffer(n),i.promise}function h(n,t,i,r){var f=t,o,h;return n&&(o=u.ComponentName.Avatar,h=0,f=!r&&i.getValue(o,n,h),!f)?e.ajax({uri:n,type:"GET",dataType:"binary",responseType:"arraybuffer",isBackgroundTask:!0,setAuthorizationHeader:{resourceName:"graph"}}).then((function(n){return s(n,t)})).catch((function(n){if(n.jqXHR.status===404)return t;
throw n;})).then((function(t){return i.setValue(o,n,t,h),t})):Q(f)}var r=i.Base,f=r.Diagnostics,e=r.Net2,o=f.createLog(n);t.getAvatarImage=h})(f||(f={})),f}));define("MsPortalImpl/Base/JQueryExtensions",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(){function f(t){return function(i){var c=n(o,this),r=s(c),h,f,e;for(t&&(r=r.reverse()),h=i?function(n){return!n.hasClass(u)&&i(n)&&n.is(":tabbable")}:function(n){return!n.hasClass(u)&&n.is(":tabbable")},f=0;f<r.length;f++)if(e=n(r[f]),h(e))return e;return n([])}}var r=i.Base.EventTypes,e=window,n=jQuery,u="msportalfx-skip-initial-focus",t=n.fn,o="input, textarea, select, button, a, [tabindex=0]",s=n.makeArray;t.setEvents=function(){for(var n,i,r=[],t=0;t<arguments.length;t++)r[+t]=arguments[t];return n=this,i=function(t){var i=n[t].bind(n);r.forEach((function(n){var u=n[0],t=n[1],f=typeof t,r;f==="function"?i(u,t):(r=n[2],r&&i(u,t,r))}))},i("on"),{dispose:function(){n&&(i("off"),n=null)}}};t.findByClassName=function(n)
{return this.find("."+n)};t.findFirstTabbable=f();t.findLastTabbable=f(!0);t.isInScrollView=function(n){var u,t=n?this.closest("."+n):u=this.scrollParent();if(!t[0].offsetParent||!t.is(u||this.scrollParent())&&!this.isInScrollView())return!1;var i=t.offset().top,f=i+t.height(),r=this.offset().top,e=r+this.height(),o=r>=i&&r<=f,s=e<=f&&e>=i;return o&&s};t.handleTransitionEndOnce=function(t,i,u){var s=this,f,h=!1,o;this.on(r.transitionend,f=function(n){for(var e,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];(e=n&&n.originalEvent,e&&e.propertyName!==t)||h||(h=!0,s.off(r.transitionend,f),u.apply(s,[n].concat(o)))});return o=function(){var i=n.Event("transitionend",{originalEvent:{propertyName:t}});f(i)},n.fx.off?o():e.setTimeout(o,i),this};n.enableAnimations=function(t){var i="fxs-transition-off-style-head-marker",u=n("<style/>").addClass(i).append("* {transition: none !important;-webkit-animation-iteration-count: .5 !important;animation-iteration-count: .5 !important;-webkit-animation-duration: 0s !important;animation-duration: 0s !important;-webkit-animation-delay: 0s !important;animation-delay: 0s !important;}"),
r=n("head");n.fx.off=!t;t?r.findByClassName(i).remove():r.findByClassName(i).length===0&&r.append(u)}})(r||(r={})),r}));define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(t){function w(n){return s.test(n)}var a=r.Extension,f=i.Base,v=f.Constants,y=f.Diagnostics,u=y.createLog(n),e="^[a-zA-Z][\\w]*$",p=window,o=p.fx.environment,s,h,c,l;t.canModifyExtensions=o.features.canmodifyextensions==="true";s=/^(https?:)?\/\/localhost(\:\d+)?(\/|$)/;t.isLocalhostUri=w;t.canAddGalleryPackages=o.features.canaddgallerypackages==="true";h=(function(){function n(){}return n.prototype._normalizeCloudNameHelper=function(n){return n||v.EmptyCloudName},n.prototype.isValid=function(){var n,t,i;return typeof this.name!="string"?(u.error("Invalid name specified for extension",1,this),!1):typeof this.uri!="string"||!this.uri?(u.error("Invalid uri specified for extension",1,this),!1):(n=new RegExp(e),t=n.test(this.
name),!t)?(i="Invalid extension name '{0}' specified. Extension names must match the following expression '{1}'.",u.error(i.format(this.name,e),8),!1):!0},n.prototype.isEqual=function(n){var t=n;return a.isEqualDescriptor(this,t)},n.prototype.updateWith=function(n){var t=n;this.name=t.name;this.uri=t.uri;this.obsoleteBundlesBitmask=t.obsoleteBundlesBitmask;this.features=t.features;this.trustedHost=t.trustedHost;this.startBoardParts=t.startBoardParts;this.isTestExtension=t.isTestExtension},n.prototype.markAsTestExtension=function(){this.isTestExtension=!0},n.prototype.logUsageWarning=function(){u.warning("Extension '{0}' is running untrusted code from '{1}'".format(this.name,this.uri),7,this)},n.prototype.normalizeCloudName=function(){this.cloudName=this._normalizeCloudNameHelper(this.cloudName);this.trustedHost||(this.trustedHost="*")},n.create=function(t){var i=new n;return i.cacheability=t.cacheability,i.cloudName=t.cloudName,i.encryptTokens=t.encryptTokens,i.features=t.features,i.feedbackEmail=
t.feedbackEmail,i.isTestExtension=t.isTestExtension,i.isTestStamp=t.isTestStamp,i.name=t.name,i.startBoardParts=t.startBoardParts,i.trustedHost=t.trustedHost,i.uri=t.uri,i.obsoleteBundlesBitmask=t.obsoleteBundlesBitmask,i},n})();t.ExtensionMetadataExt=h;c=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n;return(this.uri&&this.uri.toLowerCase())===(t&&t.uri&&t.uri.toLowerCase())},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted gallery package '{0}' is running".format(this.uri),7,this)},n.create=function(t){var i=new n;return i.uri=t.uri,i},n})();t.GalleryPackageExt=c;l=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n;return(this.uri&&this.uri.toLowerCase())===(t&&t.uri&&t.uri.toLowerCase())},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning(
"Untrusted patch '{0}' is running".format(this.uri),7,this)},n})();t.PatchExt=l})(u||(u={})),u}));define("MsPortalImpl/Services/Services.AssetManagement",["require","exports","f","o","a","../Services/Services.AssetTypes","../Services/Services.AssetTypes.Utils","../Services/Services.PortalIdentity","./Services.Settings.Schema"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function ft(n){return tt(n)||it(n)||vt(n)}function yt(n,t,i){return new y(o.getSignedInUser(),n,t,i,et.client)}function pt(n,t){return t}function wt(n,t){var i=n;return i&&u.isArray(i)?(i.reverse().forEach((function(n){var i=e.getMruItemKey({cloudName:n.cloudName,name:n.extension},n.assetType,n.resourceId||n.assetId);t.addOrUpdate(i,n)})),!0):!1}var w=FxImpl,l=w.Extension,h=i.Base,et=h.Rpc.Internal,ot=i.Extension.BrowseType,c=i.ViewModels.Services.ResourceTypes,a=w.AssetManager,b=h.Constants.ResourceTypes,st=h.Constants.ExtensionNames.Hubs,ht=h.Diagnostics,ct=1e4,k=50,d=s.assetMruListKey,lt=2e4,g="fulfilled",
v=ht.createLog(n),nt="MRU entry with no mapping view model",at=ko.observableArray,tt=c.isSubscriptionId,it=c.isResourceGroupId,vt=c.isResourceId,rt=c.tryBuildResourceManagerKey,ut=c.parseResourceDescriptor,y,p;t.createAssetManager=yt;y=(function(){function n(n,t,r,u,e,o){var h=this,s;this._assetDeletedCallbacks=$.Callbacks();this._hubsWindowId=l.getHubsWindowId();this._extensionManager=t;this._settingsService=r;this._assetTypeService=u;this._portalIdentity=n;this._assetMruList=o;s=function(n,t,i){var e,r,o,s,l;i.reason=i.reason||"Received asset deletion notification from the extension '"+n+"'";e=h.handleAssetDeleted.bind(h);i.extensionName===st&&(t.cloudName=i.cloudName);r=i.assetId;o=i.assetType;o===a.resourceAssetType?(s=t.cloudName,l=void 0,l=tt(r)?b.Subscriptions:it(r)?b.ResourceGroups:c.buildResourceTypeFromResourceId(r),l&&u.mapResourceIdToAssetId(r,s).then((function(n){e({cloudName:s,name:n.extensionName},n.assetType,n.assetId,i.reason)})).catch((function(n){var t=n&&n.message||"";t.
indexOf(f.failedToFindAssetTypePrefix)!==0&&v.warning(n)}))):e(t,o,r,i.reason)};e&&(a.notifyAssetDeletedDefinition.register(e,null,(function(n,t){var u=i.makeArray(n),r=t.srcWindowId,f=l.getDescriptor(r);u.forEach((function(n){s(r,f,n)}))})),a.hubsNotifyAssetDeletedDefinition.register(e,[this._hubsWindowId],(function(n,t){var r=i.makeArray(n),u=t.srcWindowId;r.forEach((function(n){s(u,{cloudName:n.cloudName,name:n.extensionName},n)}))})));this._notifyDeletedResources()}return n.prototype.onAssetDeleted=function(n){this._assetDeletedCallbacks.add(n)},n.prototype.markAssetDeleted=function(n,t,i,r){this.handleAssetDeleted(n,t,i,r)},n.prototype.getDiagnosticsData=function(){return{mruList:this.assetMruList.mruList.peek()}},n.prototype.handleAssetDeleted=function(n,t,i,r){this._assetDeletedCallbacks.fire(n,t,i,r)},r.defineProperty(n.prototype,"assetMruList",{get:function(){var n=this._assetMruList;if(!n){n=this._assetMruList=this._createMruList();this.onAssetDeleted((function(t,i,r){return n.removeAssetEntry(
t,i,r)}))}return n},enumerable:!0,configurable:!0}),n.prototype._createMruList=function(){return new p(this._portalIdentity,this._settingsService,this._assetTypeService)},n.prototype._notifyDeletedResources=function(){var t=this,n={},i=[];this.assetMruList.mruList.peek().filter((function(n){return!ft(n.assetId)})).forEach((function(r){var f=r.assetType,e=r.extension,o=r.cloudName,u=((o||"")+":"+e+f).toLowerCase(),s;n[u]||(s=t._assetTypeService.getAssetTypePromise(e,f,o).then((function(n){return{assetType:n,mapKey:u}})),i.push(s),n[u]=[]);n[u].push(r)}));Q.allSettled(i).then((function(i){i.forEach((function(i){var r,u;i.state===g&&(r=i.value,r&&(u=r.assetType&&r.assetType.assetTypeManifest.resourceType,u&&!u.mappingViewModel&&n[r.mapKey].forEach((function(n){v.debug("Removing "+nt+": "+JSON.stringify(n));t._assetMruList.removeEntry({name:n.extension,cloudName:n.cloudName},n.assetType,n.assetId)}))))}))}))},n})();t.AssetManagerImpl=y;p=(function(){function n(n,t,r,u){var f=this;this._list=new h.LruMap(
k);this._observableList=null;this._settingsService=t;this._assetTypeService=r;this._logDelay=i.isNullOrUndefined(u)?ct:u;this._debouncer=new h.Debouncer(pt,function(n){return f._logAssetAccess(n)},this._logDelay);this.initialSettingsSyncPromise=this._startSyncSettingsFromCloud().then((function(){f.updateObservableList()}))}return n.prototype.logAssetAccess=function(n,t,i,r){var u={cloudName:n.cloudName,extension:n.name,assetType:t,assetId:i,assetName:r,timeStamp:Date.now()};return this._logDelay?(this._debouncer.execute([u]),Q(!0)):this._logAssetAccess([u])},r.defineProperty(n.prototype,"mruList",{get:function(){var n=this._observableList;return n||(n=this._observableList=at(),this.updateObservableList()),n},enumerable:!0,configurable:!0}),n.prototype.removeAssetEntry=function(n,t,i){var f=this,r,u=rt(i);return r=u?Q(u):Q(this._assetTypeService.mapAssetIdToResourceId({extensionName:n.name,assetType:t,assetId:i},n.cloudName).then((function(n){return ut(n),n}),(function(){return null}))),r.then(
(function(r){f.removeEntry(n,t,r||i)}))},n.prototype.clear=function(){this._list.getList().forEach((function(n){n.removedTimeStamp=Date.now()}));this.updateObservableList();this._startSyncSettingsFromCloud()},n.prototype.removeEntry=function(n,t,i){var u=e.getMruItemKey(n,t,i),r=this._list.get(u);r&&(r.removedTimeStamp=Date.now(),this.updateObservableList(),this._startSyncSettingsFromCloud())},n.prototype.onCloudSyncFinished=function(n){this._cloudSyncCompletedCallback=n},n.prototype._logAssetAccess=function(n){var t=this,i=[];return n.forEach((function(n){var r=rt(n.assetId);r?i.push(Q({resourceId:r,entry:n})):i.push(Q(t._assetTypeService.mapAssetIdToResourceId({extensionName:n.extension,assetType:n.assetType,assetId:n.assetId},n.cloudName).then((function(t){return ut(t),{resourceId:t,entry:n}}),(function(){return{resourceId:null,entry:n}}))))})),Q.allSettled(i).then((function(n){var i=!1;n.forEach((function(n){var o,s,p,u;if(n.state===g){var h=n.value,f=h.resourceId,r=h.entry,c=r.assetId,l=r.cloudName,
a=r.extension,y=r.assetType;if(!f&&!ft(c)&&(o=t._assetTypeService.getAssetType(a,y,l),s=o&&o.assetTypeManifest.resourceType,s&&!s.mappingViewModel)){v.warning("Not adding "+nt+": "+JSON.stringify(r));return}i=!0;p=e.getMruItemKey({cloudName:l,name:a},y,f||c);u=t._list.getOrAdd(p,(function(){return r}));u.resourceId=f;u===r||u.removedTimeStamp&&Date.now()-u.removedTimeStamp<lt||(u.removedTimeStamp=undefined,u.assetName=r.assetName,u.timeStamp=r.timeStamp)}}));i&&(t.updateObservableList(),t._startSyncSettingsFromCloud())}))},n.prototype.updateObservableList=function(){var i=this,n=this._observableList,t;n&&(t=this._list.getList().filter((function(n){if(n.removedTimeStamp)return!1;var t=i._assetTypeService.getAssetType(n.extension,n.assetType,n.cloudName,0);return!(t&&t.assetTypeManifest.browseType===ot.ResourceType&&!n.resourceId&&typeof n.assetId!="string")})),n.splice.apply(n,[0,n().length].concat(t)))},n.prototype._startSyncSettingsFromCloud=function(){var n=this,u=function(){n._settingsService.
setSetting(0,d,n._list.getList());var t=n._cloudSyncCompletedCallback;t&&t()},t,r=this._querySettingsCalledDeferred;return r?t=r.promise():(this._querySettingsCalledDeferred=i.Helpers.Deferred(),t=this._settingsService.querySetting(0,d).then((function(t){var i=new h.LruMap(k);wt(t,i)&&(n._list=i);return}))),Q(t).then((function(){u();n._querySettingsCalledDeferred.resolve();return}))},n})();t.AssetMruListImpl=p})(h||(h={})),h}));define("MsPortalImpl/Services/Services.Permissions",["require","exports","f","FxHubs/Permissions"],(function(n,t,i,r){"use strict";var u;return (function(t){function w(n,t){return new l(n,t)}function b(n,t,i){return s.hasPermissionsToHubs.invoke(u.client,f,{entityId:n,requestedActions:t,providedActions:null,cloudName:i})}function k(n,t){return s.getPermissionsToHubs.invoke(u.client,f,{entityId:n,cloudName:t})}function d(n){return s.isCoAdminEndpoint.invoke(u.client,f,{cloudName:n})}var a=FxImpl,e=a.Extension,o=i.Base,v=o.Diagnostics,u=o.Rpc.Internal,y=i.ViewModels.Services.
ResourceTypes,h=r.PermissionChecker,s=r.Rpc,p=window,g=!!p.fx.environment.isDevelopmentMode,f=e.getHubsWindowId(),c=v.createLog(n),l;t.Internal={};t.createPermissionsManager=w;l=(function(){function n(n,t){var s=this,i;this._extensionManager=n;this._assetTypeService=t;i=r.createCachedPermissionsGetter(k);this._cachedPermissionsGetter=i;this._getPermissionsCallback=i.getPermissions.bind(i);e.hasPermissionsToShell.register(u.client,null,(function(n,t){var i=t.srcWindowId;return i!==f&&i!==o.Constants.Shell&&(n.cloudName&&c.warning("{0} should not pass cloud name".format(i)),n.cloudName=e.getDescriptor(t.srcWindowId).cloudName),s.hasPermission(n.entityId,n.requestedActions,n.cloudName)}))}return n.prototype.isCoAdmin=function(n){return d(n)},n.prototype.hasPermission=function(n,i,r){return t.Internal.hasPermissionOverride?t.Internal.hasPermissionOverride(n,i):h.isRDFEAction(i)?b(n,i,r):y.isResourceManagerId(n,!0)?h.hasPermission(n,i,null,r,this._getPermissionsCallback):(c.error("The entity ID for hasPermission must be a resource ID, a subscription ID or a resource group ID, failing open"),
Q(!0))},n.prototype.getCachedPermissions=function(n){return this._cachedPermissionsGetter.getCachedPermissions(n)},n})()})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/UI.BrowseManager",["require","exports","f","i","u","FxHubs/RpcEndPoints","../../Services/Services.AssetTypes","../../Services/Services.AssetTypes.Utils"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function et(n,t){var i=n.toLocaleLowerCase(),r=t.toLocaleLowerCase();return i===r?0:i<r?-1:1}function ii(n){ut||(ut=n.assetManager.assetMruList.mruList.subscribe((function(){var t=l.pingMruAssetsListEndPoint;n.extensionManager.getHubsExtension().then((function(){t.invoke(p.client,y,tt).catch((function(n){if(!p.errorIsRpcTimeout(n,t.getName(),y))throw n;}))}))})))}function ri(n){if(!ft){ft=!0;var t=n.rpcClient,f=n.assetManager,i=n.assetTypeService,r=[kt],u=f.assetMruList;l.clearMruAssetsListEndPoint.register(t,r,(function(){return u.clear(),Q(!0)}));l.removeMruAssetEndPoint.register(t,r,(function(n){return u.removeAssetEntry(
{cloudName:n.cloudName,name:n.extension},n.assetType,n.assetId).then((function(){return!0}))}));l.getMruAssetsListEndPoint.register(t,r,(function(){var t=u.mruList().slice(0),n=[];return t.forEach((function(t){var r=t.cloudName,u=t.extension,f=t.assetType,s,e,h;(u===ht&&f===st||i.hasAssetType(u,f,r,1))&&(s=t.resourceId||t.assetId,e=i.getAssetType(u,f,r),e?(h={key:o.getMruItemKey({cloudName:r,name:u},f,s),isResourceTypeBrowse:e.assetTypeManifest.browseType===d,id:s,isPreview:e.isPreview,name:t.assetName,resourceTypeAssetTypeInformation:i.mapAssetTypeToResourceTypeAssetTypeInformation(e),timeStamp:t.timeStamp,cloudName:r},n.push(h)):a.warning("Could not find the asset type for the MRU entry. AssetTypeId : <"+r+":"+u+":"+f+"> : ID: <"+JSON.stringify(s)+">"))})),n}))}}function ui(n,t,i,r){return new ot(n,t,i,r)}var h=i.Base,s=h.Constants,st=s.AssetNames.SubscriptionDetail,y=s.ExtensionNames.Hubs,ht=s.ExtensionNames.Billing,ct=s.ResourceTypes.ResourceGroups,lt=h.Diagnostics,p=h.Rpc.Internal,at=h.Utilities,
vt=i.Extension,c=vt.BrowseType,w=i.ViewModels.Services,yt=w.Browse,pt=w.GridColumns,l=f.Mru,v=r.Extension,b=i.getUniqueId,wt=window.fx.environment,a=lt.createLog(n),bt=ct.toLowerCase(),kt=v.getHubsWindowId(),e=a.verbose.bind(a),k=i.forEachKey,dt=c.InstanceLink,d=c.ResourceType,g=c.ServiceLink,nt=c.ServiceViewModel,gt=ko.observableArray,tt=u,it="The asset type does not have a ",rt=" service view model was already disposed.",ni=i.isFeatureEnabled("supportthirdpartyresources"),ut=null,ft=!1,ti=r.getErrorMap({badCriteria:""}),ot;t.compareAssetTypeForSort=et;t.subscribeToMruItems=ii;t.registerRpcEndpoints=ri;t.createBrowseManager=ui;ot=(function(){function n(n,t,i,r){var f=this,u;this._browsePackages={};this._registeredResourceProviders=gt(["*"]);this._haveRdfeAccess=!1;this._callbacks={};this._isCoAdmin=!1;this._extensionManager=n;this._assetTypeService=t;this._permissionsService=i;u=this._executeCallbacks.bind(this);this._registeredResourceProviders.subscribe(u);this._haveRdfeAccess=r();r.
subscribe((function(n){f._haveRdfeAccess=n;u()}));n.on("assetTypes").then((function(){u();t.assetTypes.subscribe(u)}))}return n.prototype._executeCallbacks=function(){var n=this._callbacks;n&&k(n,(function(n,t){t()}))},n.prototype._assetTypeSupportsCriteria=function(n,t){return n.extension===t.assetOwner&&n.assetTypeManifest.name===t.assetType&&v.isEqualCloudName(n.cloudName,t.cloudName)},n.prototype._releaseViewModel=function(n,t){at.disposeViewModelProperties(t);n.releaseViewModel(t)},n.prototype._assetTypeMeetsRequirements=function(n){var r,c,l,u,f,e,o,s,h,a;if(!n)return!1;var t=n.browseType,v=n.browseRequirements&1,y=!v||this._isCoAdmin;if(t===tt||!y)return!1;r=this._haveRdfeAccess;c=!n.browseRequiresRdfe||r;switch(t){case g:case dt:if(l=n.browseLinkUri||"",u=function(n){return n+="Portal",l.indexOf("{"+n+"}")>=0&&(i.getFeatureValue(n)==="false"||!wt.links[n])},u("classic")||u("account"))return!1;case nt:case d:if(!c)return!1}return(f=n.resourceType,!f)?!0:(e=f.resourceTypeName,o=e.toLowerCase(
),o===bt)?!0:!ni&&!r&&!o.startsWith("microsoft.")?!1:(s=e.split("/"),s.length<2)?!1:t===g?!0:(h=this._registeredResourceProviders,h().some((function(n){return n.toLowerCase()==="*"})))?!0:(a=s[0].toLowerCase(),h().some((function(n){return n.toLowerCase()===a})))},n.prototype.dispose=function(){k(this._browsePackages,(function(n,t){t.cancel();t.dispose()}));this._browsePackages=null},n.prototype.initialize=function(){this._extensionManager.getHubsExtension()},n.prototype.registerAssetTypesUpdateCallback=function(n){var t=b();return this._callbacks[t]=n,t},n.prototype.unregisterAssetTypesUpdateCallback=function(n){var t=this._callbacks;t[n]&&delete t[n]},n.prototype.addRegisteredResourceProvider=function(n){this._registeredResourceProviders.push(n)},n.prototype.initiateBrowse=function(n){var t=this,r;return n||ti.badCriteria(),r=new yt.ResultsViewModel(n,[]),i.require("MsPortalImpl/UI/Hubs/UI.BrowseManagerDelayed").then((function(i){var s="All browse operations returned.",h="browse-"+b(),u=new i.
BrowsePackage(r,t),y=u.lifetimeManager;t._browsePackages[h]=u;var f=0,o=0,c=!1,l=[];return t._assetTypeService.assetTypes().forEach((function(i){var p,h,b;if(!u.canceled&&t._assetTypeSupportsCriteria(i,n)&&(p=i.assetTypeManifest,p.browseType===nt)){var r=function(){++o;c&&o===f&&(e(s),u.allOperationsReturned())},w=p.browseServiceViewModel,k=v.getWindowId({name:i.extension,cloudName:i.cloudName})+"."+p.name+"."+w;e("Browse provider "+k+" using optimized browse.");h="browse operation from "+k+" browse provider";b="Failed to get ";l.push(t._extensionManager.getExtensionByName(i.extension,i.cloudName).then((function(f){return Q(f.getViewModel(w)).then((function(o){var s=o.content,c,a,l;s?(c=!1,y.registerForDispose((function(){c=!0;t._releaseViewModel(f,o)})),c?(e("The "+h+" was already disposed."),r()):(a=function(n,t){u.canceled||(e("Got "+h+"."),u.addOperation(i,n,t));r()},l=void 0,typeof s.onInputsSet=="function"&&(l=s.onInputsSet({criteria:n})),Q(l||!0).then((function(){a(k,s)})).catch((function(
n){e("The "+h+" rejected the load promise: "+n);r()})))):(e(b+"the "+h+"."),r())})).catch((function(n){e(b+"browse operation "+w+": "+n+".");r()}))})).catch((function(n){a.error(b+"extension for browse operation "+w+": "+n);r()})));e("Getting "+h+".");++f}})),c=!0,o===f&&(e(s),u.allOperationsReturned()),Q.all(l).then((function(){return h}))}))},n.prototype.getViewModelForBrowse=function(n){var t=this._browsePackages;return n in t?t[n].viewModel:null},n.prototype.releaseBrowse=function(n){var t=this._browsePackages,i;n in t&&(i=t[n],i.cancel(),i.dispose(),delete t[n])},n.prototype.getFilteredAssetTypes=function(){var n=this,t,r;return this._isCoAdminPromise||(this._isCoAdminPromise=Q(this._permissionsService.isCoAdmin(s.DefaultCloudName)).then((function(t){n._isCoAdmin!==t&&(n._isCoAdmin=t,n._executeCallbacks())}))),t=[],r=[],this._assetTypeService.assetTypes().forEach((function(i){var r=i.assetTypeManifest;n._assetTypeMeetsRequirements(r)&&(r.privateBrowse||t.push(i))})),t.length&&i.stableSort(t,(function(
n,t){return et(n.compositeDisplayName.service,t.compositeDisplayName.service)})).forEach((function(n){r.push(n)})),r},n.prototype.getGridColumnsPromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.gridColumnsServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then((function(n){return Q(n.getViewModel(i)).then((function(i){var e=!1,u,f;return(t.registerForDispose((function(){e=!0;r._releaseViewModel(n,i)})),!e)?(u=i.content,f=void 0,typeof u.onInputsSet=="function"&&(f=u.onInputsSet({usage:pt.Usage.Default})),f)?f.then((function(){return u})):u:Q.reject("The grid columns"+rt)}))})):Q.reject(it+"have a grid columns service view model.")},n.prototype.getDynamicBladePromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.dynamicBladeServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then((function(n){return Q(n.getViewModel(i)).then((function(i){var u=!1;return(t.registerForDispose((function(
){u=!0;r._releaseViewModel(n,i)})),!u)?i.content:Q.reject("The dynamic blade"+rt)}))})):Q.reject(it+"have a dynamic blade service view model.")},n})()})(s||(s={})),s}));define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","f","i","MsPortalImpl.Controls/Controls/Balloon","../../Interactions/Interactions.DismissHandler","./UI.Commands","../Compositions/UI.Composition","../../Widgets/Widgets.ContextMenu"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){function k(n){return new c(n)}function a(n){var r,u,i;if((b?n.metaKey:n.ctrlKey)||(r=p.getSelection(),r.rangeCount&&!r.getRangeAt(0).collapsed)||(u=t(n.target),u.filter("input,textarea").length))return!0;n.preventDefault();n.stopPropagation();i=t.Event(h.fxcontextmenurequest);i.pageX=n.pageX;i.pageY=n.pageY;i.clientX=n.clientX;i.clientY=n.clientY;u.trigger(i)}var v=r.TriggerableLifetimeManager,h=i.Base.EventTypes,l=i.ViewModels.Controls.Balloon,y=l.ViewModel,p=window,t=jQuery,w="<div class='fxs-commands-contextMenu'><\/div>",
b=navigator.platform.indexOf("Mac")!==-1,c;n.createCommandManager=k;n.onContextMenu=a;c=(function(){function n(n){var r=this,u;this._lifetimeManager=new v;this._body=t("body");this._desktop=n;this._initializeContextMenu();this._handleDesktopModeChange();u=function(n){var i=r._balloonContentElement;return!(i===n)&&!t.contains(i,n)};this._dismissHandle={dismissFn:function(){i.require("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox").then((function(n){n.cancelMessageBox(t(r.getForm()));r.hideForm()}))},shouldDismissOnMouseDownFn:u,shouldDismissOnMouseWheelFn:u,restoreFocus:function(){f.validatePreviousFocusedElement(r._dismissHandle,r._previouslyFocusedElement)&&r._previouslyFocusedElement.focus()},logName:"commandmanager"}}return n.prototype.dispose=function(){this.stopListeningForEvents();f.unregister(this._dismissHandle);this._lifetimeManager.dispose()},n.prototype.startListeningForEvents=function(){var u=this,n=this._body;n.on(h.fxcontextmenu,this._fxMenuEventHandler=function(n,t){u._showContextMenu(
n,t)}).on(h.contextmenu,this._browserMenuEventHandler=function(n){a(n)});var t=this._contextMenuElement,i=this._desktop.portalWidget,r=i&&i.element;return r?r.append(t):n.append(t),this},n.prototype.stopListeningForEvents=function(){var n=this._body;this._fxMenuEventHandler&&(n.off(h.fxcontextmenu,this._fxMenuEventHandler),this._fxMenuEventHandler=null);this._browserMenuEventHandler&&(n.off(h.contextmenu,this._browserMenuEventHandler),this._browserMenuEventHandler=null);this._contextMenu.hide();this._contextMenuElement.detach()},n.prototype.getForm=function(){if(!this._balloonContentElement){var n=t("<div/>"),i=this._balloonViewModel=new y(this._lifetimeManager);i.position(l.Position.Top);i.content("<div><\/div>");t("body").append(n);new u.Widget(n,i);n.addClass("fxs-dialogballoon");this._balloonContentElement=n.findByClassName("azc-balloon-content").children()[0].children[0]}return this._balloonContentElement},n.prototype.showForm=function(n){var r=this;this._previouslyFocusedElement=
document.activeElement;this._balloonViewModel.box(n);this._balloonViewModel.visible(!0);i.require("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox").then((function(n){setTimeout((function(){n.setFocusOnMessageBox(t(r.getForm()))}),125)}));f.register(this._dismissHandle)},n.prototype.hideForm=function(){this._balloonViewModel&&(this._balloonViewModel.visible(!1),t(this._balloonContentElement).empty());f.unregister(this._dismissHandle)},n.prototype._initializeContextMenu=function(){this._contextMenuElement=t(w);this._contextMenu=new s.Widget(this._contextMenuElement);this._contextMenu.hide()},n.prototype._showContextMenu=function(n,i){var v=this,s=i.contextMenu?i.contextMenu:this._contextMenu,l=s.options.menuItems,r,u,a,h=n.clientX,c=n.clientY,f;if(i.commands&&i.commands.length!==0){a=i.formTarget&&i.formTarget.length>0?e.getBladeContentWidget(i.formTarget):this;s.hide();l.splice(0,l().length);do u=u?u.parentNode:n.target,r=t(u).data(o.CompositionInstanceDataName);while(!r&&u.parentNode);(o.
isContextMenuContainer(r)&&r.beforeActivateCommandMenuItems(i),i.commands.forEach((function(t){v._shouldShowCommand(t)&&(t.activate(),t.bind(new e.CompositionInstanceCommandContext(n.target,a,r)),l.push(t))})),s.options.hasVisibleCommands())&&(h||c||(f=n.target.getClientRects()[0],h=f&&f.left||h,c=f&&f.bottom||c),s.show(h,c,i&&i.forceLeft))}},n.prototype._handleDesktopModeChange=function(){var n=this;this._desktop.mode.subscribe(this._lifetimeManager,(function(t){t===1&&n.hideForm()}))},n.prototype._shouldShowCommand=function(n){return this._desktop.mode()!==1||!this._isExtensionCommand(n)},n.prototype._isExtensionCommand=function(n){return!!n._extension},n})();n.PortalCommandManager=c})(h||(h={})),h}));define("MsPortalImpl/UI/UI.ContextPane",["require","exports","f","o","../Interactions/Interactions.DismissHandler"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function o(n,i,r){return new t(n,i,r)}var e=i.Base,f=e.EventTypes,t;n.create=o;t=(function(){function n(n,t,i){var s=this,
r,e,o;this._widget=n;r=this._viewModel=n.options;this._themeManager=i;this.collapsed=r.collapsed;e=function(n){n.stopPropagation();s.close()};n.element.on(f.fxcontextpaneclosing,e);o={dismissFn:function(){s.close()},shouldDismissOnMouseDownFn:$.noop,shouldDismissOnMouseWheelFn:$.noop,logName:"contextPane"};ko.reactor(t,(function(){r.opened()?u.register(o):u.unregister(o)}));t.registerForDispose((function(){n.element.off(f.fxcontextpaneclosing,e)}))}return r.defineProperty(n.prototype,"opened",{get:function(){return this._viewModel.opened},enumerable:!0,configurable:!0}),n.prototype.hasContent=function(n){return this._contentProvider===n},n.prototype.getContent=function(){return this._contentProvider},n.prototype.tryOpen=function(n){var r=this,t,i;return this._contentProvider===n?(this._widget.setFocus(),Q(!0)):(t=this._tryRemoveContent(),t)?(this._contentProvider=n,this._previouslyFocusedElement=document.activeElement,i=this._viewModel,i.opened(!0),i.loading(!0),this._themeManager.loadBladesCSS(
).finally((function(){return n.onAddingContent(r._widget)})).finally((function(){i.loading(!1)})).then((function(){return r._widget.setFocus(),t}))):Q(t)},n.prototype.close=function(n){var t=!0,i;return n?this._clearContent():t=this._tryRemoveContent(),t&&(i=this._viewModel,i.opened(!1),i.loading(!1),this._restoreFocus()),t},n.prototype._clearContent=function(){var n=this._contentProvider;n&&n.onRemovingContent(this._widget);this._contentProvider=null},n.prototype._tryRemoveContent=function(){var n=this._contentProvider,t;return n?(t=!n.canRemoveContent||n.canRemoveContent(),t&&this._clearContent(),t):!0},n.prototype._restoreFocus=function(){var n=this._previouslyFocusedElement;n&&n.focus()},n})();n.ContextPaneImpl=t})(f||(f={})),f}));define("MsPortalImpl/UI/Compositions/UI.Composition.JourneySettingSerializer",["require","exports","o","../../Base/Base.HierarchyMap"],(function(n,t,i,r){"use strict";var u;return (function(n){function i(n){if(n instanceof r.SerializableHierarchyMap)return n;var i=new
t;return new r.SerializableHierarchyMap(i,n)}var t=(function(){function n(){}return n.prototype.toJSON=function(n){var t={type:n.type};return n.editScope&&(t.editScope={editScopeId:n.editScope.editScopeId,dirty:!!n.editScope.dirty,saving:!!n.editScope.saving,disposeOnSelectionChange:n.editScope.disposeOnSelectionChange,disposeOnJourneyDiscard:!!n.editScope.disposeOnJourneyDiscard}),JSON.stringify(t)},n.prototype.fromJSON=function(n){var t=JSON.parse(n),i=t.editScope&&{editScopeId:t.editScope.editScopeId,dirty:t.editScope.dirty,saving:!!t.editScope.saving,disposeOnSelectionChange:t.editScope.disposeOnSelectionChange,disposeOnJourneyDiscard:t.editScope.disposeOnJourneyDiscard};return{editScope:i,type:t.type}},n})();n.JourneySettingSerializer=t;n.deserializeAmbientSettings=i})(u||(u={})),u}));define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports","f","o"],(function(n,t,i,r){"use strict";var u;return (function(n){var t={pending:"pending"},u=(function(){function n(
n,t){this.deferred=i.Helpers.Deferred();this.targetId=n;this.isSource=t}return n})(),f=(function(){function n(n){this._awaitableCompositions=[];this.resolvedCompositions=[];this._trackResolvedCompositions=n}return n.prototype.await=function(n,i){var f=this,r=new u(n&&n.toString(),i),e=this.resolvedCompositions.firstIndex((function(n){return i(n)}));if(e>=0)r.deferred.resolve(this.resolvedCompositions[e]);else if(this._awaitableCompositions.push(r),n)n.onDispose((function(){var n;r.deferred.state()===t.pending&&(r.deferred.reject(),n=f._awaitableCompositions.indexOf(r),n>=0&&f._awaitableCompositions.splice(n,1))}));return r.deferred.promise()},n.prototype.resolve=function(n){var r=this,t,i;if(this._trackResolvedCompositions){this.resolvedCompositions.push(n);n.onDispose((function(){var t=r.resolvedCompositions.indexOf(n);t>=0&&r.resolvedCompositions.splice(t,1)}))}for(t=this._awaitableCompositions.length-1;t>=0;t--)i=this._awaitableCompositions[t],i.isSource(n)&&(i.deferred.resolve(n),this._awaitableCompositions.
splice(t,1))},r.defineProperty(n.prototype,"waitingCompositions",{get:function(){return this._awaitableCompositions.map((function(n){return n.targetId}))},enumerable:!0,configurable:!0}),n})();n.CompositionAwaiter=f})(u||(u={})),u}));define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.Settings.Schema","../../Generated/SvgStartupDefinitions","../../Base/Telemetry","../Commands/UI.Commands","./UI.Composition","./UI.Composition.Base","./UI.Composition.CompositionAwaiter","./UI.Composition.PartSettingsManager","./UI.Composition.PropertyBinding","./UI.Composition.StartboardPart","../Commands/UI.ShellCommands","../../Widgets/Widgets.StartBoard","../../Widgets/Widgets.UIElementBase"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";var k;return (function(t){function rt(n){return n!==f.desktopSettingsKey&&n!==f.startBoardSettingsKey&&!i.startsWith(n,a.partIdentityStatePrefix)}function lt(
n){var t=new g(n);return t.save(),t}var k=i.Base,nt=k.Diagnostics,ut=nt.Telemetry,tt=k.EventTypes,ft=k.Utilities,et=i.Extension,d=et.ReferenceType,ot=i.Parts.PartSize,st=h.CompositionType,ht=v.ReferenceScope,it=nt.createLog(n),ct=h.getIdMatchFunc,g;t.startboardName="Startboard";t.fxstartboardsettingchanged="fxstartboardsettingchanged";t.isStartboardPartKey=rt;g=(function(n){function c(i,r,u){n.call(this,i,null,r,u,f.startBoardSettingsKey);this._partAwaiter=new l.CompositionAwaiter(!0);this._containerAwaiter=new l.CompositionAwaiter;this.masterContainer=null;this.detailContainers=[];this.notFound=ko.observable(!1);this._name=t.startboardName;this._store=4}return __extends(c,n),c.prototype.getCompositionType=function(){return st.Startboard},c.prototype.setGetDashboard=function(n){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=n},c.prototype.removeGetDashboard=function(){this._getDashboard=null},c.prototype.getDashboard=function(
){var n=this._getDashboard;return n?n():null},c.prototype.onDetailContainersChanged=function(){},c.prototype.getDeepLink=function(){return Q("")},c.fromJSON=function(n,t,i){return h.createCompositionFromJSON(i,(function(){return c._fromJSON(n,t,i)}),(function(t,i){var r=new c(n);return r.unrecoverableErrorMessage=i,r}))},c.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this),i=this._getDashboard?this._getDashboard():null,r;return i&&(t.dashboardId=i.id,t.dashboardTitle=i.title,r=i.model,t.dashboardModel=r?{model:ko.toJS(r.model),metadata:ft.clone(r.metadata,!0)}:undefined),delete t.children,t},r.defineProperty(c.prototype,"eligibleForBinding",{get:function(){return!1},enumerable:!0,configurable:!0}),c.prototype.getInputPropertyBindings=function(){throw new Error("Unreachable code");},c.prototype.getViewModel=function(n){var r,t;if(n=i.isNullOrUndefined(n)?d.Dashboard:n,n===d.Dashboard){if(t=this._getDashboard&&this._getDashboard().model,!t)throw new Error("There is no current Dashboard.");
r=t.model}return r||{}},c.prototype.getViewModelAsync=function(n){return $.Deferred().resolve(this.getViewModel(n)).promise()},c.prototype.getCompatibleSourceReferences=function(n){var u=this._getDashboard&&this._getDashboard().model,t=u&&u.metadata,i,f;return t&&(i=n.type,i)?(f=r.keys(t).filter((function(n){var r=t[n];return r===i})),f.map((function(n){return{property:n,modelType:d.Dashboard,scope:ht.CurrentContainer,cardinality:v.ReferenceCardinality.OneToOne}}))):null},c.prototype.logChildren=function(){this.children.forEach((function(n){var t=n&&n.widgetState(),i=t&&t.NormalState?ot[t.NormalState.size]:"";ut.trace({extension:n.locator.getExtensionLocator().name,source:o.Source.StartBoardPart,action:o.Action.StartBoardPartLoaded,name:n.locator.toFriendlyString(),data:i})}))},c._fromJSON=function(n,t,i){var f=r.keys(t).map((function(i){return rt(i)?y.Instance.fromJSON(n,t[i]):null})).filter((function(n){return!!n})),u=new c(n,f,i.widgetState);return u.logChildren(),u.loadFromJson(i),u},c.prototype.
_compose=function(n,r){var o=this,u=new w.ViewModel(this.id,this.widgetState()),f=this.services,e,c;ko.utils.arrayPushAll(u.commands,this._getShellCommands());var a=u.addPartsCommand=i.find(u.commands,(function(n){return n.commandName===p.CommandNames.AddParts})),v=u.newCommand=new p.NewDashboard(f),y=u.cloneCommand=new p.CloneDashboard(f),k=u.filterCommand=new p.FilterDashboard(f,this),d=u.fullscreenCommand=new p.FullscreenDashboard(f),g=u.deleteCommand=new p.DeleteDashboard(f),nt=u.shareCommand=new p.ShareDashboard(f),rt=u.browseCommand=new p.OpenBrowseDashboardsPane(f),l=this._getDashboard?this._getDashboard().title:null;l&&u.title(l);this.widget=new w.Widget(n.getStartBoardArea(),u);e=this.widget.element;c=function(n,t){n.bind(new s.CompositionInstanceCommandContext(e.findByClassName(t)[0],null,o))};c(a,w.widgetClass+"-title");[[v,"new"],[y,"clone"],[k,"filter"],[d,"fullscreen"],[g,"delete"],[nt,"share"],[rt,"browse"],].forEach((function(n){var t=n[0],i=n[1];c(t,w.headerButtonClass+"-"+
i)}));e.data(h.CompositionInstanceDataName,this);e.on(b.Widget.viewSettingsChanged,this._viewSettingsUpdateHandler=function(n,i){n.stopPropagation();o.widgetState(i);e.trigger(t.fxstartboardsettingchanged)});e.on(tt.fxunpin,this._tileUnpinHandler=function(n,t){var i=o.children.first(ct(t.tileId));i&&(it.warning("Part '{0}' is about to be removed due to user unpin operation.".format(i)),o.services.desktop.removeTile(i.id));setTimeout((function(){var n=o.widget;n&&n.setFocus()}),50)});r.resolve()},c.prototype.matchesLocatorAndModel=function(){return!1},c.prototype.resetLayout=function(){this.services.desktop.resetStartBoard()},c.prototype.dispose=function(){var t=this.widget.element;this._viewSettingsUpdateHandler&&t.off(b.Widget.viewSettingsChanged,this._viewSettingsUpdateHandler);this._tileUnpinHandler&&t.off(tt.fxunpin,this._tileUnpinHandler);this._viewSettingsUpdateHandler=null;this._tileUnpinHandler=null;it.warning("UI.Composition.Startboard.dispose() has been called.");n.prototype.dispose.
call(this,!0)},r.defineProperty(c.prototype,"journeyPath",{get:function(){return[]},enumerable:!0,configurable:!0}),c.prototype.getComposedParts=function(){return this._partAwaiter.resolvedCompositions},c.prototype.awaitComposedPart=function(n,t){return this._partAwaiter.await(n,t)},c.prototype.notifyPartComposed=function(n){this._partAwaiter.resolve(n)},c.prototype.awaitContainer=function(n,t){return this._containerAwaiter.await(n,t)},c.prototype.notifyContainer=function(n){this._containerAwaiter.resolve(n)},c.prototype.onInvocationStarted=function(){},c.prototype.getDiagnosticsData=function(){return $.extend(n.prototype.getDiagnosticsData.call(this),{detailBlades:this.detailContainers.map((function(n){return n.toString()}))})},c.prototype._getShellCommands=function(){var n=[],t=new p.AddParts(this.services);return t.text(u.Dashboard.edit),t.icon(e.Content.SvgStartup.customize),n.push(new p.ResetStartBoardCommand(this.services)),n.push(t),n.push(new p.ExitOrganizeMode(this.services)),n}
,c})(c.Instance);t.Instance=g;t.create=lt})(k||(k={})),k}));define("MsPortalImpl/UI/Dashboard/DashboardRepository",["require","exports"],(function(){"use strict";var n;return (function(n){n.ArmDashboardRepository="ArmDashboardRepository";n.PrivateDashboardRepository="PrivateDashboardRepository";n.RecommendedDashboardRepository="RecommendedDashboardRepository";n.SessionDashboardRepository="SessionDashboardRepository"})(n||(n={})),n}));define("MsPortalImpl/UI/Dashboard/ArmDashboardRepository",["require","exports","f","o","./DashboardRepository","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function c(n){try{return tt.parseResourceDescriptor(n)}catch(t){return l.error(t,0,"Failed to parse ARM dashboard id '"+n+"'."),null}}function y(n){var e=n.tags&&n.tags[a]||n.name,t=n.properties,u=t&&t.metadata,o=u&&u.model||{},i=t&&t.lenses,f=i&&i["0"]&&i["0"].parts||{};return{title:e,model:o,parts:r.keys(f).map((function(n){return f[n]}))}}function e(
n){var t=n.substr(h.length);return i.ensurePrefix(t,"/")}function p(n){return n.startsWith("/")&&(n=n.substr(1)),""+h+n}function w(n){return i.startsWith(n,h)}function rt(n,t){return t.length?n.filter((function(n){if(!w(n.id))return!0;var r=e(n.id),i=c(r);return i?t.indexOf(i.subscription)>-1:!1})):n}function k(n,t){var i={};return i[a]=n,$.extend({},t||{},i)}var s=i.Base,d=s.Diagnostics,g=s.Promises.cancelOnDispose,nt=s.Utilities,o=s.Constants.DefaultCloudName,tt=i.ViewModels.Services.ResourceTypes,it="Dashboard$DashboardViewModel",l=d.createLog(n),h="arm/",a="hidden-title",v=f.Dashboard.NotFound,b;t.normalizedDashboard=y;t.getArmDashboardId=e;t.buildDashboardId=p;t.filterDashboards=rt;b=(function(){function n(n,t,i,r){var u=this;this._lifetime=n;this._extensionManager=t;this._permissionsManager=i;this._compressor=r;this._isDisposed=!1;n.registerForDispose((function(){u._dispose()}))}return n.prototype.getTypeName=function(){return u.ArmDashboardRepository},n.prototype.createDashboard=function(
n){var t=this;return this._connect().then((function(){var r=t._compressor.compress({id:"",title:"",settings:n.settings}),u={name:i.getUniqueId(),model:r.model,parts:r.parts,subscriptionId:n.extras.subscriptionId,resourceGroupName:n.extras.resourceGroupName,tags:k(n.title)};return t._provider.createDashboard(u,o)})).then((function(n){return t._convertToDashboard(n)}))},n.prototype.readDashboard=function(n){var t=this;return this._connect().then((function(){var i=e(n);return t._provider.readDashboard(i,o)})).then((function(n){return t._convertToDashboard(n)}))},n.prototype.updateDashboard=function(n,t){var i=this,r=e(n);return this._connect().then((function(){return t.title?i._provider.readDashboard(r,o).then((function(n){return n.tags})):Q()})).then((function(n){var u=i._compressor.compress({id:"",title:"",settings:t.settings}),f={model:u.model,parts:u.parts,tags:!t.title?undefined:k(t.title,n)};return i._provider.updateDashboard(r,f,o)})).then((function(n){return i._convertToDashboard(n)}))},n.prototype.
deleteDashboard=function(n){var t=this;return this._connect().then((function(){var i=e(n);return t._provider.deleteDashboard(i,o)}))},n.prototype.readDashboards=function(){var n=this;return this._connect().then((function(){return n._provider.readDashboards(o)})).then((function(t){return t.map((function(t){return n._convertToDashboard(t)}))}))},n.prototype.isDashboardWritable=function(n){return this._permissionsManager.hasPermission(e(n),["Microsoft.Portal/dashboards/write"],o)},n.prototype.identifyDashboard=function(n){return w(n)},n.prototype.getDashboardProperties=function(n){var t=n.id,u=n.title,i=e(t),r=c(i)||{subscription:"",resourceGroup:""};return{id:t,title:u,originalId:i,subscription:r.subscription,resourceGroup:r.resourceGroup}},n.prototype.getNotFoundMessage=function(n){var r=n.id,i=n.title,u=e(r),t=c(u);return t?v.armMessageFormat.format(i,t.resourceGroup,t.subscription):v.defaultMessageFormat.format(i)},n.prototype._dispose=function(){this._isDisposed||(this._isDisposed=!0,this._isConnected=
null,nt.disposeViewModelProperties(this._viewModel),this._extension&&this._viewModel&&this._extension.releaseViewModel(this._viewModel),this._extension=null,this._viewModel=null)},n.prototype._connect=function(){var n=this;return this._isConnected||(this._isConnected=g(this._lifetime,(function(){return n._extensionManager.getHubsExtension().then((function(t){return n._extension=t,Q(t.getViewModel(it))})).then((function(t){n._viewModel=t;n._provider=t.content})).catch((function(t){return n._isConnected=null,l.error(t,0,"Failed to connect ARM dashboard repository to its data provider from hubs extension."),Q.reject(t)}))})))},n.prototype._convertToDashboard=function(n){var t=p(n.id);return this._compressor.uncompress(t,y(n))},n})();t.ArmDashboardRepository=b})(e||(e={})),e}));define("MsPortalImpl/UI/Dashboard/DashboardCompressor",["require","exports","f","o","../../Extension/Extension.Definition.Locator","../Compositions/UI.Composition","../Compositions/UI.Composition.Base","../Compositions/UI.Composition.PropertyBinding",
"../Compositions/UI.Composition.Part","./../Compositions/UI.Composition.StartBoard","../Compositions/UI.Composition.PartSettingsManager","../../Services/Services.Settings.Schema","../../Widgets/Widgets.FlowLayout"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var v;return (function(t){function ot(n,t){var y=t[b],k=y.widgetState,d=k.NormalState.layoutSettings.positions,r=d.first((function(t){return t.id===n})),a,e;if(!r)return p.warning("Cannot compress part '"+n+"', because it does not have position in startboard."),null;var i=t[n],g=i.adapterBindings||i.bindings,h=ko.toJS(tt(i.containerModel)),it=ko.toJS(tt(i.overridesModel)),l=(g||[]).map((function(n){var t=n.source,u=t&&t.property,f=n.targetProperty,e=t&&t.modelType,r,i,c,l;if(s.isDynamicBindingWithNonLocalSource(n))if(e===v.Dashboard)r={name:f,binding:u};else return p.error("For binding for property '{0}', encountered unsupported reference type '{1}'.".format(f,v[e])),null;else i=void 0,c=o.getModelValue(it,u),c.exists?i=nt(c.value):
e===v.Constant?i=t.constantValue:(l=o.getModelValue(h,u),l.exists&&(i=nt(l.value))),r={name:f,value:i};return!n.optional||(r.isOptional=!0),r}));if(l.firstIndex((function(n){return!n}))>=0)return null;a=h[f.PartContainerModelIdProperty];e={};e[f.PartContainerModelIdProperty]=a;var rt=u.Locator.fromJSON(i.locator),ut=c.buildIdentitySettingKey(rt,e),ft=t[ut]||undefined,et=ht(i.locator),ot=lt(i.partState),st=vt(i.assetInstanceDefinition);return{position:{x:r.position.col,y:r.position.row,colSpan:w(r.colSpan),rowSpan:w(r.rowSpan)},metadata:{inputs:l,type:et,settings:ft,isAdapter:i.adapterBindings?!0:undefined,viewState:ot,asset:st,defaultMenuItemId:i.defaultMenuItemId}}}function st(n,t,i,r){var o=n.metadata,a=ct(o.type),g=at(o.viewState),nt=yt(o.asset),p=rt.getDefaultSize().name,tt={NormalState:{size:p}},s={},b;s[f.PartContainerModelIdProperty]=ft(t);var w=u.Locator.fromJSON(a),it=e.createIdentifier(ut.StartboardPart,w,i),h={locator:a,partState:g,assetInstanceDefinition:nt,initialSize:p,widgetState:
tt,id:it,bindingsInitialized:!0,dontSetupWidget:!1,defaultMenuItemId:o.defaultMenuItemId,childSettings:{},children:[],containerModel:y.toSerializableObject(s),overridesModel:undefined,editScopeId:undefined,bindings:undefined,adapterBindings:undefined,errorMessage:undefined,originalPartLocator:undefined},l=[];return o.inputs.forEach((function(n){var r=n.name,t,i=n.binding,u;i?t={property:i,modelType:v.Dashboard,cardinality:k.OneToOne,scope:d.CurrentContainer}:(u=n.value,t={property:r,constantValue:u,modelType:v.Constant,cardinality:k.OneToOne,scope:d.CurrentContainer});l.push({source:t,targetProperty:r,optional:!!n.isOptional,isDynamicBinding:i?!0:undefined})})),o.isAdapter?h.adapterBindings=l:h.bindings=l,o.settings&&(b=c.buildIdentitySettingKey(w,s),r(b,o.settings)),h}function ht(n){var r=encodeURIComponent,e=[],t=n,i,f,o;do i=r(u.LocatorType[t.type]),f=t.cloudName?r(t.cloudName):undefined,f&&(i=i+"["+f+"]"),o=[i,r(t.name)],e.unshift(o.join("/")),t=t.parent;while(t);return e.join("/")}function ct(
n){var i=decodeURIComponent,f=[],r=[],t;return n.split("/").forEach((function(n,t){r.push(n);t%2==1&&(f.push(r),r=[])})),f.forEach((function(n){var s=i(n.pop()),r=n.pop(),e,o=r.match(/\[(.*?)\]/),f;o&&(r=r.substring(0,r.lastIndexOf(o[0])),e=i(o[1]));r=i(r);f={name:s,type:u.LocatorType[r]};e&&(f.cloudName=e);t&&(f.parent=t);t=f})),t}function lt(n){n=y.isSerializedObject(n)?y.fromSerializableObject(n):n;var u=r.keys(n).filter((function(n){return n!=="container"&&n!=="internal"})),t={};return i.shallowCopyFromObject(t,n,u),g(t)?undefined:t}function at(n){return y.toSerializableObject(n||{})}function vt(n){return g(n)?undefined:{idInputName:n.assetIdInputProperty,type:n.assetType}}function yt(n){return n?{assetIdInputProperty:n.idInputName,assetType:n.type}:{}}function pt(n){if(!n)return undefined;var t=n.model,u=n.metadata,i={};return r.keys(t).forEach((function(n){i[n]={value:t[n],type:u[n]}})),i}function wt(n){if(!n)return undefined;var t={},i={};return r.keys(n).forEach((function(r){var u=n[r];
t[r]=u.value;i[r]=u.type})),{model:t,metadata:i}}var y=i.Base.Utilities.Internal.Serialization,it=i.Base.Diagnostics,k=o.ReferenceCardinality,d=o.ReferenceScope,v=i.Extension.ReferenceType,rt=i.Parts.PartSizeHelper,ut=f.CompositionType,g=i.isEmpty,nt=ko.unwrap,p=it.createLog(n),ft=ko.observable,w=function(n){return Math.min(Math.max(n,1),25)},tt=s.createContainerModel,b=l.startBoardSettingsKey,et=(function(){function n(){}return n.prototype.compress=function(n){var t=n.settings,i=n.title,u=t[b],f=pt(u.dashboardModel),e=r.keys(t).filter((function(n){return h.isStartboardPartKey(n)})).map((function(n){return ot(n,t)})).filter((function(n){return!!n}));return{title:i,model:f,parts:e}},n.prototype.uncompress=function(n,t,r,u){var f={},e=[],h;t.parts.forEach((function(n,t){var c=r?r(t):i.getUniqueId(),l=u?u(t):undefined,s=st(n,c,l,(function(n,t){f[n]=t})),o,h;f[s.id]=s;o=n.position;h={id:s.id,colSpan:w(o.colSpan),rowSpan:w(o.rowSpan),position:{col:o.x,row:o.y}};e.push(h)}));try{var o=a.validateGrid(e),
c=o.success,s=o.result;c||(h=s.overlappedParts.join(", "),p.warning("Part '"+s.misplacedPart+"' is misplaced and overlaps with '"+h+"'."))}catch(l){p.error(l,1)}var v={NormalState:{layoutSettings:{positions:e}}},y=wt(t.model),k={id:b,childSettings:{},locator:null,errorMessage:undefined,widgetState:v,dashboardId:n,dashboardTitle:t.title,dashboardModel:y};return f[b]=k,{id:n,title:t.title,settings:f}},n})();t.DashboardCompressor=et})(v||(v={})),v}));define("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository",["require","exports","f","o","./DashboardRepository","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.Settings","../../Services/Services.Settings.Schema"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function v(n){var i=r.keys(n);if(i.length>=100)throw new Error("There are no more dashboard stores available.");for(var f=i.map((function(t){return n[t].storeName})),u=0,t=w(u);f.indexOf(t)>-1;)t=w(++u);return t}function b(n){for(var f=r.keys(n).map((function(
t){return n[t].title.toLowerCase()})),e=function(n){return f.indexOf(n.toLowerCase())>=0},i=function(n){return n<=1?a:a+" ("+n+")"},u=1,t=i(u);e(t);)t=i(++u);return t}function k(n,t,i,r){var u=r.settings[o.startBoardSettingsKey];u.dashboardId=i;n.setSetting(h(t),i,r);n.setSetting(s,i,{storeName:t,id:r.id,title:r.title});n.flushSettings()}function d(){var n=i.getUniqueId();return""+y+n}function g(n,t){return n[t]&&n[t].storeName}function nt(n){return!!h(n)}function tt(n){return n.queryStore(s).then((function(n){return n||{}}))}var rt=i.Base,ut=rt.Diagnostics,c=f.Dashboard,ft=ut.createLog(n),y="private/",l="recentDashboards",p=10,s=11,a=c.defaultTitle,w=e.getDashboardStoreName,h=e.getDashboardStoreId,et=i.forEachKey,it;t.buildNextStoreName=v;t.createDashboardTitle=b;it=(function(){function n(n){this._settingsManager=n}return n.prototype.getTypeName=function(){return u.PrivateDashboardRepository},n.prototype.createDashboard=function(n){var r=this,t=n.extras&&n.extras.id||d(),i={id:t,title:n.title,
settings:n.settings};return this._getDashboards().then((function(n){return k(r._settingsManager,v(n),t,i),i}))},n.prototype.readDashboard=function(n){var t=this;return this._getDashboards().then((function(i){var r=g(i,n);if(r)return t._settingsManager.querySetting(h(r),n)}))},n.prototype.updateDashboard=function(n,t){var r=this;return this.readDashboard(n).then((function(u){if(u){var f={};return i.shallowCopyFromObject(f,u),i.shallowCopyFromObject(f,t),r._getDashboards().then((function(t){var i=g(t,n)||v(t);return k(r._settingsManager,i,n,f),f}))}return r.createDashboard({title:t.title,settings:t.settings,extras:{id:n}})}))},n.prototype.deleteDashboard=function(n){var t=this._settingsManager;return tt(t).then((function(i){var f=i[n],u,e,o;u=f?f.storeName:r.keys(i).filter(nt).first((function(t){return(i[t]||{}).id===n}));u&&t.deleteSettings({store:h(u),keys:[n]});e=u&&i[u]&&i[u].id===n;o=e?[u,n]:[n];t.deleteSettings({store:s,keys:o});t.flushSettings()}))},n.prototype.readDashboards=function(){return this.
_getDashboards().then((function(n){return r.keys(n).map((function(t){return n[t]}))}))},n.prototype.identifyDashboard=function(n){return i.startsWith(n,y)},n.prototype.isDashboardWritable=function(){return Q(!0)},n.prototype.getNotFoundMessage=function(n){return c.NotFound.privateMessageFormat.format(n.title)},n.prototype.canCreateNewDashboard=function(){return this._getDashboards().then((function(n){return r.keys(n).length<100}))},n.prototype.cloneDashboard=function(n,t){return this.createDashboard({settings:n,title:c.cloneTitleFormat.format(t)})},n.prototype.getRecentDashboards=function(){return this._settingsManager.querySetting(s,l).then((function(n){var t=(n||[]).slice(0,p).filter((function(n){return!!n.id}));return i.unique(t,(function(n,t){return n.id.toLowerCase()===t.id.toLowerCase()}))}))},n.prototype.addToRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.id.toLowerCase()}));return u===0?r:(u>0&&r.
splice(u,1),r.unshift({id:n.id,title:n.title}),r=r.slice(0,p),t._settingsManager.setSetting(s,l,r),r)}))},n.prototype.removeFromRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.toLowerCase()}));return u>=0&&(r.splice(u,1),t._settingsManager.setSetting(s,l,r)),r}))},n.prototype.createDefaultDashboard=function(n){var t;return t=n?Q(n):this._getDashboards().then((function(n){return b(n)})).catch((function(n){return ft.error(n,0,"Failed to generate a dashboard title with index."),a})),t.then((function(n){var t=d();return{id:t,title:n}}))},n.prototype._getDashboards=function(){var n=this;return tt(this._settingsManager).then((function(t){var i={};return et(t,(function(t,r){if(r){var u;n.identifyDashboard(t)?(u=r,i[u.id]=u):nt(t)&&(u=r,i[u.id]||(i[u.id]=u))}})),i}))},n})();t.PrivateDashboardRepository=it})(s||(s={})),s}));define("MsPortalImpl/UI/Dashboard/DashboardClient",["require","exports","f"],(function(n,t,i){"use strict";
var r;return (function(n){function e(n){return new t(new r(n))}var u=i.Base,f=u.Utilities,r=(function(){function n(n){this._extensionManager=n}return n.prototype.connect=function(n,t,i,r){var u,e;return this._extensionManager.getExtensionByName(n,t).then((function(n){return u=n,Q(u.getViewModel(i(u)))})).then((function(n){return e=n,Q(r(n.content))})).finally((function(){f.disposeViewModelProperties(e);u&&e&&u.releaseViewModel(e)}))},n})(),t;n.ViewModelConnectorImpl=r;n.create=e;t=(function(){function n(n){this._connector=n}return n.prototype.getDashboard=function(n,t,i){return this._connector.connect(t,i,(function(n){return n.definition.dashboardProvider.viewModel}),(function(t){return t.getDashboard(n)}))},n})();n.DashboardClientImpl=t})(r||(r={})),r}));define("MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository",["require","exports","f","./DashboardRepository","FxHubs/CloudNameCommon"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function f(n){var i=n.substr(t.length),f=u.getCloudNameFromId(
i),r;return i=u.removeCloudNameFromId(i),r=i.split("/"),{cloudName:f,dashboardParam:r.slice(1).join("/"),extensionName:r[0]}}var t="recommended/",e;n.parseDashboardId=f;e=(function(){function n(n,t){this._dashboardClient=n;this._compressor=t}return n.prototype.createDashboard=function(){return Q.reject(new Error("Cannot create a recommended dashboard"))},n.prototype.readDashboard=function(n){var i=this,t=f(n);return this._dashboardClient.getDashboard(t.dashboardParam,t.extensionName,t.cloudName).then((function(t){return i._compressor.uncompress(n,t)}))},n.prototype.updateDashboard=function(){return Q.reject(new Error("Cannot update a recommended dashboard"))},n.prototype.deleteDashboard=function(){return Q()},n.prototype.readDashboards=function(){return Q([])},n.prototype.getTypeName=function(){return r.RecommendedDashboardRepository},n.prototype.identifyDashboard=function(n){return i.startsWith(n,t)},n.prototype.isDashboardWritable=function(){return Q(!1)},n})();n.RecommendedDashboardRepository=
e})(f||(f={})),f}));define("_generated/Templates/WidgetsAvatarMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-dropdown"> <ul class="fxs-avatarmenu-list-system" role="presentation"> <li class="fxs-has-hover" role="presentation"> <a href="" class="fxs-avatarmenu-signout" role="menuitem" data-bind=\'attr: { title: text.signOutLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: text.signOutLabel"><\/div> <div class="fxs-dropmenu-image fxs-fill-invalid" data-bind="image: data.icons.signout"><\/div> <\/a> <\/li> <\/ul> <div class="fxs-avatarmenu-scrollviewer"> <div class="fxs-avatarmenu-list-system"> <ul role="presentation"> <li class="fxs-has-hover" data-bind="visible: changePasswordLink" role="presentation"> <a class="fxs-avatarmenu-changepassword" role="menuitem" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: changePasswordLink, title: text.changePasswordLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: text.changePasswordLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="image: data.icons.launchCurrent"><\/div> <\/a> <\/li> <li class="fxs-has-hover" data-bind="visible: !!data.links.accessDetails" role="presentation"> <a class="fxs-avatarmenu-myaccess" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.accessDetails, title: data.text.myAccessLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.myAccessLabel"><\/div> <div class="fxs-dropmenu-image msportalfx-svg-c07" data-bind="image: data.icons.person"><\/div> <\/a> <\/li> <li class="fxs-has-hover" data-bind="visible: !!data.links.giveFeedback" role="presentation"> <a class="fxs-avatarmenu-feedback" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.giveFeedback, title: data.text.feedbackLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.feedbackLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="image: data.icons.feedback"><\/div> <\/a> <\/li> <li class="fxs-has-hover" data-bind="visible: data.links.accountPortal" role="presentation"> <a class="fxs-avatarmenu-billing" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: {href: data.links.accountPortal || ""}\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.billingLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="visible: data.links.accountPortal && !data.links.accountPortal.startsWith(\'#\'), image: data.icons.launchCurrent"><\/div> <\/a> <\/li> <\/ul> <\/div> <div class="fxs-avatarmenu-list-tenant fxs-has-border fxs-dropmenu-line-separator" data-bind="visible: listOfTenants().length"> <!-- ko if: listOfTenants().length --> <div class="fxs-avatarmenu-dropdown-title" id="avatarMenuTenantListId" data-bind="text: text.tenant"><\/div> <ul data-bind="foreach: listOfTenants" aria-labelledby="avatarMenuTenantListId" role="group"> <li class="fxs-has-hover" role="presentation"> <a role="menuitemradio" data-bind="css: { \'fxs-avatarmenu-current-tenant fxs-is-selected\': $index() === 0 }, attr: { href: $index() === 0 ? \'#\' : \'\', \'aria-checked\': $index() === 0 }"> <div class="fxs-avatarmenu-tenant-name" data-bind="text: displayName, attr: { title: displayName }"><\/div> <div data-bind="text: domainName, attr: { title: domainName }" class="fxs-avatarmenu-tenant-uri"><\/div> <\/a> <\/li> <\/ul> <!-- /ko --> <\/div> <\/div> <\/div>'}
}));define("_generated/Templates/WidgetsAvatarMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-header" data-bind="attr: { title: tooltip }"> <div class="fxs-avatarmenu-tenant-container"> <div class="fxs-avatarmenu-username" data-bind="text: displayName"><\/div> <div class="fxs-avatarmenu-tenant" data-bind="text: currentTenantDisplayName"><\/div> <\/div> <img class="fxs-avatarmenu-tenant-image" data-bind="attr: { src: avatarUri }" alt=""/> <\/div>'}}));define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","../Base/Telemetry","../../_generated/Templates/WidgetsAvatarMenu","../../_generated/Templates/WidgetsAvatarMenuButton","./Widgets.WidgetBase","./Widgets.DropMenu","../../_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){function v(n){n.preventDefault()}function r(n){return(n||"").
toLowerCase()}function l(n,t,i){var r=n.element.findByClassName(t);if(i)r.on(c.click,i);return r}function gt(n){var t=n.userIdentity(),i=t&&(t.displayName||ni(t));return i||n.text.defaultDisplayName}function ni(n){var t=n.firstName||"",i=n.lastName||"";return!t&&!i?"":rt.test(t)&&rt.test(i)?"":u.AvatarMenu.displayNameFormat.format(t,i)}function ti(n,t){return t().first((function(t){return n().tenantId===t.id}))}function ii(n,t){return k((function(){var f=n(),u=f&&r(f.tenantId),i=t();return i.length===1&&i[0]&&r(i[0].id)===u?[]:i.sort((function(n,t){var o=r(n.id),e,i,f;return o===u?-1:(e=r(t.id),e===u)?1:(i=n.displayName,f=t.displayName,i<f?-1:i>f?1:0)}))}))}var p=i.Base,at=p.Diagnostics.Telemetry,c=p.EventTypes,w=p.Images,vt=MsPortalImpl.Resources.Images,yt=window,b=yt.fx.environment.links,d=jQuery,g=f.Source.TopBar,nt=f.Action,tt=at.trace,pt=vt.getAvatarMenu().defaultAvatarSmall,t="fxs-avatarmenu",wt=t+"-header",ut=t+"-list-tenant",it=t+"-signout",ft=t+"-billing",et=t+"-feedback",ot=t+"-myaccess",
bt="fxs-menu-account",a=ko.observable,kt=ko.observableArray,k=ko.pureComputed,st="signOut",ht="switchedTenant",ct="showDiagnostics",y=c.click,dt=(function(n){function t(){n.apply(this,arguments);this.dropMenu=new h.ViewModel(o(),e());this.userIdentity=a();this.userInfo=a();this.hideTenant=a();this.listOfTenants=kt();this.showDiagnostics=null;this.openMenu=null;this.signOut=null;this.signedOut=null;this.switchTenant=null;this.switchedTenant=null;this.text=u.AvatarMenu;this.links=b;this.icons={feedback:w.Feedback(),signout:w.Signout(),person:w.Person({palette:p.ImagePalette.Inherit}),launchCurrent:w.LaunchCurrent()};this.avatarImage=a();this.showDiagnosticsDelay=3e3}return __extends(t,n),t})(s.ViewModel),rt,lt;n.ViewModel=dt;rt=/^(f(irst)?|l(ast)?)\s?name$/i;lt=(function(n){function i(i,u){var o=this;n.call(this,i,u);this._lastTouchMillis=0;var f=this.element,s=this.lifetimeManager,c=u.dropMenu;f.addClass(t);c.buttonClass=bt;this._dropMenuWidget=new h.Widget(f,c);var v=k((function(){return gt(
u)})),y=k((function(){var n=u.userInfo();return u.hideTenant()||!n?"":n.uniqueDirectoryName})),p=k((function(){var n=u.userIdentity(),i,e,s,h;if(!n)return"";var f=u.text.Tooltip,c=f.tenant,t=[];return(n.firstName||n.lastName)&&t.push(f.name.format(n.firstName||"",n.lastName||"")),n.displayName&&t.push(f.email.format(n.displayName)),i=ti(u.userIdentity,u.listOfTenants),i&&!u.hideTenant()&&(t.push(c.format(i.displayName,i.id)),e=i.domainName||"",s=n.tenantDomain,t.push(s&&r(e)!==r(s)?c.format(e,s):f.domain.format(e))),h=t.join("\n"),o._dropMenuWidget.options.buttonTooltip(h),h})),e=a(pt),l=a();ko.reactor(s,(function(){var n=u.userIdentity(),t;n&&(l(n.changePasswordUri),n.isAnonymous||(e(n.defaultAvatarUri),t=u.avatarImage(),t&&t.then((function(n){e(n)}))))}));ko.applyBindingsToDescendants({data:u,func:this,displayName:v,listOfTenants:ii(u.userIdentity,u.listOfTenants),text:u.text,currentTenantDisplayName:y,tooltip:p,avatarUri:e,changePasswordLink:l},f[0]);ko.reactor(s,u.dropMenu.isMenuOpen,(function(
n){n&&o._reactToMenuOpen()}));this._attachEventHandlers()}return __extends(i,n),i.prototype.dispose=function(){this._dropMenuWidget.dispose();this._cleanElement(t);n.prototype.dispose.call(this)},i.prototype._signOut=function(n){var t=d.Event(st),i=this.trigger(st,t,{completed:!!n});(tt({source:g,action:nt.AvatarMenuSignOut}),i)&&this.trigger("signedOut")},i.prototype._switchTenant=function(n){var t=this.options.userIdentity(),i=t&&r(t.tenantId);if(r(n.id)!==i){var u=d.Event(ht),f=this.trigger("switchTenant"),e={tenant:n};if(tt({source:g,action:nt.AvatarMenuSwitchTenant}),!f)return;this.trigger(ht,u,e)}},i.prototype._attachEventHandlers=function(){var n=this,i=this.options,t=this.element,r;this._holdStartHandler=function(){n._lastTouchMillis=Date.now()};this._holdEndHandler=function(t){var r,u;n._lastTouchMillis&&(r=Math.abs(Date.now()-n._lastTouchMillis),n._lastTouchMillis=0,r>i.showDiagnosticsDelay&&(u=d.Event(ct),n.trigger(ct,u),v(t)))};this._accountPortalHandler=function(n){i.openAccountPortal(
);b.accountPortal.startsWith("#")&&v(n)};this._feedbackHandler=function(n){i.giveFeedback();b.giveFeedback.startsWith("#")&&v(n)};r=l(this,wt);r.on([c.touchstart,c.mousedown].join(" "),this._holdStartHandler);r.on([c.touchend,c.mouseup].join(" "),this._holdEndHandler);l(this,ft,this._accountPortalHandler);l(this,et,this._feedbackHandler);this.lifetimeManager.registerForDispose((function(){t.off(y,it,n._signOutHandler);t.off(y,ft,n._accountPortalHandler);t.off(y,et,n._feedbackHandler);t.off(y,ut,n._tenantHandler);t.off(y,ot,n._myAccessHandler)}))},i.prototype._reactToMenuOpen=function(){var n=this,t=l(this,it);if(t[0].focus(),tt({source:g,action:nt.AvatarMenuOpen}),this._signOutHandler||l(this,it,this._signOutHandler=function(t){n._signOut(!1);v(t)}),!this._tenantHandler)l(this,ut).on(c.click,"a",this._tenantHandler=function(t){v(t);n._switchTenant(ko.dataFor(t.target))});this._myAccessHandler||l(this,ot,this._myAccessHandler=function(t){b.accessDetails.startsWith("#")&&v(t);n.options.showMyAccessBlade(
)})},i})(s.Widget);n.Widget=lt})(c||(c={})),c}));define("MsPortalImpl/Widgets/Widgets.BreadCrumbViewModel",["require","exports","o","./Widgets.WidgetBase"],(function(n,t,i,r){"use strict";var u;return (function(n){var t=ko.observableArray,i=(function(n){function i(){n.apply(this,arguments);this.breadCrumbs=t();this.clicksEventsHandlers=t()}return __extends(i,n),i})(r.ViewModel);n.ViewModel=i})(u||(u={})),u}));define("_generated/Templates/WidgetsBreadCrumb",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-breadcrumb-wrapper"> <div class="fxs-breadcrumb-dropmenu"><\/div> <!-- ko foreach: func.breadCrumbsVisibleUI --> <!-- ko if: $index() --> <div class="fxs-breadcrumb-divider fxs-fill-secondary" data-bind="image: $data.caretUp, visible: $data.visible"><\/div> <!-- /ko --> <a href="" class="fxs-breadcrumb-crumb fxs-has-hover" data-bind="attr: { \'data-blade-id\': $data.bladeId }, text: $data.bladeTitle, visible: $data.visible"><\/a> <!-- /ko --> <\/div>'}}));define(
"_generated/Templates/WidgetsBreadCrumbOverFlow",["require","exports"],(function(){"use strict";return function(){return'<ul class="fxs-breadcrumb-overflow"> <!-- ko foreach: breadCrumbsOverFlow --> <li> <a href="" class="fxs-breadcrumb-crumb" data-bind="attr: { \'data-blade-id\': $data.bladeId }, text: $data.bladeTitle"><\/a> <\/li> <!-- /ko --> <\/ul>'}}));define("MsPortalImpl/Widgets/Widgets.BreadCrumb",["require","exports","f","o","a","../Base/Telemetry","./Widgets.WidgetBase","../../_generated/Templates/WidgetsBreadCrumb","../../_generated/Templates/WidgetsBreadCrumbOverFlow","./Widgets.DropMenu","../../_generated/Less/MsPortalImpl/Widgets/Widgets.BreadCrumb.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){function b(n,t,i,f){u(n,t,(function(){var h=t(),c=f?h.reverse():h,l=c.length,a=l-i().length,e,v,o,n,u,s;if(a>0){for(e=[],n=0,v=Math.max(a,5);n<v;n++)e.push({bladeId:r(),bladeTitle:r(),visible:r(),caretUp:ft});i.push.apply(i,e)}for(o=i(),n=0;n<o.length;n++)u=
o[n],n<l?(s=c[n],u.bladeId(s.bladeId),u.bladeTitle(s.bladeTitle),u.visible(!0)):u.visible(!1)}))}function l(n,t,i){var r=i().first();r&&n.width()>=t.width()&&(r.visible(!1),l(n,t,i))}var a=i.Base,k=a.Diagnostics.Telemetry,t=a.EventTypes,u=ko.computed,r=ko.observable,v=ko.observableArray,y=window,p=jQuery,d=f.Source.Desktop,g=f.Action,nt=k.trace,c="fxs-breadcrumb",tt=c+"-wrapper",it=c+"-divider",rt=c+"-dropmenu",ut="&#171",w={deferred:!0},ft=i.Base.Images.CaretUp(),et=(function(n){function i(i,f){var ot=this,k,ft,st,ct,lt,at;n.call(this,i,f);var e=this.element,vt=this.options,c=this.lifetimeManager,a=vt.breadCrumbs.map(c,(function(n,t){return{bladeId:t.bladeId,bladeTitle:t.bladeTitle,visible:r()}}));a.extend(w);k=a.filter(c,(function(n){return!n.visible()}));ft=this.breadCrumbsVisible=a.filter(c,(function(n){return n.visible()}));this.breadCrumbsVisibleUI=v([]);st=v([]);e.html(o());this._bindDescendants();var yt=this._visibleBreadCrumbs=e.findByClassName(tt),pt=e.findByClassName(it),et=this._dropMenuElement=
e.findByClassName(rt),ht=new h.ViewModel(ut,s(),!0);ht.alignMenu=0;c.registerForDispose(new h.Widget(et,ht));ko.applyBindings({breadCrumbsOverFlow:ko.computed((function(){return k().reverse()}))},et[0]);u(c,k,(function(){return k().length>0})).subscribeAndRun(c,(function(n){et.css("display",n?"":"none")}));e.on(t.click,"a",ct=function(n){var i=ko.dataFor(n.target),r=i&&ko.unwrap(i.bladeId);n.preventDefault();nt({source:d,action:g.BreadCrumbClicked});r&&e.trigger(t.fxbreadcrumbclick,{bladeId:r})});u(c,a,at=function(){var n=a();n.length&&(n.forEach((function(n){n.visible(!0)})),l(yt,e,ft))}).extend(w);p(y).on(t.resize,lt=function(){if(ot.options.breadCrumbs().length>0){var t=e.width(),n=ot._visibleBreadCrumbs;n.width()>=t?l(n,e,ft):at()}});f.clicksEventsHandlers.map(c,(function(n,i){e.on(t.fxbreadcrumbclick,i);n.registerForDispose((function(){e.off(t.fxbreadcrumbclick,i)}))}));c.registerForDispose((function(){e.off(t.click,"a",ct);p(y).off(t.resize,lt)}));b(c,ft,this.breadCrumbsVisibleUI,!1);b(c,k,st,
!0)}return __extends(i,n),i})(e.Widget);n.Widget=et})(c||(c={})),c}));define("_generated/Templates/WidgetsJourneysMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fx-dropmenu-dropdown"> <!-- ko ifnot: data.journeysList && data.journeysList() && data.journeysList().length --> <div tabindex="0" class="fxs-journeysmenu-journey-nodata"> <div class="fxs-journeysmenu-journey-nodata-content" data-bind="text: data.text.noJourneys"><\/div> <\/div> <!-- /ko --> <!-- ko if: data.journeysList && data.journeysList() && data.journeysList().length --> <div class="fxs-dropmenu-list-system"> <ul> <!-- ko foreach: data.journeysList --> <li class="fxs-journeysmenu-list fxs-has-hover"> <a href="" class="fxs-journeysmenu-journey-wrapper" data-bind="attr: { \'data-journey-id\': $data.journeyId }"> <div class="fxs-has-hover fxs-journeysmenu-journey"> <!-- ko foreach: $data.breadCrumbs --> <div class="fxs-breadcrumb-divider fxs-fill-secondary" data-bind="image: $root.data.icons.caretUp, visible: $index()"> <\/div> <div class="fxs-journeysmenu-journey-content" data-bind="attr: { \'data-blade-id\': $data.bladeId, title: $data.bladeTitle }, text: $data.bladeTitle"><\/div> <!-- ko if: $parent.isOverflow() && $index() === 0 --> <div class="fxs-breadcrumb-divider fxs-fill-secondary" data-bind="image: $root.data.icons.caretUp"><\/div> <div class="fxs-journey-breadcrumb-overflow fxs-text-title" data-bind="image: $root.data.icons.ellipsis"><\/div> <!-- /ko --> <!-- /ko --> <\/div> <\/a> <button class="fxs-journeysMenu-discardButton fxs-has-hover" data-bind="attr: { \'data-journey-id\': $data.journeyId, title: $root.data.text.discardButton }, image: $root.data.icons.close"><\/button> <\/li> <!-- /ko --> <\/ul> <\/div> <!-- /ko --> <\/div>'}
}));define("_generated/Templates/WidgetsJourneysMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-button fxs-has-hover fxs-topbar-journey-icon" data-bind="image: data.icons.caretDown"><\/div>'}}));define("MsPortalImpl/Widgets/Widgets.JourneysMenu",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.KeyboardNavigation","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Widgets.WidgetBase","./Widgets.DropMenu","../../_generated/Templates/WidgetsJourneysMenu","../../_generated/Templates/WidgetsJourneysMenuButton"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a;return (function(n){function nt(n){var i=t(n.target);return i.closest("[data-journey-id]").data(ct)}var it=i.Base.Diagnostics.Telemetry,rt=i.Base.EventTypes,a=window,t=jQuery,ut=o.Source.TopBar,ft=o.Action,et=it.trace,ot="fxs-breadcrumb",v="fxs-dropmenu",st=v+"-button",y=v+"-content",p="fxs-journeysmenu",ht=p+"-content",
w="."+p+"-journey-wrapper",b=".fxs-journeysMenu-discardButton",ct="journeyId",lt=ko.observable,k=ko.observableArray,d="resize",r=rt.click,g=u.KeyboardShortcuts,at=g.tooltipFormat,vt=at.format(g.active,"A"),yt=(function(n){function t(){n.apply(this,arguments);this.dropMenu=new h.ViewModel(l(),c());this.journeysMetadata=k();this.text=u.JourneysMenu;this.icons=e.Content.SvgStartup}return __extends(t,n),t})(s.ViewModel),tt;n.ViewModel=yt;tt=(function(n){function i(t,i){var u=this;n.call(this,t,i);var f=this.element,e=this.lifetimeManager,o=this.options,r=i.dropMenu;this._breadCrumbsBar=f.parent().findByClassName(ot);new h.ViewModel(l(),c());r.menuWidth=this._breadCrumbsBar.width();r.alignMenu=0;this._dropMenuWidget=new h.Widget(f,r);ko.reactor(e,r.isMenuOpen,(function(n){n?u._openMenu():u._closeMenu()}));r.buttonTooltip(vt);ko.computed(e,(function(){o.journeysList=o.journeysMetadata.map((function(n){var t=[];return n.journeyBlades().forEach((function(n){var i={bladeId:n.id,bladeTitle:n.title};t.push(
i)})),{journeyId:n.id,breadCrumbs:k(t),isOverflow:lt(!1)}}))}));this._bindDescendants()}return __extends(i,n),i.prototype.dispose=function(){n.prototype.dispose.call(this);this._closeMenu();this._dropMenuWidget&&(this._dropMenuWidget.dispose(),this._dropMenuWidget=null)},i.prototype._handleJourneyOverflow=function(n,i){n.breadCrumbs().length>1&&t(i).width()>=this._dropMenuWidget.element.findByClassName(y).width()-62&&(n.isOverflow(!0),n.breadCrumbs.splice(1,1),this._handleJourneyOverflow(n,i))},i.prototype._attachHandlers=function(){var n=this,i=this.element,u=this.options;if(!this._onClick)i.on(r,w,this._onClick=function(n){var t=nt(n);n.preventDefault();u.activateJourney(t)});if(!this._onDiscard)i.on(r,b,this._onDiscard=function(n){var t=nt(n);n.preventDefault();u.discardJourney(t)});if(!this._onResize)t(a).on(d,this._onResize=function(){n._journeysMenu.width(n._breadCrumbsBar.width())});this.lifetimeManager.registerForDispose((function(){i.off(r,w,n._onClick);i.off(r,b,n._onDiscard);t(a).
off(d,n._onResize)}))},i.prototype._openMenu=function(){var u=this,n=this.element,t,i,r;et({source:ut,action:ft.JourneyMenuOpen});t=n.find("a.fxs-journeysmenu-journey-wrapper")[0];t?t.focus():n.findByClassName(st).focus();i=this._journeysMenu=n.findByClassName(y);i.width(this._breadCrumbsBar.width());i.addClass(ht);this._attachHandlers();r=0;this.options.journeysList().forEach((function(t){var i=n.findByClassName("fxs-journeysmenu-journey")[r];u._handleJourneyOverflow(t,i);r++}));this._keyboardNav=new f.KeyboardNavigation(n)},i.prototype._closeMenu=function(){this._keyboardNav&&(this._keyboardNav.dispose(),this._keyboardNav=null)},i})(s.Widget);n.Widget=tt})(a||(a={})),a}));define("_generated/Templates/WidgetsTopBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-exit-customize"> <div class="fxs-topbar-exit-customize-message" data-bind="text: data.text.exitCustomizeText"><\/div> <div type="button" class="fxs-topbar-exit-customize-button fxs-button fxs-button-primary" data-bind="text: data.text.exitCustomizeButton"><\/div> <\/div> <div class="fxs-topbar-content fxs-hide-in-customize" role="banner"> <div class="fxs-topbar-internal msportalfx-bg-warning" data-bind="visible:data.showPreview, text: data.text.internalText"><\/div> <a href="#" class="fxs-topbar-home fxs-has-hover" role="button" data-bind="text: data.productName, attr: { title: data.dashboardTooltip }"><\/a> <div class="fxs-topbar-journeysmenu" data-bind="stopBindings: true"><\/div> <div class="fxs-breadcrumb" data-bind="stopBindings: true"><\/div> <!-- ko if: data.inDevMode --> <a class="fxs-topbar-exitdevmode fxs-has-hover msportalfx-bg-warning" href="#" role="button" data-bind="text: data.text.exitDevModeLinkText, click: func._exitDevMode"><\/a> <!-- /ko --> <!-- ko if: data.canReportBug --> <a href="#" class="fxs-topbar-reportbug fxs-has-hover msportalfx-bg-warning" role="button" data-bind="text: data.text.reportBug, click: func._reportBug, attr: { title: data.text.reportBugTitle, \'aria-label\': data.text.reportBug }"><\/a> <!-- /ko --> <div class="fxs-topbar-search" data-bind="stopBindings: true, attr: { title: data.searchTooltip }"><\/div> <!-- ko ifnot: data.notificationsContextPane --> <div class="fxs-topbar-notifications" data-bind="stopBindings: true"><\/div> <!-- /ko --> <!-- ko if: data.notificationsContextPane --> <a href="#" class="fxs-topbar-notifications fxs-topbar-button fxs-has-hover" role="button" data-bind="attr: { title: data.text.notifications }, image: data.notificationsIcon"><\/a> <div class="fxs-topbar-toast"><\/div> <!-- /ko --> <a role="button" class="fxs-topbar-console fxs-topbar-button fxs-has-hover" data-bind="attr: { title: data.text.console }, image: data.consoleIcon"><\/a> <a href="#" class="fxs-topbar-settings fxs-topbar-button fxs-has-hover fxs-menu-settings" role="button" data-bind="attr: { title: data.text.settings }, image: data.settingsIcon"><\/a> <!-- ko if: data.showFeedbackButton --> <a href="#" class="fxs-topbar-feedback fxs-topbar-button fxs-has-hover" role="button" data-bind="attr: { title: data.text.feedback }, image: data.feedbackIcon, click: func._feedbackButtonClick"><\/a> <!-- /ko --> <div class="fxs-topbar-helpmenu" data-bind="stopBindings: true, attr: { title: data.helpTooltip }"><\/div> <div class="fxs-topbar-avatarmenu" data-bind="stopBindings: true"><\/div> <\/div> <div class="fxs-topbar-dashboard"> <div class="fxs-topbar-dashboard-message" data-bind="text: data.dashboardMessage"><\/div> <button type="button" class="fxs-button fxs-topbar-dashboard-done-customize" data-bind="text: data.text.exitCustomizeButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-view" data-bind="text: data.text.viewDashboardButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-save" data-bind="text: data.dashboardSaveButtonText"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-discard" data-bind="text: data.text.discardDashboardButton"><\/button> <\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Widgets.AvatarMenu","./Widgets.BreadCrumbViewModel","./Widgets.BreadCrumb","./Widgets.WidgetBase","./Widgets.JourneysMenu","../../_generated/Templates/WidgetsTopBar","../../_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var v;return (function(n){var p=i.Base,et=p.Diagnostics.Telemetry,r=p.EventTypes,ot=p.Images,st=p.Utilities,w=f.Content.SvgStartup,ht=window,nt=ht.fx.environment,b=nt.features,tt=jQuery,ct="fxs-breadcrumb",it="fxs-topbar",lt="fxs-topbar-exit-customize-button",at="fxs-topbar-home",vt="fxs-topbar-journeysmenu",yt="fxs-topbar-notifications",pt="fxs-topbar-settings",wt="fxs-topbar-devmode",bt="fxs-topbar-dashboard",kt="fxs-topbar-dashboard-visible",dt="fxs-topbar-dashboard-changed",gt="fxs-topbar-dashboard-save",ni="fxs-topbar-dashboard-discard",
ti="fxs-topbar-dashboard-view",rt="fxs-topbar-dashboard-done-customize",ii="fxs-topbar-console",ri=e.Source.TopBar,v=e.Action,ui=et.trace,d=u.KeyboardShortcuts,fi=d.tooltipFormat,k=u.TopBar,g=r.fxexitorganizemode,t=ko.observable,y,ut,ft;n.fxfinishdashboardedit="fxfinishdashboardedit",(function(n){n[n.Unknown=0]="Unknown";n[n.Save=1]="Save";n[n.SaveACopy=2]="SaveACopy";n[n.Discard=3]="Discard";n[n.Cancel=4]="Cancel"})(n.FinishDashboardEditAction||(n.FinishDashboardEditAction={}));y=n.FinishDashboardEditAction;ut=(function(n){function r(){n.apply(this,arguments);this.breadCrumb=new s.ViewModel;this.journeysMenu=new l.ViewModel;this.avatarMenu=new o.ViewModel;this.productName=st.htmlEncode(nt.branding.productName);this.showPreview=ko.observable(i.isNullOrUndefined(b.internalonly)||b.internalonly==="true");this.text=u.TopBar;this.dashboardTooltip=d.GoTo.dashboard;this.searchTooltip=d.search;this.canReportBug=t(!1);this.reportBug=tt.noop;this.showFeedbackButton=b.feedback==="true";this.inDevMode=
t(!1);this.exitDevMode=tt.noop;this.exitDevModeIcon=ot.Discard();this.settingsIcon=w.settings;this.consoleIcon=w.console;this.notificationsContextPane=b.notificationspane==="true";this.notificationsIcon=w.notifications;this.feedbackIcon=w.smileyHappy;this.dashboardMessage=t("");this.dashboardSaveButtonText=t("");this.dashboardChanged=t(!1);this.dashboardWritable=t(!1);this.dashboardVisible=t(!1);this.isInOrganizeMode=t(!1)}return __extends(r,n),r})(c.ViewModel);n.ViewModel=ut;ft=(function(t){function u(n,r,u){var p=this,e,y,f,s,c,v;if(t.call(this,n,r),e=this.lifetimeManager,n.addClass(it).html(a()),y=this.options.breadCrumb,e.registerForDispose(new h.Widget(n.findByClassName(ct),y)),i.isFeatureEnabled("retirejourneysmenu")||e.registerForDispose(this._journeysMenuWidget=new l.Widget(n.findByClassName(vt),this.options.journeysMenu)),new o.Widget(n.findByClassName("fxs-topbar-avatarmenu"),this.options.avatarMenu),this._feedbackButtonClick=function(){r.feedbackButtonClick()},f=this.lifetimeManager,
ko.reactor(f,(function(){n.toggleClass(wt,!!r.inDevMode()).toggleClass("msportalfx-bg-warning",!!r.inDevMode())})),ko.reactor(f,(function(){var n=r.dashboardWritable(),i=n?k.saveDashboardButton:k.saveDashboardCopyButton,t;r.dashboardSaveButtonText(i);t=n?k.saveMessage:k.saveCopyMessage;r.dashboardMessage(t)})),ko.reactor(f,(function(){n.toggleClass(dt,!!r.dashboardChanged());n.toggleClass(kt,!!r.dashboardVisible());n.findByClassName(rt).toggle(!!r.isInOrganizeMode());var t="fxs-button-primary",i="fxs-button-default",u=n.findByClassName(bt).find(".fxs-button:visible");u.removeClass(t).addClass(i);u.eq(0).removeClass(i).addClass(t)})),this._bindDescendants(),this._attachEventHandlers(n),i.isFeatureEnabled("azureconsole")){s=!1;v=n.findByClassName(ii);v.css("display","flex");v.on("click",(function(){s?c.toggle():(s=!0,i.require("MsPortalImpl/Widgets/Widgets.Console").then((function(n){p.options.getConsoleViewModel().then((function(t){c=new n.Widget(u,t);c.toggle()}))})))}))}}return __extends(u,t),u.prototype.
dispose=function(){this._cleanElement(it);t.prototype.dispose.call(this)},u.prototype.getJourneysMenuWidget=function(){return this._journeysMenuWidget},u.prototype._reportBug=function(n,t){t.preventDefault();n.data.reportBug()},u.prototype._exitDevMode=function(n,t){t.preventDefault();n.data.exitDevMode()},u.prototype._attachEventHandlers=function(t){function u(n,i){var r=i&&{action:i}||undefined;t.trigger(n,r)}function i(n,i){t.on(r.click,n,i)}function f(n,t){ui({source:ri,action:n,data:t})}function e(n,t,i){return function(r){r.preventDefault();t&&f(t,i);u(n)}}var o=this.options;i("."+lt+", ."+rt,e(g,v.CustomizeModeExited,{dashboardChanged:!!o.dashboardChanged(),onDashboard:!!o.dashboardVisible()}));i("."+at,e(r.fxhomebuttonclick,v.HomeButtonClicked));i("."+pt,e(r.fxsettingsbuttonclick));i("."+yt,e(r.fxnotificationsbuttonclick));i("."+gt,(function(){var t=o.dashboardWritable(),i=t?y.Save:y.SaveACopy,r=t?v.DashboardPublish:v.DashboardSaveACopy;f(r);u(n.fxfinishdashboardedit,i);i===y.Save&&
u(g)}));i("."+ni,(function(){f(v.DashboardDiscard);u(n.fxfinishdashboardedit,y.Discard);u(g)}));i("."+ti,(function(){f(v.DashboardView);u(r.fxhomebuttonclick)}))},u})(c.Widget);n.Widget=ft})(v||(v={})),v}));define("MsPortalImpl/UI/Dashboard/DashboardManager",["require","exports","f","i","o","./../../Base/Base.Router","./ArmDashboardRepository","./DashboardCompressor","./DashboardRepository","../../Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","./PrivateDashboardRepository","../../Services/Services.SelectedSubscriptions","../../Services/Services.Settings.Schema","../../Base/Telemetry","../Compositions/UI.Composition","../Compositions/UI.Composition.Base","../Compositions/UI.Composition.CompositionBinder","../Compositions/UI.Composition.Part","../Compositions/UI.Composition.PartSettingsManager","../Compositions/UI.Composition.StartBoard","../Compositions/UI.Composition.StartboardPart","./DashboardClient","./RecommendedDashboardRepository","../UI.DesktopManager",
"../../Widgets/Widgets.Common","../../Widgets/Widgets.StartBoard","../../Widgets/Widgets.TopBar"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et){"use strict";var ot;return (function(t){function pi(n){var i=n||{},r=i.model,u=i.metadata;return{model:$.extend({},t.defaultDashboardModelJson.model,r),metadata:$.extend({},t.defaultDashboardModelJson.metadata,u)}}function ot(n,t,i){return new ri(n,t||new Error,i)}function or(n){var t=n.services,s=new ki(t.settings),h=new ei(n.services),i=new o.DashboardCompressor,r=new oi(s,n.services.desktop.portalWidget.getTopBarWidget(),n.lifetime,h,i,n.services.storageService),c=new e.ArmDashboardRepository(n.lifetime,t.extensionManager,t.permissionsManager,i),u,f;return r.addRepository(c),u=tt.create(t.extensionManager),f=new it.RecommendedDashboardRepository(u,i),r.addRepository(f),r}function wi(n){return n.id.toLowerCase().replace(/\/\/+/g,"/")}function at(n,t){return wi(n)===wi(t)}function ui(n){return Q(n)}function fi(n,t){return d.
buildIdentitySettingKey(n,t)}function wt(n){return ni.start({source:gi.Dashboard,action:n,actionModifier:nr.Start})}function bt(n,t){ni.completeTrace(n,t)}function sr(n){var t={},r=n[vt],o=r.widgetState,f=o.NormalState.layoutSettings,e=[];return u.keys(n).filter((function(n){return g.isStartboardPartKey(n)})).forEach((function(r){var u=n[r],c=h.Locator.fromJSON(u.locator),v=li(u.containerModel),b=fi(c,v),y=ko.toJS(v),l,o,a,p,s;y[ti]=i.getUniqueId();l=ii(y);u.containerModel=k.getSerializableContainerModel(l,!1);o=w.createIdentifier(dt.StartboardPart,c);u.id=o;t[o]=u;a=n[b];a&&(p=fi(c,l),t[p]=a);s=(f.positions||[]).first((function(n){return n.id===r}));s&&(s.id=o,e.push(s))})),f.positions=e,t[vt]=r,JSON.parse(JSON.stringify(t))}function hr(n){var r=n&&n.relative,f=n&&n.absolute,t="",i,u;if(r){i=r.duration;u=r.timeUnit;switch(u){case gt.Week:i===1&&(t=yt.pastWeek);break;case gt.Hour:i===1?t=yt.pastHour:i===24&&(t=yt.past24Hours)}}else f&&(t=yt.custom);return t}function cr(n){var t=n&&n.model&&n.
model.model;return t&&t.timeRange}function ct(n,t){ir&&n&&f.updateDashboardUri(n.id,t)}function rt(n,t){n._startboard.widget.options.loading(t)}var kt=i.Base,si=kt.Diagnostics,bi=i.Hubs.Notifications.NotificationStatus,ki=l.PrivateDashboardRepository,dt=p.CompositionType,hi=i.Composition.Configuration,di=b.CompositionBinder,gt=hi.TimeUnit,ni=si.Telemetry,gi=y.Source,ci=y.Action,nr=ni.ActionModifier,tr=window,ht=tr.fx,ir=i.isFeatureEnabled("deeplinkdashboard"),lt=si.createLog(n),vt=v.startBoardSettingsKey,rr=10,ti=p.PartContainerModelIdProperty,ur=d.partIdentityStatePrefix,st=c.Dashboard,yt=c.Filter.Option,fr=c.NavBar.home,pt=kt.Constants.DefaultCloudName,ii=di.createObservableModel,li=k.createContainerModel,ai="create",vi="clone",yi="unpublish",er=ko.observable,ri,ei,oi;t.defaultDashboardModelJson={model:{timeRange:{relative:{duration:24,timeUnit:gt.Hour}}},metadata:{timeRange:hi.TimeRangeValueType}};t.backfillDashboardModel=pi;ri=(function(n){function t(t,i,r){n.call(this,{code:t,data:
r||{},message:i.message,stack:i.stack,innerErrors:i})}return __extends(t,n),t.TypeName="MsPortalImpl.UI.DashBoardError",t})(i.Errors.Error);t.create=or;t.isSameDashboard=at;t.startTrace=wt;ei=(function(){function n(n){this._desktopManager=n.desktop;this._settingsManager=n.settings;this._notificationManager=n.notificationManager}return n.prototype.collectDashboardSettings=function(n){var i=this,t={},r=n.toJSON(),u=n.children.filter((function(n){return!n.dontSetupWidget&&!n.isDisposed()})).map((function(n){return i.getPartSettings(n)}));return Q.allSettled(u).then((function(n){return n.forEach((function(n){$.extend(t,n.value)})),t[vt]=r,JSON.parse(JSON.stringify(t))}))},n.prototype.getPartSettings=function(n){var t=this;return Q(n.awaitComposed()).then((function(){var f;if(n.isDisposed())return{};var e={},r=n.toJSON(),u=n.containerModel;return u[ti]||(f=ko.toJS(li(r.containerModel)),f[ti]=i.getUniqueId(),u=ii(f),r.containerModel=k.getSerializableContainerModel(u,!1)),e[r.id]=r,t.getPartIdentitySettings(
n,u).then((function(n){return $.extend(e,n)}))})).catch((function(t){return lt.error(t,8,"part: '"+n.id+"'."),{}}))},n.prototype.getPartIdentitySettings=function(n,t){var r=n.partDefinition,i;return!r||!r.partState?Q({}):(i=fi(n.locator,t),n.getPartSettingsManager().getStartboardPartIdentitySettings().then((function(n){if(!n)return{};var t={};return t[i]=n,t})).catch((function(t){return lt.error(t,9,"Failed to get part '"+n.id+"' identify settings for key '"+i+"'."),{}})))},n.prototype.clearStartboard=function(n){var t=this._desktopManager;n.children.filter((function(n){return!n.dontSetupWidget})).forEach((function(n){return t.removeTile(n.id,!0)}))},n.prototype.renderStartboard=function(n,t,r,f){var s=this._settingsManager,e=u.keys(t),h=function(n,t){var r={};return i.shallowCopyFromObject(r,n,t),r},c=e.filter((function(n){return i.startsWith(n,ur)})),o;s.setSettings({store:2,settings:h(t,c)});o=t[vt];n.widget.options.applyViewSettings(o.widgetState);e.filter((function(n){return g.isStartboardPartKey(
n)})).forEach((function(i){var o=t[i],u=nt.Instance.fromJSON(n.services,o),e=u.locator.getExtensionLocator(),s=n.services.extensionManager.getExtension(e.name,e.cloudName);(s||!f)&&(n.addChild(u),r||(u.compose(n.widget),u.save()))}));r||n.save()},n.prototype.readDashboardsOfMaxCount=function(n,t,i,r){n=n.slice();i=i.slice();var u=[],e=i.map((function(n){return n.id.toLowerCase()})),f=function(){var i=n.shift();return i.readDashboards().then((function(n){return r(n,i.getTypeName()),n.filter((function(n){return e.indexOf(n.id.toLowerCase())<0})).slice(0,t-u.length)})).catch((function(n){var t=i.getTypeName();return lt.error(n,10,"Failed to read dashboards from '"+t+"' repository."),[]})).then((function(i){return u.push.apply(u,i),u.length>=t||!n.length?Q():f()}))};return f().then((function(){return u}))},n.prototype.enterOrganizeMode=function(n){var t=this._desktopManager;t.mode(1);n&&t.portalWidget.options.sideBar.isCollapsed(!n)},n.prototype.isStartboardReady=function(){return this._desktopManager.startBoardPartsLoaded(
)},n.prototype.getStartboardReadyPromise=function(){return this._desktopManager.getStartboardPartsLoadedPromise()},n.prototype.popNotification=function(n,t,i){i===void 0&&(i=bi.Error);this._notificationManager.addClientNotification({title:n,description:t,cloudName:pt,status:i,timestamp:new Date})},n})();t.DashboardHelperImpl=ei;oi=(function(){function n(n,t,i,r,u,f){this.currentDashboardId=er("");this._privateRepo=n;this._topbarWidget=t;this._lifetime=i;this._helper=r;this._compressor=u;this._storage=f;this._otherRepos=[];this._isStartboardChanging=!1;this._isMigrated=!1;this._armDashboardCache=[]}return n.prototype.resetLayout=function(n){var t=this._helper,i=e.normalizedDashboard(ht.environment.defaultDashboard||{}),r=this._compressor.uncompress(st.defaultTitle,i);t.clearStartboard(n);t.renderStartboard(n,r.settings,!1,!0)},n.prototype.isCurrentDashboardShared=function(){var n=this._findOwningRepo(this._curDashboard.id);return n&&n.getTypeName()===s.ArmDashboardRepository},n.prototype.
isCurrentDashboardWritable=function(){return this._isWritable(this._curDashboard.id)},n.prototype.getCurrentDashboardProperties=function(){var n=this._curDashboard,t=this._findOwningRepo(n.id);return t&&t.getDashboardProperties?t.getDashboardProperties(n):{id:n.id,title:n.title}},n.prototype.initialize=function(n,t,r,u,e){var o=this,h,s;return this._startboard=n,this._registerEventHandlers(this._lifetime),h=i.isFeatureEnabled("addsessiondashboardrepository")?i.require("MsPortalImpl/UI/Dashboard/SessionDashboardRepository").then((function(n){var t=new n.SessionDashboardRepository(o._storage);o.addRepository(t)})):Q(),s=h.then((function(){return t?(o._isMigrated=!0,o._initDashboard(t,e)):o._migrateStartboard().then((function(){return e.dashboardMigration=ht.getTimestamp(),r?o.switchDashboard({id:r,title:r},"DeepLinkAfterMigration"):Q()}))})).then((function(){e.dashboardInitialized=ht.getTimestamp();(f.isDashboardRoute()||f.isDashboardUri()&&!t)&&ct(o._curDashboard,!0)})).catch((function(n){o._handleError(
n,"initializeDashboard")})).finally((function(){o._endDashboardRevealedTrace(u,"PortalLoad").then((function(){e.dashboardRevealed=ht.getTimestamp()}))})),s.finally((function(){o._preloading()})),s},n.prototype.addRepository=function(n){this._otherRepos.push(n)},n.prototype.readDashboardsForType=function(n){return this._getRepositoryByType(n).readDashboards()},n.prototype.startNewDashboard=function(){var n=this;return this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw ot(6,null,{action:ai});})).then((function(){return rt(n,!0),n._addToRecent(n._curDashboard)})).then((function(){return n._privateRepo.createDefaultDashboard()})).then((function(t){return n._setCurDashboard(t,!0),ct(t),n._isStartboardChanging=!0,n._helper.clearStartboard(n._startboard),n._isStartboardChanging=!1,n._startboard.save(),n._saveDashboard(n._curDashboard)})).then((function(){n._helper.enterOrganizeMode(!0)})).catch((function(t){n._handleError(t,"startNewDashboard")})).finally((function(){rt(n,!1)}))},n.
prototype.saveCurrentDashboard=function(){var n=this;return this._saveDashboard(this._curDashboard).catch((function(t){n._handleError(t,"saveCurrentDashboard")}))},n.prototype.cloneCurrentDashboard=function(n){var t=this;return n===void 0&&(n=!0),this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw ot(6,null,{action:vi});})).then((function(){return t._isStartboardChanging=!0,rt(t,!0),t._collectDashboardSettings(n,!0)})).then((function(n){return t._addToRecent(t._curDashboard).then((function(){return n}))})).then((function(n){return t._privateRepo.cloneDashboard(n,t._curDashboard.title)})).then((function(n){return ct(n),t._loadDashboard(n,!1,!0)})).then((function(){t._helper.enterOrganizeMode()})).catch((function(n){t._handleError(n,"cloneCurrentDashboard")})).finally((function(){t._isStartboardChanging=!1;rt(t,!1)}))},n.prototype.deleteCurrentDashboard=function(){var n=this,t="deleteCurrentDashboard";return this._isStartboardChanging=!0,rt(this,!0),this._readNextDashboards(1).
then((function(n){if(n.length<=0)throw ot(2);return n[0]})).then((function(i){return n._deleteDashboard(n._curDashboard).catch((function(i){return n._handleError(i,t)})).then((function(){return i}))})).then((function(t){return ct(t,!0),n._loadDashboard(t)})).catch((function(i){n._handleError(i,t)})).finally((function(){n._isStartboardChanging=!1;rt(n,!1)}))},n.prototype.restoreCurrentDashboard=function(){var n=this;return this._isStartboardChanging=!0,rt(this,!0),this._loadDashboard(this._curDashboard).catch((function(t){n._handleError(t,"restoreCurrentDashboard")})).finally((function(){n._isStartboardChanging=!1;rt(n,!1)}))},n.prototype.switchDashboard=function(n,t){var i=this,r=at(this._curDashboard,n),u;return(ct(n,r),r)?Q():(u=wt("DashboardRevealed"),rt(this,!0),Q(this._switchDashboard(n,!1)).finally((function(){rt(i,!1);i._endDashboardRevealedTrace(u,t)})))},n.prototype._endDashboardRevealedTrace=function(n,t){var i=this._curDashboard.id;return Q.allSettled(this._startboard.children.map((function(n){return Q(
n.awaitComposed()).then((function(){return n.awaitOnInputsSetComplete()})).then((function(){return n}),(function(){return n}))}))).then((function(r){bt(n,{success:!0,dashboardId:i,parts:r.map((function(n){var t=n.value;return{name:t.locator.toFriendlyString(),visible:ut.isElementFullyInViewport(t.widget.element[0]).fullyVisible}})),interactionSource:t})}))},n.prototype.populateQuickDashboards=function(n){var t=this;return this._readNextDashboards(rr,(function(i){i=t._curDashboard.id?[t._curDashboard].concat(i):i;n(i)}))},n.prototype.shareCurrentDashboard=function(n,t,i){var r=this,u=this._curDashboard;return rt(this,!0),this.shareCurrentDashboardToArm(n,t,i).then((function(n){return ct(n,!0),r._switchDashboard(n,!0)})).then((function(){return r._deleteDashboard(u)})).finally((function(){rt(r,!1)}))},n.prototype.unshareCurrentDashboard=function(){var n=this,i="unshareCurrentDashboard",t=this._curDashboard;return this._privateRepo.canCreateNewDashboard().then((function(t){if(t)return Q();var r=ot(6,null,{action:
yi});n._handleError(r,i);throw r;})).then((function(){return rt(n,!0),n._shareCurrentDashboard(s.PrivateDashboardRepository,t.title)})).then((function(t){return ct(t,!0),n._switchDashboard(t)})).then((function(){return n._deleteDashboard(t)})).finally((function(){rt(n,!1)}))},n.prototype.shareCurrentDashboardToArm=function(n,t,i){var r=this,u=wt(ci.DashboardPublishNew);return this._shareCurrentDashboard(s.ArmDashboardRepository,n,{subscriptionId:t,resourceGroupName:i}).then((function(n){return bt(u,{success:!0,dashboardId:n.id}),n})).catch((function(f){bt(u,{success:!1});var e=ot(7,f,{dashboardId:r._curDashboard.id,dashboardTitle:n,subscriptionId:t,resourceGroupName:i});r._handleError(e,"shareCurrentDashboardToArm");throw e;}))},n.prototype.shareCurrentDashboardToSession=function(n){var t=this;return this._shareCurrentDashboard(s.SessionDashboardRepository,n).catch((function(i){var r=ot(7,i,{dashboardId:t._curDashboard.id,dashboardTitle:n});t._handleError(r,"shareCurrentDashboardToSession");throw r;
}))},n.prototype._registerEventHandlers=function(n){var t=this,u=this._startboard,y=this._topbarWidget.element,w=this._topbarWidget.options,o=u.widget,i=o.element,s,h,e,c,l,v,f;u.setGetDashboard((function(){return $.extend({},t._curDashboard)}));ko.reactor(n,(function(){var n,i,r;t.currentDashboardId();n=cr(t._curDashboard);i=hr(n&&n());i&&(r=st.filterButtonTextFormat.format(i),o.options.filterButtonText(r))}));s=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()};i.on(g.fxstartboardsettingchanged,s);h=function(n,i){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&i.part.getCompositionType()===dt.StartboardPart&&t._notifyDashboardChanged()};i.on(p.fxreplacedpartcomposing,h);e=function(n,i){var r,u,f;n.stopPropagation();r=i.part;r.getCompositionType()===dt.StartboardPart&&(u=r.getViewModel(),u&&!u.container.operations.inProgress.peek()&&(f=t._privateRepo.identifyDashboard(t._curDashboard.id),(w.
dashboardVisible()||f)&&t._notifyDashboardChanged()))};i.on(d.fxpartsettingchanged,e);i.on(k.fxpartinputchanged,e);c=function(n){n.stopPropagation();var i=o.options;i.title().length===0&&(u.services.desktop.mode(1),i.title(st.untitled));t._notifyDashboardChanged()};i.on(ft.fxstartboardtitlechanged,c);l=function(n,i){if(n.stopPropagation(),w.dashboardChanged(!1),!u.notFound()){var r=et.FinishDashboardEditAction;switch(i.action){case r.Save:t.saveCurrentDashboard();break;case r.SaveACopy:t.cloneCurrentDashboard(!1);break;case r.Discard:t.restoreCurrentDashboard()}}};y.on(et.fxfinishdashboardedit,l);v=function(n){n.stopPropagation();t._migrateStartboard()};i.on(ft.fxmigratestartboard,v);f=o.options;f.refreshDashboardList=function(n){return t.populateQuickDashboards(n)};f.switchDashboard=function(n){return t.switchDashboard(n,"RecentList")};f.title.subscribe(n,(function(n){t._curDashboard.title=n}));u.notFound.subscribe(n,(function(n){f.notFound(n)}));a.selectedSubsUpdateTriggered.subscribe(n,
(function(){var n=r.Azure.getAllSubscriptions(kt.Rpc.Internal.client,pt),t=a.getSelectedSubscriptions(pt);Q.all([n,t]).spread((function(n,t){var i=n.length,r=t.length;f.subscriptionsInfo(r>=i?st.browseForAllSubs.format(i):st.browseForSelectedSubs.format(r,i))}))})).callback(null);n.registerForDispose((function(){u.removeGetDashboard();i.off(g.fxstartboardsettingchanged,s);i.off(p.fxreplacedpartcomposing,h);i.off(d.fxpartsettingchanged,e);i.off(k.fxpartinputchanged,e);i.off(ft.fxstartboardtitlechanged,c);i.off(ft.fxmigratestartboard,v);y.off(et.fxfinishdashboardedit,l)}))},n.prototype._notifyDashboardChanged=function(){if(!this._startboard.notFound()){var n=this._privateRepo.identifyDashboard(this._curDashboard.id);n?this.saveCurrentDashboard():this._topbarWidget.options.dashboardChanged(!0)}},n.prototype._setCurDashboard=function(n,t,i){var r,u,f,e;i===void 0&&(i=!1);n=n||{id:"",title:fr};n&&(u=n.settings,f=u&&u[vt],r=f&&f.dashboardModel);r=pi(r);e={model:ii(r.model),metadata:r.metadata};this.
_curDashboard={id:n.id,title:n.title,isWritable:t,model:e};this._startboard.widget.options.title(n.title);this._topbarWidget.options.dashboardWritable(t);this.currentDashboardId(n.id);this._startboard.notFound(i)},n.prototype._switchDashboard=function(n,t){var i=this;return this._isStartboardChanging=!0,this._addToRecent(this._curDashboard).then((function(){return i._loadDashboard(n,!1,t)})).catch((function(n){i._handleError(n,"switchDashboard")})).finally((function(){i._isStartboardChanging=!1}))},n.prototype._findOwningRepo=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first((function(t){return t.identifyDashboard(n)}))},n.prototype._getRepositoryByType=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first((function(t){return t.getTypeName()===n}))},n.prototype._readDashboard=function(n){var i=this,t=n.id;return ui(this._findOwningRepo(t)).then((function(n){return n.readDashboard(t)})).then((function(n){if(!n)throw new Error("It succeeded in reading dashboard '"+
t+"'. But the result is "+n+".");return n})).catch((function(r){throw ot(1,r,{dashboardId:t,dashboardTitle:n.title,initDashboardIdFromStore:i.initDashboardIdFromStore});}))},n.prototype._collectDashboardSettings=function(n,t){var i=this,r=n?this._readDashboard(this._curDashboard):Q(null);return r.catch((function(){return null})).then((function(n){return n?n.settings:i._helper.collectDashboardSettings(i._startboard)})).then((function(n){return t?sr(n):n}))},n.prototype._saveDashboard=function(n){var r=this,t=n.id,i=n.title;return this._collectDashboardSettings().then((function(n){return ui(r._findOwningRepo(t)).then((function(r){return r.updateDashboard(t,{settings:n,title:i})}))})).catch((function(t){throw ot(5,t,{dashboardId:n.id,dashboardTitle:i});}))},n.prototype._deleteDashboard=function(n){var f=this,t=n.id,u,r;return i.remove(this._armDashboardCache,(function(n){return n.id.toLowerCase()===t.toLowerCase()})),u=wt(ci.DashboardDelete),r=!0,this._removeFromRecent(t).then((function(){var n=f._findOwningRepo(
t);return n.deleteDashboard(t)})).catch((function(i){r=!1;throw ot(4,i,{dashboardId:t,dashboardTitle:n.title});})).finally((function(){bt(u,{success:r,dashboardId:t})}))},n.prototype._readNextDashboards=function(n,t){var r=this;t||(t=function(){});var u=function(t,i){return t=i?e.filterDashboards(t,i):t,t.filter((function(n){return!at(n,r._curDashboard)})).slice(0,n)},f=a.getSelectedSubscriptions(pt).catch((function(){return[]})),o=this._privateRepo.getRecentDashboards().catch((function(){return[]}));return Q.all([f,o]).spread((function(f,e){var o=f.map((function(n){return n.subscriptionId}));return(e=u(e,o),e.length>=n)?(t(e),Q(e)):r._privateRepo.readDashboards().catch((function(){return[]})).then((function(f){var h=i.union(e,f,at);return(h=u(h),h.length>=n)?(t(h),h):(h=i.union(h,r._armDashboardCache,at),h=u(h,o),t(h),h.length>=n)?h:r._helper.readDashboardsOfMaxCount(r._otherRepos,n-h.length,h,(function(n,f){f===s.ArmDashboardRepository&&(r._armDashboardCache=n);h=i.union(h,n,at);h=u(h);t(h)})).then((function(
){return h}))}))}))},n.prototype._preloading=function(){var n=this;return this.readDashboardsForType(s.ArmDashboardRepository).then((function(t){n._armDashboardCache=t}))},n.prototype._isWritable=function(n){return ui(this._findOwningRepo(n)).then((function(t){return t.isDashboardWritable(n)})).catch((function(){return!0}))},n.prototype._addToRecent=function(n){return this._startboard.notFound()?Q():this._privateRepo.addToRecent(n).catch((function(){}))},n.prototype._removeFromRecent=function(n){return this._privateRepo.removeFromRecent(n).catch((function(){}))},n.prototype._loadDashboard=function(n,t,i,r){var u=this,e=n.id,o=i?Q(n):this._readDashboard(n),f=this._helper;return r=r||{},Q.all([this._removeFromRecent(e).then((function(){r.dashboardRemoveFromRecent=ht.getTimestamp()})),this._isWritable(e).then((function(n){return r.dashboardIsWritable=ht.getTimestamp(),n})),o.then((function(n){return r.dashboardRead=ht.getTimestamp(),n}))]).spread((function(n,i,r){u._setCurDashboard(r,i);f.clearStartboard(u._startboard);
f.renderStartboard(u._startboard,r.settings,t)})).catch((function(t){u._setCurDashboard(n,!0,!0);f.clearStartboard(u._startboard);u._startboard.save();throw t;}))},n.prototype._migrateStartboard=function(){var n=this,t=this._startboard.widget.options,i=c.NavBar.home;return this._helper.getStartboardReadyPromise().then((function(){return n._privateRepo.createDefaultDashboard(i)})).then((function(t){return n._setCurDashboard(null,!0),n._startboard.save(),n._saveDashboard(t).then((function(){return t}))})).then((function(i){t.headerMode(ft.HeaderMode.Normal);n._setCurDashboard(i,!0);n._startboard.save();n._isMigrated=!0})).catch((function(n){throw ot(3,n);}))},n.prototype._initDashboard=function(n,t){var i=this,r=this._startboard.widget.options;return r.headerMode(ft.HeaderMode.Normal),this._loadDashboard(n,!0,!1,t).then((function(){i._startboard.logChildren()}))},n.prototype._shareCurrentDashboard=function(n,t,i){var r=this._getRepositoryByType(n);return this._collectDashboardSettings(!0,!0).then((function(
n){return r.createDashboard({title:t,settings:n,extras:i})}))},n.prototype._handleError=function(n,t){var o=this,e=this._startboard.widget.options,r=this._helper,u=st.Notification.errorTitle,i=st.Error,f=function(n,i){lt.error(n,n.code,t+": "+i)},s=function(n){var u=n.data,i=u.dashboardId,f=u.dashboardTitle;lt.warning(n,n.code,t+": Failed to find dashboard '"+i);var r=o._findOwningRepo(i),s={id:i,title:f},h=r&&r.getNotFoundMessage?r.getNotFoundMessage(s):st.NotFound.defaultMessageFormat.format(f);e.notFoundMessage(h)},h=function(){r.popNotification(u,i.cannotDelete)},c=function(n){f(n,"Failed to migrate startboard.");e.headerMode(ft.HeaderMode.Migration)},l=function(n){var t=n.data;f(n,"Failed to delete dashboard '"+t.dashboardId+"'");r.popNotification(u,i.failToDeleteFormat.format(t.dashboardTitle,n.message))},a=function(n){var t=n.data;f(n,"Failed to save dashboard '"+t.dashboardId+"'.");r.popNotification(u,i.failToSaveFormat.format(t.dashboardTitle))},v=function(n){var f=n.data.action,
t="";switch(f){case ai:t=i.cannotCreate;break;case vi:t=i.cannotClone;break;case yi:t=i.cannotUnpublish}r.popNotification(u,t)},y=function(n){var t=n.data,e=t.dashboardId,o=t.dashboardTitle,s=t.resourceGroupName,h=t.subscriptionId;f(n,"Failed to publish dashboard '"+e+"'");r.popNotification(u,i.failToPublishFormat.format(o,s,h,n.message))},p=function(){lt.error(n,0,t);r.popNotification(u,i.unknown)};if(n instanceof ri)switch(n.code){case 1:s(n);break;case 2:h();break;case 3:c(n);break;case 4:l(n);break;case 5:a(n);break;case 6:v(n);break;case 7:y(n)}else p()},n})();t.DashboardManagerImpl=oi})(ot||(ot={})),ot}));define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","f","i","o","../Extension/Extension.Definition.Locator","../Base/Telemetry","./UI.DesktopManager"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function a(n,t){o.isTraceEnabled&&w.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(n,t.toString(),ko.toJSON(t.getInputsOnlyViewModel())))}function b(
n,t){return new s(n,t)}var v=f.LocatorType,y=r.Extension,h=i.Base.Diagnostics,p=h.Telemetry,c=i.Base.EventTypes,l=window,w=h.createLog(n),s;t.showConfirmDialog=l.confirm.bind(l);s=(function(){function n(n,t){var i=this;this._portalWidget=n;this._panoramaWidget=n.getPanorama();this._contextPane=t;this._portalWidget.element.on(c.fxautosettings,(function(n,t){i._autoOpenedBy=t}))}return u.defineProperty(n.prototype,"portalWidget",{get:function(){return this._portalWidget},enumerable:!0,configurable:!0}),n.prototype.composeJourney=function(n){n&&(n.compose(this._panoramaWidget),n.isStartedWithContextBlade()||this._portalWidget.showJourney())},n.prototype.composeStartBoard=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.addPartToStartBoard=function(n){n.compose(this._panoramaWidget.getStartBoardWidget())},n.prototype.addBlade=function(n,t){var u,i,r;return(a("Adding blade to desktop.",n),u=n.parent,i=u.blades,p.trace({action:"JourneyLength",source:e.Source.Desktop,data:{count:i.length,
blades:i.map((function(n){var t=n.locator;return{bladeName:t.name,extension:y.getWindowId(t.getExtensionLocator())}}))}}),n.flags&1)?this._contextPane.tryOpen(n).then((function(){})):(this._autoOpenedBy&&(r=n.masterContainer,r&&r.instanceId===this._autoOpenedBy.masterBladeId&&(t||(t={}),t.autoOpenedByBlade=this._autoOpenedBy.masterBladeId,t.autoOpenedByPart=this._autoOpenedBy.masterPartId),this._autoOpenedBy=null),n.compose(this._panoramaWidget.getJourneyWidget(),t),t&&t.focus&&n.awaitWidgetReadyToDisplay().done((function(){var i=n.containerWidget;i.element.trigger(c.fxensureviewportvisible,{widget:i,alignStart:t.alignToStart})})),Q())},n.prototype.removeBlade=function(n){a("Removing blade from desktop.",n);var t=this._contextPane;t.hasContent(n)?t.close(!0):this._panoramaWidget.removeChild(n.id)},n.prototype.removeAllBlades=function(n){var t=this._panoramaWidget.getJourneyWidget();t&&t.removeChildren(n);var i=this._contextPane,r=i.getContent(),u=r&&r.locator;u&&u.type===v.Blade&&i.close(!0)}
,n.prototype.showConfirmDialog=function(n){return!!t.showConfirmDialog(n)},n})();t.DesktopManagerViewImpl=s;t.create=b})(s||(s={})),s}));define("MsPortalImpl/Extension/ViewModelManager",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i,r){t[n]={name:n,modulePath:i,factory:r}}function o(n,t,i){r[n]={name:n,modulePath:t,factoryWithState:i}}function s(n,t,i){u[n]={name:name,modulePath:t,factoryWithPrefix:i}}function h(n,e,o){var s=null,h=null,c=i.Helpers.Deferred();return(e in t?(s=t[e].modulePath,h=t[e].factory):e in r&&(s=r[e].modulePath,h=function(n){return r[e].factoryWithState(n,o)}),f(u,(function(t,i){e.startsWith(t)&&(s=i.modulePath,h=function(t){return i.factoryWithPrefix(t,o,e,n)})})),s)?(i.require(s).then((function(n){c.resolve(h(n))}),(function(n){c.reject(n.message)})),c.promise()):null}var t={},r={},u={},f=i.forEachKey;n.register=e;n.registerWithState=o;n.registerPrefix=s;n.resolve=h})(r||(r={})),r}));define("MsPortalImpl/UI/UI.DesktopManagerImpl",
["require","exports","f","o","../Base/Base.Events","../Base/Base.Router","../Extension/DefinitionPreprocessor","../Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.Settings.Schema","../Services/Services.EditScopeManagement","../Base/Telemetry","./Compositions/UI.Composition","./Compositions/UI.Composition.Base","./Compositions/UI.Composition.JourneySettingSerializer","./Compositions/UI.Composition.Part","./Compositions/UI.Composition.StartBoard","./Compositions/UI.Composition.StartboardPart","./Dashboard/DashboardManager","./UI.DesktopManager","./UI.DesktopManagerView","../Extension/ViewModelManager","./Compositions/UI.Composition.Base"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){"use strict";var tt;return (function(t){function pt(n,t,i,r){return ot.startTrace({source:n,action:t,name:i,assetType:r})}function ei(){return st("MsPortalImpl/UI/UI.Desktop.Actions")}function dr(n,t){var i=g.create(n,t.contextPane);return new
si(i,t)}function gr(){return null}function nu(n,t){var i=[],r={},u=ar[a.CompositionType.StartboardPart];return br(n,(function(n,t){var f=w.isStartboardPartKey(n),e=ri(n,u+"-"+dt)||ri(n,u+"-"+gt);!f||e?r[n]=t:i.push(n)})),i.length&&t.deleteSettings({store:4,keys:i}),r}function tu(n){var t=n[h.startBoardSettingsKey]||{},i=t.dashboardId;return!i?null:{id:i,title:t.dashboardTitle||s.NavBar.home}}function ur(n,t,i){if((i===void 0&&(i=wr),!i)||!t)return n;if(n){var r=t.toLowerCase(),u=(n.id||"").toLowerCase()===r;return u?n:{id:r,title:r}}return null}function oi(n,t){n.removeChild(t,!1,!t.dontSetupWidget)}function fr(n){return n&&n.locator&&n.locator.toFriendlyString()}function iu(t){var r=hr.composePartViewModel,u=nt.registerWithState,f=n.normalize("./UI.BladeLauncher"),i;u("Shell$BladeLauncherViewModel",f,(function(n,t){return r((function(i){return new n.BladeLauncher(i,t)}),{initialState:t,createSelectable:!0,logArea:f})}));i=n.normalize("./UI.AssetBladeLauncher");u("Shell$AssetBladeLauncherViewModel",
i,(function(n,u){return r((function(i){return new n.AssetBladeLauncher(i,u,t)}),{initialState:u,createSelectable:!0,logArea:i})}))}function ru(n,t,i,r){var u,f="Unable to replace part '"+(n&&n.toString())+"', ";return n&&t?n.isDisposed()?u=f+"it has already been disposed.":n.getPartsContainer()?n.widget&&n.parent&&n.parent.widget||(u=f+"the part or its parent have not been composed."):u=f+"it is not a child of a PartsContainerComposition.":u="Replace part requires a part and a new locator.",u&&r&&r(u),!!u==!1}var er=o.Locator,ht=o.LocatorType,wt=FxImpl,ct=wt.Extension,or=ct.CloudName,sr=wt.TriggerableLifetimeManager,hr=wt.ViewModels.Part,rt=i,et=rt.Base,hi=et.Constants,ci=hi.ExtensionNames,bt=ci.Hubs,li=et.Diagnostics,cr=li.Telemetry,kt=et.EventTypes,ai=et.Utilities,vi=ai.Internal.Serialization,yi=rt.Parts.PartSize,lr=rt.ViewModels.Dialogs.MessageBoxButtons,ar=a.CompositionType,tt=d.DesktopManagerEvents,pi=c.EditScopeState,ut=rt.Helpers,vr=o.DefinitionFinderImpl,wi=i.deepEquals,bi=i.getUniqueId,
dt="AssetBladeLauncher",gt="BladeLauncher",ni=window,v=li.createLog(n),lt=l.Source.Desktop,at=l.Action,vt=s.Desktop,it={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."},ti=h.desktopSettingsKey,ot=cr,yr=ni.fx.environment,ii=8,pr=4,wr=yr.features.deeplinkdashboard==="true",br=rt.forEachKey,ri=rt.startsWith,st=rt.require,ft=ko.observable,kr=ko.observableArray,ki=er.forExtension,di=tt.journeyDeactivated,gi=tt.journeyActivated,nr=tt.journeyDiscarded,ui=tt.journeyCreated,tr=tt.settingsLoaded,ir="./Compositions/UI.Composition.Journey",rr="./Compositions/UI.Composition.Blade",fi="BladePairManager",yt=ko.toJSON,si;t.organizeModeModules={dragDrop:"MsPortalImpl/UI/UI.DragDropCompositionManager"};t.createDesktopManager=dr;t.getCurrent=gr;t.resolveInitialDashboard=ur;si=(function(){function o(n,t){var i=this;this._savedJourneys=[];this._previousActiveJourney="";this.
_startboardPartsLoadedDeferred=Q.defer();this._loadedStartBoardPartIds={};this._mode=ft(0);this._lifetime=new sr;this._hubsCloudName=ct.getHubsCloudName();this._dashboardMgrDeferred=Q.defer();this.activeJourney=ft(null);this.cachedJourneys=new et.LruMap;this.cachedJourneysCapacity=10;this.commandsEnabled=ft(!0);this._loadingJourneyGuid=null;this._view=n;this._services=t;this._initDeferred=ut.Deferred();this._sharedSettings=t.settings;this._portalServices=t;iu(this._services.assetTypeService);$(this).on([di,gi,nr,ui,tr].join(" "),(function(){i.populateJourneysInJourneysMenu()}))}return o.prototype.startBoardPartsLoaded=function(){return Q.isFulfilled(this.getStartboardPartsLoadedPromise())},o.prototype.getStartboardPartsLoadedPromise=function(){return this._startboardPartsLoadedDeferred.promise},r.defineProperty(o.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),r.defineProperty(o.prototype,"isJourneyLoading",{get:function(){return this._loadingJourneyGuid!==
null},enumerable:!0,configurable:!0}),o.prototype.initialize=function(n,i,r){var u=this;this._setupOrganizeModeComponents(t.organizeModeModules);this._extensionsMetadata=n;this._services.assetManager.onAssetDeleted((function(n,t,i,r){ei().then((function(f){f.handleAssetDeleted(u,n,t,i,r)}))}));var s=k.startTrace("DashboardRevealed"),o=f.getDashboardIdFromUri(),e=this._dashboardMgr=k.create({services:this._services,lifetime:this._lifetime});return i.then((function(n){r.startboardSettingsLoaded=ni.fx.getTimestamp();var t,h=n&&n[ii]||{},i=n&&n[pr]||{},f=tu(i);return(r.dayZero=!i[ti])?(u._startBoard=w.create(u._createCompositionServices()),u._view.composeStartBoard(u._startBoard),u._populateStartBoardFromManifests().then((function(){u._startboardPartsLoadedDeferred.resolve()})),u._initDeferred.resolve()):(t=ur(f,o),u.load(h,i,t&&t.id)),e.initDashboardIdFromStore=f?f.id:"",e.initialize(u._startBoard,t,o,s,r).finally((function(){r.dashboardManagerInitialized=ni.fx.getTimestamp();u._dashboardMgrDeferred.
resolve(e);u._initDeferred.resolve()}))})),Q(this._initDeferred.promise())},o.prototype.resetStartBoard=function(n){var t=this,i;return i=n?Q(6):this._services.getService("DialogManager").then((function(n){return n.showModalDialog({title:s.Startboard.resetConfirmationTitle,description:s.Startboard.resetConfirmationText,buttons:lr.YesNo})})),i.then((function(n){var r,i;if(n===6){for(r=t.startBoard.children,i=r.length-1;i>=0;i--)t.removeTile(r[i].id,!0);t._populateStartBoardFromManifests()}}))},o.prototype._populateStartBoardFromManifests=function(){var n=this,t;return this._dashboardMgr.resetLayout(this._startBoard),this.save(),t=this._services.extensionManager.getExtensions().map((function(t){var r=n._extensionsMetadata.first((function(n){return ct.isEqualDescriptor(n,t)})),i=r.startBoardParts;if(r.isTestExtension||i&&i.length)return t.getManifestAsync().then((function(t){n._addStartBoardPartsFromManifest(t,i);n.save()}))})).filter((function(n){return!!n})),Q.allSettled(t)},o.prototype._getExtensionEmailAddress=
function(n){var t=this._extensionsMetadata.first((function(t){return t.name===n}));return t&&t.feedbackEmail},o.prototype.getCurrentBladeInfo=function(){var n=this._getBreadCrumb(),i=this._getExtensionEmailAddress(bt),r=n[n.length-1],t=r&&r.extensionName||"",u=t?this._getExtensionEmailAddress(t):i;return{extensionName:t,feedbackTo:u,feedbackCC:i,breadcrumb:n.map((function(n){return n.title})).join(" > ")}},o.prototype._getBreadCrumb=function(){var t=this.getActiveJourney(),n;return t?(n=t.children,!n||!n.length)?[]:n.map((function(n){return{title:n.isDefaultTitle()?n.id:n.title(),extensionName:n.locator.getExtensionLocator().name,id:n.id}})):[]},o.prototype.createJourney=function(t,i,r){var u=this,e=this._startBoard.children.first((function(n){return n.id===t})),f;return e?(f=ut.Deferred(),r||(r=bi(),this._loadingJourneyGuid=r,this._createNewJourneyPromise=f.promise()),f.promise().finally((function(){u._loadingJourneyGuid===r&&(u._loadingJourneyGuid=null,u._createNewJourneyPromise=null)})),e.awaitComposed(
).then((function(){if(u.tryDeactivateJourney(r)){$(u).trigger(tt.journeyCreating,i);var t=u._createCompositionServices(),o=pt(lt,at.JourneyOpened,fr(e)),s=t.getService(fi);st(ir,n).then((function(r){return s.then((function(s){return u.setActiveJourney(r.create(t,s,e)),st(rr,n).then((function(n){var e=n.create(t,s,i,u._startBoard),r=u._activeJourney;r.addChild(e);u._view.composeJourney(r);u._startBoard.detailContainers=[e];u._view.addBlade(e,{assetType:i.originAssetType,focus:!0,reusableWidget:i.reusableWidget}).catch((function(n){v.error(n)}));u._savedJourneys=u.getJourneysJson();u.cachedJourneys.getOrAdd(r.id,(function(){return!0}));u._trimSavedJourneys();u._triggerActiveJourneyChanged();u.save();f.resolve(r);$(u).trigger(ui);ot.completeTrace(o);Q.nextTick((function(){u._savedJourneys=u.getJourneysJson();u.save()}))}))}))})).catch((function(n){f.reject(n)}))}else f.reject("tryDeactivateJourney returned false")})),f.promise()):(v.error(it.noTileInDesktop.format(t)),v.verbose(yt(this.getDiagnosticsData(
),null,2)),ut.Deferred().reject())},o.prototype.createJourneyForBlade=function(n,t){return this._createJourneyWithHiddenPart(bt,gt,n,t,gt,this._hubsCloudName,n.cloudName,n.defaultMenuItemId)},o.prototype.createJourneyForAsset=function(n,t,i){var u=n.extension,r=n.assetType;return this._createJourneyWithHiddenPart(bt,dt,{extensionName:u,assetType:r,assetId:i},t,dt,this._hubsCloudName,n.cloudName,n.defaultMenuItemId,r)},o.prototype._createJourneyWithHiddenPart=function(n,t,i,r,u,f,e,o,s){var h=this,a,v,c,l;return this._loadingJourneyGuid!==r?Q():(a=pt(lt,at.JourneyOpened,u,s),or.addToModel(e,i),v=ki(n,f).withPartType(t),c=this.addPartToStartBoard({originPartLocator:v,model:i,defaultMenuItemId:o,reuseExistingPart:!1,dontSetupWidget:!0}),c.isComposed&&c.isSelected()&&this._activeJourney&&this._activeJourney.originTile===c?(this.portalWidget.showJourney(),l=Q()):l=c.selectOnReady((function(){return h._loadingJourneyGuid!==r?!1:!c.isSelected()&&h.tryDeactivateJourney(r)}),{timeoutInMilliseconds:
9e4}).then((function(n){n&&(h._savedJourneys=h.getJourneysJson(),h.save(),$(h).trigger(ui),ot.completeTrace(a))})),l.finally((function(){h._loadingJourneyGuid===r&&(h._loadingJourneyGuid=null)})))},o.prototype.openSingleBlade=function(n,t){return this._openBlade(n,t,(function(n,i){return i===0&&n.locator.equals(t.locator)}))},o.prototype.openMultipleBlades=function(n,t){var u=this,i=ut.Deferred(),r;return t&&t.length!==0?(r=t.map((function(t){return u._openBlade(n,t,(function(n){return n.locator.equals(t.locator)&&t.model&&n.getViewModel()&&a.deepSubset(n.getViewModel(),t.model)}))})),$.when.apply($,r).done((function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];i.resolve(t)})).fail((function(){i.reject()}))):i.resolve([]),i.promise()},o.prototype.confirmBladesCanClose=function(n){var t=this,h=(n||[]).first((function(n){return!t.canCloseBlade(n)})),r,u,f,e,o,s;return h?(u=this.activeJourney(),f=[],n.forEach((function(n){var i=t._findFirstItemIndex(u.children,n,it.noBladeInJourney.format(
n));f.push(u.children[i])})),e=[],i.pushUnique(e,i.mapMany(f,(function(n){return t._getAlertMessageRecursive(n)}))),o=e.join("\n"),r=this._view.showConfirmDialog(o||vt.confirmEditScopeDiscard),s=this._getBreadCrumb().some((function(n){return n.extensionName===ci.Marketplace||n.id===hi.BladeNames.Hubs.CreateHubBlade})),r&&this._activeJourney&&s&&this.portalWidget.element.trigger(kt.fxcreateabandoned,JSON.stringify(this.getCurrentBladeInfo())),r):!0},o.prototype.forceCloseBlade=function(n,t,i){var e,r,u=this._activeJourney,f,o,s;if(!u)throw new Error(it.noActiveJourney);e=this._findFirstItemIndex(u.children,n,it.noBladeInJourney.format(n));r=u.children[e];this._startBoard.detailContainers.length===1&&this._startBoard.detailContainers[0].id===r.id?this.forceDiscardJourney(u.id,t):(f=r.masterContainer,f&&(o=f.detailContainers,s=o.indexOf(r),s>=0&&(o.splice(s,1),i&&i.openBlade||f.onDetailContainersChanged())),this._closeBladeRecursive(r,e,t),r.pairManager().update(u.blades,!!i&&!!i.openBlade));this.
_triggerActiveJourneyChanged();this.save()},o.prototype.tryCloseBlade=function(n,t){var i=this.confirmBladesCanClose([n]);return i&&this.forceCloseBlade(n,t),i},o.prototype.closeChildBlades=function(n){var i=this.discardEditsOfBlade(n,{includeSelf:!1,includeDescendants:!0}),t;if(i.successful)for(t=n.detailContainers.length-1;t>=0;t--)this.forceCloseBlade(n.detailContainers[t].id,1);return i},o.prototype.discardEditsOfPart=function(n,t){var i=n.getPartsContainer();return this._discardEditsOfContainer(i,t.force,(function(r){var o=r.path,c=n.journeyPath,f=i.journeyPath,s=wi(o,c),h=!1,u,e;if(!s&&o.length>f.length){try{u=ai.parseSortedString(r.path[f.length])}catch(l){v.error("Failed to parse journey path segment for blade '{0)'. Path: '{1}'. Error: '{2}'.".format(i.toString(),JSON.stringify(f),l.message))}h=u&&u.master&&u.master.part===n.id}return e=r.value,e&&e.editScope&&(t.includeSelf&&s||t.includeDescendants&&h)}))},o.prototype.discardEditsOfBlade=function(n,t){return this._discardEditsOfContainer(
n,t.force,(function(i){var r=i.value,u=i.path,f=n.journeyPath,e=wi(u,f),o=!e&&(r.type===ht.Blade||u.length>=f.length+2);return r&&r.editScope&&(t.includeSelf&&e||t.includeDescendants&&o)}))},o.prototype._discardEditsOfContainer=function(n,t,i){var o=this,u=[],s=n,h=n instanceof w.Instance||s.isInitialized,r={confirmationRequired:!1,successful:!1},e=this._activeJourney,f;if(!e)throw new Error(it.noActiveJourney);return f=e.ambientSettings,h&&(u=f.getItemsInPath(n.journeyPath).filter(i)),r.confirmationRequired=!t&&u.filter((function(n){var t=n.value.editScope;return t.dirty&&!t.saving})).length>0,(!r.confirmationRequired||this._view.showConfirmDialog(vt.confirmEditScopeDiscard))&&(r.successful=!0,u.forEach((function(n){f.removeItem(n.path);o._services.editScopeManager.onEditScopeDisposed(n.value.editScope.editScopeId)}))),r},o.prototype.canCloseBlade=function(n){var t=this._activeJourney,r=this._findFirstItemIndex(t.children,n,it.noBladeInJourney.format(n)),u=t.children[r],i=function(n){if(n.shouldAlertOnClose(
)||n.isInitialized&&!n.children.some((function(n){return n.children.some((function(n){return n.suppressAlert()}))}))&&t.ambientSettings.getItemsInPath(n.journeyPath).some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving})))return!0;var r=n.detailContainers;return!r||r.length===0?!1:(r||[]).some((function(n){return i(n)}))};return!i(u)},o.prototype.addPartToStartBoard=function(n){var i,t,r,u,f,e;if(!n){v.error("options should be specified for adding a part to the startboard.");return}if(!n.originPartLocator){v.error("options.originPartLocator should be specified for adding a part to the startboard.");return}return i=this._createCompositionServices(),r=n.model,n.reuseExistingPart!==!1&&(t=this._startBoard.children.first((function(t){return t.matchesLocatorAndModel(i.finder,n.originPartLocator,r,n.defaultMenuItemId)}))),t||(t=b.create(i,n.originPartLocator,r,{modelContainsSensitiveData:n.modelContainsSensitiveData}),t.dontSetupWidget=!!n.dontSetupWidget,u=n.defaultMenuItemId,
u&&(t.defaultMenuItemId=u),yi[n.initialSize]&&(t.initialSize=n.initialSize,n.initialSize===yi.Custom&&(t.initialHeight=n.initialHeight,t.initialWidth=n.initialWidth)),f=t.id,e=this._isStartBoardPartLoaded.bind(this),e(f)||(e(f,!0),this._startBoard.addChild(t,undefined,!t.dontSetupWidget),this._view.addPartToStartBoard(t),t.save(),this.save())),t},o.prototype.pinMultipleParts=function(n,t,i,r){var u=this,f=this._createCompositionServices();return ei().then((function(e){return e.pinMultipleParts(u,f.finder,n,t,i,r)}))},o.prototype.removeTile=function(n,t){var o=this._startBoard,i=o.children.first((function(t){return t.id===n})),r,u,f;if(i){r=void 0;u=this._activeJourney;u&&u.isStartedWithContextBlade()&&u.originTile===i?r=u.id:(f=this.getJourneysJson().first((function(n){return n.originPartId===i.id})),r=f&&f.id);var e=i.editScopeId()&&this._services.editScopeManager.getStateObservable(i.editScopeId()),h=!e||e()===pi.NotDirty||e()===pi.DirtyAndSaving,c=!r||this._canDiscardJourney(r),s=t||h&&c;
(s||this._view.showConfirmDialog(vt.confirmEditScopeDiscard))&&(r&&this.forceDiscardJourney(r),i.clearIdentitySettings(),oi(o,i),s||i.dontSetupWidget||v.warning("Part '{0}' is removed from the start board.".format(i)),this.save())}},o.prototype.replacePart=function(n,t,i){var o=this,u=n&&n.id,r,s=this.getJourneysJson().first((function(n){return u===n.originPartId})),h=this._createCompositionServices(),f=ut.Deferred(),c=!0,l,v,e;return i=i||{},ru(n,t,i.newPartContainerModel,(function(n){v=n}))?(n instanceof b.Instance?(r=b.create(h,t,i.newPartContainerModel,{id:u,doNotSaveSettings:i.doNotSaveSettings,overridesModel:i.newPartOverridesModel}),e=n,r.dontSetupWidget=e.dontSetupWidget,c=!e.dontSetupWidget):r=p.create(h,t,u,i.newPartContainerModel,i.newPartOverridesModel),r.originalPartLocator=n.originalPartLocator||n.locator,l=n.getPartsContainer(),n.dispose(!0),n.parent.replaceChild(n,r),r instanceof b.Instance&&s?this.tryDiscardJourney(s.id):l.getPartsContainer().detailContainers.slice(0).reverse(
).forEach((function(n){n.masterPartId===u&&o.tryCloseBlade(n.id,1)})),r.widgetState(n.widgetState()),r.save(),c?(r.widget=n.widget,r.recompose(n.parent.widget)):r.compose(n.parent.widget),r.widget.element.trigger(a.fxreplacedpartcomposing,{part:r}),r.awaitComposed().then((function(){f.resolve(r);!i.preventNewPartActivation&&r.partDefinition.details&&r.partDefinition.details.length>0&&r.selectOnReady((function(){return!o._activeJourney}),{timeoutInMilliseconds:15e3})}),(function(){f.reject("Unable to compose the mutated part.")}))):f.reject(v),f.promise()},r.defineProperty(o.prototype,"portalWidget",{get:function(){return this._view.portalWidget},enumerable:!0,configurable:!0}),o.prototype.getDashboardManager=function(){return this._dashboardMgrDeferred.promise},o.prototype.getSettingCollections=function(){var i={},r={},n=this._activeJourney,t=[];return i[ti]=JSON.parse(JSON.stringify(this)),t.push({store:4,settings:i}),n&&n.children&&(r[n.id]=JSON.parse(JSON.stringify(n)),t.push({store:ii,settings:
r})),t},o.prototype.dispose=function(){this._lifetime&&(this._lifetime.dispose(),this._lifetime=null);this._onShowStartBoard&&(this.portalWidget.element.off(kt.fxshowstartboard,this._onShowStartBoard),this._onShowStartBoard=null);this._sharedSettings&&(this._sharedSettings.dispose(),this._sharedSettings=null);$(this).off({journeyActivated:"journeyActivated",journeyDeactivated:"journeyDeactivated",journeyDiscarded:"journeyDiscarded",journeyCreated:"journeyCreated",settingsLoaded:"settingsLoaded"})},o.prototype.save=function(){var n=this;this._initDeferred.promise().finally((function(){n.getSettingCollections().forEach((function(t){n._services.settings.setSettings(t)}))}))},o.prototype.load=function(n,t,i){var r=this,s=this._createCompositionServices(),u=t[ti],f=!1,h,e,o;u&&u.startBoardId&&t[u.startBoardId]?(h=t[u.startBoardId],f=!!i,f&&(t=nu(t,this._sharedSettings)),this._startBoard=w.Instance.fromJSON(s,t,h)):(v.error("Unable to load StartBoard state from user settings, setting does not exist. Creating a default StartBoard."),
this._startBoard=w.create(s));this._savedJourneys=(u&&u.savedJourneyIds||[]).map((function(t){var i=n[t];if(i)try{i.ambientSettings=y.deserializeAmbientSettings(i.ambientSettings)}catch(r){v.error(r,0,"Unable to load state for saved Journey '{0}' from user settings.".format(t))}else v.verbose("Unable to load state for saved Journey '{0}' from user settings, setting does not exist.".format(t),0);return i})).filter((function(n){return n&&r.cachedJourneys.addOrUpdate(n.id,!0),!!n}));this._trimSavedJourneys();this._removeOrphanedStartboardParts();this._view.composeStartBoard(this._startBoard);f||this._initDeferred.resolve();e=this._view.portalWidget.element;o=kt.fxshowstartboard;e.on(o,this._onShowStartBoard=function(){var n=r._startBoard.children.slice();n.forEach((function(n){r._displayPartOnStartBoardIfAvailable(n)}));r._startBoard.discardWidgetStateOfUnusedChildren();r._startboardPartsLoadedDeferred.resolve();e.off(o,r._onShowStartBoard);r._loadingJourneyGuid=null});$(this).trigger(tr)},o.prototype.
_removeOrphanedStartboardParts=function(){var t={},n;this._savedJourneys.forEach((function(n){t[n.originPartId]=!0}));n=this.startBoard;n.children.slice(0).forEach((function(i){i.dontSetupWidget&&!t[i.id]&&oi(n,i)}))},r.defineProperty(o.prototype,"startBoard",{get:function(){return this._startBoard},enumerable:!0,configurable:!0}),o.prototype.getActiveJourney=function(){return this._activeJourney},o.prototype.setActiveJourney=function(n){this.activeJourney(n);this._activeJourney=n;this.portalWidget.hasActiveJourney=!!n;n&&u.isFullscreen()&&u.exitFullscreen()},o.prototype.getJourneysMetadata=function(){var t=[],i,r=!1,u=function(n,t){return n.id===t.id||n.originPartId&&n.originPartId===t.originPartId},n=this._activeJourney;return n&&(i=n.toJSON()),this._savedJourneys.forEach((function(f){if(i&&!i.firstBladeInContextPane&&u(i,f))t.push(n),r=!0;else{var e=kr(),o=f.bladeTitles;o&&o.forEach((function(n){var t={id:n.bladeId,title:ft(n.bladeTitle),icon:ft(),subtitle:ft("")};e.push(t)}));e().length&&
(e().first().flags|=f.firstBladeInContextPane?1:0);t.push({id:f.id,journeyBlades:e,ambientSettings:f.ambientSettings,lastModifiedTime:ft(f.lastModifiedTime)})}})),n&&!r&&t.push(n),t},o.prototype.populateJourneysInJourneysMenu=function(){var n=this._activeJourney,t=this.getJourneysMetadata().filter((function(t){var r=n&&n.id===t.id,i=t.journeyBlades().first();return i&&!(i.flags&1)&&!r})).sort((function(n,t){return t.lastModifiedTime()-n.lastModifiedTime()}));this.portalWidget.getTopBarWidget().options.journeysMenu.journeysMetadata(t)},o.prototype.getJourneysJson=function(){var u=this,i=this._savedJourneys.slice(0),t,r,n=this._activeJourney;return n&&!n.isStartedWithContextBlade()&&(n.originTile&&n.originTile.partState&&n.originTile.getViewModel()!==p.EmptyViewModel&&(n.originPartStateWhenActive=ko.toJS(n.originTile.partState)),t=n.toJSON(),r=i.firstIndex((function(n){var i=n.id;return i===t.id?!0:n.originPartId===t.originPartId?(u.cachedJourneys.remove(i),u._deleteJourneySettings(i),!0):!1})),
r>=0?i[r]=t:i.push(t)),i},o.prototype.getSavedJourneys=function(){return this._savedJourneys},o.prototype.setSavedJourneys=function(n){this._savedJourneys=n},o.prototype.generateLoadingJourneyGuid=function(){return this._loadingJourneyGuid=bi(),this._loadingJourneyGuid},o.prototype.tryDeactivateJourney=function(n){var t=this._activeJourney,r,i,u,f;if(t){if(!this.confirmBladesCanClose(t.children.map((function(n){return n.id}))))return!1;for(r=t.children.filter((function(n){return!n.isRestorable()})),i=r.length-1;i>=0;i--)this.forceCloseBlade(r[i].id);u=t.id;f=pt(lt,at.JourneyDeactivated,fr(t.originTile));this._savedJourneys=this.getJourneysJson();t.save();this._closeActiveJourney(!0);this.cachedJourneys.addOrUpdate(u,!0);this._trimSavedJourneys();this.save();$(this).trigger(di);ot.completeTrace(f)}else this._startBoard&&(this._startBoard.detailContainers=[]);return this._loadingJourneyGuid=n||null,!0},o.prototype.tryDiscardJourney=function(n){var t=!1;return(this._canDiscardJourney(n)||this.
_view.showConfirmDialog(vt.confirmEditScopeDiscard))&&(this.forceDiscardJourney(n),t=!0),t},o.prototype._triggerActiveJourneyChanged=function(){var n=this._activeJourney,t=n?JSON.stringify(n):"";this._previousActiveJourney!==t&&($(this).trigger(tt.activeJourneyChanged),this._previousActiveJourney=t)},o.prototype._trimSavedJourneys=function(){var t=this,n;this.cachedJourneys.trim(this.cachedJourneysCapacity);n=this._savedJourneys;n.length>this.cachedJourneysCapacity&&n.filter((function(n){return!t.cachedJourneys.contains(n.id)})).forEach((function(n){return t.forceDiscardJourney(n.id)}))},o.prototype._canDiscardJourney=function(n){var t=this.getJourneysMetadata().first((function(t){return t.id===n})),i=t&&t.ambientSettings.getItems().some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving&&t.disposeOnJourneyDiscard}));return!t||!i},o.prototype.forceDiscardJourney=function(n,t){var u=this._savedJourneys,i=u.first((function(t){return t.id===n})),f=!1,e,r,o;this.cachedJourneys.
remove(n);this._deleteJourneySettings(n);i&&(e=u.indexOf(i),u.splice(e,1),f=!0,this._activeJourney&&this._activeJourney.id===n||(r=i.originPartId&&this.startBoard.getChildById(i.originPartId),o=i.ambientSettings.getItems().reduce((function(n,t){var i=t.value,r=i&&i.editScope;return r&&n.push(r),n}),[]),this._disposeEditScopes(o),r&&r.dontSetupWidget&&this.removeTile(r.id)));this._activeJourney&&this._activeJourney.id===n&&(this.isJourneyLoading||this.portalWidget.showStartBoard(),this._closeActiveJourney(!1,t),f=!0);f&&(this._triggerActiveJourneyChanged(),this.save(),$(this).trigger(nr))},o.prototype._deleteJourneySettings=function(n){this._sharedSettings.deleteSettings({store:8,keys:[n]})},o.prototype._disposeEditScopes=function(n){var t=this;(n||[]).forEach((function(n){if(n.disposeOnJourneyDiscard)t._services.editScopeManager.onEditScopeDisposed(n.editScopeId)}))},o.prototype.activateJourney=function(n){var i=this,h=this._savedJourneys.first((function(t){return t.id===n})),t=ut.Deferred(),
f,e,u=this.generateLoadingJourneyGuid(),s=function(){i._journeySettingsPromise=f=i._services.settings.querySettings({store:ii});f.then((function(r){i._loadingJourneyGuid!==u?t.reject("Another journey started loading. Aborted loading journey '{0}'".format(n)):i._journeySettingsPromise!==f?t.reject("Aborted retrieval of settings for journey '{0}'.".format(n)):i._activateJourneyFromSettings(n,r,u).then((function(r){i._loadingJourneyGuid!==u?t.reject("Another journey started loading. Aborted loading journey '{0}'".format(n)):t.resolve(r)})).catch((function(n){t.reject(n)}))}))},r,o;return t.promise().finally((function(){i._loadingJourneyGuid===u&&(i._loadingJourneyGuid=null)})),r=this._activeJourney,o=r&&r.id,r&&o===n?(t.resolve(r),r.isStartedWithContextBlade()||this.portalWidget.showJourney()):h?r&&r.isStartedWithContextBlade()?this.tryDiscardJourney(o)?s():t.reject("Unable to discard current journey."):this.tryDeactivateJourney(u)&&s():(e="Unable to activate journey '{0}', not found in saved journeys.".
format(n),v.error(e),t.reject(e)),t.promise()},o.prototype._activateJourneyFromSettings=function(t,i,r){var u=this,s=this._createCompositionServices(),o=i&&i[t],f=ut.Deferred(),e,h,c;return o?(h=pt(lt,at.JourneyRehydrated,o.originPartId),c=s.getService(fi),st(ir,n).then((function(n){return c.then((function(c){var a,l;u.setActiveJourney(n.Instance.fromJSON(s,c,i,o,u._startBoard));u._activeJourney?($(u).trigger(tt.journeyActivating),u._view.composeJourney(u._activeJourney),a=u._activeJourney.children.slice(),a.forEach((function(n,t){var i=t===u._activeJourney.children.length-1;u._view.addBlade(n,{assetType:undefined,focus:i}).catch((function(n){v.error(n)}))})),l=u._activeJourney.originTile,l&&(u._displayPartOnStartBoardIfAvailable(l),l.notifyDetailBladesRehydrated(u._activeJourney.blades),l.awaitComposed().done((function(){if(u._loadingJourneyGuid===r||u._activeJourney&&u._activeJourney.id===t){var n=o.originPartStateWhenActive;vi.isSerializedObject(n)&&(n=vi.fromSerializableObject(n));l.loadState(
n)}}))),u._triggerActiveJourneyChanged(),u.save(),f.resolve(u._activeJourney),$(u).trigger(gi)):(e="Unable to activate journey '{0}', deserialization of journey settings failed.".format(t),v.error(e),f.reject(e));ot.completeTrace(h)}))})).catch((function(n){f.reject(n)}))):(e="Unable to activate journey '{0}', settings for this journey are not found in user settings.".format(t),v.error(e),f.reject(e)),f.fail((function(){u.forceDiscardJourney(t)})),f.promise()},o.prototype.toJSON=function(){var n={startBoardId:this._startBoard?this._startBoard.id:null,savedJourneyIds:(this._savedJourneys||[]).map((function(n){return n.id}))},i=this._activeJourney,t=i&&i.id;return t&&n.savedJourneyIds.indexOf(t)<0&&n.savedJourneyIds.push(t),n},o.prototype._addStartBoardPartsFromManifest=function(n,t){var r=this,i=n.startBoardParts,u=ki(n.name,n.cloudName);t||(t=i.map((function(n){return n.name})));i&&i.length&&t.forEach((function(n){var t=i.first((function(t){return t.name===n})),f;t&&(f=u.withStartboardPartInstance(t.
name),r.addPartToStartBoard({originPartLocator:f,initialSize:t.initialSize}))}))},o.prototype._createCompositionServices=function(n){var t=$.extend({},this._services);return t.finder=n||new vr(this._services.extensionManager),t.desktop=this,t.sharedSettings=this._sharedSettings,t},o.prototype._findPartContainer=function(n){var t,i=this._startBoard;if(i&&i.id===n)t=i;else if(this._activeJourney)t=this._findFirstItem(this._activeJourney.children,n,it.noBladeInJourney.format(n));else throw new Error(it.noActiveJourney);return t},o.prototype._openBlade=function(t,i,r){var e=this,f=this._findPartContainer(t),l=f instanceof w.Instance,o=ut.Deferred(),u,s,a=this._createCompositionServices(),h,c;return f?((f.detailContainers||[]).forEach((function(n,t){n.locator.equals(i.locator)&&n.masterPartId===i.masterPartId&&n.masterInvocationProperty===i.masterInvocationProperty&&r(n,t)&&(u=n,o.resolve(u))})),u?(c=u.containerWidget,c&&c.setFocus(),d.isTraceEnabled&&v.verbose("[DesktopManager] Found a previously opened detail blade."+
"\n  Existing blade: {0}. Model: {1}.".format(u.toString(),yt(u.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(yt(i)))):($(this).trigger(tt.bladeOpening,{masterContainerId:t,bladeDescriptor:i}),h=function(){if(l&&f.detailContainers.length===0)e.createJourney(i.masterPartId,i).finally((function(n){n&&n.children&&n.children.length>0?o.resolve(n.children[0]):o.reject()}));else{var t=a.getService(fi);st(rr,n).then((function(n){return t.then((function(t){u=n.create(a,t,i,f);f.detailContainers.unshift(u);f.onDetailContainersChanged();s=l?0:1+e._findFirstItemIndex(e._activeJourney.children,f.id,it.noBladeInJourney.format(f.id));e._activeJourney.addChild(u,s);e._view.addBlade(u,{assetType:i.originAssetType,alignToStart:!!(i.flags&8),index:s,reusableWidget:i.reusableWidget,focus:!i.reusableWidget}).catch((function(n){v.error(n)}));e._triggerActiveJourneyChanged();e.save();o.resolve(u)}))})).catch((function(n){o.reject(n)}))}},this._createNewJourneyPromise?this._createNewJourneyPromise.
always((function(){h()})):h())):o.reject(),o.promise()},o.prototype._closeBladeRecursive=function(n,t,i,r){this._removeBladesFromUIRecursive(n);this._disposeBladesRecursive(n,t,r);r||n.parent.save();r||$(this).trigger(tt.bladeClosed,{id:n.id,reason:i})},o.prototype._getAlertMessageRecursive=function(n){var t=function(n){var t=n.detailContainers,r;return t&&t.length!==0?(r=i.mapMany(t,(function(n){return n.getAlertOnCloseMessages()})),i.union(n.getAlertOnCloseMessages(),r)):n.getAlertOnCloseMessages()};return t(n)},o.prototype._removeBladesFromUIRecursive=function(n){for(var i=n.detailContainers,t=i.length-1;t>=0;t--)this._removeBladesFromUIRecursive(i[t]);this._view.removeBlade(n)},o.prototype._disposeBladesRecursive=function(n,t,i){var f=this,r=n.parent,u=r.children.indexOf(n,t);i?n.dispose(!0):r.removeChildAt(u,undefined);n.detailContainers.forEach((function(n){f._disposeBladesRecursive(n,u,i)}))},o.prototype._closeActiveJourney=function(n,t){var u=this,i=this._activeJourney,r;this.setActiveJourney(
null);this._startBoard.detailContainers=[];i&&(i.children.slice(0).forEach((function(i){i.isDisposed()||u._closeBladeRecursive(i,0,t,n)})),r=i.originTile,r&&r.dontSetupWidget&&!n&&this.removeTile(r.id),i.dispose(n));this._view.removeAllBlades((function(n){v.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(n))}))},o.prototype._findFirstItem=function(n,t,i){var r=this._findFirstItemIndex(n,t,i);return n[r]},o.prototype._findFirstItemIndex=function(n,t,i){var r=n.firstIndex((function(n){return n.id===t}));if(r===-1){v.verbose(yt(this.getDiagnosticsData(),null,2));throw new Error(i);}return r},o.prototype.pinPartComposition=function(n){this._startBoard.addChild(n);this._view.addPartToStartBoard(n);n.save();this.save()},o.prototype._isStartBoardPartLoaded=function(n,t){return typeof t=="boolean"?this._loadedStartBoardPartIds[n]=t:!!this._loadedStartBoardPartIds[n]},o.prototype._displayPartOnStartBoardIfAvailable=function(
n){var r=this,f=this._isStartBoardPartLoaded.bind(this);if(!f(n.id)){f(n.id,!0);var t=n.locator,i=t.getExtensionLocator(),u=function(t,i){if(v.warning(t.format(n)),i){var u=r._startBoard;oi(u,n);u.removeChildWidget(n.id)}},o=function(t,i){var f=!1;return t===0?(i||r._view.addPartToStartBoard(n),f=!0):t===1&&(u("[Definition Change] Part '{0}' is not working because it no longer exists in pre-loaded extension definition"),f=!0),f},s=function(i,f){(i.startBoardParts||[]).some((function(n){return n.name===t.name}))?f||r._view.addPartToStartBoard(n):u("[Definition Change] Part '{0}' is not working because it no longer exists in force-loaded extension definition.")};this._extensionsMetadata.some((function(n){return ct.isEqualDescriptor(n,i)}))?o(n.definitionExists(),n.isComposed||n.dontSetupWidget)||(this._view.addPartToStartBoard(n),t.type===ht.StartboardPartInstance?this._services.extensionManager.getManifestByName(i.name,i.cloudName).then((function(n){s(n,!0)})):this._services.extensionManager.
getExtensionByName(i.name,i.cloudName).then((function(n){var r=e.PinPrefix,u=t.name,f,i;if(ri(u,r))return f=u.substr(r.length),n.getBladeDefinition(f);for(i=t;i;i=i.parent)if(i.type===ht.Blade)return n.getBladeDefinition(i.name);if(t.type===ht.PartType)return n.getPartDefinition(t.name)})).then((function(){o(n.definitionExists(!0),!0)}))):u("[Definition Change] Part '{0}' will be removed because the extension it belongs to is no longer known by the portal.",!0)}},o.prototype.getDiagnosticsData=function(){var n=this._startBoard,t=this._activeJourney;return{startboard:n&&n.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}},o.prototype.getAssetDiagnosticsData=function(){var n=this._activeJourney;return n?ei().then((function(t){return t.dumpCompositionAssets(n)})):Q.resolve("No journey")},o.prototype._setupOrganizeModeComponents=function(n){var t=this,i=this._lifetime,r=i.createChildLifetime();this.mode.subscribe(r,(function(u){u===1&&rt.require(n.dragDrop).then((function(n){n.create(i,
t,t.portalWidget.element);r.dispose()}))}))},o})();t.DesktopManagerImpl=si})(tt||(tt={})),tt}));define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","f","o","../Interactions/Interactions.DismissHandler","../Widgets/Widgets.WidgetBase","../Widgets/Widgets.FlowLayout","../Widgets/Widgets.UIElementBase"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){function vt(n,i){var f=n.target,r=c(f),o;s&&s.htmlTarget!==f||(s={htmlTarget:f,elementObject:r,width:r.outerWidth(!1),height:r.outerHeight(!1)},s&&s.htmlTarget!==f)||(l=v=t=g(r.closest(tt),e.Widget),p.appendTo(r.parent()),o=p.parent(),i.helper.css({position:"fixed",top:i.offset.top,left:i.offset.left,marginTop:0-o.scrollTop(),marginLeft:0-o.scrollLeft(),pointerEvents:"none"}),r.hide(),b=h=d(i.helper),u.register(et,!0))}function yt(n,i){var r=s.elementObject,f=r.draggable("option","revert");u.unregister(et);f&&r.draggable({revert:!1});it();f?st():ot(i.helper);r.show();t?t===v?dt(i.helper):gt(i.helper):
kt();p.remove();ht()}function pt(){s.elementObject.draggable({revert:!0}).trigger(w.mouseup)}function wt(n,i){var r;(ot(i.helper),t)&&(r=d(i.helper),r.col!==h.col||r.row!==h.row)&&(it(),h=r,(l!==t||t.dropPlaceholder===null)&&(l&&l.disposeDropPlaceholder(),t.createDropPlaceholder(s.width,s.height),l=t),t.moveDropPlaceholder(r),y=rt.setTimeout((function(){y=null;s.elementObject.show();t.moveChild(s.elementObject,h.col,h.row,!1);s.elementObject.hide()}),lt))}function it(){y&&(rt.clearTimeout(y),y=null)}function ot(n){var i=bt(n);t&&t!==i&&st();t=i}function st(){t&&(it(),t.refreshLayout(!0))}function bt(n){var t=n.offset(),i=p.parent(),r=i.scrollTop(),u=i.scrollLeft(),f=t.left-u+Math.floor(k*a.GridSpacingWidth),o=t.top-r+Math.floor(k*a.GridSpacingHeight),s=c(document.elementFromPoint(f,o)),h=s.closest(tt);return g(h,e.Widget)}function d(n){var i=t.element,r=i.offset(),u=n.offset(),f=u.left-r.left+i.scrollLeft(),e=u.top-r.top+i.scrollTop(),o=Math.floor((f+k*a.GridSpacingWidth)/a.GridSpacingWidth),
s=Math.floor((e+k*a.GridSpacingHeight)/a.GridSpacingHeight);return{col:o,row:s}}function kt(){v.moveChild(s.elementObject,b.col,b.row,!0)}function dt(n){h=d(n);v.moveChild(s.elementObject,h.col,h.row,!0)}function gt(n){t.refreshLayout(!0);h=d(n);var i=o.Widget.getId,r=i(s.elementObject),u=v.element.closest(ft),f=t.element.closest(ft),e=i(u),c=i(f);t.element.trigger(w.fxrearrange,{partId:r,sourceId:e,targetId:c,col:h.col,row:h.row})}function ht(){l&&l.disposeDropPlaceholder();v=null;t=null;b=null;h=null;l=null;s=null}function ct(){var t=c(tt),n=[];return t.each((function(t,i){var r=g(c(i),e.Widget),u=r.options;u.allowReorder&&!u.locked()&&n.push(r.element.findByClassName("fxs-flowlayout-childcontainer"))})),n}var w=i.Base.EventTypes,a=i.Widgets.AzureGrid,rt=window,c=jQuery,g=f.Widget.getWidget,ut="fxs-drag-disableTouchAction",nt=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",tt=".fxs-flowlayout",ft=".fxs-lens",et={dismissFn:
function(){pt()},shouldDismissOnMouseDownFn:c.noop,shouldDismissOnMouseWheelFn:c.noop,logName:"flowlayoutdragdrop"},s,v,t,l,b,h,y,lt=250,k=.33,p=c("<div class='fxs-drag-surface'><\/div>"),at={start:vt,drag:wt,stop:yt,cursor:"move",helper:"clone",appendTo:p,opacity:.65,distance:3,cancel:"input,textarea,button,select,option,.fxs-tile-actionbar-contextmenu"},ni=(function(){function n(){if(n._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");n._singleton=this}return n.prototype.dispose=function(){this.disableDragDropTargets();ht();n._singleton=null},r.defineProperty(n,"Instance",{get:function(){return n._singleton||(n._singleton=new n),n._singleton},enumerable:!0,configurable:!0}),n.prototype.enableDragDropOnSingleTarget=function(n){n.draggable("instance")||n.filter(nt).addClass(ut).draggable(at)},n.prototype.enableDragDropTargets=function(){var n=this;ct().forEach((function(t){t.on(w.mouseenter,nt,(function(t){var i=c(t.currentTarget);if(i.draggable("instance")){i.draggable(
"option","handle",!1);return}n.enableDragDropOnSingleTarget(i)}))}))},n.prototype.disableDragDropTargets=function(){ct().forEach((function(n){n.off(w.mouseenter,nt)}));c(".ui-draggable:not(.ui-draggable-dragging)").removeClass(ut).draggable("destroy")},n})();n.FlowLayoutDragDrop=ni})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;-ms-touch-action:none;touch-action:none}.fxs-desktop-normal .fxs-hide-in-normal,.fxs-desktop-normal .fxs-portal-contextpane-left,.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay,.fxs-desktop-organize .fxs-sidebar,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-actions,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration{display:none}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay:hover{border-width:1px;border-style:solid;box-sizing:border-box}.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide.fxs-tile-selected .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-blade-locked .fxs-tile .fxs-tile-overlay:hover{border:none}.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}")})
);define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","f","o","../Base/Base.Events","../Interactions/Interactions.DismissHandler","../Interactions/Interactions.FlowLayoutDragDrop","../Widgets/Widgets.WidgetBase","../Widgets/Widgets.Tile","../../_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){function nt(n,i,r){var f=n.desktop,u=new l(f,i,n,r),v=function(n){var t=h(n.target).closest(k);return o.Widget.getWidget(t,s.Widget)},p=i.element,a=i.getPanorama().getStartBoardArea();p.on(t.fxexitorganizemode,(function(){f.mode(0)}));a.on(t.fxenterorganizemode,(function(n){var t=v(n),i=t?0:1;u.startPartManagment({trigger:i});t&&(t.options.selected(!0),u.updateTileSelection(t),t.showTileManagementContextMenu())}));a.on(t.click,b,(function(n){var i=v(n),t=i&&i.options;t&&!t.locked()&&(t.selected(!t.selected()),u.updateTileSelection(i))}));a.on(t.click,c,(function(n){if(f.mode()===1){var i=v(n),t=i&&i.options;!t||t.locked(
)||t.selected()||(t.selected(!0),u.updateTileSelection(i))}}));a.on(t.mouseenter,c,(function(n){var r,u,i;if(f.mode()!==1&&(r=v(n),u=r&&r.options,u&&!u.locked()&&!u.selected())){i=r.element;e.FlowLayoutDragDrop.Instance.enableDragDropOnSingleTarget(i);i.hasClass(y)&&i.draggable("option","handle",c);i.one(t.mouseleave,(function(){f.mode()!==1&&e.FlowLayoutDragDrop.Instance.disableDragDropTargets()}))}}));a.on(t.dragstart,d,(function(n){f.mode()!==1&&(f.mode(1),h(n.target).draggable("option","handle",!1));var t=v(n),i=t&&t.options;i&&!i.selected()&&(i.selected(!0),u.updateTileSelection(t))}));a.on(t.fxaddparts,(function(n,t){n.stopPropagation();t.expandTileGallery=!0;u.startPartManagment(t)}));a.on(t.fxpartcreated,(function(n,t){n.stopPropagation();var i=t.widget;i.options.selected(!0);u.updateTileSelection(i)}));return u}var p=i.Base,t=p.EventTypes,w=MsPortalImpl.Resources.Images,h=jQuery,a=o.Widget.widgetRemoveEvent,b="."+s.overlayClassName,k="."+s.widgetClassName,c="."+s.actionBarContainerClassName,
v="fxs-desktop-normal",y="ui-draggable",d="."+y,g="fxs-partgallery-container",l;(function(){var t=w.getFlowLayout().gridShadow,i=".fxs-desktop-organize .fxs-flowlayout-childcontainer {"+("background: url("+t+");")+"}",n=document.createElement("style");n.setAttribute("type","text/css");n.appendChild(document.createTextNode(i));document.head.appendChild(n)})();n.organizeModeClassName="fxs-desktop-organize";n.createDesktopModeManager=nt;l=(function(){function t(n,t,i,r){var u=this;this._wasContextPaneCollapsed=!1;this._dismissHandle={dismissFn:function(){u._desktop.mode(0)},shouldDismissOnMouseDownFn:h.noop,shouldDismissOnMouseWheelFn:h.noop,logName:"desktopmodemanager"};this._desktop=n;this._portalWidget=t;this._services=i;this._lifetime=r;this._userSettingsManager=i.settings;this._contextPane=i.leftContextPane;this._partMgmtStarted=!1;this._selectedTile=null;this._handleModeChange(n,r)}return r.defineProperty(t.prototype,"selectedTile",{get:function(){return this._selectedTile},enumerable:
!0,configurable:!0}),t.prototype.updateTileSelection=function(n){var t=this;if(this._deselectCurrentTile(),n.options.selected()&&(this._selectedTile=n),this._selectedTile)this._selectedTile.element.on(a,this._tileRemoveHandler=function(n){n.target===t._selectedTile.element[0]&&t._deselectCurrentTile()})},t.prototype.startPartManagment=function(n){var t=this,r;return this._partMgmtStarted?Q():(this._partMgmtStarted=!0,this._desktop.mode(1),r=this._contextPane,Q.all([i.require("MsPortalImpl/UI/UI.PartGalleryManager"),r.tryOpen(this)]).spread((function(i){var u=t._partGalleryManager,f=t._partGallery;u||(u=t._partGalleryManager=i.createPartGalleryManager(t._lifetime.createChildLifetime(),t._services,f),u.load(5,n));f.setFocus();n.expandTileGallery&&r.collapsed(!1)})))},t.prototype.onAddingContent=function(n){var t=this;return i.require("MsPortalImpl/Widgets/Widgets.PartGallery").then((function(i){t._partGallery||(t._partGallery=i.create(h("<div class='"+g+"'><\/div>")),n.addChild(t._partGallery.
element))}))},t.prototype.onRemovingContent=function(){this._partMgmtStarted=!1},t.prototype._enterOrganizeMode=function(){var i=this._portalWidget,r=i.element,t;return(r.addClass(n.organizeModeClassName),r.removeClass(v),t=i.getTopBarWidget(),t&&t.options.isInOrganizeMode(!0),f.register(this._dismissHandle),e.FlowLayoutDragDrop.Instance.enableDragDropTargets(),this._wasContextPaneCollapsed=this._contextPane.collapsed(),!this._partMgmtStarted)?this.startPartManagment({}):Q()},t.prototype._exitOrganizeMode=function(){var r=this._portalWidget,u=r.element,t,i;e.FlowLayoutDragDrop.Instance.disableDragDropTargets();u.removeClass(n.organizeModeClassName);u.addClass(v);t=r.getTopBarWidget();t&&t.options.isInOrganizeMode(!1);i=this._contextPane;i.close(!0);i.collapsed(this._wasContextPaneCollapsed);this._deselectCurrentTile();this._userSettingsManager.flushSettings();f.unregister(this._dismissHandle)},t.prototype._handleModeChange=function(n,t){var i=this;n.mode.subscribe(t,(function(n){switch(n)
{case 1:i._services.getService("DialogManager").then((function(n){n.dismissOpenDialog()}));i._enterOrganizeMode();u.isFullscreen()&&u.exitFullscreen();break;case 0:default:i._exitOrganizeMode()}}))},t.prototype._deselectCurrentTile=function(){this._selectedTile&&(this._selectedTile.element.off(a,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)},t})();n.DesktopModeManagerImpl=l})(h||(h={})),h}));define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","f","../../Base/Base.Router","../../Services/Services.AssetManagement","../../Services/Services.AssetTypes","../../Services/Services.Permissions","../../Base/Themes","../Hubs/UI.BrowseManager","../Commands/UI.CommandManager","../UI.ContextPane","../UI.DesktopManagerImpl","../UI.DesktopModeManager","../Hubs/UI.NotificationManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return (function(t){function k(t,p,k,d,g,nt,tt){var ht=w.client,rt=
p.extensionManager,ut=f.createAssetTypeService(rt),ct=u.createAssetManager(rt,p.settings,ut),et=e.createPermissionsManager(rt,ut),lt=s.createBrowseManager(rt,ut,et,d),ft=o.createManager(t,b,k["fxs-theme"]),ot=c.create(g.getRightContextPane(),t,ft),at=c.create(g.getLeftContextPane(),t,ft),vt=window.fx.environment.features.notificationspane==="true"?g.getToastVM():g.getNotificationMenuWidget().getToastVM(),it={rpcClient:ht,storageService:p.storageService,themeManager:ft,redirect:nt,settings:p.settings,editScopeManager:p.editScopeManager,extensionManager:rt,extensionVersionCache:p.extensionVersionCache,hubsMetadata:p.hubsMetadata,openWindow:p.openWindow,assetManager:ct,permissionsManager:et,assetTypeService:ut,browseManager:lt,desktop:null,modeManager:null,portalFormTarget:null,contextPane:ot,leftContextPane:at,getService:null,router:null,notificationManager:null},st=it.desktop=l.createDesktopManager(g,it),yt=it.getService=i.memoize((function(t){switch(t){case"DialogManager":return tt();case"ResourceMapManager":
return y("../Hubs/UI.ResourceMapManager",n).then((function(n){return n.createResourceMapManager(rt,ut)}));case"BladePairManager":return y("./UI.Composition.BladePair",n).then((function(n){return n.createBladePairManager()}));case"FeedbackPane":return y("../../Widgets/Widgets.FeedbackPane",n).then((function(n){return{amdModule:n,widget:new n.FeedbackPane(ot,vt,function(){return st.getCurrentBladeInfo()})}}));case"ThemeManager":return Q(ft)}throw new Error("Invalid service type '{0}' specified.".format(t));})),pt=it.portalFormTarget=h.createCommandManager(it.desktop).startListeningForEvents();return it.notificationManager=v.createNotificationManager(it),it.router=r.createRouter(it),it.modeManager=a.createDesktopModeManager(it,g,t),t.registerForDispose([st,pt,it.router,yt,]),it}function d(){return y("MsPortalImpl/UI/UI.DialogManager")}var p=i.Base,w=p.Rpc.Internal,y=i.require,b=$("body");t.initialize=k;t.getDialogManagerModule=d})(y||(y={})),y}));define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager",
["require","exports","f","a","./CodeComponentSideLoadModels","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.Storage","../UI/Compositions/UI.Composition.Services"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){var v=i.Base,y=v.Diagnostics,p=i.ViewModels.Dialogs.MessageBoxButtons,w=jQuery,s=y.createLog(n),u=f.Shell.Dialogs,c=0,a=1,h=0,b=1,k=2,l=u.loadOnlySafeExtensionsButtonText,d=(function(){function n(n,t,i,r,u,f,e,o,s,h,c,l){this._temporaryTestCodeComponents=[];this._trustedCodeComponents=n;this._normalizeCodeComponents(this._trustedCodeComponents);this._settingsManager=t;this._storageService=i;this._getDialogManager=r;this._dialogContainer=u;this._canModifyCodeComponents=f;this._acceptWithoutPrompt=e;this._storageServiceKey=o;this._hashQueryStringKey=s;this._createFunction=h;this._componentType=c;this._settingsKey=l}return n.prototype.getCodeComponentsMetadata=function(){var n=this,t=null,i=null;return Q().then((function(){var i=JSON.parse(JSON.stringify(
n._trustedCodeComponents));return t=i.map((function(t){return n._createFunction(t)})),n.loadFromServer(t)})).then((function(i){return i.length>0&&n._merge(t,i),t}),(function(){return t})).then((function(t){return i=t,n._loadUntrustedCodeComponentsIfAllowed()})).then((function(t){if(t.length>0){var r=function(n){n.logUsageWarning()};n._merge(i,t,r)}return i})).then((function(n){return n.filter((function(n){return n.isValid()}))}))},n.prototype.loadFromServer=function(){throw new Error("This is an abstract method that must be overridden by all subclasses.");},n.prototype.listTestCodeComponents=function(){var t=this,n=this._temporaryTestCodeComponents.slice(0);return this._settingsManager.querySetting(c,this._settingsKey).then((function(i){return i=i&&i.map((function(n){return t._createFunction(n)})),r.isArray(i)&&(n=n.concatUnique(i,(function(n,t){return n.isEqual(t)}))),n.filter((function(n){return n.isValid()}))})).then(null,(function(n){return s.error("Error listing code components",2,n),[]}))},n.prototype.registerTestCodeComponent=
function(n,t){var i=this;return n.isValid()?t?(this._addOrUpdateCodeComponent(this._temporaryTestCodeComponents,n),Q.resolve(null)):this.listTestCodeComponents().then((function(t){return i._addOrUpdateCodeComponent(t,n),i._settingsManager.setSetting(c,i._settingsKey,t),i._settingsManager.flushSettings()})).catch((function(t){s.error("Error registering code component",4,{codeComponent:n,error:t})})):Q.reject()},n.prototype.unregisterTestCodeComponent=function(n){var t=this;return this._removeCodeComponent(this._temporaryTestCodeComponents,n),this.listTestCodeComponents().then((function(i){if(t._removeCodeComponent(i,n))return t._settingsManager.setSetting(c,t._settingsKey,i),t._settingsManager.flushSettings()})).catch((function(n){s.error("Error unregistering code component.",6,{name:name,error:n})}))},n.prototype.unregisterAll=function(){this.clearTemporaryTestCodeComponents();var n=this._settingsManager;return n.deleteSettings({store:c,keys:[this._settingsKey]}),n.flushSettings().catch((function(
n){s.error("Error registering all code components",5,n)}))},n.prototype.clearTemporaryTestCodeComponents=function(){var n=this._temporaryTestCodeComponents;n.splice(0,n.length)},n.prototype._loadUntrustedCodeComponentsIfAllowed=function(){var n=this,t=this._canModifyCodeComponents;return t?this.listTestCodeComponents().then((function(i){return i.length===0?(t&&s.verbose("No untrusted code components were found. Will load the portal in normal mode.",3),[]):n.prompt().then((function(t){return t?(i.forEach((function(t){n._componentType===h&&t.markAsTestExtension()})),i):[]}))})):Q([])},n.prototype.prompt=function(){var s=this,i=e.ComponentName.ExtensionManager,r=this._storageServiceKey,f=this._storageService,c=f.getValue(i,r,a),n,t;if(c||this._acceptWithoutPrompt)return Q(!0);n=null;t=null;switch(this._componentType){case h:n=u.untrustedExtensionsTitle;t=u.untrustedExtensionsDescriptionFmt.format(l);break;case b:n=u.untrustedGalleryPackageTitle;t=u.untrustedGalleryPackageDescriptionFmt.format(l);
break;case k:n=u.untrustedPatchTitle;t=u.untrustedExtensionsDescriptionFmt.format(l);break;default:throw new Error("Unsupported componentType");}return o.getDialogManagerModule().then((function(e){var o=w("<div />"),h=new e.MessageBox(n,t,p.OKCancel);return s._dialogContainer.prepend(o),h.defaultButtonText=l,h.cancelButtonText=u.loadUnsafeExtensionsButtonText,s._getDialogManager().then((function(n){return n.showDialog(o,h,null).then((function(t){var u=t===1;return n.dismissOpenDialog(),o.remove(),u?f.setValue(i,r,"true",a):f.clearValue(i,r,a),u}))}))}))},n.prototype._registerTestCodeComponentFromUri=function(n){return n.isValid()?this.registerTestCodeComponent(n,!0):null},n.prototype._removeCodeComponent=function(n,t){this._componentType===h&&t.normalizeCloudName();var i=-1;return i=n.firstIndex((function(n){return n.isEqual(t)})),i>=0?(n.splice(i,1),!0):!1},n.prototype._normalizeCodeComponents=function(n){var t=this;n.forEach((function(n){t._componentType===h&&n.normalizeCloudName()}))},n.prototype.
_merge=function(n,t,i){var r=this;n!==null&&t!==null&&t.forEach((function(t){i&&i(t);r._addOrUpdateCodeComponent(n,t)}))},n.prototype._addOrUpdateCodeComponent=function(n,t){this._componentType===h&&t.normalizeCloudName();var i=n.first((function(n){return n.isEqual(t)}));i?i.updateWith(t):n.push(t)},n})();t.CodeComponentSideLoadManagerImpl=d})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14{fill:#7fba00}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.fxs-sidebar-bar .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05,.msportalfx-inverted-theme .msportalfx-svg-c05{fill:#777}.fxs-sidebar-bar .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07,.msportalfx-inverted-theme .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white>*,.msportalfx-svg-palette-white>g>*{fill:#fff}.msportalfx-svg-palette-blue>*,.msportalfx-svg-palette-blue>g>*{fill:#3999c6}.msportalfx-svg-palette-black>*,.msportalfx-svg-palette-black>g>*{fill:#1e1e1e}.msportalfx-svg-palette-green>*,.msportalfx-svg-palette-green>g>*{fill:#7fba00}.msportalfx-svg-palette-gray>*,.msportalfx-svg-palette-gray>g>*{fill:#a0a1a2}.msportalfx-svg-palette-inherit>*,.msportalfx-svg-palette-inherit>g>*{fill:inherit}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:12px;min-width:12px}.msportalfx-svg-disabled .msportalfx-svg-c01,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c01{fill:#fff}.msportalfx-svg-disabled .msportalfx-svg-c02,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-disabled .msportalfx-svg-c03,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c03{fill:#a1a1a1}.msportalfx-svg-disabled .msportalfx-svg-c04,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-disabled .msportalfx-svg-c05,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-disabled .msportalfx-svg-c06,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-disabled .msportalfx-svg-c07,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-disabled .msportalfx-svg-c08,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c08{fill:#676767}.msportalfx-svg-disabled .msportalfx-svg-c09,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c09{fill:#6f6f6f}.msportalfx-svg-disabled .msportalfx-svg-c10,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c10{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c11,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c11{fill:#898989}.msportalfx-svg-disabled .msportalfx-svg-c12,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c12{fill:#c3c3c3}.msportalfx-svg-disabled .msportalfx-svg-c13,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c13{fill:#838383}.msportalfx-svg-disabled .msportalfx-svg-c14,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c14{fill:#5d5d5d}.msportalfx-svg-disabled .msportalfx-svg-c15,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c15{fill:#999}.msportalfx-svg-disabled .msportalfx-svg-c16,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c16{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c17,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c17{fill:#717171}.msportalfx-svg-disabled .msportalfx-svg-c18,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c18{fill:#767676}.msportalfx-svg-disabled .msportalfx-svg-c19,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c19{fill:#636363}.msportalfx-svg-disabled .msportalfx-svg-c20,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c20{fill:#4e4e4e}.msportalfx-svg-disabled .msportalfx-svg-c21,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c21{fill:#484848}.msportalfx-svg-disabled .msportalfx-svg-c22,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c22{fill:#7d7d7d}.msportalfx-svg-disabled .msportalfx-svg-c97,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c97{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c98,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c98{fill:#787878}.msportalfx-svg-disabled .msportalfx-svg-c99,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c99{fill:#8a8a8a}.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c02,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c03,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c04,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c05,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c06,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c07,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c08,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c09,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c10,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c11,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c12,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c13,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c14,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c15,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c16,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c17,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c18,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c19,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c20,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c21,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c22,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c97,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c98,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c99{fill:#a0a1a2}.msportalfx-svg-loading-ellipsis-square .msportalfx-svg-loading-square{-webkit-animation:ProgressFlagAnimation 1.45s infinite ease-in-out;animation:ProgressFlagAnimation 1.45s infinite ease-in-out}.msportalfx-svg-loading-ellipsis-square .msportalfx-svg-loading-square:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.msportalfx-svg-loading-ellipsis-square .msportalfx-svg-loading-square:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.msportalfx-svg-loading-ellipsis-square .msportalfx-svg-loading-square:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}@-webkit-keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}@keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scalex(-1)}.msportalfx-svg-rotate360{-webkit-animation:ImageRotation 1.45s infinite linear;animation:ImageRotation 1.45s infinite linear}@-webkit-keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}")})
);define("_generated/Less/MsPortalImpl/Widgets/HighContrastMode.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,"@media screen and (-ms-high-contrast:active){.azc-balloon-content,.azc-slider-marker,.azc-slider-slider,.fxc-actionbarbase-button,.fxs-avatarmenu-dropdown,.fxs-avatarmenu-header,.fxs-blade,.fxs-commandBar-item,.fxs-contextpane.fxs-contextpane-visible,.fxs-hubpane,.fxs-navbar,.fxs-part,.fxs-progress div,.fxs-splashscreen-loader-container div,.fxs-tile-actionbar-action,.fxs-tile-actionbar-actionlist,.fxs-tile-progress-transparent div{border:1px solid}svg,svg *,text{fill:#fff!important}.azc-bg-selected,.azc-br-focused,.azc-editableCombo-focus,.azc-filterCombo-focus,.azc-has-focus,.azc-input:focus,.azc-list-focused,.azc-listView-focusable .azc-listView-item.azc-outline-focusable:focus,.azc-outline-focusable:focus,.fxc-dropdown-keynav,.fxs-is-selected{outline:#fff solid 2px!important}.fxs-blade-locked .fxs-part{border:none}.fxs-tile-overlay{background:0 0}.azc-noRadio li:focus{outline:solid 1px!important}tr:not(.azc-grid-groupheader):hover td{border-top:4px solid;border-bottom:4px solid;border-collapse:collapse}}@media screen and (-ms-high-contrast:black-on-white){svg,svg *,text{fill:#000!important}.azc-bg-selected,.azc-br-focused,.azc-editableCombo-focus,.azc-filterCombo-focus,.azc-has-focus,.azc-input:focus,.azc-list-focused,.azc-listView-focusable .azc-listView-item.azc-outline-focusable:focus,.azc-outline-focusable:focus,.fxc-dropdown-keynav,.fxs-is-selected{outline-color:#000!important}}")})
);define("_generated/Less/MsPortalImpl/Themes/Themes.Universal.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-bg-white{background-color:#fff}.fxs-button-default{background:#acacac;border-color:#acacac;color:#fff}.fxs-button-default:hover:after{border-color:#949494}.fxs-button-default:focus:after{border-color:#eee}.fxs-button-default:active{background-color:#868686;border-color:#868686;outline-color:#868686}.fxs-button-primary{background:#00bcf2;border-color:#00bcf2;color:#fff}.fxs-button-primary:hover:after{border-color:#00a0ce}.fxs-button-primary:focus:after{border-color:#ccf2fc}.fxs-button-primary:active{background-color:#00a0ce;border-color:#00a0ce;outline-color:#00a0ce}.fxs-button-disabled{background:#e4e4e4;border-color:#e4e4e4;color:#b3b3b3}.fxs-button-disabled:active{background-color:#e4e4e4;border-color:#e4e4e4;outline-color:#e4e4e4}.fxs-overlay{background:rgba(0,0,0,.7)}.fxs-highlight{color:#000;background-color:#fff100}.fxs-tile-actionbar{background-color:#9cd5f4}.fxs-tile-actionbar-action svg{fill:#fff!important}.fxs-tile-actionbar-action.fxs-tile-actionbar-action-pressed,.fxs-tile-actionbar-action:hover{background:#00bcf2}.fxs-tile-actionbar-action.fxs-tile-actionbar-command-unpinfromstartboard:hover{background:#ba141a}.fxs-portal .fxs-accent,.fxs-portal .fxs-popup{box-shadow:0 5px 15px 2px rgba(0,0,0,.3)}.fxs-portal .fxs-text-info{color:#0072c6}.fxs-portal .fxs-text-success{color:#7fba00}.fxs-portal .fxs-text-dirty{color:#9b4f96}.fxs-portal .fxs-text-error,.fxs-portal .fxs-text-invalid{color:#e81123}.fxs-portal .fxs-text-warning{color:#ff8c00}.fxs-portal .fxs-br-success{border-color:#7fba00}.fxs-portal .fxs-br-dirty{border-color:#9b4f96}.fxs-portal .fxs-br-error{border-color:#e81123}.fxs-portal .fxs-br-warning{border-color:#ff8c00}.fxs-portal .fxs-br-info{border-color:#00bcf2}.fxs-portal .fxs-fill-info svg{fill:#0072c6}.fxs-portal .fxs-fill-success svg{fill:#7fba00}.fxs-portal .fxs-fill-dirty svg{fill:#9b4f96}.fxs-portal .fxs-fill-error svg,.fxs-portal .fxs-fill-invalid svg{fill:#e81123}.fxs-portal .fxs-fill-warning svg{fill:#ff8c00}.fxs-portal .fxs-portal-main .fxs-br-dirty{border-color:#9b4f96}.fxs-portal .fxs-portal-main .fxs-br-error{border-color:#e81123}.fxs-portal .fxs-portal-main .fxs-bg-error{background-color:#e81123}.fxs-portal .fxs-portal-main .fxs-bg-dirty{background-color:#9b4f96}.fxs-portal .fxs-portal-main .azc-is-edited .azc-dockedballoon-validation{border-color:#9b4f96}.fxs-portal .fxs-portal-main .azc-has-focus .azc-dockedballoon-validation,.fxs-portal .msportalfx-br-info{border-color:#00bcf2}.fxs-portal .fxs-portal-main .fxs-bg-info,.fxs-portal .fxs-portal-main .fxs-bg-info:hover{background-color:#0072c6}.fxs-portal .fxs-portal-main .fxs-bg-complete,.fxs-portal .fxs-portal-main .fxs-bg-complete:hover,.fxs-portal .fxs-portal-main .fxs-bg-success,.fxs-portal .fxs-portal-main .fxs-bg-sucess:hover{background-color:#7fba00}.fxs-portal .fxs-portal-main .fxs-bg-dirty,.fxs-portal .fxs-portal-main .fxs-bg-dirty:hover,.fxs-portal .fxs-portal-main .fxs-bg-upsell,.fxs-portal .fxs-portal-main .fxs-bg-upsell:hover{background-color:#9b4f96}.fxs-portal .fxs-portal-main .fxs-bg-error,.fxs-portal .fxs-portal-main .fxs-bg-error:hover{background-color:#e81123}.fxs-portal .fxs-portal-main .fxs-bg-warning,.fxs-portal .fxs-portal-main .fxs-bg-warning:hover{background-color:#ff8c00}.fxs-portal .fxs-dirty-before::before{background-color:#9b4f96}.fxs-portal .fxs-bg-error-before::before{background-color:#e81123}.fxs-portal .fxs-bladestyle-create .msportalfx-form .fxs-dirty-before::before{background-color:transparent}.fxs-portal .fxs-bladestyle-create .msportalfx-form .fxs-bg-dirty{background-color:#00bcf2}.fxs-portal .fxs-bladestyle-create .msportalfx-form .fxs-bg-error-before::before{background-color:#e81123}.fxs-portal .msportalfx-bg-info{background-color:#0072c6}.fxs-portal .msportalfx-bg-success{background-color:#7fba00}.fxs-portal .msportalfx-bg-dirty{background-color:#9b4f96}.fxs-portal .msportalfx-bg-error{background-color:#e81123}.fxs-portal .msportalfx-bg-warning{background-color:#ff8c00}.fxs-portal .msportalfx-text-info{color:#0072c6}.fxs-portal .msportalfx-text-success{color:#7fba00}.fxs-portal .msportalfx-text-dirty{color:#9b4f96}.fxs-portal .msportalfx-text-error{color:#e81123}.fxs-portal .msportalfx-text-warning{color:#ff8c00}.fxs-portal .msportalfx-br-success{border-color:#7fba00}.fxs-portal .msportalfx-br-dirty{border-color:#9b4f96}.fxs-portal .msportalfx-br-error{border-color:#e81123}.fxs-portal .msportalfx-br-warning{border-color:#ff8c00}.fxs-portal .msportalfx-fill-info{fill:#0072c6}.fxs-portal .msportalfx-fill-success{fill:#7fba00}.fxs-portal .msportalfx-fill-dirty{fill:#9b4f96}.fxs-portal .msportalfx-fill-error{fill:#e81123}.fxs-portal .msportalfx-fill-warning{fill:#ff8c00}.fxs-text-white{color:#fff}.fxs-fill-white{fill:#fff}.fxs-bg-primary{background-color:#00bcf2}.fxs-br-primary{border-color:#00bcf2}.fxs-tile-selected .fxs-tile-overlay{background-color:transparent}.fxs-bg-overlay-dark{background:rgba(0,0,0,.7)}.fxs-bg-primary-10{background-color:rgba(0,188,242,.1)}.azc-is-edited.azc-has-focus{border-color:#7fba00}.azc-is-edited.azc-has-focus .azc-dockedballoon-validation{border-color:#00bcf2}.azc-is-edited .azc-dockedballoon-validation{border-color:#9b4f96}.azc-disabled:hover,.azc-row-disabled:hover{background-color:inherit}.azc-disabled,.azc-disabled:focus,.azc-disabled:hover,input.azc-disabled{cursor:default;outline:0}")})
);define("_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxpart-itemsummary{height:100%;background:#00f;display:block;color:#fff}.fxpart-itemsummary-name{font-size:19px;padding:20px;text-transform:uppercase}.fxpart-itemsummary-sourceControl{font-size:16px;padding:0 20px}")}));define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,'.msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker:after,.msportalfx-specpicker:before{content:"";position:absolute;z-index:-1;top:10px;bottom:10px;left:0;right:0;border-radius:10px}.msportalfx-specpicker:after{right:10px;left:auto;transform:skew(8deg) rotate(3deg)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.fxs-mode-dark .msportalfx-specpicker{box-shadow:0 1px 4px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1) inset}.fxs-mode-dark .msportalfx-specpicker:after,.fxs-mode-dark .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(255,255,255,.8)}.fxs-mode-light .msportalfx-specpicker{box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset}.fxs-mode-light .msportalfx-specpicker:after,.fxs-mode-light .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(0,0,0,.8)}.msportalfx-specpicker-star{width:14px;height:14px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;text-transform:uppercase;padding-left:11px}.msportalfx-specpicker-header .msportalfx-specpicker-header-title{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;opacity:.8;padding-left:6px}.msportalfx-specpicker-footer-value,.msportalfx-specpicker-table .msportalfx-specpicker-feature-name,.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-specpicker-header-text{width:161px;position:absolute}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade1{background-color:#9b4f96}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(155,79,150,.2)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(155,79,150,.1)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade1{background-color:#7fba00}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(127,186,0,.2)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(127,186,0,.1)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade1{background-color:#ffb900}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade2{background-color:rgba(255,185,0,.2)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade3{background-color:rgba(255,185,0,.1)}.msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-size:12px;margin-left:6px}.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-size:17px}.msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:12px;padding-top:6px;margin-left:6px;line-height:normal}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;font-size:22px;line-height:22px;letter-spacing:-.025em}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions,.msportalfx-specpicker-footer-details{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-specpicker-footer-details{font-size:10px;line-height:14px;text-transform:uppercase;color:#8f9ca8}.msportalfx-specpicker-footer-channelMessage,.msportalfx-specpicker-footer-statusMessage{color:#8f9ca8;margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;overflow:hidden;text-overflow:ellipsis;max-height:32px}.msportalfx-specpicker-footer-channelMessage::after,.msportalfx-specpicker-footer-channelMessage::before{position:absolute;background-color:inherit}.msportalfx-specpicker-footer-channelMessage::before{content:\'\\02026\';top:16px;right:0}.msportalfx-specpicker-footer-channelMessage::after{content:\'\';height:100%;width:100%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline;color:#fff}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-filtersContainer.ext-hubs-specPicker-filtersContainer{margin-top:0}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions{font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#00bcf2;fill:#00bcf2}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:0;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus{outline-style:dotted;outline-width:1px}')})
);define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle{text-align:center;float:initial}")})
);define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","f","./Parts","../../_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","../../_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","../../_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],(function(n,t,i,r){"use strict";var u;return (function(n){var t=i.Parts.PartKind,u=i.Parts.PartSize,h=u.Mini,o=u.Small,e=u.Normal,f=u.Wide,c=u.Large,l=u.Tall,a=u.HeroWide,v=u.HeroTall,w=u.HeroWideFitHeight,y=u.FullWidthFitHeight,b=u.FitToContainer,s="<div data-bind='{0}: $root'><\/div>",p={defaultSize:y,supportedSizes:[y],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]};n.parts=[{kind:t.Asset,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",(function(n,t,i,r,u){return new n.AssetPart(t,i,r,u)}),{defaultSize:o,supportedSizes:[h,o,e]})},{kind:t.Button,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",(function(n,t,i,r,u){return new n.ButtonPart(
t,i,r,u)}),{supportedSizes:[h,o,e,f]})},{kind:t.Chart,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Chart",(function(n,t,i,r,u){return new n.Chart(t,i,r,u)}),{supportedSizes:[o,e,l,f,c,a,v,w,y,b]})},{kind:t.Collection,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",(function(n,t,i,r,u){return new n.CollectionPart(t,i,r,u)}),{supportedSizes:[h,o,e,f,l,c,a,v,w,b,y]})},{kind:t.CollectionSummary,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",(function(n,t,i,r,u){return new n.Part(t,i,r,u)}),{supportedSizes:[h,o,e,f]})},{kind:t.DiffEditor,factory:r.createPartFactory(s.format("pcDiffEditor"))},{kind:t.Donut,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Donut",(function(n,t,i,r,u){return new n.Donut(t,i,r,u)}),{supportedSizes:[e,a,f,c,l,v,]})},{kind:t.Editor,factory:r.createPartFactory(s.format("pcEditor"))},{kind:t.Grid,factory:r.createPartFactory(s.format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems","content.selectableData.activatedItems",
"content.selectableData.itemsWithChildEdits"]})},{kind:t.InfoList,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.InfoList",(function(n,t,i,r,u){return new n.InfoListPart(t,i,r,u)}),p)},{kind:t.ItemSummary,factory:r.createPartFactory("<div class='fxpart-itemsummary'><div class='fxpart-itemsummary-name' data-bind='text: name'><\/div><\/div>")},{kind:t.LogStream,factory:r.createPartFactory(s.format("pcLogStream"))},{kind:t.Properties,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",(function(n,t,i,r,u){return new n.PropertiesPart(t,i,r,u)}),p)},{kind:t.Provisioning,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Provisioning",(function(n,t,i,r,u){return new n.ProvisioningPart(t,i,r,u)}),{supportedSizes:[e,f]})},{kind:t.QuickStart,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",(function(n,t,i,r,u){return new n.QuickStartPart(t,i,r,u)}),{defaultSize:o,supportedSizes:[h,o,e,f]})},{kind:t.QuotaGauge,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuotaGauge",
(function(n,t,i,r,u){return new n.QuotaGauge(t,i,r,u)}),{supportedSizes:[e,c,f,l,v,a]})},{kind:t.ResourceSummary,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",(function(n,t,i,r,u){return new n.ResourceSummaryPart(t,i,r,u)}),p)},{kind:t.Settings,factory:r.createPartFactory(s.format("pcSettings"),{defaultSize:f,supportedSizes:[f]})},{kind:t.SingleSetting,factory:r.createPartFactory(s.format("pcSingleSetting"))},{kind:t.SingleValueGauge,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.SingleValueGauge",(function(n,t,i,r,u){return new n.SingleValueGauge(t,i,r,u)}),{supportedSizes:[e,c,f,l]})},{kind:t.Unavailable,factory:r.createPartFactory("<div><\/div>")}];n.parts.forEach((function(n){r.registerFactory(t[n.kind],n.factory)}))})(u||(u={})),u}));define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function l(n){var i=n.originalEvent,t=i&&i.touches,r=t&&t.length===1,u=t&&t[0];
return r?u:null}function y(){var n={width:0,height:0,top:t.targetY,left:t.targetX};f.css(n);u("body").append(f);f.animate({width:e,height:e,top:"-="+(e/2+5),left:"-="+e/2},75)}function p(n){if(n){var t={opacity:.2},i={opacity:1};f.animate(t,25).animate(i,25).animate(t,25).animate(i,25)}f.animate({width:0,height:0,top:"+="+e/2,left:"+="+e/2},75,(function(){f.detach()}))}function s(n,i){i.off(o);h.clearTimeout(c);p(n);t={startTime:0,target:null,targetX:0,targetY:0}}function w(n){s(!0,u(n.currentTarget))}function b(i){var r=l(i),f=u(i.currentTarget),e=Math.abs(t.targetX-r.clientX),o=Math.abs(t.targetY-r.clientY);(e>n.MoveTolerancePixels||o>n.MoveTolerancePixels)&&s(!0,f)}function k(i){var e=u(i.currentTarget),h,f;t.startTime&&(h=Math.abs(Date.now()-t.startTime),h>=n.ReactionDelayMillis&&(e.off(r.contextmenu+o),f=u.Event(r.contextmenu),f.clientX=t.targetX,f.clientY=t.targetY,u(t.target).trigger(f)));s(!1,e)}function a(i){var f=l(i),e=u(i.currentTarget);if(!f){s(!0,e);return}if(!t||t.startTime===
0){t={startTime:Date.now(),target:i.target,targetX:f.clientX,targetY:f.clientY};c=h.setTimeout((function(){y()}),n.ReactionDelayMillis);e.on(r.contextmenu+o,(function(){return!1})).on(r.touchmove+o,b).on(r.touchcancel+o,w).on(r.touchend+o,k)}}function d(n){n.on(r.touchstart,a)}function g(n){n.off(r.touchstart,a);s(!0,n)}var r=i.Base.EventTypes,h=window,u=jQuery;n.ReactionDelayMillis=550;n.MoveTolerancePixels=10;n.HintClassIdentifier="fxs-contextMenuTouchHint";var v="<div class='"+n.HintClassIdentifier+"' style='position: fixed;z-index: 500border: 2px solid grey;box-sizing: border-box;background-color: rgba(255, 255, 255, 0.2);pointer-events: none;'><\/div>",f=u(v),e=110,o=".cmtevt",c,t={startTime:0,target:null,targetX:0,targetY:0};n.register=d;n.unregister=g})(r||(r={})),r}));define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Generated/SvgStartupDefinitions","./Widgets.Common","./Widgets.UIElementBase","../../_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],
(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var r=i.Base.EventTypes,l=f.Content.SvgStartup,c=u.ContextPane,t="fxs-contextpane",k=t+"-visible",d=t+"-loading",h=t+"-close",s=t+"-expand",a=t+"-button-inner",v="fxs-contextpane-content",y="fxs-trim",p="fxs-blade-color-trim",w=ko.observable,g=(function(n){function t(){n.call(this,"fxs-contextpane-identifier");this.opened=w(!1);this.loading=w(!1)}return __extends(t,n),t})(o.ViewModel),b;n.ViewModel=g;b=(function(n){function i(i,r){n.call(this,i,r);var u='<button type="button" class="'+s+'"><div class="'+a+'">'+l.hamburger.data+"<\/div><\/button>"+('<button type="button" class="'+h+'" title="'+c.close+'"><div class="'+a+'">'+l.close.data+"<\/div><\/button>")+'<div class="fxs-progress-dots"><div><\/div><div><\/div><div><\/div><\/div>';i.addClass(t).addClass(y).addClass(p).attr("role","complementary").append(u);this._init();this._attachEventHandlers(r)}return __extends(i,n),i.prototype.dispose=function(){this._cleanElement(t,y,p);
this.element.removeAttr("role");n.prototype.dispose.call(this)},i.prototype.hasContent=function(){return!!this._$content},i.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this.hasContent()&&this.removeChild(null);var i=this.element,t=this._$content=n.element?n.element:n;t.addClass(v).insertBefore(i.find(".fxs-progress-dots"));i.findByClassName(h).toggle(!t.hasClass("fxs-blade")&&!t.hasClass("fxs-partgallery-container"));i.findByClassName(s).toggle(t.hasClass("fxs-partgallery-container"))},i.prototype.insertChild=function(n){this.addChild(n)},i.prototype.removeChild=function(n,t){return this._$content?(t?this._$content.detach():this._$content.remove(),this._$content.removeClass(v),this._$content=null,!0):!0},i.prototype.clear=function(n){return this.removeChild(null,n)},i.prototype.setFocus=function(){var n=this._$content;n&&e.waitForBindings(this.element[0]).then((function(){n.findFirstTabbable().focus()}))},i.prototype._init=function(){var n=this.lifetimeManager,
t=this.element,i=this.options;ko.reactor(n,(function(){var n=i.opened();t.toggleClass(k,n)}));ko.reactor(n,(function(){var n=i.loading();t.toggleClass(d,n)}))},i.prototype._attachEventHandlers=function(n){var i=this.element,t=i.findByClassName.bind(i),u,f;t(h).on(r.click,u=function(){i.trigger(r.fxcontextpaneclosing)});t(s).on(r.click,f=function(){n.collapsed(!n.collapsed())});n.collapsed&&n.collapsed.subscribe(this.lifetimeManager,(function(n){t(s).attr({title:n?c.expand:c.collapse,"aria-expanded":!n})})).callback(n.collapsed());this.lifetimeManager.registerForDispose((function(){t(h).off(r.click,u);t(s).off(r.click,f)}))},i})(o.Widget);n.Widget=b})(s||(s={})),s}));define("_generated/Templates/WidgetsHelpMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fx-dropmenu-dropdown"> <div class="fxs-dropmenu-list-system"> <ul role="presentation"> <li class="fxs-has-hover" data-bind="visible: !!data.links.createSupportRequest" role="presentation"> <a class="fxs-helpmenu-support-request" role="menuitem" href="" target="_blank" data-bind=\'attr: {href: data.links.createSupportRequest || "", title: data.text.newSupportRequestLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.newSupportRequestLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="image: data.icons.add"><\/div> <\/a> <\/li> <li class="fxs-has-hover" data-bind="visible: !!data.links.manageSupportRequests" role="presentation"> <a class="fxs-helpmenu-manage-support-requests" role="menuitem" href="" target="_blank" data-bind=\'attr: {href: data.links.manageSupportRequests || "", title: data.text.manageSupportRequestsLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.manageSupportRequestsLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="visible: data.links.manageSupportRequests && !data.links.manageSupportRequests.startsWith(\'#\'), image: data.icons.hyperlink"><\/div> <\/a> <\/li> <li class="fxs-has-hover" data-bind="visible: !!data.links.helpAndSupport" role="presentation"> <a class="fxs-helpmenu-support" role="menuitem" href="" target="_blank" data-bind=\'attr: {href: data.links.helpAndSupport || "", title: data.text.supportLabel}\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.supportLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="visible: data.links.helpAndSupport && !data.links.helpAndSupport.startsWith(\'#\'), image: data.icons.hyperlink"><\/div> <\/a> <\/li> <li class="fxs-has-hover" role="presentation" data-bind="visible: data.showKeyboardShortcuts"> <a href="" class="fxs-helpmenu-keyboardshortcuts" role="menuitem" data-bind="attr: { title: data.text.keyboardshortcutsPaneLabel, \'aria-haspopup\': true }"> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.keyboardshortcutsPaneLabel"><\/div> <\/a> <\/li> <li class="fxs-has-hover" role="presentation" data-bind="visible: !!data.links.privacyAndTerms, css: { \'fxs-has-border fxs-dropmenu-line-separator\': !!data.links.createSupportRequest || !!data.links.manageSupportRequests || !!data.links.helpAndSupport }"> <a class="fxs-helpmenu-legal" role="menuitem" href="" target="_blank" data-bind=\'attr: {href: data.links.privacyAndTerms || "", title: data.text.legalLabel}\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.legalLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="visible: data.links.privacyAndTerms && !data.links.privacyAndTerms.startsWith(\'#\'), image: data.icons.hyperlink"><\/div> <\/a> <\/li> <li class="fxs-has-hover" role="presentation"> <a href="" class="fxs-helpmenu-show-diagnostics" role="menuitem" data-bind="attr: { title: data.text.showDiagnosticsLabel, \'aria-haspopup\': true }"> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.showDiagnosticsLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="image: data.icons.hyperlink"><\/div> <\/a> <\/li> <\/ul> <\/div> <\/div>'}
}));define("_generated/Templates/WidgetsHelpMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-button fxs-has-hover" data-bind="image: data.icons.help"><\/div>'}}));define("MsPortalImpl/Widgets/Widgets.HelpMenu",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Widgets.WidgetBase","./Widgets.DropMenu","../../_generated/Templates/WidgetsHelpMenu","../../_generated/Templates/WidgetsHelpMenuButton"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){function l(n,t){(!t||t.startsWith("#"))&&n.preventDefault()}function tt(n,t){t.openKeyboardShortcutsPane();n.preventDefault()}var v=i.Base,ut=v.Diagnostics.Telemetry,y=v.EventTypes,ft=jQuery,et=window,p=et.fx.environment,w=p.chrome,r=p.links,ot=e.Source.TopBar,st=e.Action,ht=ut.trace,t=y.click,b="fxs-dropmenu",k="fxs-helpmenu-legal",d="fxs-helpmenu-support",ct="fxs-helpmenu-keyboardshortcuts",
a="fxs-helpmenu-support-request",g="fxs-helpmenu-manage-support-requests",nt="fxs-helpmenu-show-diagnostics",lt=u.HelpMenu.supportLabel,it,rt;n.preventDefaultIfHash=l;it=(function(n){function t(){n.apply(this,arguments);this.showKeyboardShortcuts=!w.hideShortcuts;this.legal=null;this.text=u.HelpMenu;this.links=r;this.icons=f.Content.SvgStartup}return __extends(t,n),t})(o.ViewModel);n.ViewModel=it;rt=(function(n){function i(t,i){var r=this,u,f;if(n.call(this,t,i),u=this.element,u.addClass(b),this._dropMenuViewModel=new s.ViewModel(c(),h()),!w.hideShortcuts)ft(document).on(y.fxopenshortcutslegend,(function(n){tt(n,r.options)}));f=this._dropMenuWidget=new s.Widget(u,this._dropMenuViewModel);this._dropMenuWidget.options.buttonTooltip(lt);this._bindDescendants();ko.reactor(this.lifetimeManager,(function(){f.options.isMenuOpen()?r._openMenu():r._closeMenu()}))}return __extends(i,n),i.prototype.dispose=function(){this._removeEventHandlers();this._dropMenuWidget.dispose();this._cleanElement(b);n.prototype.
dispose.call(this)},i.prototype.getDropMenuWidget=function(){return this._dropMenuWidget},i.prototype._removeEventHandlers=function(){var e=this.element,n=e.findByClassName.bind(e),o=this._legalHandler,i,r,u,f;o&&(n(k).off(t,o),this._legalHandler=null);i=this._supportRequestHandler;i&&(n(a).off(t,i),this._supportRequestHandler=null);r=this._helpBladeHandler;r&&(n(d).off(t,r),this._helpBladeHandler=null);u=this._manageRequestsHandler;u&&(n(g).off(t,u),this._manageRequestsHandler=null);f=this._diagnosticsHandler;f&&(n(nt).off(t,f),this._diagnosticsHandler=null)},i.prototype._openMenu=function(){var u=this.element,i=this.options,n=u.findByClassName.bind(u),f=n(a);if(f[0].focus(),ht({source:ot,action:st.HelpMenuOpen}),!this._legalHandler)n(k).on(t,this._legalHandler=function(n){i.openPrivacyAndTerms();l(n,r.privacyAndTerms)});n(ct).on(t,(function(n){tt(n,i)}));n(a).on(t,this._supportRequestHandler=function(n){i.openSupportRequestBlade();l(n,r.createSupportRequest)});n(g).on(t,this._manageRequestsHandler=
function(n){i.openManageSupportRequestsBlade();l(n,r.manageSupportRequests)});n(d).on(t,this._helpBladeHandler=function(n){i.openHelpAndSupport();l(n,r.helpAndSupport)});n(nt).on(t,this._diagnosticsHandler=function(n){i.showDiagnostics();n.preventDefault()})},i.prototype._closeMenu=function(){this._removeEventHandlers()},i})(o.Widget);n.Widget=rt})(l||(l={})),l}));define("_generated/Templates/WidgetsNotificationMenu",["require","exports","f"],(function(){"use strict";return function(){return'<!-- ko if: data.menuOpen --> <div class="fxs-notificationmenu-dropdown"> <!-- ko ifnot: data.notifications && data.notifications() && data.notifications().length --> <div tabindex="0" class="fxs-notificationmenu-notification-nodata"> <div class="fxs-notificationmenu-notification-nodata-content" data-bind="text: data.text.noNewNotifications, title: data.text.noNewNotifications"/> <\/div> <!-- /ko --> <!-- ko if: data.notifications && data.notifications() && data.notifications().length --> <div class="fxs-notificationmenu-list-system"> <ul class="fxs-notificationmenu-list" data-bind="foreach: data.notifications"> <li> <a href="" role="button" class="fxs-has-hover fxs-notificationmenu-notificationclick"> <!-- ko if: status === MsPortalFx.Hubs.Notifications.NotificationStatus.InProgress --> <div class="fxs-notificationmenu-notification"> <div class="fxs-notificationmenu-notification-title"> <div class="fxs-notificationmenu-notification-title-icon" data-bind="image: $root.func._getIcon($data)"/> <div class="fxs-notificationmenu-notification-title-progresstext msportalfx-tooltip-overflow" data-bind="text: title"><\/div> <div data-bind="if: $data.percentComplete"> <div class="fxs-notificationmenu-notification-title-subtitle fxs-text-secondary" data-bind="text: $root.func._getPercentCompleteStr($data.percentComplete)"><\/div> <\/div> <\/div> <div class="fxs-notificationmenu-notification-progressbar" data-bind="pcProgressBar: $root.func._getProgressBarViewModel($data.percentComplete)"><\/div> <\/div> <!-- /ko --> <!-- ko ifnot: status === MsPortalFx.Hubs.Notifications.NotificationStatus.InProgress --> <div class="fxs-notificationmenu-notification"> <div class="fxs-notificationmenu-notification-title"> <div class="fxs-notificationmenu-notification-title-icon" data-bind="image: $root.func._getIcon($data)"/> <div class="fxs-notificationmenu-notification-title-text msportalfx-tooltip-overflow" data-bind="text: title"><\/div> <time class="fxs-notificationmenu-notification-title-subtitle fxs-text-secondary" data-bind="attr: { datetime: $root.func._timestampToString(timestamp) }, text: $root.func._timestampToString(timestamp)"><\/time> <\/div> <div class="fxs-notificationmenu-notification-description fxs-text-secondary msportalfx-tooltip-overflow" data-bind="text: description"><\/div> <\/div> <!-- /ko --> <\/a> <\/li> <\/ul> <\/div> <!-- /ko --> <\/div> <!-- /ko -->'}
}));define("_generated/Templates/WidgetsNotificationMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-button fxs-has-hover fxs-notificationmenu-button"> <div class="fxs-notificationmenu-icon" data-bind="image: data.icon"><\/div> <!-- ko if: data.unreadNotificationsCount --> <div class="fxs-notificationmenu-button-unreadcount" data-bind="text: data.unreadNotificationsCount, css: data.unreadCountClass"><\/div> <!-- /ko --> <\/div>'}}));define("MsPortalImpl/Widgets/Widgets.ToastViewModel",["require","exports","o","a","MsPortalImpl/Resources/ImplScriptResources","./Widgets.WidgetBase"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function s(n){var t=ko.unwrap(n&&n.timeoutID);t&&i.clearTimeout(t)}var i=window,t=ko.observable,e=ko.observableArray,o;n.clearItemTimeout=s;o=(function(n){function f(i){i===void 0&&(i={});n.call(this);this.displayCount=4;this.displayTime=t(5e3);this.shouldShowToasts=t(!0);this._items=e();this.eventHandlers=
e();this.displayCount=i.displayCount||this.displayCount;this.displayTime=i.displayTime||this.displayTime;this.shouldShowToasts=i.shouldShowToasts||this.shouldShowToasts}return __extends(f,n),f.prototype.addToasts=function(n){var i=this,f=r.isArray(n)?n:[n];f.length&&f.forEach((function(n){var h=i._items(),c=n.icon,l=n.title,a=n.description,v=n.uri,y=n.time,f=n.ids||[],p=n.inProgress||!1,w=n.progressBar||null,b=n.data||null,o=n.stayOpen||!1,k=n.htmlContent||"",d=n.clickable===undefined?!0:n.clickable,g=n.descriptiveText||u.Toast.description.format(n.title),r,s;f.length>0&&(r=h.first((function(n){var t=n.ids();return f.some((function(n){return t.indexOf(n)>-1}))})));r?(r.icon(c),r.title(l),r.description(a),r.uri(v),r.time(y),r.ids(f),r.inProgress(p),r.progressBar(w),r.data(b),r.stayOpen(o),r.clickable(d),r.htmlContent(k),r.descriptiveText(g)):(s={icon:t(c),title:t(l),description:t(a),uri:t(v),time:t(y),ids:e(f),inProgress:t(p),progressBar:t(w),stayOpen:t(o),data:t(b),htmlContent:t(k),timeoutID:
t(null),clickable:t(d),onDismissFn:n.onDismissFn,descriptiveText:t(g)},h.length>=i.displayCount&&i._removeLastRemoveableItem(),i._items.unshift(s),o||i.startRemoveTimer(s))}))},f.prototype._removeLastRemoveableItem=function(){for(var t,i=this._items(),n=i.length-1;n>=0;n--)if(t=i[n],!t.stayOpen()){this.removeToast(t);return}},f.prototype.removeToast=function(n){i.clearTimeout(n.timeoutID());this._items.remove(n)},f.prototype.removeAllToasts=function(){this._items().forEach((function(n){i.clearTimeout(n.timeoutID())}));this._items.removeAll()},f.prototype.startRemoveTimer=function(n){var r=this,t;typeof n.timeoutID=="function"&&(t=i.setTimeout((function(){r._items.remove(n)}),this.displayTime()),n.timeoutID(t))},f})(f.ViewModel);n.ViewModel=o})(e||(e={})),e}));define("_generated/Templates/WidgetsToast",["require","exports","f"],(function(){"use strict";return function(){return'<ul role="presentation" class="fxs-toast" data-bind="visible: data.shouldShowToasts, foreach: func._uiItems"> <li class="fxs-toast-item fxs-popup" role="alert" aria-live="polite" aria-atomic="true" data-bind="attr: { \'aria-label\': descriptiveText }"> <!-- ko ifnot: htmlContent --> <a class="fxs-toast-link" aria-hidden="true" data-bind="href: clickable ? \'#\' : null"> <div class="fxs-toast-header"> <div class="fxs-toast-icon" data-bind="image: icon"/> <div class="fxs-toast-title" data-bind="text: title"><\/div> <div class="fxs-toast-time fxs-text-secondary" data-bind="attr: { datetime: time }, text: time"><\/div> <\/div> <!-- ko ifnot: inProgress --> <div class="fxs-toast-description fxs-text-secondary" data-bind="sanitizedHtml: description"><\/div> <!-- /ko --> <!-- ko if: inProgress --> <div class="fxs-toast-progressbar" data-bind="pcProgressBar: progressBar"><\/div> <!-- /ko --> <\/a> <!-- /ko --> <!-- ko if: htmlContent --> <div class="fxs-toast-content" aria-hidden="true" data-bind="unsanitizedHtml: htmlContent"><\/div> <!-- /ko --> <button class="fxs-toast-close" aria-hidden="true" data-bind="image: MsPortalFx.Base.Images.Shell.Close()"><\/button> <\/li> <\/ul> '}
}));define("MsPortalImpl/Widgets/Widgets.Toast",["require","exports","f","o","../Base/Telemetry","./Widgets.WidgetBase","../../_generated/Templates/WidgetsToast","./Widgets.ToastViewModel","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var t=i.Base.EventTypes,l=i.Base.Diagnostics.Telemetry,b=window,r=".fxs-toast-item",h=".fxs-toast-link",c=".fxs-toast-close",a=u.Source.ToastTray,v=u.Action,y=l.trace,k=ko.observable,d=ko.observableArray,s=ko.dataFor,p=o.clearItemTimeout,w=(function(n){function u(t,r){n.call(this,t,r);this._uiItems=ko.computed(this.lifetimeManager,r._items,i.identity).extend({deferred:!0});this.element.html(e());this._attachEventHandlers();this._bindDescendants()}return __extends(u,n),u.prototype._attachEventHandlers=function(){var n=this.element,i=this.options,u=this.lifetimeManager,f,e,o=function(n){var t=s(n.currentTarget);p(t)},l=function(n){var t=s(n.currentTarget);t.stayOpen&&!t.stayOpen(
)&&i.startRemoveTimer(t)};n.on(t.focusin,r,o);n.on(t.focusout,r,l);n.on(t.mouseenter,r,o);n.on(t.mouseleave,r,l);n.on(t.click,h,f=function(r){var u=s(r.currentTarget);u.clickable()&&(r.preventDefault(),y({source:a,action:v.ToastClicked}),n.trigger(t.fxtoastclick,u.data()),i.removeToast(u))});n.on(t.click,c,e=function(n){n.preventDefault();var t=s(n.currentTarget);t.onDismissFn&&t.onDismissFn();i.removeToast(t)});i.eventHandlers.map(u,(function(t,i){n.on(i.events,i.selector,i.data,i.handler);t.registerForDispose((function(){n.off(i.events,i.selector,i.handler)}))}));u.registerForDispose((function(){n.off(t.focusin,r);n.off(t.focusout,r);n.off(t.mouseenter,r);n.off(t.mouseleave,r);n.off(t.click,h,f);n.off(t.click,c,e)}))},u})(f.Widget);n.Widget=w})(s||(s={})),s}));define("MsPortalImpl/Widgets/Widgets.NotificationMenu",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.GeneralSettings","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Widgets.WidgetBase",
"./Widgets.DropMenu","../../_generated/Templates/WidgetsNotificationMenu","../../_generated/Templates/WidgetsNotificationMenuButton","./Widgets.ToastViewModel","./Widgets.Toast","../../_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return (function(t){function oi(n,t){d({source:ot,action:k.NotificationMenuNotificationClick});t.trigger(it.fxnotificationclickinmenu,n)}var b=i.Base,tt=b.Diagnostics,wt=tt.Telemetry,it=b.EventTypes,p=b.Images.StatusBadge,r=i.Hubs.Notifications.NotificationStatus,rt=i.ViewModels.Controls.Visualization.ProgressBar.StatusType,bt=i.ViewModels.Controls.Visualization.ProgressBar.ViewModel,kt=r.Information,dt=r.Warning,gt=r.Error,ni=r.Success,ut=r.InProgress,w=u.NotificationMenu,ft=window,ti=ft.fx.environment,et=ti.features.rapidtoasts,ot=o.Source.TopBar,k=o.Action,d=wt.trace,ii=355,ri=20,g=ko.observable,st=it.click,y="fxs-notificationmenu",ht=y+"-dropmenu",ct=y+"-dropdown",lt=y+"-menu",at=
y+"-toast",vt=y+"-button-unreadcount",ui=vt+"-oval",fi=vt+"-circle",nt="a."+y+"-notificationclick",ei=w.title,yt,pt;t.iconMap={};t.iconMap[kt]=p.Info();t.iconMap[dt]=p.Warning();t.iconMap[gt]=p.Error();t.iconMap[ut]=p.Pending();t.iconMap[ni]=p.Success();ft.Intl||tt.createLog(n).warning("Intl polyfill not loaded");yt=(function(n){function t(){n.apply(this,arguments);this.unreadNotificationsCount=g("");this.unreadCountClass=g("");this.text=w;this.icon=e.Content.SvgStartup.notifications;this.menuOpen=g(!1);this.toastsEnabled=f.settings.notificationToastEnabledKey}return __extends(t,n),t})(s.ViewModel);t.ViewModel=yt;pt=(function(n){function i(t,i){var r=this,u,f,o,e;n.call(this,t,i);this._lastMenuOpenedTime=new Date;t.addClass(ht);t.append("<div class='"+lt+"'><\/div>"+("<div class='"+at+"' data-bind='stopBindings: true'><\/div>"));u=this.lifetimeManager;f=this._dropMenuViewModel=new h.ViewModel(l(),c());f.menuWidth=ii;f.buttonTooltip(ei);o=ko.computed(this.lifetimeManager,(function(){return!i.
menuOpen()&&i.toastsEnabled()&&et!=="0"}));e=this._toastViewModel=new a.ViewModel({shouldShowToasts:o});et==="true"&&e.displayTime(50);u.registerForDispose(this._dropMenuWidget=new h.Widget(t.findByClassName(lt),this._dropMenuViewModel));u.registerForDispose(new v.Widget(t.findByClassName(at),e));this._bindDescendants();ko.reactor(this.lifetimeManager,(function(){r._dropMenuWidget.options.isMenuOpen()?r._openMenu():r._closeMenu()}))}return __extends(i,n),i.prototype.getToastVM=function(){return this._toastViewModel},i.prototype.register=function(n){var i=this,r=this.options,f=this.lifetimeManager;r.notifications=n;n.subscribe(f,(function(n){var u=n.filter((function(n){return n.timestamp>i._lastMenuOpenedTime})),t=u.length;i._dropMenuWidget.options.buttonLabel(w.overflowTitle.format(t)||w.overflowTitle.format(0));t>ri?(r.unreadCountClass(ui),r.unreadNotificationsCount(w.overflowCountMessage)):(r.unreadCountClass(fi),r.unreadNotificationsCount(t?t.toString():""))}));n.subscribeArrayBulkChanges(
f,(function(n){if(r.toastsEnabled()){var f=[];n.forEach((function(n){if(n.timestamp>i._lastMenuOpenedTime){var r=i._timestampToString(n.timestamp),e=n.description||"",o=i._getProgressBarViewModel(n.percentComplete),s=n.status===ut?!0:!1,h=u.Toast.description.format(n.title),c=n.correlationIds;f.push({icon:t.iconMap[n.status],title:n.title,description:e,time:r,ids:c,inProgress:s,progressBar:o,descriptiveText:h,data:n})}}));f.length&&i._toastViewModel.addToasts(f)}}))},i.prototype._getIcon=function(n){return t.iconMap[n.status]},i.prototype._timestampToString=function(n){var t="numeric";return n.toString({hour:t,minute:t})},i.prototype._getProgressBarViewModel=function(n){var u=!0,i=0,r=rt.Indeterminate,t;return n&&(u=!1,i=n,r=rt.InProgress),t=new bt(this.lifetimeManager),t.valuePercentage(i),t.status(r),t},i.prototype._getPercentCompleteStr=function(n){return this.options.text.percentComplete.format(n)},i.prototype.dispose=function(){this._removeEventHandlers();this._dropMenuWidget.dispose(
);this._cleanElement(ht);n.prototype.dispose.call(this)},i.prototype.getDropMenuWidget=function(){return this._dropMenuWidget},i.prototype._removeEventHandlers=function(){var n=this._notificationClickEventHandler;n&&(this.element.findByClassName(ct).off(st,nt,n),this._notificationClickEventHandler=null)},i.prototype._openMenu=function(){var f=this,n=this.element,t=this.options,i,u;if(d({source:ot,action:k.NotificationMenuOpen}),i=n.findByClassName(nt)[0],i&&i.focus(),t.menuOpen(!0),this._toastViewModel.removeAllToasts(),u=t.notifications().filter((function(n){return n.isRecommendation&&n.timestamp>f._lastMenuOpenedTime})),u.forEach((function(n){var t=n.additionalProperties||{};b.Utilities.extend(t,{status:r[n.status],correlationId:n.correlationIds&&n.correlationIds.join(",")});d({source:o.Source.NotificationHub,action:k.RecommendationSurfaced,data:t})})),this._lastMenuOpenedTime=new Date,t.unreadNotificationsCount(""),!this._notificationClickEventHandler)n.findByClassName(ct).on(st,nt,this.
_notificationClickEventHandler=function(t){t.preventDefault();var i=ko.dataFor(t.currentTarget);oi(i,n)})},i.prototype._closeMenu=function(){this.options.menuOpen(!1);this._removeEventHandlers()},i})(s.Widget);t.Widget=pt})(y||(y={})),y}));define("_generated/Templates/WidgetsPanorama",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-target" aria-labelledby="startboard-title"><\/div> <div class="fxs-journey-target"><\/div>'}}));define("MsPortalImpl/Widgets/Widgets.Panorama",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","./Widgets.WidgetBase","../Widgets/Widgets.Common","../../_generated/Templates/WidgetsPanorama","./Widgets.StartBoard","./Widgets.UIElementBase","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){var c=i.Base,t=c.EventTypes,b=c.Utilities,l=window,k=l.fx.environment.features,a=jQuery,r="fxs-panorama",d=r+"-previewbadge",
g=r+"-previewbadge-text",nt="fxs-startboard-target",tt="fxs-journey-target",it="fxs-journey-layout",v="fxs-blade",y=b.htmlEncode(u.Portal.preview),p="Can't add null child.",rt=(function(n){function t(t,i){n.call(this,t);this.rotateThemeEvent=null;this.applyViewSettings(i)}return __extends(t,n),t.prototype.getViewSettings=function(){return{}},t.prototype.applyViewSettings=function(){return},t})(h.ViewModel),w;n.ViewModel=rt;w=(function(n){function u(t,i){n.call(this,t,i);t.addClass(r).html(o());t.findByClassName(d).attr("title",y).findByClassName(g).text(y);this._attachEventHandlers();this._scrollBarSize=e.getBrowserScrollbarWidth()}return __extends(u,n),u.prototype.dispose=function(){this._cleanElement(r);n.prototype.dispose.call(this)},u.prototype.addChild=function(n){if(!n)throw new Error(p);this.getJourneyWidget().addChild(n)},u.prototype.insertChild=function(n,t){if(!n)throw new Error(p);this.getJourneyWidget().insertChild(n,t)},u.prototype.removeChild=function(n){var t=this.getJourneyWidget(
);return t&&t.removeChild(n)},u.prototype.getStartBoardArea=function(){return this.element.findByClassName(nt)},u.prototype.getJourneyArea=function(){return this.element.findByClassName(tt)},u.prototype.getStartBoardWidget=function(){return f.Widget.getWidget(this.getStartBoardArea(),s.Widget)},u.prototype.getJourneyWidget=function(){var n=f.Widget.getWidgets(this.getJourneyArea());if(n.length>1)throw new Error("The journey target has been initialized with more than one widget.");return n[0]},u.prototype.saveViewSettings=function(){return this.options.getViewSettings()},u.prototype.ensureElementInViewport=function(n,t){var i,c;if(n){if(i=n.element,c=this.element,t){this._snapElementToEdge(i);return}var u,e=i.outerWidth(),o=this.element.outerWidth(),f=this.element.scrollLeft(),s=f+o,r=i.position().left,h=r+e;r<f?u=r:h>s&&(u=e>o?r:f+(h-s));this.element.scrollLeft(u)}},u.prototype._attachEventHandlers=function(){var u=this,n=this.element,f,e,o,s;n.on(t.doubleclick,f=function(n){var i=a(n.
target),f=i.hasClass(r),e=i.hasClass("fxs-startboard-layout"),o=i.hasClass("fxs-flowlayout-childcontainer"),s=i.hasClass(it);(f||e||o||s)&&(n.preventDefault(),n.stopPropagation(),l.getSelection().removeAllRanges(),u.trigger(t.fxrotatetheme))});n.on(t.fxensureviewportvisible,e=function(n,t){n.stopPropagation();u.ensureElementInViewport(t.widget,t.alignStart)});n.on(t.mousedown,o=function(i){if(i.pageY>=n.outerHeight()-u._scrollBarSize){var r;n.on(t.mouseup,r=function(){n.off(t.mouseup,r);var i=u._tryGetLeftMostBladeInView();i.length>0&&i.trigger(t.fxactivatepairmaster)})}});n.on(t.fxpancomplete,s=function(n,t){n.stopPropagation();u._snapBladeToEdge(t)});k.makethewebweird==="true"&&i.require("MsPortalImpl/Interactions/Interactions.MousePanning").then((function(t){var i=new t.MousePanning(n);u.lifetimeManager.registerForDispose((function(){i.dispose()}))}));this.lifetimeManager.registerForDispose((function(){n.off(t.doubleclick,f);n.off(t.fxensureviewportvisible,e);n.off(t.mousedown,o);n.off(t.
fxpancomplete,s)}))},u.prototype._snapBladeToEdge=function(n){var h=this.element.offset(),r=this._tryGetLeftMostBladeInView(),i,f,e,o;if(r.length!==0){if(n===0){r.trigger(t.fxactivatepairmaster);return}var c=r.outerWidth(!1),l=r.offset(),a=l.left-h.left,s=Math.abs(a/c),y=1-s,u;n===1&&(u=s>=.2?!0:!1);n===2&&(u=y>=.2?!1:!0);i=r;f="."+v;u?(e=r.next(f),i=e.length!==0?e:r):i=r;o=i.next(f).length>0;o?i.trigger(t.fxactivatepairmaster):o||i.prev().trigger(t.fxactivatepairmaster);i.hasClass("fxs-blade-pairdetails")&&i.hasClass("fxs-blade-pair-fullscreen")&&(i=i.prev());this._snapElementToEdge(i)}},u.prototype._snapElementToEdge=function(n){var t=this;n&&n.length!==0&&n.handleTransitionEndOnce("width",200,(function(){var i=t.element,r;i.width()>=n.width()&&(r=n.position().left,i.scrollLeft(r))}))},u.prototype._tryGetLeftMostBladeInView=function(){var t="."+v,n=this.element.offset(),i=document.elementFromPoint(n.left,n.top);return a(i).closest(t)},u})(h.Widget);n.Widget=w})(c||(c={})),c}));define("_generated/Templates/WidgetsSearch",
["require","exports","f"],(function(){"use strict";return function(){return'<div class="fxs-search" role="search" data-bind="css: { \'fxs-search-expanded\': data.isExpanded(), \'fxs-search-no-journeys\': !data.journeysShown() }"> <div class="fxs-box-wrapper" data-bind="css: { \'fxs-searching\': data.showSearching() }"> <div class="fxs-icon msportalfx-svg-flip-horizontal" data-bind="image: MsPortalFx.Base.Images.Search()"><\/div> <div class="fxs-searchbox fxs-topbar-input"><\/div> <div class="fxs-indicator"> <div><\/div><div><\/div><div><\/div> <\/div> <div role="presentation" class="fxs-cross">&times;<\/div> <\/div> <a href="#" class="fxs-search-icon fxs-topbar-button fxs-has-hover"> <div class="msportalfx-svg-flip-horizontal" data-bind="image: MsPortalFx.Base.Images.Search()"><\/div> <\/a> <div class=\'fxs-menu fxs-popup fxs-dropmenu-content\' data-bind=\'visible: data.showMenu()\' title=\'\'><\/div> <\/div>'}}));define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","f","o",
"MsPortalImpl/Resources/ImplScriptResources","../../Viva.Controls/Controls/Forms/Viva.TextBox","./Widgets.WidgetBase","../../_generated/Templates/WidgetsSearch","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var l=i.Base,r=l.EventTypes,c;n.searchClass="fxs-search";n.searchBoxClass="fxs-searchbox";var a="fxs-search-icon",v="fxs-hidden-important",s=u.Search,y=window.fx.environment,t=ko.observable,h=ko.observableArray,p=(function(n){function i(){n.apply(this,arguments);this.journeysShown=t(!1);this.isExpanded=t(!1);this.showMenu=t(!0);this.showResults=t(!1);this.showSearching=t(!1);this.showExternalColumn=t(!1);this.showAllSubscriptionsSearch=t(!1);this.showChangeSubscriptions=t(!1);this.text=s;this.filter=t();this.searchInFilterText=t();this.subscriptionSummary=t();this.mruItems=h();this.results=h()}return __extends(i,n),i})(e.ViewModel);n.ViewModel=p;c=(function(u){function e(e,h){var c=this,b;u.call(this,e,h);
this._initialized=Q.defer();b=n.searchClass;e.addClass(b).html(o());y.chrome.hideSearchBox&&e.addClass(v);this._bindDescendants({text:h.text});var tt=e.findByClassName(n.searchBoxClass),k=this._textWidget=new f.Widget(tt,{placeholder:t(s.placeholder),readonly:t(!1)}),it=this._textField=$(k._getElementToFocus()),w,d,g,l=r.focusin,nt=r.mousedown,p=e.findByClassName(a);e.on(l,w=function(){e.off(l,w);var n=c._initOptions;(n&&n()||Q(!0)).then((function(){i.require("MsPortalImpl/Widgets/Widgets.SearchDefered").then((function(n){c._initialized.resolve();n.initialize(c,it)}))}))});p.on(l,d=function(n){n.preventDefault();c.setFocus()});p.on(nt,g=function(n){n.preventDefault();c.setFocus()});this.lifetimeManager.registerForDispose((function(){k.dispose();e.off(l,w);p.off(l,d);p.off(nt,g)}))}return __extends(e,u),e.prototype.setFocus=function(){this.options.isExpanded(!0);this._textField.focus()},e.prototype.initOptions=function(n){this._initOptions=n},e.prototype.isDropdownInitialized=function(){return this.
_initialized.promise},e})(e.Widget);n.Widget=c})(s||(s={})),s}));define("_generated/Templates/WidgetsSideBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-sidebar-bar" role="navigation"> <button class="fxs-sidebar-collapse-button fxs-has-hover" role="button" data-bind="image: data.icons.hamburger"><\/button> <!-- ko if: data.cloudOptions().length > 1 --> <!--TODO 7288579 cscro: remove fxs-blade-color-trim when bug--> <div class="fxs-sidebar-cloudFilter fxs-blade-color-trim" data-bind=\'formElement: func.cloudDropDown\'><\/div> <!-- /ko --> <button class="fxs-sidebar-create fxs-has-hover fxs-has-border" role="button" data-bind="attr: { title: data.createTooltip }, visible: !data.hideCreateButton()"> <div class="fxs-sidebar-button-flex"> <div class="fxs-sidebar-create-icon fxs-fill-success" data-bind="image: data.icons.plus"><\/div> <div class="fxs-sidebar-create-label fxs-sidebar-show-if-expanded" data-bind="text: data.createText"><\/div> <\/div> <\/button> <ul class="fxs-sidebar-favorites"> <!-- ko foreach: data.favorites --> <!-- ko if: $data && typeof($data) !== "string" && $data.cloudName === $root.data.selectedCloud() --> <li class="fxs-sidebar-item fxs-has-hover fxs-sidebar-draggable fxs-sidebar-droppable fxs-has-border" draggable="true"> <a href="" class="fxs-sidebar-item-link" data-bind="attr: { href: uri, title: label, role: opensExternal ? \'link\' : \'button\' }"> <div class="fxs-sidebar-handle fxs-fill-secondary" data-bind="image: $root.data.icons.ellipsis"><\/div> <div class="fxs-sidebar-icon" data-bind="image: image"><\/div> <div class="fxs-sidebar-label fxs-sidebar-show-if-expanded" data-bind="text: label"><\/div> <div class="fxs-sidebar-external fxs-sidebar-show-if-expanded"> <!-- ko if: $data.opensExternal --> <div class="fxs-fill-secondary" data-bind="image: $root.data.icons.hyperlink"><\/div> <!-- /ko --> <\/div> <\/a> <\/li> <!-- /ko --> <!-- /ko --> <li> <button class="fxs-sidebar-browse fxs-has-hover fxs-menu-browse" data-bind="attr: { title: data.browseTooltip }"> <div class="fxs-sidebar-button-flex"> <div class="fxs-sidebar-browse-label fxs-sidebar-show-if-expanded" data-bind="text: data.browseText"><\/div> <div class="fxs-sidebar-browse-icon" data-bind="image: data.icons.caretUp"><\/div> <\/div> <\/button> <\/li> <\/ul> <\/div> <div class="fxs-sidebar-flyout fxs-popup fxs-sidebar-flyout-is-hidden"> <div class="fxs-sidebar-browse-flyout"> <div class="fxs-sidebar-flyout-header"> <button class="fxs-sidebar-flyout-close fxs-fill-secondary" data-bind="image: data.icons.close, attr: { title: data.closeText }"><\/button> <\/div> <div class="fxs-sidebar-content"> <div class="fxs-sidebar-hint-text" data-bind="attr: { title: data.toggleShortcutHintText }, text: data.toggleShortcutHintText"><\/div> <input class="fxs-sidebar-filter-input fxs-input fxs-input-default" role="combobox" data-bind="attr: { placeholder: data.placeholder, \'aria-label\': data.placeholder }, css: { \'fxs-sidebar-filter-categories\': data.showDisplayModePicker() }, valueUpdate: \'input\', value: data.filterInputValue" type="text"/> <div class="fxs-sidebar-dropdown-container" data-bind="stopBindings: true, css: { \'fxs-sidebar-hide\': !data.showDisplayModePicker() }"> <div class="fxs-sidebar-dropdown"><\/div> <\/div> <\/div> <ul tabindex="-1" aria-expanded="true" class="fxs-sidebar-possible-favorites" data-bind="css: { \'fxs-sidebar-adjustment\': data.showDisplayModePicker() }"> <!-- ko foreach: data.visibleCategories --> <!-- ko ifnot: $data.isHidden --> <!-- ko if: $data.showLabel --> <div class="fxs-sidebar-item-category" data-bind="css: { \'fxs-sidebar-hide\': $data.isFilteredOut() }"> <div class="fxs-sidebar-label" data-bind="text: label, attr: { title: label }"><\/div> <\/div> <!-- /ko --> <!-- ko foreach: $data.possibleFavorites --> <!-- ko if: $data.cloudName === $root.data.selectedCloud() --> <!-- ko ifnot: $data.isHidden --> <li tabindex="-1" class="fxs-sidebar-item fxs-has-hover" data-bind="css: { \'fxs-sidebar-hide\': $data.isFilteredOut() || $parent.isFilteredOut() }, attr: { id: labelId }"> <div class="fxs-sidebar-item-content"> <a href="" tabindex="-1" class="fxs-sidebar-item-link" data-bind="attr: { href: uri, role: opensExternal ? \'link\' : \'button\'}"> <div class="fxs-sidebar-icon" data-bind="image: image"><\/div> <div class="fxs-sidebar-label"> <span data-bind="text: label, attr: { title: label }"><\/span> <!-- ko if: $data.matches --> <div class="fxs-sidebar-matches"><span class="fxs-sidebar-matches-prefix" data-bind="text: $root.data.matchesPrefix"><\/span> <span data-bind="text: $data.matches, attr: { title: $data.matches }"><\/span><\/div> <!-- /ko --> <\/div> <!-- ko if: $data.isPreview --> <span class="fxc-preview" data-bind="text: $root.data.previewText, attr: { title: $root.data.previewText }"><\/span> <!-- /ko --> <!-- ko if: $data.opensExternal --> <div class="fxs-sidebar-external"> <div class="fxs-fill-secondary" data-bind="image: $root.data.icons.hyperlink"><\/div> <\/div> <!-- /ko --> <\/a> <!-- ko ifnot: $data.opensExternal --> <div class="fxs-sidebar-item-icon fxs-sidebar-home" data-bind="image: $root.data.icons.home, css: {\'fxs-is-home\': isHome}"><\/div> <!-- /ko --> <div class="fxs-sidebar-item-icon fxs-sidebar-star" data-bind="image: $root.data.icons.star, css: {\'fxs-is-favorite\': isFavorite}"><\/div> <\/div> <\/li> <!-- /ko --> <!-- /ko --> <!-- /ko --> <!-- /ko --> <!-- /ko --> <\/ul> <!-- ko if: data.feedbackLabel --> <div class="fxs-popup-feedback"> <a href=\'#\' class=\'fxs-sidebar-feedback-link\' role=\'button\' data-bind="text: data.feedbackLabel, attr: { title: data.feedbackLabel }"><\/a> <\/div> <!-- /ko --> <\/div> <\/div> '}
}));define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","f","i","o","../Base/Base.Router","../Interactions/Interactions.DismissHandler","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","../Services/Services.GeneralSettings","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Widgets.WidgetBase","../../_generated/Templates/WidgetsSideBar","./Widgets.DropMenu","../../_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";var p;return (function(n){function rt(n,t,i){var r=n.subscribe((function(n){t(n)}));i&&r.callback(n())}function d(n,t,i){ur.trace({source:l.Source.SideBar,name:t,action:n,data:i})}function kt(n,t,i,r){d(n,i,yr({view:iu(t)},r||{}))}function dr(n,t,i,r){var f=r?u.expand:u.collapse;n.toggleClass(cr,r);t.attr({title:f,"aria-expanded":!r});n.handleTransitionEndOnce("width",150,(function(){$(ri).trigger(b.resize)}))}function ai(n,t,i,r){n.removeClass(p);(n.length===0||
t.length===0)&&(t=i);r.attr(ui,t.attr("id"));t.addClass(p);t.get(0).scrollIntoView(!1)}function gr(n){var i=n.isCollapsed,f=i(),t=!f,r=n.saveCollapseState,u=n.getStartboardVisible;u&&u()&&r&&r(t);i(t);d(w.SideBarViewChanged,"",t?"collapsed":"expanded")}function ht(n,t){var e;if(!n.isHome()&&!n.opensExternal){var r=n.id,u=t.favorites,f=u().firstIndex((function(n){return n.id===r}));t.categories().forEach((function(n){n.possibleFavorites().forEach((function(n){return n.isHome(!1)}))}));f===-1&&(n.isFavorite(!0),e=t.possibleFavorites().first((function(n){return n.id===r})),u.push(e),t.add(r),f=i.findIndex(t.favorites(),(function(n){return n.id===r})));f>0&&(u.splice(0,0,u.splice(f,1)[0]),t.move(0));n.isHome(!0);d(w.SideBarFavorite,r,{totalFavorites:u().length})}}function dt(n,t){var u=n.id,f=t.favorites,r=f().firstIndex((function(n){return n.id===u})),e,o,s,h;n.isFavorite()?r!==-1&&(r!==0||n.id!==lt)&&(r===0&&(s=i.find(t.possibleFavorites(),(function(n){return n.id===lt})),s&&ht(s,t)),n.isFavorite(!1),
f.splice(r||1,1),e=w.SideBarUnFavorite,o=t.remove):r===-1&&(n.isFavorite(!0),h=t.possibleFavorites().first((function(n){return n.id===u})),f.push(h),e=w.SideBarFavorite,o=t.add);e&&d(e,u,{totalFavorites:f().length});o&&o(u)}function vi(n,t,i){if(t){var u=i.favorites,r=u.indexOf(n),f=u.indexOf(t);if(r||!t.opensExternal)return d(w.SideBarFavoriteMoved,t.id,{oldIndex:f,newIndex:r}),u.splice(r,0,u.splice(f,1)[0]),i.move(r),r}return-1}function yi(n,t,i){var u=$(document.activeElement).parent(),f=i?u.next(ci)[0]:u.prev(ci)[0],e,r,o,s;f&&(e=st(f),r=vi(e,n,t),r>=0&&(o=t.favorites()[r].uri,s=$("."+hi+" [href|='"+o+"']"),s.focus()))}function bi(n){return(pi.test(n)||wi.test(n))&&(n+=" "+n.replace(pi,"$1 ").replace(wi,"")),n.toLowerCase()}function nu(n){return n.toLowerCase().replace(gt," ").split(" ")}function ki(n,t){return bi(n).replace(gt," ").split(" ").map((function(n){return{value:n,keywordHint:t}}))}function tu(n,t){var i=!!n.length,r;t.isFiltered(i);r=nu(n);t.possibleFavorites().forEach((function(
n){var f=!0,e=[],t,u;i&&(t=ni[n.id],u=n.keywords,t||(t=ki(n.label(),!1),u&&t.push.apply(t,ki(u,!0)),ni[n.id]=t),f=r.every((function(n){var i=t.filter((function(t){if(t.value.startsWith(n)){if(t.keywordHint){var r=u.split(","),i=r.first((function(t){var i=bi(t).replace(gt," ");return i.startsWith(n)||RegExp(" "+n).test(i)}));i=(i||r.first((function(t){return t.indexOf(n)>=0}))||"").trim();e.push(i)}return!0}return!1}));return i.length>0})));n.isFilteredOut(!f);n.matches(i&&e.first())}))}function ti(n){var t=n.findByClassName(p);t.removeClass(p)}function di(n,t){var i=n.find("."+ft+":not("+ot+")").first();i.addClass(p);t.attr(ui,i.attr("id"))}function g(n){n.preventDefault()}function tt(n){n.stopPropagation()}function gi(n,t){n.displayModeTitle(t===0?u.showByCategory:u.showByName)}function iu(n){return n===0?"category":"name"}var ut=i.Base,tr=i.ViewModels.Forms.DropDown,ir=tr.ViewModel,b=ut.EventTypes,rr=ut.Utilities,ur=ut.Diagnostics.Telemetry,ii=c.Content.SvgStartup,ri=window,ui="aria-activedescendant",
fi=ri.fx.environment,k=b.click,fr=fi.branding,er="fxs-sidebar-flyout-close",or="fxs-sidebar-collapse-button",sr="fxs-sidebar-create",hr="fxs-sidebar-draggable",ct=".fxs-sidebar-droppable",cr="fxs-sidebar-is-collapsed",p="fxs-is-selected",ft="fxs-sidebar-item",lr="."+ft+" a",lt=r.Extension.getHubsWindowId()+"_Dashboard",it="fxs-sidebar-entered",et="."+it,ar="fxs-sidebar-filter-input",vr="fxs-sidebar-flyout",ei="fxs-sidebar-flyout-is-hidden",oi="fxs-sidebar-flyout-is-open",yr=ut.Utilities.extend,at=40,vt=38,yt=b.keydown,pt=b.keyup,si=h.settings,hi="fxs-sidebar-bar",pr="fxs-sidebar-browse",wt="fxs-sidebar-browse-shown",wr="fxs-sidebar-feedback-link",bt="fxs-sidebar-feedback-link-disabled",ot=".fxs-sidebar-hide",ci="li."+ft,br="fxs-sidebar-possible-favorites",u=o.SideBar,w=l.Action,t=ko.observable,nt=ko.observableArray,st=ko.dataFor,li=i.isFeatureEnabled("userdefineddefaultview"),kr=(function(n){function i(){n.call(this);this.browseText=rr.htmlEncode(fr.browseLabel);this.closeText=u.close;this.
browseTooltip=this.browseText;this.createText=u.create;this.createTooltip=u.create;this.favorites=nt();this.isCollapsed=t(!0);this.isFlyoutOpen=t(!1);this.isFiltered=t(!1);this.possibleFavorites=nt();this.categories=nt();this.visibleCategories=nt();this.showCategories=t(!1);this.showDisplayModePicker=t(!1);this.previewText=u.preview;this.icons=ii;this.placeholder=u.search;this.toggleShortcutHintText=li?u.toggleShortcutHints:u.toggleShortcutHint;this.cloudOptions=nt();this.selectedCloud=t();this.displayModeTitle=t();this.displayModes=nt();this.filterInputValue=t();this.feedbackLabel=t(u.feedbackTitle);this.matchesPrefix=t(u.keywords);this.populationTelemetry=t();this.allAssetTypesLoaded=t(!1);this.goToDashboard=function(){return Q()};this.hideCreateButton=t(!0);this.hideCreateButton(fi.chrome.hideCreateButton)}return __extends(i,n),i.prototype.openFavorite=function(n,t,i){var r,u;if(typeof n=="number"?(u=this.favorites(),n||u.length?r=this.favorites()[n]:(r=this.possibleFavorites().first(
(function(n){return n.id===lt})),r?this.favorites.push(r):this.goToDashboard())):r=n,r){if(r.opensExternal)return this.openExternal(r.uri),!0;if(!t&&!i)return r.opensDashboard?this.goToDashboard():this.launchBlade(r.uri),!0}},i.prototype.openExternal=function(n){window.open(n,"_blank")},i.prototype.attachFavoritesManager=function(n){rt(n.favorites,this.favorites);rt(n.possibleFavorites,this.possibleFavorites);rt(n.categories,this.categories);rt(n.showCategories,this.showCategories);rt(this.selectedCloud,n.selectedCloud,!0);this.add=n.add;this.move=n.move;this.remove=n.remove},i})(a.ViewModel),ni,nr;n.ViewModel=kr;n.setAsHome=ht;n.toggleFavorite=dt;var pi=/([a-z](?=[A-Z][^ ]))/g,wi=/[^a-z0-9 ]/gi,gt=/[^a-z0-9]/gi;ni={};nr=(function(n){function r(r,f){var h=this,e,rt,o,c,s,d,a,ct,lt,nt,it,pt;n.call(this,r,f);this._validateForDismiss=function(n){var t=h.element[0];return!(t===n)&&!$.contains(t,n)};this._dismissHandle={dismissFn:function(){h.hideFlyout()},shouldDismissOnMouseDownFn:this._validateForDismiss,
shouldDismissOnMouseWheelFn:this._validateForDismiss,logName:"sideBarFlyout"};r.html(v());li&&r.addClass("fxs-sidebar-defaultviewenabled");e=r.findByClassName.bind(r);this._createButton=e(sr);this._filterInput=e(ar);this._flyout=e(vr);this._browseLink=e(pr);this._closeButton=e(er);rt=this._collapseButton=e(or);this._sideBar=e(hi);var ut=this._feedbackLink=e(wr),ft=i.getUniqueId(),at=this._flyout.findByClassName(br);at.attr("id",ft);this._filterInput.attr("aria-owns",ft);o=this.lifetimeManager;c=e("fxs-sidebar-favorites");c.hover((function(){return c.addClass("fxs-hovered")}),(function(){return c.removeClass("fxs-hovered")}));s=this._displayMode=si.sideBarBrowseDisplayModeKey();s!==0&&s!==1&&(s=this._displayMode=0);gi(f,s);kt(w.SideBarBrowseMenuViewInitialized,s);var p=[{id:"_",label:"",showLabel:t(!1),isFilteredOut:t(!0),isHidden:t(!1),possibleFavorites:f.possibleFavorites}],et=f.showCategories,l=f.categories,ot=f.isFiltered,b=function(){var n=et()&&!ot();f.showDisplayModePicker(n);n=n&&h.
_displayMode!==1;p.forEach((function(t){t.isFilteredOut(n)}));l().forEach((function(t){t.isFilteredOut(!n)}))},st=f.visibleCategories;st(p.concat(l()));l.subscribe(o,(function(){st(p.concat(l()))}));var ht=f.cloudOptions,vt={label:t(u.cloud),options:ht},yt=this.cloudDropDown=new ir(o,vt),k=yt.value;ht.subscribe(o,(function(n){n.length>0&&!k()&&k(n[0].value)}));k.subscribe(o,(function(n){f.selectedCloud(n)}));d="data.displayModeTitle";a=new y.ViewModel('<div class="fxs-sidebar-dropdown-title fxs-portal-text-primary" data-bind="text: '+d+", attr: { title: "+d+' }"><\/div><button type="button" tabindex="-1" class="fxs-sidebar-dropdown-button"><div class="fxs-sidebar-dropdown-button-container">'+('<div class="fxs-sidebar-dropdown-button-icon">'+ii.caretDown.data+"<\/div>")+"<\/div><\/button>",'<div class="fx-dropmenu-dropdown"><ul class="fx-dropmenu-list-system"><!-- ko foreach: data.displayModes --><li class="fxs-sidebar-dropdown-item fxs-has-hover"><a href="" data-bind="attr: { title: title, id: displayMode }, click: $parent.func.clickHandler"><div class="fxs-sidebar-dropdown-item-title" data-bind="text: title"><\/div><\/a><\/li><!-- /ko --><\/ul><\/div>');
a.alignMenu=0;ct=new y.Widget(e("fxs-sidebar-dropdown"),a);f.displayModes([{displayMode:0,title:u.showByCategory},{displayMode:1,title:u.showByName}]);lt=function(n,t){g(t);tt(t);var i=h._displayMode=n.displayMode;gi(f,i);b();a.close();si.sideBarBrowseDisplayModeKey(i);kt(w.SideBarBrowseMenuViewChanged,i)};ko.applyBindings({data:f,func:{clickHandler:lt}},ct.element[0]);this._bindDescendants();this._attachEventHandlers(o,r,f);nt=!1;ut.addClass(bt);f.isFlyoutOpen.subscribe(o,(function(n){var t=h._initOptions;n&&!nt&&t&&t().then((function(){nt=!0;ut.removeClass(bt)}))}));it=f.isCollapsed;it.subscribe(o,(function(n){dr(r,rt,f,n)})).callback(it());et.subscribe(o,b);ot.subscribe(o,b).callback(!0);pt=f.allAssetTypesLoaded}return __extends(r,n),r.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement();var t=this._dismissHandle;t&&e.unregister(t);this._dismissHandle=null},r.prototype.initOptions=function(n){this._initOptions=n},r.prototype.showFlyout=function(){var n=this._flyout,
t=this._filterInput;n.addClass(oi);n.removeClass(ei);this._filterInput.focus();this.options.isFlyoutOpen(!0);di(n,t);d(w.SideBarBrowseMenuOpened);e.register(this._dismissHandle)},r.prototype.hideFlyout=function(){var n=this._flyout,t;n.removeClass(wt);this._browseLink.removeClass(p);n.removeClass(oi);n.addClass(ei);t=this.options;t.filterInputValue("");t.isFlyoutOpen(!1);ti(n);e.unregister(this._dismissHandle)},r.prototype.toggleFlyout=function(){this.options.isFlyoutOpen()?this.hideFlyout():this._flyout.hasClass(wt)?this.showFlyout():this._browseLink.click()},r.prototype.openCreate=function(){d(w.SideBarNewMenuOpened);this.hideFlyout();this.options.launchBlade(f.getGalleryDeepLink("hub","",this.cloudDropDown.value()))},r.prototype._attachEventHandlers=function(n,t,i){var u=this,f=this._flyout,e=this._filterInput,a=this._sideBar,l=this._feedbackLink,r=function(t,i,r,u){t.on(i,r,u);n&&n.registerForDispose((function(){t.off(i,r,u)}))},o,h,c;r(this._createButton,k,null,(function(){u.openCreate(
)}));o=this._browseLink;h=function(){o.addClass(p);f.addClass(wt);u.toggleFlyout()};r(o,k,null,h);r(o,pt,null,(function(n){if(n.keyCode===13)return h(),!1}));r(this._closeButton,k,null,(function(){u.hideFlyout()}));r(t,k,lr,(function(n){var t=ko.dataFor(n.target);u.hideFlyout();kt(w.SideBarItemOpened,u._displayMode,t.id,{isFavorite:t.isFavorite(),isHome:t.isHome()});u.options.openFavorite(t)&&g(n)}));r(t,k,".fxs-sidebar-item-icon",(function(n){var r=ko.dataFor(n.target),t=$(n.currentTarget),u;t.hasClass("fxs-sidebar-home")?ht(r,i):t.hasClass("fxs-sidebar-star")&&dt(r,i);ti(f);u=t.closest("li");u.addClass(p);e.focus()}));r(this._collapseButton,k,null,(function(){gr(i)}));ko.reactor(n,i.favorites,(function(n){n.forEach((function(n,t){n.isHome(!t)}))}));c=s.getModifierKeys;r(a,yt+" "+pt,null,(function(n){var t=n.keyCode,r;(t===at||t===vt)&&c(n)===5&&(g(n),n.type===yt?u._dragItem=st(n.target):(r=u._dragItem,t===at?yi(r,i,1):yi(r,i,0)))}));r(e,yt,null,(function(n){var r=c(n),e=f.findByClassName(p),t;if(e.length>
0&&(t=ko.dataFor(e[0])),n.keyCode===vt&&g(n),n.keyCode===13&&r===4)return ht(t,i),tt(n),!1;if(n.keyCode===32&&r===4)return dt(t,i),tt(n),!1;n.keyCode===13&&r===0&&(t&&(u.hideFlyout(),i.openFavorite(t)),tt(n))}));r(e,pt,null,(function(n){var t=f.findByClassName(p),r=f.findByClassName(ft).not(ot).first(),u=t.nextAll("li").not(ot),i;switch(n.keyCode){case at:i=u.first();ai(t,i,r,e);tt(n);break;case vt:i=t[0]===r[0]?u.last():t.prevAll("li").not(ot).first();ai(t,i,r,e);tt(n)}}));i.filterInputValue.subscribe(n,(function(n){tu(n,i);var t=f.findByClassName(p);t.is(":visible")||(ti(f),di(f,e))}));r(t,b.dragstart,"."+hr,(function(n){var t=n.originalEvent.dataTransfer;t.setData("text","foo");t.effectAllowed="move";u._dragItem=st(n.target)}));r(t,b.dragover,null,(function(n){g(n)}));r(t,b.dragenter,null,(function(n){var t=$(n.target),i=t.closest(ct),r=t.closest(et);r.length===0&&($(et).removeClass(it),i.length&&i.addClass(it))}));r(t,b.dragleave,null,(function(n){var t=$(n.target).closest(ct).length===0?!0:!1;
t&&$(et).removeClass(it)}));r(t,b.drop,null,(function(n){var t=n.target,r=$(t).closest(ct),f=st(t);g(n);$(et).removeClass(it);r.length&&vi(f,u._dragItem,i)}));r(l,k,null,(function(n){g(n);l.hasClass(bt)||i.openFeedbackPane()}))},r})(a.Widget);n.Widget=nr})(p||(p={})),p}));define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","f","o","../Interactions/Interactions.ContextMenuTouch","../Interactions/Interactions.OverflowAutoTooltip","../Services/Services.GeneralSettings","../Base/Telemetry","./Widgets.WidgetBase","./Widgets.ContextPane","./Widgets.HelpMenu","./Widgets.NotificationMenu","./Widgets.Panorama","./Widgets.Search","./Widgets.SideBar","./Widgets.ToastViewModel","./Widgets.TopBar"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";var b;return (function(n){var k=i.Base.UriBuilder,ut=i.Base.Diagnostics.Telemetry,ft=i.Base.EventTypes,d=window,bt=jQuery,g=ft,et=d.fx.environment,r=et.features,nt=r.rapidtoasts,ot="fxs-topbar-helpmenu",st="fxs-topbar-notifications",ht="fxs-topbar-search",
ct="fxs-topbar-toast",t="fxs-show-journey",tt="fxs-show-startboard",lt="fxs-portal-content",at="fxs-portal-contextpane-left",vt="fxs-portal-contextpane-right",yt="fxs-sidebar",pt="fxs-topbar",wt="fxs-fullwidth",b,it,rt;ko.components.register("fxs-progress",{template:'<div class="fxs-progress-dots"><div><\/div><div><\/div><div><\/div><\/div>'});b=ko.computed;it=(function(n){function t(){n.apply(this,arguments);this.topBar=new w.ViewModel;this.sideBar=new y.ViewModel}return __extends(t,n),t})(s.ViewModel);n.ViewModel=it;rt=(function(n){function s(t,o){var ut=this,d,s,g,rt,tt,it;n.call(this,t,o);this.hasActiveJourney=!1;d=this.lifetimeManager;s=function(n){return t.findByClassName(n)};this._topBarWidget=new w.Widget(s(pt),o.topBar,s("fxs-console"));this._panoramaContainer=s(lt);this._panorama=new a.Widget(this._panoramaContainer,new a.ViewModel("fxs-panorama-instanceid"));g=new h.ViewModel;g.collapsed=o.sideBar.isCollapsed;this._leftContextPaneWidget=new h.Widget(s(at),g);this._rightContextPaneWidget=
new h.Widget(s(vt),new h.ViewModel);u.register(t);f.register(t);this._helpMenuWidget=new c.Widget(s(ot),new c.ViewModel);this._searchWidget=new v.Widget(s(ht),new v.ViewModel);r.notificationspane==="true"?(rt=b(this.lifetimeManager,(function(){return e.settings.notificationToastEnabledKey()&&nt!=="0"})),tt=this._toastViewModel=new p.ViewModel({shouldShowToasts:rt}),nt==="true"&&tt.displayTime(50),i.require("MsPortalImpl/Widgets/Widgets.Toast").then((function(n){d.registerForDispose(new n.Widget(s(ct),tt))}))):d.registerForDispose(this._notificationMenuWidget=new l.Widget(s(st),new l.ViewModel));o.sideBar.getStartboardVisible=function(){return ut.isStartBoardVisible()};this._sideBarWidget=new y.Widget(s(yt),o.sideBar);r.fullwidth==="true"&&t.addClass(wt);it=e.settings;b(d,(function(){var t=it.animationEnabledKey&&it.animationEnabledKey(),n=new k(location.href).query.getParameter("enableAnimations");n}));d.registerForDispose((function(){u.unregister(t);f.unregister(t)}))}return __extends(s,n),s.
prototype.dispose=function(){this._panorama.dispose();this._cleanElement();n.prototype.dispose.call(this)},s.prototype.getPanorama=function(){return this._panorama},s.prototype.getLeftContextPane=function(){return this._leftContextPaneWidget},s.prototype.getRightContextPane=function(){return this._rightContextPaneWidget},s.prototype.getHelpMenuWidget=function(){return this._helpMenuWidget},s.prototype.getNotificationMenuWidget=function(){return this._notificationMenuWidget},s.prototype.getSearchWidget=function(){return this._searchWidget},s.prototype.getSideBarWidget=function(){return this._sideBarWidget},s.prototype.getToastVM=function(){return this._toastViewModel},s.prototype.getTopBarWidget=function(){return this._topBarWidget},s.prototype.isStartBoardVisible=function(){return!this.element.hasClass(t)},s.prototype.isJourneyVisible=function(){return this._hasJourneyWithContent()&&this.element.hasClass(t)},s.prototype.showStartBoard=function(){this._sideBarWidget.options.isCollapsed(
e.settings.sideBarCollapsedKey());this.element.removeClass(t).addClass(tt);this.options.topBar.dashboardVisible(!0);this.trigger(g.fxshowstartboard);var n=this.getPanorama().getStartBoardWidget();n&&n.setFocus()},s.prototype.showJourney=function(){if(!this.isJourneyVisible()){this.element.removeClass(tt).addClass(t);this.options.topBar.dashboardVisible(!1);var n=this.getPanorama().getJourneyWidget();n&&n.setFocus()}},s.prototype._hasJourneyWithContent=function(){var n=this.getPanorama(),t=n&&n.getJourneyWidget(),i=this.getRightContextPane();return t&&t.hasChildren()||i&&i.options.opened()},s.prototype.handleStartButtonClick=function(){var t=o.ActionModifier.PortalScrolled,i=new k(d.location.href),r=!i.fragment,n;this.isStartBoardVisible()||(this._hasJourneyWithContent()&&r&&!this.hasActiveJourney?(n=this._panorama.getJourneyWidget(),n&&n.close()):(this.element.trigger(g.fxhomebuttonclick),t=o.ActionModifier.StartBoardRestored));ut.trace({source:o.Source.Desktop,action:o.Action.HomeButtonClicked,
actionModifier:t})},s})(s.Widget);n.Widget=rt})(b||(b={})),b}));define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function f(i){t||(t=!0,n.uploadSettingsManager=i,Q(i.querySettings({store:12})).then((function(n){var t=!1;for(var r in n){t=!0;break}t&&u().then((function(n){return n.init(i)}))})))}var r="MsPortalImpl/Services/Services.FileUploadSettings",u=i.memoize((function(){return i.require(r).then((function(n){return n.fileUploadResumableTrackerInstance()}))})),t=!1;n.init=f})(r||(r={})),r}));define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports","f","u","a"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function s(n,t){d(n,(function(n,i){i!==r&&t(n,i)}))}function g(n){var r=new l,i=r.errors;return n?(s(n,(function(r,u){switch(r){case"name":t("Extension name",u,i);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":t(r,u,i);break
case"isPreview":a(r,u,i);break;case"assetTypes":f(r,u,i);break;case"blades":nt(n,u,i);break;case"startBoardParts":ft(u,i);break;case"partsCatalog":yt(u,i);break;case"commandsCatalog":vt(u,i);break;case"commandGroups":lt(u,i);break;case"htmlTemplates":ot(u,i);break;case"styleSheets":st(u,i);break;case"galleryService":ht(u,i);break;case"dashboardProvider":ct(u,i);break;case"requireConfig":break;default:i.push("Unexpected attribute '{0}' on definition.".format(r))}})),r):(i.push("Definition is null or undefined."),r)}function t(n,t,i){typeof t!="string"&&i.push("{0} is not a valid string.".format(n))}function a(n,t,i){typeof t!="boolean"&&i.push("{0} is not a valid boolean.".format(n))}function f(n,t,i){var r=u.isArray(t);return r||i.push("The '{0}' property is not a valid array.".format(n)),r}function nt(n,t,i){t&&f("blades",t,i)&&t.forEach((function(t,r){v(n,t,r,i)}))}function v(n,t,i,r){var u=t.name;t.inputs&&f("Blade: {0}. Property: blades[{1}].inputs".format(u,i),t.inputs,r);t.optionalInputs&&
f("Blade: {0}. Property: blades[{1}].optionalInputs".format(u,i),t.optionalInputs,r);f("Blade: {0}. Property: blades[{1}].lenses".format(u,i),t.lenses,r)&&t.lenses.forEach((function(n,t){var e="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(u,n.name,i,t);n.partInstances&&f(e,n.partInstances,r)&&n.partInstances.forEach((function(f,e){var o="Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(u,n.name,f.name,i,t,e);p(o,f,r)}))}));t.permissions&&f("Blade: {0}. Property: blades[{1}].permissions".format(u,i),t.permissions,r)&&t.permissions.forEach((function(n,t){h("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(u,i,t),n,t,r)}));tt(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(u,i),r);it(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(u,i),r)}function tt(n,t,i){n&&(n.source?y(n.source,t+".source",i):i.push("Source not specified for toolbar. "+t))}function it(n,t,i){n&&n.source&&y(n.source,t+".source",
i)}function y(n,i,r){n.property&&t(i+".property",n.property,r);n.optional&&typeof n.optional!="boolean"&&r.push("The attribute 'optional' should be of type boolean. "+i);n.isIdentityInput&&typeof n.isIdentityInput!="boolean"&&r.push("The attribute 'isIdentityInput' should be of type boolean. "+i);f(i+".valuesFrom",n.valuesFrom,r)&&n.valuesFrom.forEach((function(n,t){rt(i+".valuesFrom[{0}]".format(t),n,r)}))}function rt(n,i,r){switch(i.referenceType){case e.Part:case e.BladeInput:case e.BladeActionBar:case e.BladeProperty:case e.Command:case e.Constant:case e.SelectedItem:case e.Adapter:break;default:r.push("Unknown reference type '{0}' found for {1}.referenceType.".format(i.referenceType,n))}t(n+".property",i.property,r);i.part&&t(n+".part",i.part,r)}function ut(n,i,r){switch(i.sourceType){case o.AssetIdSourceType.FromInput:i.providerKey&&r.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(n));break;case o.AssetIdSourceType.
FromProvider:i.providerKey||r.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(n));t(n+".providerKey",i.providerKey,r);break;case o.AssetIdSourceType.FromSourceProvider:i.providerKey||r.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(n));t(n+".providerKey",i.providerKey,r);break;default:r.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".format(i.sourceType,n))}t(n+".property",i.property,r)}function h(n,i,r,u){var e,o;switch(i.permissionType){case 0:e=i;e.extensionName&&t(n+".extensionName",e.extensionName,u);t(n+".assetType",e.assetType,u);e.assetId?ut(n+".assetId",e.assetId,u):u.push("Permission missing assetId found for {0}.assetId.".format(n));t(n+".action",e.action,u);break;case 1:o=i;switch(o.requirement){case c.All:case c.Any:break;default:u.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(o.requirement,
n))}f(n+".permissions",o.permissions,u)&&o.permissions.forEach((function(t,i){h("{0}.permissions[{1}]".format(n,i),t,i,u)}));break;default:u.push("Unknown permission type '{0}' found for {1}.permissionType.".format(i.permissionType,n))}}function ft(n,t){f("startBoardParts",n,t)&&n.forEach((function(n,i){p("startBoardParts[{0}]".format(i),n,t)}))}function p(n,t,i){t.reference||t.inline?t.reference&&t.inline?i.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".format(n)):t.reference&&!t.reference.partTypeName?i.push("'partTypeName' property is required on part reference. Property: {0}".format(n)):t.inline&&w(n,t.inline,i):i.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(n))}function w(n,t,i){t&&(et(n,t.partState,i),t.permissions&&f("{0}.permissions".format(n),t.permissions,i)&&t.permissions.forEach((function(t,r){h("{0}.permissions[{1}]".format(n,r),t,r,i)})))}function et(n,t,i){if(
t){var e=t.inputIdentityProperties||[],f=t.sharedProperties||[],o=e.concat(f.map((function(n){return n.property}))),s=f.map((function(n){return n.key})),r=b(o),u=b(s);r&&r.length>0&&i.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(r),n));u&&u.length>0&&i.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(u),n))}}function b(n){var t={},i=[];return(n||[]).forEach((function(n){!t[n]||i.push(n);t[n]=!0})),i}function ot(n,i){s(n,(function(n,r){typeof r!="string"&&(t("htmlTemplates['{0}'].file".format(n),r.file,i),t("htmlTemplates['{0}'].content".format(n),r.content,i))}))}function st(n,i){u.isArray(n)?n.forEach((function(n,r){t("StyleSheet at position {0}".format(r),n,i)})):i.push("Invalid type for 'styleSheets' property on definition.")}function ht(n,i){var r;s(n,(function(n,t){switch(n){case"serviceViewModel":r=t;break;default:i.push(
"Unexpected properties on 'galleryService' property of definition.")}}));t("galleryService.serviceViewModel",r,i)}function ct(n,t){var i=n.viewModel;i&&typeof i=="string"||t.push("The view model of dashboard provider must be non-empty string.")}function lt(n,t){n&&f("commandGroups",n,t)&&n.mapMany((function(n){return n.commands})).forEach((function(n){n.reference&&at(n,t)}))}function at(n,t){if(n&&n.reference){var i=!1;s(n,(function(n){n!=="name"&&n!=="bindings"&&n!=="reference"&&(i=!0)}));i?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".format(ko.toJSON(n))):n.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(ko.toJSON(n)))}}function vt(n,t){n&&f("commandsCatalog",n,t)&&n.forEach((function(n){var i="Commands in 'commandsCatalog' ";n.name||t.push(i+"must have names.");!n.reference||t.push(i+"cannot specify a 'reference' property.")}))}function yt(n,t){n&&f("partsCatalog",n,t)&&n.forEach(
(function(n){k(n,t)}))}function pt(n,i){t("name",n.name,i);t("moduleId",n.moduleId,i)}function k(n,t){n.inputDefinitions&&f("PartType: {0}. Property: inputDefinitions".format(n.name),n.inputDefinitions,t);n.reference&&wt(n,t);w("PartType: {0}".format(n.name),n,t)}function wt(n,t){(n.reference.bindings||[]).forEach((function(i){(i.valuesFrom||[]).forEach((function(i){i.referenceType!==e.Adapter&&i.referenceType!==e.AdapterInput&&i.referenceType!==e.Constant&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".format(n.name))}))}))}var o=i.Extension,e=o.ReferenceType,c=o.SetRequirement,d=i.forEachKey,l=(function(){function n(){this.errors=[]}return n.prototype.valid=function(){return!this.errors.length},n})();n.ValidationResult=l;n.validateDefinition=g;n.validateIsString=t;n.validateIsBoolean=a;n.validateIsArray=f;n.validateBlade=v;n.validateControl=pt;n.validatePartType=k})(f||(f={})),f}));define("MsPortalImpl/Extension/Extension.Manifest",
["require","exports","f","./Extension.DefinitionValidator","../Services/Services.Storage"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function y(n){var t=new r.ValidationResult,i,u;return n?((typeof n.name!="string"||s(n.name)||n.name.indexOf("!")>=0)&&(u="The extension manifest should specify a valid name. This name is obtained from the <Extension> tag in PDL. This name should be a string and cannot be empty or whitespace. It also cannot contain the ! character. The recommended naming convention for an extension name is to follow the pattern {Company}_{BrandOrSuite}_{ProductOrComponent} (e.g. Microsoft_Azure_Insights).",t.errors.push(u)),n.assetTypes&&r.validateIsArray("manifest.assetTypes",n.assetTypes,t.errors)&&n.assetTypes.forEach((function(i){p(i,n.name,t.errors)})),t):(i="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the FxExtension.register/FxExtension.registerAmd call that is used to register your extension with the portal.",
t.errors.push(i),t)}function t(n,t,i,r){n.push(t.format(i,r))}function p(n,r,u){var e=n.name;if(s(e)&&t(u,"The name for the asset type in manifest '{0}' was not specified.",r),n.browseType!==undefined&&typeof n.browseType!="number"&&t(u,"The browse type for the asset type '{0}' in manifest '{1}' was not a number.",e,r),n.browseServiceViewModel&&typeof n.browseServiceViewModel!="string"&&t(u,"The browse service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r),n.browseLinkUri&&typeof n.browseLinkUri!="string"&&t(u,"The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.",e,r),n.privateBrowse!==undefined&&typeof n.privateBrowse!="boolean"&&t(u,"The private browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",e,r),n.browseRequiresRdfe!==undefined&&typeof n.browseRequiresRdfe!="boolean"&&t(u,"The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",e,r),n.browseRequirements!==
undefined&&typeof n.browseRequirements!="number"&&t(u,"The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.",e,r),n.browseType!==undefined){switch(n.browseType){case f.ServiceViewModel:n.browseServiceViewModel||t(u,"The browse for the asset type '{0}' in manifest '{1}' is set to use a service view model but there was no service view model.",e,r);break;case f.ResourceType:n.browseServiceViewModel&&t(u,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's resource type but there was a service view model.",e,r);break;case f.AssetTypeBlade:n.browseServiceViewModel&&t(u,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's blade but there was a service view model.",e,r);break;case f.ServiceLink:n.browseLinkUri||t(u,"The browse for the asset type '{0}' in manifest '{1}' is set to be a service link but there was no link URI.",e,r);break;case f.InstanceLink:n.browseLinkUri||t(u,"The browse for the asset type '{0}' in manifest '{1}' is set to be an instance link but there was no link URI.",
e,r)}n.privateBrowse!==undefined&&n.browseType===undefined&&t(u,"The private browse flag was present for the asset type '{0}' in manifest '{1}' but there was browse type.",e,r);n.browseType!==f.ServiceViewModel&&n.browseServiceViewModel&&t(u,"The asset type '{0}' in manifest '{1}' has a browse service but doesn't have service view model browse type.",e,r);s(n.pluralDisplayName)&&s(n.text)&&t(u,"The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",e,r);i.isNullOrUndefined(n.icon)&&t(u,"The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",e,r)}else n.browseServiceViewModel!==undefined?n.browseType=f.ServiceViewModel:n.privateBrowse!==undefined&&t(u,"The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.",e,r);n.gridColumnsServiceViewModel&&typeof n.gridColumnsServiceViewModel!="string"&&t(u,"The grid columns service view model for the asset type '{0}' in manifest '{1}' was not a string.",
e,r);n.dynamicBladeServiceViewModel&&typeof n.dynamicBladeServiceViewModel!="string"&&t(u,"The dynamic blade service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r);n.propertyProviderServiceViewModel&&typeof n.propertyProviderServiceViewModel!="string"&&t(u,"The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r)}var s=i.isNullOrWhiteSpace,l=i.Extension,f=l.BrowseType,e=u.ComponentName.ManifestVersions,h="latest",c="expired",o=0,a=i.forEachKey,v=(function(){function n(n){var t,i;this._storage=n;t=n.getValue(e,h,o);this._latestVersions=JSON.parse(t||"{}");i=n.getValue(e,c,o);this._expiredVersions=JSON.parse(i||"{}")}return n.prototype.getLatest=function(n){var t=n.toLowerCase();return this._latestVersions[t]||""},n.prototype.setLatest=function(n){var t=this;a(n,(function(n,i){var r=n.toLowerCase(),u=i.manifest,f=(u&&u.pageVersion||"").toLowerCase(),e=t._expiredVersions[r]||[];e.indexOf(f)!==-1||(t._latestVersions[
r]=f)}));this._storage.setValue(e,h,JSON.stringify(this._latestVersions),o)},n.prototype.expireLatest=function(n){var i=n.toLowerCase(),r=this._latestVersions[i],t;if(r){if(this._latestVersions[i]="",t=this._expiredVersions[i],t){while(t.length>=5)t.pop();t.splice(0,0,r)}else this._expiredVersions[i]=[r];this._storage.setValue(e,h,JSON.stringify(this._latestVersions),o);this._storage.setValue(e,c,JSON.stringify(this._expiredVersions),o)}},n})();n.ExtensionVersionCache=v;n.validate=y})(f||(f={})),f}));define("MsPortalImpl/_generated/Common/Relex.Channel",["require","exports"],(function(){"use strict";var n;return (function(n){var t,i,r;n.signature="###CHANNEL###",(function(n){n[n.None=0]="None";n[n.Auth=1]="Auth";n[n.AuthAck=2]="AuthAck";n[n.ExtensionLoad=3]="ExtensionLoad";n[n.ExtensionReload=4]="ExtensionReload";n[n.ExtensionUnload=5]="ExtensionUnload";n[n.Boot=6]="Boot";n[n.Rpc=7]="Rpc";n[n.Telemetry=8]="Telemetry";n[n.Connection=9]="Connection"})(n.MessageKind||(n.MessageKind={}));t=n.MessageKind,
(function(n){n[n.Disconnected=1]="Disconnected"})(n.ConnectionEventType||(n.ConnectionEventType={}));i=n.ConnectionEventType,(function(n){n[n.None=0]="None";n[n.FetchManifest=1]="FetchManifest";n[n.Proxy=2]="Proxy"})(n.ExtensionHostMode||(n.ExtensionHostMode={}));r=n.ExtensionHostMode})(n||(n={})),n}));define("MsPortalImpl/Extension/Extension",["require","exports","f","i","o","../UI/Compositions/UI.Composition.CloudName","../Extension/DefinitionPreprocessor","./Extension.DefinitionValidator","../Extension/Extension.Definition.Locator","../Extension/Extension.Manifest","MsPortalFx/Globalization","MsPortalImpl/Resources/ImplScriptResources","../Base/Languages","../Parts/Parts","../_generated/Common/Relex.Channel","../UI/Compositions/UI.Composition.BladeOpenerBase","../UI/Hubs/UI.NotificationManager","../Extension/ViewModelManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";var k;return (function(t){function ei(n){return n&&n.formatCulture===ti&&n.displayLanguage===ni}function oi(
n){var i=ri.format(n),t;try{t=JSON.parse(it.localStorage.getItem(i))}catch(r){nt.error(r,4,n)}return t}function eu(n){var t=ri.format(n);try{it.localStorage.removeItem(t)}catch(i){nt.warning(i,4,n)}}function ou(n,t,i){var r=i.useRelex(n),u=r?new lr(i):new li;return new hi(n,t,u,r)}function or(n,t,i){return new cr(n,t,i)}function su(){pt={}}function hu(n,t){fi=n;rr=t}function cu(n){return pt[n]||(pt[n]={})}function lu(n){for(var r=fi["*"].slice()||[],t=n.obsoleteBundlesBitmask,u=0,f;t;)t%2&&(f=fi[u],i.pushUnique(r,f)),t=t>>1,u++;return r}function sr(n,i,r){if(r)return i;var f=cu(n.name),u=f[i];return u?u:(u=f[i]=[],i&vt.ExtensionScripts&&u.push.apply(u,lu(n)),i&vt.PostScripts&&(t.patchUris&&t.patchUris.length&&u.push.apply(u,t.patchUris),u.push.apply(u,rr)),u)}function hr(n){var t=gt("<iframe/>").addClass("fxs-extension-frame").attr({tabindex:-1,"aria-hidden":!0});return n||t.attr({sandbox:"allow-same-origin allow-scripts"}),t.appendTo(br),t}function au(n,t,i){for(var r=[],u=Q(),f=function(
){r.length<t&&(u=u.then((function(){if(r.length<t)return i().then((function(n){r.push(n)})).catch((function(n){nt.error(n,6)}))})))},e=0;e<t;e++)f();return{getItem:function(){return Q.delay(ru).then(f),r.pop()},size:function(){return r.length}}}var rt=r.Extension,ar=r.TelemetryContext,ut=i.Base,ct=ut.Constants,vr=ct.ExtensionNames.Hubs,wt=ut.Diagnostics,yr=wt.Telemetry,bt=ut.Rpc.Internal,kt=ut.Utilities,pr=i.Hubs.Notifications.NotificationStatus,dt=ut.Promises,vi=ut.tryParseVersion,yi=i.Helpers.Deferred,vt,er,si,d,g,yt,pt,hi,ht,ci,cr,li,lr,ai;t.frameRemovalDelay=1e3;t.patchUris=[];var gt=jQuery,it=window,et=it.fx.getTimestamp,ft=bt.client,pi=i.isNullOrUndefined,wr=gt("head"),br=gt("body"),nt=wt.createLog(n),k=it.fx.environment,ot=k.cdn,wi="FxCdnIndex"+ot.index,kr=k.features,ni=c.displayLanguage,ti=c.formatCulture,dr=ni+a.localeDelimiter+ti,gr=!!k.trace.extensionmanager,vu=gr?function(n){nt.verbose(n)}:i.noop,bi=ut.getVersionFromString,lt=bi(k.sdkVersion),ki=kr.extloadtimeout,ii=ki&&parseInt(
ki)||9e4,di=k.relex,gi=l.Shell,nu="data-extensionname",st="ExtensionManager",ri="EXTENSIONMANIFEST_{0}",ui=3,at=(ui+1)*2,tt=yr,tu=ar,iu=k.bootReturnConst,nr=2e4,ru=4e3,tr=3,ir=ko.observable,fi=k.extensionScripts,rr=k.postScripts,ur=0,fr=0,uu=et(),fu=i.forEachKey;t.canUseManifest=ei;t.getCachedManifestFromLocalStorage=oi,(function(n){n[n.None=0]="None";n[n.ExtensionScripts=1]="ExtensionScripts";n[n.PostScripts=2]="PostScripts"})(t.RequiredScripts||(t.RequiredScripts={}));vt=t.RequiredScripts;t.initialRetryDelay=ii;er=i.find,(function(n){function t(t){return er(n.loadedExtensions,(function(n){return rt.isEqualDescriptor(n.extension,t.extension)}))}function i(i){var r=t(i);r||n.loadedExtensions.push(i)}function r(i){var r=t(i);r&&n.loadedExtensions.remove(r)}n.loadedExtensions=[];n.addLoadedExtension=i;n.removeLoadedExtension=r})(si=t.LoadedExtensions||(t.LoadedExtensions={})),(function(n){n[n.NotLoaded=0]="NotLoaded";n[n.FirstResponseReceived=1]="FirstResponseReceived";n[n.ManifestReceived=2]="ManifestReceived";
n[n.Initialized=3]="Initialized";n[n.Error=4]="Error"})(t.ExtensionReadyState||(t.ExtensionReadyState={}));d=t.ExtensionReadyState,(function(n){n[n.None=0]="None";n[n.FirstResponseNotReceived=1]="FirstResponseNotReceived";n[n.ManifestNotReceived=2]="ManifestNotReceived";n[n.InvalidExtensionName=3]="InvalidExtensionName";n[n.InvalidManifest=4]="InvalidManifest";n[n.InvalidDefinition=5]="InvalidDefinition";n[n.FailedToInitialize=6]="FailedToInitialize";n[n.TooManyRefreshes=7]="TooManyRefreshes";n[n.TooManyBootGets=8]="TooManyBootGets";n[n.TimedOut=9]="TimedOut";n[n.MaxRetryAttemptsExceeded=10]="MaxRetryAttemptsExceeded";n[n.HomePageTimedOut=11]="HomePageTimedOut"})(g||(g={})),(function(n){n[n.Default=0]="Default";n[n.Part=1]="Part"})(t.ViewModelType||(t.ViewModelType={}));yt=t.ViewModelType;t.create=ou;t.createInitializedExtension=or;pt={};t._clearScriptUris=su;t._setExtensionScripts=hu;t.getScriptUris=sr;hi=(function(){function n(n,t,r,u){var w=this,y;this._readyState=d.NotLoaded;this._errorState=
g.None;this._manifests=new i.Map;this._initializedInternal=Q.defer();this._initializedDeferred=Q.defer();this._manifestLoaded=Q.defer();this._perfData={};this._initializeRequired=!1;this._bootGetCount=0;this._scriptErrors=[];this._bladeRedirectMap={};this.metadata=n;this._hostingContext=r;this._useRelex=u;var c=n.name,s=new ut.UriBuilder(n.uri),f=s.query,h=n.cacheability||0,e=[];s.fragment=k.sessionId;k.passThroughVariables&&(e=e.concat(k.passThroughVariables));h===0?e.push(k.clientSessionIdName):h===2?t=k.pageVersion:f.setParameter("cacheability",h);k.extensionQueryParameters&&(e=e.concat(k.extensionQueryParameters));e.forEach((function(n){var t=k[n];pi(t)||f.setParameter(n,t)}));var b=c.toLowerCase(),l={},o=k.userTypeHint||"",v=b+"_";fu(k.extensionFlags,(function(n,t){var r=n.toLowerCase(),i;r.startsWith(v)&&(i=r.substr(v.length),i==="clean"&&t.toLowerCase()==="true"?w._clean=!0:i==="clientoptimizations"?f.setParameter(i,t):i==="usertype"?o+="("+t+")":f.setParameter(n,t),l[i]=t)}));o&&(y=
o.substr(1,o.length-2),f.setParameter("feature.userType",y));this.effectiveFeatureFlags=kt.extend(kt.clone(k.features),l);f.setParameter("pageVersion",t);f.setParameter(a.localeQueryStringName,dr);var p=di.portalUri,nt=this._useRelex&&p?p:it.location.href,tt=new ut.UriBuilder(nt).getAuthority();f.setParameter("trustedAuthority",tt);f.setParameter("extensionName",c);rt.multiCloudEnabled&&f.setParameter("cloudName",this.cloudName);ot.forceDisable||this._useRelex?f.setParameter(ot.disableParameter,!0):ot.forceIndex&&f.setParameter(ot.indexParameter,ot.forceIndex);this._uri=s.toString()}return u.defineProperty(n.prototype,"cloudName",{get:function(){return this.metadata.cloudName},enumerable:!0,configurable:!0}),n.prototype.getVersion=function(){return this._extVersion},u.defineProperty(n.prototype,"initializeRequired",{get:function(){return this._initializeRequired},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"unloaded",{get:function(){return!this._currentWindow},enumerable:
!0,configurable:!0}),n.prototype.useRelex=function(){return this._useRelex},u.defineProperty(n.prototype,"name",{get:function(){return this.metadata.name},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isTestExtension",{get:function(){return!!this.metadata.isTestExtension},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isTestStamp",{get:function(){return!!this.metadata.isTestStamp},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"readyState",{get:function(){return this._readyState},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"extensionLoadedInternal",{get:function(){return this._initializedInternal.promise},enumerable:!0,configurable:!0}),n.prototype.getBladeRedirect=function(n){return this._bladeRedirectMap[n&&n.toLowerCase()]},n.prototype.onManifestReceived=function(n){var t=this,i=function(){t._startExtensionLoadListener&&(it.
removeEventListener("message",t._startExtensionLoadListener),t._startExtensionLoadListener=null)};i();(n.redirects||[]).forEach((function(n){var i=n.fromBlade;i&&(t._bladeRedirectMap[i.toLowerCase()]=n)}));this.getWindow().postMessage({boot:iu,stopListening:!0,scripts:sr(this.metadata,vt.PostScripts,this.useRelex())},this.getTrustedHost());this._startExtensionLoadListener=function(r){if(r.data){var u=r.data,f=u.signature===y.signature&&u.kind===y.MessageKind.Boot&&u.windowId===t.getWindowId()&&u.data&&u.data.kind===tr,e=r.data.kind===tr&&t.getWindow()===r.source;(f||e)&&(t._acceptManifestAndInitializeIfRequired(n),i())}};it.addEventListener("message",this._startExtensionLoadListener,!1)},n.prototype.getManifest=function(n){return this._manifests.get(n)},n.prototype.setManifest=function(n,t){var i=t;return i.cloudName=this.cloudName,this._manifests.set(n,i),i},n.prototype.ensureInitialize=function(){this._initializeRequired=!0},n.prototype.getManifestAsync=function(){return this._manifestLoaded.
promise},n.prototype.isExtensionLoadedAsync=function(){return this._initializedDeferred.promise},n.prototype.resolveExtensionLoaded=function(){var n=this._initializedExtension;n&&this._initializedDeferred.resolve(n);this._initializedExtension=null},n.prototype._acceptManifestAndInitializeIfRequired=function(n){var t=this._validateAndSetManifest(n,!1);t&&(this._addManifestToCache(),this._initializeRequired?this._initialize():this.dispose(),this._initializeRequired=!0)},n.prototype._initialize=function(){var n=this,t=this.getWindowId();this._initializeCancelationToken&&this._initializeCancelationToken.cancel();var r=this._initializeCancelationToken=new dt.CancelationToken,u=rt.initializeEndPoint.invoke(ft,t,undefined),f=dt.wrapWithCancelablePromise(u,r);f.then((function(u){i.Base.Utilities.Internal.JQuery.extend(n._perfData,u);var f=rt.getDefinitionEndPoint.invoke(ft,t,undefined);return dt.wrapWithCancelablePromise(f,r)})).then((function(t){var u=n.getManifest("assetTypes"),r=o.validateDefinition(
t);if(r.valid()){var f=e.preprocessDefinition(t,u),s=n._perfData.totalTime=et()-n._extensionLoadStartTime,i=or(n,f,s);i.injectStyles(document);n._initializedExtension=i;n._initializedInternal.resolve(i);n._transitionStateTo(d.Initialized);n._clearExtensionReloadHandle();n._extensionInitializedTraceKey=tt.startTrace({source:st,action:"ExtensionInitialized",name:n.name});n.resolveExtensionLoaded();n._initializedDeferred.promise.isFulfilled()&&si.addLoadedExtension(i)}else n._onError(g.InvalidDefinition,"The extension definition has validation errors. Errors: {0}".format(JSON.stringify(r.errors)))})).catch((function(t){n._reloadFrame("message: {0}, stack: {1}".format(t.message,t.stack),g.FailedToInitialize)}))},n.prototype.getOrLoadWindow=function(){var n=this;if(!this._currentWindow){this._bootGetCount=0;this._retryAttempt=0;this._initialResponseTraceKey=tt.startTrace({source:st,action:"InitialExtensionResponse",name:this.name});this._loadTraceKey=tt.startTrace({source:st,action:"LoadExtensions",
name:this.name});var t=this.metadata,i=t.features,u=k.trace.nonsecure||i&&i.nonsecure==="true",r=0;this._currentWindow=this._hostingContext.createRpcWindow({getWindowId:function(){return rt.getWindowId(t)},trustedHost:t.trustedHost,frameUri:this._uri,createIframe:function(){return hr(u)},onLoad:function(){return n._readyState=d.NotLoaded,n._errorState=g.None,r++,r>at?(n._onError(g.TooManyRefreshes,"The iframe for extension '{0}' refreshed/reloaded more than '{1}' times and has been unloaded.".format(n.name,at)),!1):!0},onError:function(){n._reloadFrame("Extension Index page failed to load timed out in '{0}'ms.".format(nr),g.HomePageTimedOut)}});this._currentWindow.onDispose((function(){var t,i;n._clearExtensionReloadHandle();t=n._initializedDeferred.promise;t.isFulfilled&&t.then((function(n){si.removeLoadedExtension(n)}));n._initializedInternal=Q.defer();n._initializedDeferred=Q.defer();tt.trace({source:st,action:"ExtensionUnloaded",name:n.name,data:{currentState:n._readyState}});n._extensionInitializedTraceKey&&
(tt.completeTrace(n._extensionInitializedTraceKey),n._extensionInitializedTraceKey=null);i="style[{0}='{1}']".format(nu,n.name);wr.remove(i);n._currentWindow=null}));this._extensionLoadStartTime=et();this._extensionReloadHandle=it.setTimeout((function(){n._reloadFrame()}),ii)}return this._currentWindow},n.prototype.noteScriptError=function(n){this._scriptErrors.push(n)},n.prototype._reloadFrame=function(n,t){var r=this,i;if(!this.unloaded&&this._readyState!==d.Initialized){if(!n&&!t){t=g.None;n="Failed to load extension after {1} attempts over {0} secs.";switch(this._readyState){case d.NotLoaded:t=g.FirstResponseNotReceived;n="First response was not received after a time of {0} secs.";break;case d.FirstResponseReceived:t=g.ManifestNotReceived;n="Manifest not received after {0} secs.";break;case d.ManifestReceived:t=g.TimedOut;n="Manifest was received, however failed to initialize the extension after {0} secs."}}this._retryAttempt>=ui&&(t=g.MaxRetryAttemptsExceeded);n=n.format(Math.round(et(
)-this._extensionLoadStartTime)/1e3,this._retryAttempt+1);this._clearExtensionReloadHandle();this._retryAttempt<ui?(this._extensionLoadStartTime=et(),i=new ut.UriBuilder(this._uri),this._retryAttempt++,i.query.setParameter(k.retryAttemptName,this._retryAttempt),this._currentWindow.refresh(i.toString()),this._onExtensionLoadingRetry&&this._onExtensionLoadingRetry(),this._extensionReloadHandle=it.setTimeout((function(){r._reloadFrame()}),ii),nt.warning("Reloading extension '{0}' from '{1}'. Retry attempt: {4}. ErrorState: {2}. Error: {3}.".format(this.name,this.uri,g[t],n,this._retryAttempt))):this._onError(t,n)}},n.prototype.getWindow=function(){var n=this._currentWindow;return n&&n.getValue()},n.prototype.getTrustedHost=function(){var n=this._currentWindow;return n&&n.getTrustedHost()},n.prototype.getWindowId=function(){return rt.getWindowId(this)},n.prototype.loadAsync=function(n){var r,t,i,u,f;return this.unloaded?(r=this.getWindowId(),(!n||this._clean)&&(n={}),t=oi(r),i=n.manifest,ei(
t)&&(u=vi(t&&t.extVersion),f=vi(n.version),u&&f&&u.compareTo(f)>=0&&(i=t.manifest)),i&&this._validateAndSetManifest(i,!0)?this.ensureInitialize():(bt.internalClient.acquireWindow(r,0),this._manifestLoaded.promise.isPending()||(this._manifestLoaded=Q.defer())),this._initializedInternal.promise):this.isExtensionLoadedAsync()},n.prototype.dispose=function(){this._currentWindow&&(this._currentWindow.dispose(),this._currentWindow=null)},n.prototype.processBootGetMessage=function(n,t){var i,r;try{i=bi(n)}catch(u){nt.error("Invalid version information '{0}' specified by '{1}'.".format(n,this.name),0,u)}return(i&&lt.major===i.major&&lt.minor===i.minor||(r="The '{0}' extension at '{1}' was compiled with version '{2}' of the SDK, whereas the shell is running on version '{3}'. You may see unexpected results.",nt.warning(r.format(this.name,this.uri,i,lt))),this._readyState===d.NotLoaded&&(this._readyState=d.FirstResponseReceived,this._initialResponseTraceKey&&(this._perfData.initialExtensionResponse=
tt.completeTrace(this._initialResponseTraceKey),this._initialResponseTraceKey=null),this._manifestLoadTraceKey=tt.startTrace({source:st,action:"ManifestLoad",name:this.name,data:{fxcdn:wi}})),this._bootGetCount++,this._bootGetCount>at)?(this._onError(g.TooManyBootGets,"The iframe '{0}' sent more than '{1}' handshake messages over '{2}' attempts without making progress. it has been unloaded.".format(this.name,at,this._retryAttempt)),!1):!this._tryLoadCachedManifest(t)},n.prototype._tryLoadCachedManifest=function(n){var i=!1,r,t;return this._extVersion=n,this.initializeRequired||!n||(r=this.getWindowId(),t=oi(r),ei(t)&&n===t.extVersion&&(i=this._validateAndSetManifest(t.manifest,!0),this.dispose(),this.ensureInitialize()),i||eu(r)),i},n.prototype._addManifestToCache=function(){var n=this.getManifest("assetTypes"),t=this._extVersion,i,r,u;if(n)if(t)if(n.sdkVersion)try{r=ri.format(this.getWindowId());u={manifest:n,formatCulture:ti,displayLanguage:ni,extVersion:t,sdkVersion:lt};it.localStorage.
setItem(r,JSON.stringify(u))}catch(f){nt.warning(f,4,this.getWindowId())}else i="Unable to add manifest for '{0}' to cache since it has not specified the SDK version on which it was compiled. Specified version was '{1}'.",nt.warning(i.format(this.name,n.sdkVersion),102);else nt.warning("Unable to add manifest for '{0}' to cache since it has not specified a valid version. Specified version was '{1}'.".format(this.name,t),101);else nt.warning("Unable to add manifest for '{0}' to cache since it is unavailable.".format(this.name))},n.prototype._validateAndSetManifest=function(n,t){var c=this,r=!1,f=h.validate(n),e,o,u,s;return f.valid()?this.name.toLowerCase()!==n.name.toLowerCase()?(e="The extension name defined in the manifest '{0}' (obtained from the <Extension> tag in PDL) does not match the name '{1}' used to identify the extension with the portal. Ensure that the name you specify in the <Extension> tag in PDL matches the one used in the extensions.json file to identify the extension with the portal.",
this._onError(g.InvalidExtensionName,e.format(n.name,this.name))):(this._readyState!==d.NotLoaded&&this._readyState!==d.FirstResponseReceived&&(o="Extension manifest for '"+this.name+"' received at an incorrect point in time. "+("Current extension state: ExtensionReadyState."+d[this._readyState]+". ")+"This method should be called when the extension state is ExtensionReadyState.NotLoaded or ExtensionReadyState.FirstResponseReceived. "+("Callstack: "+kt.getCurrentCallStack()),nt.error(o,5)),pi(n.isPreview)&&(u=this.metadata.features,n.isPreview=(u&&u.preview||"").toLowerCase()==="true"),t||i.forEachKey(di.cachedManifestTypes,(function(t){c.setManifest(t,n)})),s=this.setManifest("assetTypes",n),this._transitionStateTo(d.ManifestReceived),this._manifestLoaded.resolve(s),r=!0):(f.errors.forEach(nt.error,nt),this._onError(g.InvalidManifest,"The extension manifest has validation errors.")),(r||!t)&&this._manifestLoadTraceKey&&(this._perfData.manifestLoad=tt.completeTrace(this._manifestLoadTraceKey),
this._manifestLoadTraceKey=null),r},n.prototype._onError=function(n,t){var i="Failed to initialize extension '{0}' at '{1}'. ErrorState: {2}. Error: {3}.".format(this.name,this.uri,g[n],t),u=et(),f=this._extensionLoadStartTime,r;nt.error(i,1,{previousState:this._readyState,hasLoadTraceKey:this._loadTraceKey?1:0,hasInitializeTraceKey:this._initializeTraceKey?1:0,successfulExtensionLoads:fr,failedExtensionLoads:ur,timeThisFileLoaded:uu,scriptErrors:this._scriptErrors,timeThisExtensionStartedLoading:f,timeThisExtensionFailed:u,timeToFail:u-f});wt.Upload.flush();this._initializeCancelationToken&&(this._initializeCancelationToken.cancel(),this._initializeCancelationToken=null);this._manifestLoaded.reject(i);this._initializedInternal.reject(i);this._initializedDeferred.reject(i);this._readyState!==d.Error&&(this._transitionStateTo(d.Error,n),r=w.getNotificationManager(),r&&r.addClientNotification({title:gi.extensionError,description:gi.loadingError.format(this.name),status:pr.Error,timestamp:
new Date,cloudName:ct.DefaultCloudName}));this.dispose()},n.prototype._transitionStateTo=function(n,t){var i=this;this._readyState=n;n===d.ManifestReceived?(this._loadTraceKey&&(tt.completeTrace(this._loadTraceKey),this._loadTraceKey=null),this._initializeRequired&&(this._initializeTraceKey=tt.startTrace({source:st,action:"InitializeExtensions",name:this.name,data:{fxcdn:wi}}))):n===d.Initialized?this._initializeTraceKey&&(tt.completeTrace(this._initializeTraceKey,this._perfData),this._initializeTraceKey=null,fr++):n===d.Error&&(ur++,this._loadTraceKey&&(tt.cancelTrace(this._loadTraceKey),this._loadTraceKey=null),this._initializeTraceKey&&(tt.cancelTrace(this._initializeTraceKey,{errorState:t}),this._initializeTraceKey=null),this._initialResponseTraceKey&&(tt.cancelTrace(this._initialResponseTraceKey),this._initialResponseTraceKey=null),this._manifestLoadTraceKey&&(tt.cancelTrace(this._manifestLoadTraceKey),this._manifestLoadTraceKey=null));t&&(this._errorState=t)},n.prototype._clearExtensionReloadHandle=
function(){this._extensionReloadHandle&&(it.clearTimeout(this._extensionReloadHandle),this._extensionReloadHandle=null)},n})();t.ExtensionImpl=hi;ht=ct.BladeNames.Hubs.ResourceMenuBlade;ci={};ci[vr]=[{partName:ht+"$"+ht,locator:s.resourceMenu.withLens(ht).withPartInstance(ht),getPartDefinition:function(n){return n.getBladeDefinition(ht).then((function(n){return n.lenses[0].partInstances[0].inline}))}}];cr=(function(){function n(n,t,u){var e=this,o,s,h;this.outstandingObjectCount=ir(0);this.metadataCount=ir(0);this._proxiedObjects=[];this._pools={};o=this._lifetime=new r.TriggerableLifetimeManager;o.registerForDispose(this._extension=n);this.cloudName=n.cloudName;s=this.name=n.name;this.definition=t;this.loadTime=u;(ci[s]||[]).forEach((function(n){e._pools[n.locator.toString()]=au(o,5,(function(){return n.getPartDefinition(e).then((function(t){var r=t.details;return Q(e.getPartViewModel(n.partName,{initialState:{},createSelectable:p.needContainerSelectable(r),createHubsInternalCloudNameProperty:
f.needInternalProperty(s,r),partSize:t.initialSize,partLocation:i.ViewModels.PartLocation.Blade,collapsed:null,containerType:0}))}))}))}));t.styleSheets?(h=n.getWindowId(),this.injectStyles=function(n){v.injectStyles(n,{extensionName:h,uniqueName:h,styleSheets:t.styleSheets.map((function(n){return{file:null,content:n}}))})}):this.injectStyles=i.noop}return u.defineProperty(n.prototype,"extension",{get:function(){return this._extension},enumerable:!0,configurable:!0}),n.prototype.canUseInputsSetParameters=function(n){var t=this._pools[n.toString()];return!t||!t.size()},n.prototype.getBladeRedirect=function(n){return this._extension.getBladeRedirect(n)},n.prototype.getWindow=function(){return this._extension.getWindow()},n.prototype.processMessages=function(){return rt.pingEndPoint.invoke(ft,this._extension.getWindowId(),undefined)},n.prototype.dispose=function(){this._lifetime.dispose()},n.prototype.getManifest=function(n){return this._extension.getManifest(n)},n.prototype.getBladeDefinition=
function(n){var r=this,t=this.definition,i=t.bladeMap[n.toLowerCase()];return i?Q(i):Q(rt.getBladeDefinitionEndPoint.invoke(ft,this._extension.getWindowId(),n)).then((function(n){return e.processBlade(t,r.getManifest("assetTypes"),n)})).then((function(n){var i=[];if(o.validateBlade(t,n,null,i),i.length)throw new Error("Invalid blade definition. Errors: "+i.join("\n"));return n}))},n.prototype.getPartDefinition=function(n){var r=this,t=this.definition,i=t.partTypeMap[n.toLowerCase()];return i?Q(i):Q(rt.getPartDefinitionEndPoint.invoke(ft,this._extension.getWindowId(),n)).then((function(n){return e.processPart(t,r.getManifest("assetTypes"),n)})).then((function(n){var t=[];if(o.validatePartType(n,t),t.length)throw new Error("Invalid part type definition. Errors: "+t.join("\n"));return n}))},n.prototype.getControlDefinition=function(n){var t=this;return Q(rt.getControlDefinitionEndPoint.invoke(ft,this._extension.getWindowId(),n)).then((function(n){return e.processControl(t.definition,t.getManifest(
"assetTypes"),n)})).then((function(n){var t=[];if(o.validateControl(n,t),t.length)throw new Error("Invalid control definition. Errors: "+t.join("\n"));return n}))},n.prototype.getViewModel=function(n,t){return this._getViewModel(yt.Default,n,t)},n.prototype.getPartViewModel=function(n,t){var f,r,u;return t&&t.locator&&(f=this._pools[t.locator.toString()])&&!t.onInputsSetParameters&&!i.keysLength(t.initialState)&&(r=f.getItem(),r)?(u=t&&t.onViewModelAcquired,u&&u(r),yi().resolve(r).promise()):this._getViewModel(yt.Part,n,t)},n.prototype._getViewModel=function(n,t,i){var e=this,u,r,f;return(i=i||{},u=b.resolve(this,t,i.initialState,i.createSelectable),u)?u.then((function(n){if(i.onViewModelAcquired)i.onViewModelAcquired(n);return typeof i.partSize=="number"&&n&&n.content&&ko.isObservable(n.content.size)&&n.content.size(i.partSize),i.onInputsSetParameters&&n&&n.updatePartInputValues&&(n.onInputsSetPromise=Q().then((function(){return n.updatePartInputValues(i.onInputsSetParameters.inputs,i.onInputsSetParameters.
settings,i.onInputsSetParameters.traceOptions)}))),n})):(r=yi(),f=n===yt.Part?ct.ViewModelTypes.PartViewModel:ct.ViewModelTypes.ViewModel,rt.getViewModelsDefinition.acquireObject(ft,this._extension.getWindowId(),{type:f,containerType:i.containerType||0,name:t,initialState:i.initialState,createSelectable:i.createSelectable,createHubsInternalCloudNameProperty:i.createHubsInternalCloudNameProperty,telemetryContext:tu.getState(),partSize:i.partSize,partLocation:i.partLocation,onInputsSetParameters:i.onInputsSetParameters,collapsed:i.collapsed,flags:i.flags},i.onViewModelAcquired&&function(n){return i.onViewModelAcquired(n&&n.getValue())}).then((function(n){return e._proxiedObjects.push(n),n.getValue()})).then((function(n){r.resolve(n)}),(function(n){r.reject(n)})),r.promise())},n.prototype.releaseViewModel=function(n){i.disposeDisposable(n);var t=i.findIndex(this._proxiedObjects,(function(t){return t.getValue()===n}));t!==-1&&this._proxiedObjects.splice(t,1)[0].dispose()},n.prototype.isPreview=function(
){return this.getManifest("assetTypes").isPreview},n})();li=(function(){function n(){}return n.prototype.createRpcWindow=function(n){var i=(n.createIframe||hr)(),r=it.setTimeout((function(){n.onError()}),nr),e,o,u,f;i.on("load",e=function(t){r&&(it.clearTimeout(r),r=null);n.onLoad(t.originalEvent)});i.on("error",o=function(n){var t=n.originalEvent;nt.error(t.error,3,{message:t.message,filename:t.filename,colno:t.colno,lineno:t.lineno})});i.attr("src",n.frameUri);u=i[0].contentWindow;f=new ai({source:u,window:u,trustedHost:n.trustedHost||"*",initializationFunc:undefined},function(n){i.attr("src",n)});f.onDispose((function(){i.off("load",e);i.off("error",o);setTimeout((function(){i.remove()}),t.frameRemovalDelay)}));return f},n})();t.BrowserHostingContext=li;lr=(function(){function n(n){this._relexConfig=n}return n.prototype.createRpcWindow=function(n){return this._relexConfig.createRpcWindow(n)},n})();ai=(function(n){function t(t,i){n.call(this,t);this.refresh=i}return __extends(t,n),t})(bt.RpcWindow);
t.RpcWindow=ai})(k||(k={})),k}));define("MsPortalImpl/Extension/ExtensionManager",["require","exports","f","o","../Base/Base.CustomControlsBladeHost","../_generated/Common/Relex.Channel","./Extension","MsPortalFx/Globalization","../Base/Languages","../Services/Services.GeneralSettings","../Services/Services.Storage","../Base/Telemetry"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a;return (function(t){function ht(n){return r.keys(n||{}).filter((function(t){var i=n[t];return i&&!!i.manifest})).length}function ct(n,t,i){it.Log.writeEntry2(2,n,t,i)}function lt(n){var t=new ft(location.href);return t.setRelativePath(n),t.toString()}function tt(n){return n.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")}function ri(n){return new at.ExtensionManagerImpl({createExtension:e.create,extensionVersionCache:n,storageService:c.create()})}var vt=FxImpl,d=vt.Extension,v=i.Base,yt=v.Constants,pt=v.Constants.ExtensionNames.Hubs,it=v.Diagnostics,wt=it.Telemetry,b=v.Rpc.Internal,ft=v.UriBuilder,w=e.LoadedExtensions,
rt=l.Source,g=jQuery,y=window,et=y.fx.early,p=it.createLog(n),bt=n.normalize(undefined),a=y.fx.environment,ot=a.bootMessageSignature,kt=a.bootGetConst,st=a.bootReturnConst,dt=1e4,gt=6e4,k=wt.trace,ut=y.fx.getTimestamp,ni=tt(lt(a.extensionTraceUri)),ti=tt(lt(a.extensionTelemetryUri)),ii=tt(a.shellVersion),nt,at;(function(n){function i(n,i){return Q(v.Net2.ajax({uri:t.getUri(n,i),performRetry:!0,type:"GET",dataType:"json",contentType:"application/json"}))}function r(i){var r;return r=i==="assetTypes"?Q(t.promise).catch((function(n){return p.warning(n,6),null})).then((function(t){return ht(t)?t:n.getManifestsAjax(undefined,i)})):n.getManifestsAjax(undefined,i),r.then((function(n){return n||{}})).catch((function(n){return p.error(n,7),{}}))}var t=et.manifestCache;n.getManifestsAjax=i;n.getManifests=r})(nt=t.Relex||(t.Relex={}));t.escapeSingleQuote=tt;t.create=ri,(function(n){function ui(n){var t=JSON.stringify(n.effectiveFeatureFlags);return"(function() {var global = window;var env = global.fx.environment;"+
("env.activeFlights = "+lt+";")+("env.extensionTraceUri = '"+ni+"';")+("env.shellVersion = '"+ii+"';")+("env.extensionTelemetryUri = '"+ti+"';")+("env.fxRequireConfig = "+at+";")+("var extFeatures = "+t+";")+"var features = env.features = env.features || {};Object.keys(extFeatures).forEach(function(key) {    features[key] = extFeatures[key];});var impl = global.FxImpl || {};((impl.startBoot) || MsPortalFx.Internal.startBoot)();})();"}function fi(n){var t=document.createElement("a");return t.href=n,t.href}function tt(n,t,i){return n.count=i.count-t.count,n.chars=i.chars-t.chars,n}var lt=JSON.stringify(a.activeFlights),at=JSON.stringify(a.fxRequireConfig),vt=o.displayLanguage,wt=o.formatCulture,ri=vt+s.localeDelimiter+wt,ei=(function(){function n(n){var f=this,r,u;this._messageHandlers=[];this._isRpcStarted=!1;this._callbacksMap=new i.Map;this._callbacks=g.Callbacks();this._unloadCallbacks=g.Callbacks();this._allManifestsLoaded=Q.defer();this._manifestLoadStarted=Q.defer();this._relexDisconnected=
Q.defer();this._bladeFrameMap={};this.manifestLoadComplete=!1;this._createExtension=n.createExtension;this._extensionVersionCache=n.extensionVersionCache;w.loadedExtensions=[];n.skipRegisterManifest||d.registerManifestDefinition.register(b.client,null,(function(n,t){f._getExtensionByWindowId(t.srcWindowId).onManifestReceived(n)}));this._addExtensionBootReceiver();r="false";a.features.relex?r=a.features.relex:a.features.showrelexdialog&&(r=n.storageService.getValue(c.ComponentName.Relex,"Enabled",0)==="Enable"?"*":"false");this._relexConfig=new t(r);r&&r!=="false"&&this._addRelexReceiver();u=this.getExtensionByName(pt,d.getHubsCloudName());this.getHubsExtension=function(){return u}}return n.prototype.isRelexEnabled=function(){return this._relexConfig.enabled()},n.prototype.getExtension=function(n,t){return this._getExtensionByDescriptor({cloudName:t,name:n})},n.prototype.getInitializedExtensions=function(){return w.loadedExtensions},n.prototype.getManifestByName=function(n,t){var i=this;return this.
_manifestLoadStarted.promise.then((function(){return i.getExtension(n,t).getManifestAsync()}))},n.prototype.getExtensionByName=function(n,t,i){var r=this;return i=i||{},this._manifestLoadStarted.promise.then((function(){var u=r._getExtensionByDescriptor({cloudName:t,name:n}),e,f;if(!u)throw new Error("extension {0}, in cloud {1} was not found".format(n,t));return u.unloaded?i.onlyIfLoaded||(e=u.loadAsync(),r._onExtensionLoaded(e)):u.initializeRequired||r._onExtensionLoaded(u.extensionLoadedInternal),u.ensureInitialize(),f=u.isExtensionLoadedAsync(),i.timeout>0&&(f=Q(f).timeout(i.timeout,"Timed out waiting for extension '{0}' to load.".format(n))),f.then((function(){return r._getLoadedExtensionByWindowId(u.getWindowId())}))}))},n.prototype.initialize=function(n){var t=this,o=n.onRelexDisconnected,s,r,f,h,i,c;return o&&this._relexDisconnected.promise.then((function(){o()})),this._extensionsMap={},s=this._createExtension,r=n.extensions.map((function(n){var r=s(n,t._extensionVersionCache.getLatest(
n.name),t._relexConfig),i=r.getWindowId().toLowerCase();if(t._getExtensionByWindowId(i))throw new Error("Extension with window ID '{0}' has already been registered.".format(i));return t._extensionsMap[i]=r})),this.startRpc(),f=this._getExtensionByWindowId(d.getHubsWindowId()),f&&b.internalClient.acquireWindow(f.getWindowId()),h=ut(),n.useCachedManifests?(i=nt.getManifests("assetTypes"),this._callbacksMap.has("assetTypes")||this._callbacksMap.set("assetTypes",{initialPromise:i,callbacks:new v.Callbacks})):i=Q({}),i.then((function(n){k({source:"ExtensionManager",action:"CachedManifestCount",actionModifier:l.ActionModifier.Default,data:ht(n),duration:ut()-h});t._extensionVersionCache.setLatest(n);r.forEach((function(t){var i=n[t.name],r;i&&i.manifest||(r=e.getCachedManifestFromLocalStorage(t.getWindowId()),e.canUseManifest(r)&&r.manifest&&(i={manifest:r.manifest,version:r.extVersion}));(t.isTestExtension||t.isTestStamp)&&(i=null);t.loadAsync(i)}))})),c=r.map((function(n){var i=n.getManifestAsync(
);return i.then((function(n){t._callbacksMap.has("assetTypes")&&t._callbacksMap.get("assetTypes").callbacks.fire(n)})),i})),this._manifestLoadStarted.resolve(),u.getControlDefinitionEndpoint.register(b.client,null,(function(n,i){return i.srcWindowId===yt.Shell?Q.reject("Running custom controls from the shell frame is not allowed. Specify the HasCustomControls attribute in your template blade to enable this."):t.getExtensionByName(n.extension,n.cloud).then((function(t){return t.getControlDefinition(n.name)}))})),Q.any([Q.allSettled(c),Q.delay(gt)]).then((function(){t._allManifestsLoaded.resolve();t.manifestLoadComplete=!0}))},n.prototype.registerBladeFrame=function(n,t){this._bladeFrameMap[n]=t},n.prototype.unregisterBladeFrame=function(n){var t=this._bladeFrameMap;n in t&&(t[n]().dispose(),delete t[n])},n.prototype.startRpc=function(){var n=this;this._isRpcStarted||(this._isRpcStarted=!0,b.start({originId:"fx",loadWindow:function(t){var r=n._bladeFrameMap[t],i;if(r)return r();if(i=n._getExtensionByWindowId(
t),!i)throw new Error("Failed to load extension '{0}'.".format(t));return i.getOrLoadWindow()},parentWindow:y}))},n.prototype.pinExtensions=function(n){var t=this;return this._manifestLoadStarted.promise.then((function(){n.forEach((function(n){if(n){var i=t._getExtensionByWindowId(n);i&&b.internalClient.acquireWindow(i.getWindowId())}}))}))},n.prototype.unloadExtension=function(n){var t={cloudName:n.cloudName,name:n.name};n.dispose();w.removeLoadedExtension(n);this._unloadCallbacks.fire(t)},n.prototype.on=function(n,t){var u=this,f,i,r;return this._callbacksMap.has(n)||(f=void 0,f=a.relex.cachedManifestTypes[n]?nt.getManifests(n).then((function(t){var i=u.getExtensions().map((function(i){var e=i.isTestExtension||i.isTestStamp?null:t[i.name],r=e&&e.manifest,f;if(r)i.setManifest(n,r),u._callbacksMap.get(n).callbacks.fire(r);else return i.loadAsync(),f=i.getManifestAsync(),f.then((function(t){u._callbacksMap.get(n).callbacks.fire(t)})),f.timeout(dt)})).filter((function(n){return!!n}));return Q.allSettled(
i)})):this._allManifestsLoaded.promise,this._callbacksMap.set(n,{initialPromise:f,callbacks:new v.Callbacks})),i=this._callbacksMap.get(n),t&&(r=function(n){try{t(n)||i.callbacks.remove(r)}catch(u){p.error(u,11)}},i.callbacks.add(r),this.getExtensions().forEach((function(t){var i=t.getManifest(n);i&&r(i)}))),i.initialPromise},n.prototype.onLoad=function(n){var i=this,r=w.loadedExtensions.slice(0),t=function(r){try{n(r)||i._callbacks.remove(t)}catch(u){p.error("onLoad event callback has thrown an exception.",2,u)}};this._callbacks.add(t);r.forEach((function(t){n(t)}))},n.prototype.onUnload=function(n){var i=this,t=function(r){try{n(r)||i._unloadCallbacks.remove(t)}catch(u){p.error("onUnload event callback has thrown an exception.",3,u)}};this._unloadCallbacks.add(t)},n.prototype.refreshManifests=function(n){return nt.getManifestsAjax(n)},n.prototype.dispose=function(){this._messageHandlers&&(this._messageHandlers.forEach((function(n){y.removeEventListener("message",n)})),this._messageHandlers=
[])},n.prototype._getExtensionByWindowId=function(n){return this._extensionsMap[n.toLowerCase()]},n.prototype._getExtensionByDescriptor=function(n){return this._getExtensionByWindowId(d.getWindowId(n))},n.prototype._onExtensionLoaded=function(n){var t=this;n.then((function(n){w.addLoadedExtension(n);var i=n.extension;i.resolveExtensionLoaded&&i.resolveExtensionLoaded();t._callbacks.fire(n)}))},n.prototype._getLoadedExtensionByWindowId=function(n){return w.loadedExtensions.first((function(t){return t.extension.getWindowId()===n}))},n.prototype._getExtensionByWindow=function(n){return this.getExtensions().first((function(t){return t.getWindow()===n}))},n.prototype.getExtensions=function(){var n=this;return r.keys(this._extensionsMap||{}).map((function(t){return n._extensionsMap[t]}))},n.prototype._addExtensionBootReceiver=function(){var n=this,t=function(t){var r=t,i=t.data,u;i&&i.signature===f.signature&&i.kind===f.MessageKind.Boot&&(u=n._getExtensionByWindowId(i.windowId),r={data:i.data,origin:
t.origin,source:u.getWindow()});n._onBoot(r);n._onBootGetRequested(r)};y.addEventListener("message",t,!1);this._messageHandlers.push(t)},n.prototype._onBoot=function(n){var w=this,t=this._getExtensionByWindow(n.source),u=n.data,o,f,a,v;if(u&&u.signature===ot){if(!t&&n.origin!==y.location.origin){o=i.find(r.keys(this._bladeFrameMap),(function(t){return w._bladeFrameMap[t]().getSource()===n.source}));o||p.error("Received a boot message from '{0}' which is not associated to an extension.".format(n.origin),9,u);return}var s=t&&"/"+t.getWindowId(),h=bt+s,c=function(){t&&t.noteScriptError({kind:u.kind,error:u.data})};switch(u.kind){case 0:f=u.data;a=t.processBootGetMessage(f.sdkVersion,f.extVersion);a&&t.getWindow().postMessage({signature:ot,kind:1,data:{stopListening:!0,scripts:[{kind:1,data:ui(t)}]}},"*");break;case 2:v="{0} Origin: {1}".format(JSON.stringify(u.data),n.origin);ct(h,v,10);c();break;case 4:ct(h,u.data,8);k({source:rt.Shell,action:l.Action.UnhandledExtensionError,actionModifier:
l.ActionModifier.Default,extension:s,data:e.ExtensionReadyState[t.readyState]});case 5:c();break;case 3:break;default:p.error("Received a boot message from a source that isn't a recognized extension. Will ignore. Origin: {0}".format(n.origin))}}},n.prototype._onBootGetRequested=function(n){var i=n.data,t,r,u;i&&i.boot===kt&&(t=this._getExtensionByWindow(n.source),t?(r=t.processBootGetMessage(i.sdkVersion,i.extVersion),r&&(u={boot:st,stopListening:!1,scripts:e.getScriptUris(t.metadata,e.RequiredScripts.ExtensionScripts,t.useRelex())},t.getWindow().postMessage(u,"*"))):p.error("_onBootGetRequested receieve invalid evt.source. Origin:"+n.origin+" \n Data:"+JSON.stringify(i)))},n.prototype._addRelexReceiver=function(){var n=this,t;this._m={sent:{count:0,chars:0,startOffBy:0},recv:{count:0,chars:0}};t=function(t){var i=t.data,r=i&&i.messageTelemetry;if(r&&(n._m=r,delete i.messageTelemetry,r.sent.startOffBy=n._relexConfig.messagesSent-r.sent.count),i&&i.signature===f.signature)switch(i.kind)
{case f.MessageKind.Telemetry:k(i.data);break;case f.MessageKind.Connection:n._handleConnectionMessage(i.data)}};y.addEventListener("message",t,!1);this._messageHandlers.push(t)},n.prototype._handleConnectionMessage=function(n){n.type===f.ConnectionEventType.Disconnected&&this._relexDisconnected.resolve()},n.prototype.getMessageTelemetry=function(n){var t=this._m;return n&&t?{sent:tt({startOffBy:n.sent.startOffBy,stopOffBy:t.sent.startOffBy},n.sent,t.sent),recv:tt({},n.recv,t.recv)}:t},n})(),t,it;n.ExtensionManagerImpl=ei;t=(function(){function n(n,t){var r=this;this.multiComm=!1;this.devMode=!1;this.messagesSent=0;this._allExtensionsOnRelex=!1;this._extensionMap={};n!=="false"&&(n==="true"&&(n="*,HubsExtension"),n.toLowerCase().split(",").forEach((function(n){n==="*"?r._allExtensionsOnRelex=!0:n==="multicomm"?r.multiComm=!0:n==="devmode"?r.devMode=!0:r._extensionMap[n]=!0})),this._instancePromise=Q().then((function(){var n;if(r.devMode)return h.processor.initialized.then((function(n){var t=
n.relexHost(),i=t.split("/"),r=location.protocol+"//"+i[2];return{uri:t,trustedHost:r}}));n=new ft(a.relex.instanceUri);n.path=i.ensureSuffix(n.path,"/")+"relexproxy";n.query.setParameter("verbose",a.isDevelopmentMode?"2":"0");var t=n.toString(),u=t.split("/"),f=location.protocol+"//"+u[2];return{uri:t,trustedHost:f}})),t||(t=function(n){return new it(n)}),this.multiComm?this._createChannel=t:this._channelSingleton=t(this))}return n.prototype.enabled=function(){return this._allExtensionsOnRelex},n.prototype.getInstance=function(){return this._instancePromise},n.prototype.createRpcWindow=function(n){var t;return t=this.multiComm?this._createChannel(this):this._channelSingleton,t.createRpcWindow(n)},n.prototype.useRelex=function(n){return!n.isTestExtension&&this._allExtensionsOnRelex!==Boolean(this._extensionMap[n.name.toLowerCase()])},n})();n.DefaultRelexConfig=t;it=(function(){function n(n){var u=this,t,r,i;this._config=n;t=et.relex;t?(this._readyPromise=Q(t.loadPromise),this._frame=g(t.frame),
this._trustedHost=t.trustedHost,r=t.initRelexDelay):(i=Q.defer(),this._readyPromise=i.promise,r=ut(),n.getInstance().then((function(n){u._trustedHost=n.trustedHost;u._frame=g(MsPortalEarly.Relex.initializeRelexFrame(n,(function(n){i.resolve(n)}),(function(n){i.reject(n)})))})));k({action:"InitRelexDelay",actionModifier:"complete",source:rt.Shell,duration:r});this._readyPromise.then((function(n){k({action:"RelexClientPageLoad",actionModifier:"complete",source:rt.Shell,duration:n})}))}return n.prototype.createRpcWindow=function(n){var t=this,i=n.getWindowId(),u,r;this._readyPromise.then((function(){n.onLoad(null)&&t._postMessage(i,f.MessageKind.ExtensionLoad,{uri:fi(n.frameUri),locale:ri})}));u=this._frame[0].contentWindow;r=new e.RpcWindow({source:u,window:{postMessage:function(n){var r=n&&n.boot===st?f.MessageKind.Boot:f.MessageKind.Rpc;t._postMessage(i,r,n)}},trustedHost:this._trustedHost,initializationFunc:undefined},function(){});r.onDispose((function(){t._postMessage(i,f.MessageKind.ExtensionUnload,
{});t._config.multiComm&&setTimeout((function(){t.dispose()}),e.frameRemovalDelay)}));return r},n.prototype.dispose=function(){this._frame&&(this._frame.remove(),this._frame=null)},n.prototype._postMessage=function(n,t,i){var r={signature:f.signature,windowId:n,kind:t,data:i};this._frame[0].contentWindow.postMessage(r,this._trustedHost);this._config.messagesSent++},n})()})(at=t.Internal||(t.Internal={}))})(a||(a={})),a}));define("MsPortalImpl/Extension/ExtensionMetadataSource",["require","exports","f","i","o","../CodeComponentSideLoad/CodeComponentSideLoadManager","../CodeComponentSideLoad/CodeComponentSideLoadModels","../Services/Services.Settings.Schema","../Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function rt(n,t,i,r,u){var f=new l(n,t,i,r,u,b,p.isDevelopmentMode);return MsPortalImpl.Extension=f,f}var a=i.Base,d=a.Diagnostics,h=e.ExtensionMetadataExt,v=r.Extension,y=window,g=d.createLog(n),p=y.fx.environment,w="testExtensions",nt="loadUntrustedExtensions",
tt=o.testExtensionsKey,it=5e3,b=e.canModifyExtensions,k="Reload the portal with the query parameter ?feature.canmodifyextensions=true to load the test extension.",c=h.create,l;t.initializeTestExtension=rt;l=(function(n){function t(t,i,r,u,f,e,o){n.call(this,t,i,r,u,f,e,o,nt,w,c,0,tt)}return __extends(t,n),t.prototype.registerTestExtension=function(n,t){var i=c(n);return this.registerTestCodeComponent(i,t).then((function(){console.log(k)}))},t.prototype.registerTestExtensionsFromUri=function(n,t){var o=this,l=new s.Uri(n),c=l.getHashQueryStringValue(w),r,f;return c?(r=JSON.parse(decodeURIComponent(c)),f=u.keys(r),!b&&f.length&&console.warn(k),Q.allSettled(f.map((function(n){var u=new h,c,f,s,l;return u.name=n,u.cloudName=t,c=v.getWindowId(u),f=i.find(o._trustedCodeComponents,(function(n){return v.getWindowId(n)===c})),f&&(u.obsoleteBundlesBitmask=f.obsoleteBundlesBitmask),s=u.uri=r[n],e.isLocalhostUri(s)?o._registerTestCodeComponentFromUri(u):(l="Invalid extension: '{0}', only allowed on 'localhost'.".
format(s),g.error(l,1),null)})))):Q(null)},t.prototype.unregisterTestExtension=function(n,t){var i=new h;return i.name=n,i.cloudName=t,this.unregisterTestCodeComponent(i)},t.prototype.listTestExtensions=function(){return this.listTestCodeComponents()},t.prototype.clearTemporaryTestExtensions=function(){this.clearTemporaryTestCodeComponents()},t.prototype.loadFromServer=function(n){var i=p.extensionsUri,r,t;return i?(t=y.location.search,t&&(i.indexOf("?")!==-1&&(t="&"+t.substr(1)),i+=t),r=a.Net2.postJSON({uri:i},n).then((function(n){return n.map((function(n){return c(n)}))})).timeout(it,"Timed out fetching extension metadata from the server.")):r=Q([]),r},t})(f.CodeComponentSideLoadManagerImpl);t.ExtensionMetadataSourceImpl=l})(h||(h={})),h}));define("MsPortalImpl/GalleryPackage/GalleryPackageLoader",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function o(n){return new t(n)}var f=i.Base,r=f.Constants,u=r.ExtensionNames,e=i.Services.Rpc,t;n.initialize=o;t=(function(
){function n(n){this._extensionManager=n}return n.prototype.loadGalleryPackages=function(n){if(n&&n.length>0)return this._extensionManager.getExtensionByName(u.Marketplace,r.DefaultCloudName).then((function(){e.invokeCallback(u.Marketplace,"loadGalleryPackages",n)}))},n})();n.GalleryPackageLoaderImpl=t})(r||(r={})),r}));define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-keyboardshortcuts{padding:20px}.fxs-keyboardshortcuts .fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts .fxs-keyboardshortcuts-category .fxs-keyboardshortcuts-shortcut{display:-webkit-flex;display:flex}.fxs-keyboardshortcuts .fxs-keyboardshortcuts-category .fxs-keyboardshortcuts-shortcut .fxs-keyboardshortcuts-key{-webkit-flex:0 0 auto;flex:0 0 auto;width:70px}")}));define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources",
"../Base/Base.KeyboardHelper","../Base/Telemetry","../../_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function y(n){var t=n.isJourneyVisible()&&n.getPanorama();return t&&t.getJourneyWidget()}function c(n){var t=y(n);return t&&t.getFocusedBlade()}function ut(n,t){var i=c(t);i&&i.toggleBladeSize(n)}function ft(n,t,i,r,u){return new p(n,t,i,r,u)}var a=i.Base.Diagnostics,w=a.Telemetry,l=i.Base.EventTypes,b=u.VariableKeyCode,k=window,s=jQuery,v="#blade/HubsExtension/Resources",h=v+"/resourceType/",d=i.disposeDisposable,g="fxs-sidebar-collapse-button",nt="fxs-topbar-home",e=r.KeyboardShortcuts,o=e.GoTo,tt=a.createLog(n),it=w.trace,rt=[49,50,51,52,53,54,55,56,57,48],p;t.setup=ft;p=(function(){function n(n,t,i,r,u){this._disposables=[];this._keyShortcuts={};this._goToShortcuts={};this._widgetPortal=n;this._addKeyShortcuts(t.contextPane);this._attachEventHandlers();this._errorLoggingFunc=u||function(
n){tt.error(n)};this._registerActionShortcuts();this._addGoToShortcuts(t.router);this._registerSpecialShortcut(e.showDiagnostics,i,65);this._registerSpecialShortcut(e.showDebugHelper,r,68)}return n.prototype.dispose=function(){this._removeEventHandlers()},n.prototype._attachEventHandlers=function(){var t=this,n;this._removeEventHandlers();n=!1;this._disposables.push(s(k.document).setEvents([l.keydown,function(i){var r,h=u.getModifierKeys(i),o,e;if(i.keyCode===71&&h===0){n=!0;return}(o=n?t._goToShortcuts[i.keyCode]:t._keyShortcuts[i.keyCode],e=o&&o[h],e)&&((r=s(document.activeElement),r.length>0&&(r.is("input")||r.is("textarea")||["azc-editableControl","fxc-editor","fxc-console","fxc-consolev2"].some((function(n){return r.closest("."+n).length>0}))))||(e.handler(),it({source:f.Source.KeyboardShortcuts,action:f.Action.KeyboardShortcutExecuted,name:e.id}),i.preventDefault()))}],[l.keyup,function(t){var i=u.getModifierKeys(t);t.keyCode===71&&i===0&&(n=!1)}]))},n.prototype._removeEventHandlers=
function(){d(this._disposables);this._disposables=[]},n.prototype._registerShortcut=function(n,t,i,r){r===void 0&&(r=0);var u=this._keyShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate shortcut: "+f):this._keyShortcuts[i]=[];this._keyShortcuts[i][r]=e},n.prototype._addKeyShortcuts=function(){var i=this,t=this._widgetPortal,n=function(n,t,r,u){u===void 0&&(u=0);i._registerShortcut(n,t,r,u)};n(e.showAvailableKeyboardShortcuts,(function(){s(document).trigger(l.fxopenshortcutslegend)}),191,4);n(e.maximizeOrRestore,(function(){ut(!0,t)}),b.Equals,4);n(e.closeBlade,(function(){var n=c(t);n&&n.close(!1)}),51,4);n(e.closeJourney,(function(){var n=y(t);n&&n.close()}),220,4);n(e.toggleFocusSideAndTopBar,(function(){var n=s(document).findByClassName(nt)[0];s(document.activeElement)[0]===n?s(document).findByClassName(g)[0].focus():n.focus()}),190);n(e.moveFocusToCommandBar,(function(){var n=c(t).getContentWidget();n&&n.setFocusOnCommandBar(
)}),188);n(e.bladeSearch,(function(){var n=c(t);n&&n.focusSearchBox()}),191,8)},n.prototype._registerGotoShortcut=function(n,t,i){var r=0,u=this._goToShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r,!0),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate goto shortcut: "+f):this._goToShortcuts[i]=[];this._goToShortcuts[i][r]=e},n.prototype._registerSpecialShortcut=function(n,t,i){s.isFunction(t)&&this._registerShortcut(n,t,i,9)},n.prototype._addGoToShortcuts=function(n){var r=this,t=this._registerGotoShortcut.bind(this),i=this._widgetPortal;[[o.allResources,v,65],[o.applicationInsights,h+"microsoft.insights%2Fcomponents",73],[o.cloudServices,h+"microsoft.classicCompute%2FdomainNames",67],[o.resourceGroups,h+"Microsoft.Resources%2Fsubscriptions%2FresourceGroups",82],[o.virtualMachines,h+"Microsoft.ClassicCompute%2FVirtualMachines",86],[o.virtualNetworks,h+"Microsoft.ClassicNetwork%2FvirtualNetworks",78],[o.appService,h+"Microsoft.Web%2Fsites",87]].forEach((function(
i){t(i[0],(function(){n.route(i[1])}),i[2])}));t(o.dashboard,(function(){i.handleStartButtonClick()}),68);t(o.dashboard+"(obsolete)",(function(){i.handleStartButtonClick()}),72);rt.forEach((function(n,t){var u=n===48?10:t+1;r._registerGotoShortcut(o.sideBarItem+u,(function(){i.options.sideBar.openFavorite(t)}),n)}))},n.prototype._generateIdForKeyboardShortcut=function(n,t,i){i===void 0&&(i=!1);var r=i?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),t&8&&(r+="CTRL+"),t&1&&(r+="ALT+"),t&2&&(r+="WIN/CMD+"),r+u.mapKeyCodeToString((t&4)==4,n)},n.prototype._registerActionShortcuts=function(){var t=this._widgetPortal,n=this._registerShortcut.bind(this),r;i.isFeatureEnabled("retirejourneysmenu")||n(e.active,(function(){var n=t.options.topBar.journeysMenu.dropMenu;n.toggle()}),65);n(e.browse,(function(){t.getSideBarWidget().toggleFlyout()}),66);r=function(){t.getSideBarWidget().openCreate()};n(e.new,r,78);n(e.new,r,67);n(e.search,(function(){t.getSearchWidget().setFocus()}),191)},n.prototype.
getShortcuts=function(){return{key:this._keyShortcuts,goTo:this._goToShortcuts}},n})()})(e||(e={})),e}));define("MsPortalImpl/Services/Services.AzureStorage",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function c(){s.register(f.client,[r.Extension.getWindowId({name:"Microsoft_Azure_Scheduler",cloudName:t.Constants.DefaultCloudName})],l)}function l(n){var t={isBackgroundTask:!1,uri:h};return o.postJSON(t,n).then((function(n){return n.data}))}var t=i.Base,u=t.Resources,f=t.Rpc.Internal,e=r.InternalAzure,o=t.Net2,s=e.getSasUriForQueueEndPoint,h=u.getAppRelativeUri("api/Storage/getsasuriforqueue");n.registerSasEndPoint=c})(u||(u={})),u}));define("MsPortalImpl/Services/Services.BrowseCuration",["require","exports","f","i","MsPortalImpl/Resources/ImplScriptResources","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function p(n){if(n&&!nt.test(n)){e.warning("Invalid curation file name: <"+n+">, skipping this curation file.");
return}return n}function ut(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return{base:h(n,!1),associated:c.apply(c,i)}}function h(n,t){var i,r;if(n&&!(n.length<2)&&n[0].length&&n[1].length)return i={extensionName:n[0],assetType:n[1]},t||n[n.length-1]===!1&&(i.isHidden=!0),n.length>2&&(r=n[2],r&&typeof r=="string"&&(i.kind=r)),i}function c(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];return t.map((function(n){return h(n)})).filter((function(n){return!!n}))}function ft(n){return i.require("MsPortalImpl/Services/BrowseCuration/"+n).then((function(n){return n.getCuration()}))}function b(){return o||(o=ft(w),o.catch((function(n){var t="Failed to get the browse curation file <"+w+">";return n&&n.statusText?e.warning(t+": "+(n.status||"")+" ("+n.statusText+")"):n&&n.message?e.warning(t+": "+n.message):e.warning(t),l.ClientNotification.publish({title:v.noCurationTitle,description:v.noCuration,status:l.NotificationStatus.Warning}),{}}))),o}function k(){var n=u.SearchTypeDisplayText,
t=u.SearchTypeKeywords,i=u.SearchTypeSubText;return b().then((function(r){var u=(r&&r.search||[]).map((function(r){var u=(r.id||"").toLowerCase(),f=u&&n[u];if(f)return{id:r.id,displayName:f,subText:i[u],keywords:(t[u]||"").split(","),icon:typeof r.icon=="string"?s.Images.ImageUri(r.icon):r.icon,link:(r.link||"").format({accountPortal:a.links.accountPortal})}})).filter((function(n){return!!n}));return{searchCuration:u,resourceTypesExcludedFromBrowse:y(r&&r.resourceTypesExcludedFromBrowse),mergedAssetTypes:y(tt&&r&&r.mergedAssetTypes)}}))}function et(){f.Curation.getSharedCurationEndpoint.register(d.client,[r.Extension.getHubsWindowId()],(function(){return k()}))}var s=i.Base,d=s.Rpc.Internal,l=i.Hubs.Notifications,g=window,a=g.fx.environment,e=s.Diagnostics.createLog(n),nt=/^[a-z\_]+[a-z\d\-\_]*$/i,v=u.BrowseCuration,tt=i.isFeatureEnabled("mergedassets"),y=i.lowerCaseAllStrings,it=p(i.getFeatureValue("browsecuration")),rt=p(a.browseCuration),w=it||rt||"default",o;t.getMergedAssetType=ut;t.getAssetType=
h;t.getAssetTypes=c;t.getBrowseCuration=b;t.getSharedCuration=k;t.initializeRpc=et})(e||(e={})),e}));define("MsPortalImpl/Services/Services.Controller",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function u(n){var i=[n?n.flushSettings():Q(),r.flush(),t.Upload.flush()],u=i.every((function(n){return!Q.isPending(n)}));return u?Q():Q.all(i)}var t=i.Base.Diagnostics,r=t.Telemetry;n.flush=u})(r||(r={})),r}));define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function s(){e||(e=!0,u.uploadActionEndPoint.register(t.client,null,(function(n){return f().then((function(t){return t.invokeUploadAction(n.uploadKey,n.action,n.context)}))})),u.getUploadInfosEndPoint.registerObjectFactory(t.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){return f().then((function(t){return t.getUploadInfos(n.uploadKeys,n.category,n.resumable)}))}}))}var t=i.Base.Rpc.Internal,
u=r.FileUpload,o="MsPortalImpl/Services/Services.FileUploadManager",f=i.memoize((function(){return i.require(o).then((function(n){return n.fileUploadManagerInstance()}))})),e=!1;n.registerFileUploadEndpoints=s})(u||(u={})),u}));define("MsPortalImpl/Services/Services.GalleryEndpoints",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){var t=r.Extension,e=i.Base,o=e.Constants.ExtensionNames,s=window,u=s.fx.environment,f=u.features,h=(function(){function n(n,i,r){var e=this;this._registeredEndpoints=[];this._extensionManager=i;this._extensionMetadataSource=r;t.getLocalGalleryPackagesEndpointsDefinition.register(n,null,(function(n,i){var r=t.getDescriptor(i.srcWindowId).name.toLowerCase();return r===o.Marketplace.toLowerCase()?e._ensureAllTestExtensionsAreLoaded().then((function(){return e._registeredEndpoints.slice(0)})):null}));t.registerLocalGalleryPackagesEndpointDefinition.register(n,null,(function(n){if(u.isDevelopmentMode||f&&f.canmodifyextensions){var t=e._registeredEndpoints;
t.indexOf(n)<0&&t.push(n)}}))}return n.prototype._ensureAllTestExtensionsAreLoaded=function(){var n=this;return this._extensionMetadataSource.listTestExtensions().then((function(t){return Q.allSettled(t.map((function(t){return n._extensionManager.getExtensionByName(t.name,t.cloudName)})))}))},n})();n.GalleryEndpointsService=h})(u||(u={})),u}));define("MsPortalImpl/Services/Services.FavoritesSettings",["require","exports","./Services.SettingsProcessor"],(function(n,t,i){"use strict";var r;return (function(n){function o(i){if(r&&!e.isTestMode)throw new Error(t+" has already been called.");r=!0;n.processor.init(i,n.settings,f,t,!0)}var f=10,t="InitializeFavoritesSettingsInternal",e=window.fx.environment,r=!1,u=ko.observable;n.processor=new i.SettingsProcessor;n.settings={favorites:u(""),version:u(0)};n.init=o})(r||(r={})),r}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-messagebox,.fxs-messagebox h2,.fxs-progressbox,.fxs-progressbox h2{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.fxs-commandBar-form{padding:0}.fxs-messagebox,.fxs-progressbox{font-size:14px;box-sizing:border-box;border:1px solid}.fxs-messagebox h2,.fxs-progressbox h2{font-size:110%;padding:24px 27px 7px;margin:0;line-height:14px;border-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-messagebox .fxs-messagebox-html,.fxs-messagebox .fxs-messagebox-text,.fxs-messagebox .fxs-progressbox-text,.fxs-progressbox .fxs-messagebox-html,.fxs-progressbox .fxs-messagebox-text,.fxs-progressbox .fxs-progressbox-text{padding:0 27px;word-wrap:break-word}.fxs-messagebox .fxs-progressbox-progressbar,.fxs-progressbox .fxs-progressbox-progressbar{padding:7px 27px 24px}.fxs-messagebox .fxs-messagebox-buttons,.fxs-progressbox .fxs-messagebox-buttons{border-top:1px solid}.fxs-messagebox .fxs-messagebox-buttons button,.fxs-progressbox .fxs-messagebox-buttons button{margin-right:5px}.fxs-messagebox .msportalfx-form,.fxs-progressbox .msportalfx-form{padding:0;margin:27px 0 0}.fxs-messagebox .msportalfx-form div,.fxs-progressbox .msportalfx-form div{padding:15px 27px}.fxs-messagebox-confirmation{padding:10px 27px 0;display:block}.fxs-messagebox-confirmation input{vertical-align:-2px}')})
);define("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","../../Interactions/Interactions.DismissHandler","../../Interactions/Interactions.KeyboardNavigation","../Widgets.WidgetBase","../../../_generated/Less/Viva.Controls/Controls/Forms/Viva.Button.css","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function s(n){return"button[value='"+n+"']"}function ei(n){var i=n.closest("."+c),t;i.length>0&&(t=o.Widget.getWidget(i,p),t.cancelButton&&t.cancelButton.click())}function oi(n){var i=n.closest("."+c),t;i.length>0&&(t=o.Widget.getWidget(i,p),t.options.confirmationRequired?t.element.find("input").focus():t.defaultButton&&t.defaultButton.focus())}var vt=i.Base.Diagnostics,tt=i.Base.EventTypes,yt=i.ViewModels.Dialogs,l=yt.MessageBoxButtons,h=jQuery,pt=vt.createLog(n),it=i.newGuid,a=u.Dialogs.ButtonText,rt="fxs-accent",w="azc-button",
wt="fxs-button-primary",ut="fxs-button-default",c="fxs-messagebox",bt=c+"-title",b=c+"-text",ft=c+"-buttons",kt=c+"-confirmation",dt='<h2 data-bind="text: data.title" class="'+bt+' msportalfx-tooltip-overflow"><\/h2><!-- ko if: data.modal -->'+('<div data-bind="sanitizedHtml: data.text" class="'+b+'"><\/div>')+"<!-- /ko --><!-- ko ifnot: data.modal -->"+('<div data-bind="text: data.text" class="'+b+'"><\/div>')+"<!-- /ko --><!-- ko if: data.confirmationRequired -->"+('<label class="'+kt+"\"><input type=\"checkbox\" data-bind='checked: func._confirmed'><span data-bind='sanitizedHtml: data.confirmationMessage'><\/span><\/label>")+"<!-- /ko -->"+('<div class="'+["msportalfx-form",ft,"fxs-has-border"].join(" ")+'"><\/div>'),et="<button value='ok'>"+a.ok+"<\/button>",ot="<button value='retry'>"+a.retry+"<\/button>",k="<button value='cancel'>"+a.cancel+"<\/button>",st="<button value='yes'>"+a.yes+"<\/button>",ht="<button value='no'>"+a.no+"<\/button>",gt="<div><button value='abort'>"+a.abort+
"<\/button>"+ot+"<button value='ignore'>"+a.ignore+"<\/button><\/div>",ni="<div>"+et+"<\/div>",ti="<div>"+et+k+"<\/div>",ii="<div>"+ot+k+"<\/div>",ri="<div>"+st+ht+"<\/div>",ui="<div>"+st+ht+k+"<\/div>",v=ko.observable,ct="abort",lt="retry",fi="ignore",d="ok",y="cancel",g="yes",nt="no",at,p;t.cancelMessageBox=ei;t.setFocusOnMessageBox=oi;at=(function(n){function t(){n.apply(this,arguments);this.title=v();this.text=v();this.modal=!1;this.buttons=v(l.OK);this.confirmationRequired=!1}return __extends(t,n),r.defineProperty(t.prototype,"onButtonClick",{get:function(){return this._buttonClick},set:function(n){if(this._buttonClick)throw new Error("The onButtonClick callback has already been set.");this._buttonClick=n},enumerable:!0,configurable:!0}),t})(o.ViewModel);t.ViewModel=at;p=(function(n){function t(t,i){var r=this;n.call(this,t,i);this._validateForDismiss=function(n){var t=r.element[0];return!r.options.modal&&!(t===n)&&!h.contains(t,n)};this._dismissHandle={dismissFn:function(){r.cancelButton&&
r.cancelButton.click()},shouldDismissOnMouseDownFn:this._validateForDismiss,shouldDismissOnMouseWheelFn:this._validateForDismiss,restoreFocus:function(){f.validatePreviousFocusedElement(r._dismissHandle,r._previouslyFocusedElement)&&r._previouslyFocusedElement.focus()},logName:"messagebox"};this._confirmed=v();t.html(dt).addClass(c).addClass(rt);this._attachEventHandlers();this._previouslyFocusedElement=document.activeElement;i.buttons.subscribeAndRun(this.lifetimeManager,(function(n){t.findByClassName(ft).empty().append(r._getButtonHtml(n))}));this._bindDescendants();this._setAria();this.defaultButton&&this.defaultButton.addClass(w).addClass(wt).focus();this.cancelButton&&this.cancelButton.addClass(w).addClass(ut);this.noButton&&this.noButton.addClass(w).addClass(ut);this._confirmed(!i.confirmationRequired);ko.reactor(this.lifetimeManager,(function(){var n=r._confirmed();r.defaultButton&&r.defaultButton.toggle(n)}))}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(c,
rt);n.prototype.dispose.call(this)},t.prototype._getButtonHtml=function(n){var i=this.options,t,r;switch(n){case l.AbortRetryIgnore:t=h(gt);this.cancelButton=t.find(s(ct));break;case l.OK:t=h(ni);this.defaultButton=this.cancelButton=t.find(s(d));break;case l.OKCancel:t=h(ti);this.defaultButton=t.find(s(d));r=this.cancelButton=t.find(s(y));break;case l.RetryCancel:t=h(ii);this.defaultButton=t.find(s(lt));this.cancelButton=t.find(s(y));break;case l.YesNo:t=h(ri);this.defaultButton=t.find(s(g));this.cancelButton=t.find(s(nt));break;case l.YesNoCancel:t=h(ui);this.defaultButton=t.find(s(g));this.cancelButton=t.find(s(y));this.noButton=t.find(s(nt));break;default:throw new Error("Could not locate message box button of type {0}.".format(n));}return this.defaultButton&&this.defaultButton.length&&i.defaultButtonText&&this.defaultButton.text(i.defaultButtonText),r&&r.length&&i.cancelButtonText&&r.text(i.cancelButtonText),t},t.prototype._setAria=function(){var t="aria-labelledby",i="aria-describedby",
n=this.element,r=it(),u=it();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName(b).attr({id:r,role:"document",tabindex:0});this.lifetimeManager.registerForDispose((function(){n.removeAttr(["role",t,i].join(" "))}))},t.prototype._attachEventHandlers=function(){var n=this,t=this.element,i,r;t.on(tt.click,"button",i=function(t,i){n._buttonHandler(t,i);n._dismissHandle.restoreFocus()});r=new e.KeyboardNavigation(t,e.TabTrigger.TabKeys);f.register(this._dismissHandle);this.lifetimeManager.registerForDispose((function(){t.off(tt.click,"button",i);r.dispose();f.unregister(n._dismissHandle)}))},t.prototype._buttonHandler=function(n){var i=h(n.target).attr("value"),t;switch(i){case ct:t=0;break;case y:t=1;break;case fi:t=2;break;case nt:t=3;break;case d:t=4;break;case lt:t=5;break;case g:t=6;break;default:pt.error("Unknown command message box button was clicked. Button value is {0}.".format(i));return}if(typeof this.options.onButtonClick=="function")this.options.
onButtonClick(t)},t})(o.Widget);t.Widget=p})(s||(s={})),s}));define("MsPortalImpl/Services/Services.PortalTips",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.GeneralSettings","../../Viva.Controls/Controls/Viva.Balloon","../Widgets/Dialogs/Widgets.MessageBox"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function s(n,t,i){return t.then((function(){h(n);u.settings.whatsNewVersion(i)}))}function h(n){var s=n.createChildLifetime(),h=o.DefaultView,r=new e.ViewModel,u,c;r.buttons(i.ViewModels.Dialogs.MessageBoxButtons.OK);r.title(h.title);r.text(h.description.format(t.browseLabel));r.onButtonClick=function(){s.dispose()};r.disabled(!1);u=new f.ViewModel;c=f.getBox($(".fxs-sidebar-item:first-child"));u.box(c);u.content('<div class="fxs-portal-tip-content"><\/div>');s.registerForDispose([new f.Widget($(".fxs-portal-tip"),u,{isTrusted:!0}),new e.Widget($(".fxs-portal-tip-content"),r),]);u.position(2);setTimeout((function(){u.visible(!0)}))}
var t=window.fx.environment.branding,o=r.PortalTips;n.setup=s})(o||(o={})),o}));define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function h(){f.getSharedSettingsEndPoint.register(o.client,null,(function(){return u()}))}function u(){return Q.fcall((function(){return{links:{accountPortal:t.accountPortal,classicPortal:t.classicPortal,createSupportRequest:t.createSupportRequest,helpAndSupport:t.helpAndSupport,manageSupportRequests:t.manageSupportRequests,giveFeedback:t.giveFeedback,privacyAndTerms:t.privacyAndTerms,learnRelatedResources:t.learnRelatedResources,resourceGroupOverview:t.resourceGroupOverview}}}))}var f=r.Extension,e=i.Base,o=e.Rpc.Internal,s=window,t=s.fx.environment.links;n.initializeRpc=h;n.getSharedSettings=u})(u||(u={})),u}));define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(t){function pt(){var n=l.getItem(v);
return t.authState=JSON.parse(n),l.removeItem(v),t.authState}function wt(n){t.authState=n}function bt(){t.authState&&l.setItem(v,JSON.stringify(t.authState))}function kt(n){return n.refreshToken?new y(new rt,n):new ut(n)}function dt(n,t,i){return new p(ot.client,n,t,i)}function gt(n,t,i){var r=n&&n.authHeader,u,f;return r?(u=n.expiresInMs||1,f=t+u,function(){var n=o();return n<f?Q(r):(i(a,n),Q.reject(e))}):function(){return Q.reject(e)}}var s=FxImpl,h=s.Extension,r=i.Base,w=r.Net2,c=r.Constants,ft=r.Constants.ExtensionNames.Hubs,b=r.Diagnostics,k=b.Telemetry,et=r.Resources,ot=r.Rpc.Internal,st=r.Utilities,ht=r.Security,ct=s.Security,d=window,l=d.sessionStorage,g=b.createLog(n),lt=et.getAppRelativeUri("/api/DelegationToken"),u=ct.tokenErrors,f="",a=c.Shell,at=u.accessDenied,nt=u.unknown,tt=u.sessionEnded,e=u.credentialsExpired,vt=u.networkError,yt=u.nullToken,o=Date.now,it=h.getWindowId,v=d.fx.environment.bootstrapAuthorizationKey,rt,y,ut,p;t.extractAndClearAuthState=pt;t.updateAuthState=
wt;t.writeAuthState=bt;t.createOAuthTokenProvier=kt;t.createSecurityTokensManager=dt;rt=(function(){function n(){}return n.prototype.getToken=function(n,t,i,r){var f={extensionName:n,resourceName:i,tenant:t,portalAuthorization:r},e=k.start({source:"Services.SecurityTokens",action:"Get",name:n}),u;return w.postJSON({uri:lt,dataType:"json",setAuthorizationHeader:!1},f).catch((function(t){return u="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(n,i,t.jqXHR.status,t.textStatus,t.errorThrown),Q.reject(t.jqXHR)})).finally((function(){k.endTrace(e,!u,u||i)}))},n})();y=(function(){function n(n,t){var r=this._refreshToken=t.refreshToken,i;this._pendingAuthorization=Q.resolve(r);this._client=n;i=this._user=t.user;this._tenant=i&&i.tenantId}return n.prototype.getToken=function(n,t){var i=this;return this._pendingAuthorization.then((function(r){var u=i._client.getToken(n,i._tenant,t||f,r).catch((function(n){var t=s.Azure.buildSimplifiedError(n),i=t.status,u;return u=400<=i&&i<
500?e:i?nt:vt,{portalAuthorization:r,value:{authHeader:null,expiresInMs:0,refreshToken:null,error:u,errorMessage:"code: {0}, statusText: {1}, message: {2}, stack: {3}".format(i,t.statusText,t.message,t.stack||"")}}}));return i._pendingAuthorization=u.then((function(n){return i._refreshToken=n.portalAuthorization||r})),u}))},n.prototype.getRefreshToken=function(){return this._refreshToken},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();t.OAuthTokenProviderImpl=y;ut=(function(){function n(n){this._token=n.oAuthToken;this._user=n.user}return n.prototype.getToken=function(){return Q.resolve({value:this._token,portalAuthorization:""})},n.prototype.getRefreshToken=function(){return""},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();p=(function(){function n(n,t,i,r){this._privilegedExtensionsList={};this._sessionEnded=!1;this._extensionTokenFailures=[];this._hubsWindowId=h.getHubsWindowId();this._tokenProvider=t;this._rpcClient=n;this._sessionEndedHandler=
i;this._tokenFailedHandler=r}return n.prototype.initializeSecurityForShell=function(n){var t=n||{},i=t.oAuthToken,f=t.refreshToken,r=t.createdOn||o(),u=f?this._createShellTokenFunc(i,r):gt(i,r,this._sessionEndedHandler);return this._enableShellTokenAccess(),w.initialize(u),u},n.prototype.registerGetAuthorizationTokenEndpoint=function(n){var t=this;this._privilegedExtensionsList=st.convertArrayToMap(n.filter((function(n){return!n.encryptTokens})).map((function(n){var t=n.cloudName;return it({name:n.name.toLowerCase(),cloudName:t?t.toLowerCase():undefined},{forceCloudName:!0})})),(function(n){return n}));this._enableShellTokenAccess();h.getAuthorizationTokenEndPoint.register(this._rpcClient,null,(function(n,i){var r,u=n.cloudName;return r=i.srcWindowId===t._hubsWindowId?it({name:ft,cloudName:u},{forceCloudName:!0}):i.srcWindowId,t._getSecurityToken(u,r,n.resourceName||f,n.isBackground)}))},n.prototype.getDiagnosticsData=function(){return this._tokenProvider.getDiagnosticsData()},n.prototype._getSecurityToken=
function(n,t,r,u){var s=this;return r&&!this._privilegedExtensionsList[t.toLowerCase()]?Q({error:at}):this._sessionEnded?Q({error:tt}):this._tokenProvider.getToken(t,r,u).then((function(h){var y=s._extensionTokenFailures,p=o(),c=h&&h.value||{},l=c?c.error:yt,d=c.errorMessage,w,v,b,it,k;return!l&&c.authHeader?(i.remove(y,t),{token:{header:c.authHeader,expiresAt:p+c.expiresInMs}}):(w=l===e,(l===tt||w)&&(s._sessionEnded=!0,v=void 0,b=s._shellTokenCache,w||!b?v=p:(it=t===a?r:f,v=b.getTokenExpiresAt(n,it)),s._sessionEndedHandler(t,v||p)),u||(i.pushUnique(y,[t]),s._tokenFailedHandler(y.join(", ")),k="Failed to get token for {0} & {1}. Error:{2}. Message:{3}".format(t,r,l,d),l===nt?g.error(k):g.verbose(k)),{error:l,errorMessage:d})}))},n.prototype._createShellTokenFunc=function(n,i){var u=this,e={},r,s;return n&&(r=n.expiresInMs||1,e[f]={header:n.authHeader,expiresAt:r>0?i+r:-1}),s=this._shellTokenCache=ht.createAuthTokenCache((function(n){return u._getSecurityToken(n.cloudName,a,n?n.resourceName:
f,n.isBackground).then((function(i){var s=(i||{}).token,h;if(!!s&&n.resourceName===f){var r=t.authState||{},c=o(),e=r.oAuthToken||{};e.authHeader=s.header;e.expiresInMs=s.expiresAt-c;h=u._tokenProvider.getRefreshToken();h&&(e.refreshToken=h);r.createdOn=c;r.oAuthToken=e;t.authState=r}return i}))}),e),function(n){return s.getToken(n).then((function(n){return n&&n.header}))}},n.prototype._enableShellTokenAccess=function(){this._privilegedExtensionsList[c.Shell]=c.Shell},n})();t.SecurityTokensManagerImpl=p})(r||(r={})),r}));define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","f","i","u","../Extension/Extension.Definition.Locator"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function w(n){return s||(s=new h(n.desktop,n.rpcClient)),s}var l=f.Locator,e=r.Extension,a=e.CloudName,o=r.ViewModels.ParameterCollectionV3,v=i.Base,y=v.Diagnostics,p=i.Parts.PartSize,c,s,h;t.promiseCleanupDelay=3e4;c=y.createLog(n);t.create=w;h=(function(){function n(n,t){this.provisioningPromisesLookup=
{};this._desktopManager=n;this._registerRpcCallbacks(t)}return n.prototype.processProvisioningRequest=function(n,i){var f=this,h=!0,e="The provisioning request is ",r,o,s;if(!n)throw new Error(e+"null or undefined.");if(r=n.provisioningRefKey,!r)throw new Error(e+"missing the provisioning reference key.");if(!n.provisioningPromise)throw new Error(e+"missing the provisioning promise.");if(n.startboardInfo){if(this.provisioningPromisesLookup[r])throw new Error("A provisioning promise already exists with the same reference key.");this.provisioningPromisesLookup[r]={promise:n.provisioningPromise,wasAcquired:!1,data:u};o=function(n){f.provisioningPromisesLookup[r].data=n};n.provisioningPromise.progress(o).then(o).finally((function(){setTimeout((function(){f.provisioningPromisesLookup[r]&&!f.provisioningPromisesLookup[r].wasAcquired&&f._logWarning("Provisioning operation with ref key '{0}' wasn't aquired by the provisioning part and is now deleted at '{1}'.".format(r,new Date));delete f.provisioningPromisesLookup[
r]}),t.promiseCleanupDelay)}));this._addProvisioningPart(n,i)}else n.provisioningPromise.catch((function(n){var t=n||{};t=n.error||n;throw new Error(t.message||t);})),n.provisioningConfig&&!!n.provisioningConfig.dontDiscardJourney&&(h=!1);return h&&(s=this._desktopManager.getActiveJourney(),s&&this._desktopManager.forceDiscardJourney(s.id)),n.provisioningPromise},n.prototype._addProvisioningPart=function(n,t){var i=n.startboardInfo,r=i.provisioningPart,u=r.extension,f=r.name,e=l.forExtension(u,t).withPartType(f),o={provisioningConfig:n.provisioningConfig,provisioningRefKey:n.provisioningRefKey,startboardPart:i.startboardPart};this._desktopManager.addPartToStartBoard({originPartLocator:e,model:a.addToModel(t,{initialData:o}),initialSize:p.Normal})},n.prototype._registerRpcCallbacks=function(n){var t=this;o.initiateProvisioningRequestEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(i,r){var f,u=r.srcWindowId;return(f=u!==e.getHubsWindowId()?e.getDescriptor(
u).cloudName:i.cloudName,!i.provisionerId)?Q.reject("Cannot initiate the provisioning request. The 'provisionerId' was not specified."):i.provisioningRefKey?(o.getProvisioningRequestEndPoint.acquireObject(n,u,i).then((function(n){var i=n.getValue();t.processProvisioningRequest(i,f).finally((function(){n.dispose()}))}),(function(n){throw new Error(n);})),Q.resolve(i)):Q.reject("Cannot initiate the provisioning request. The 'provisioningRefKey' was not specified.")}});o.getProvisioningOperationEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){if(!n)return Q.reject("Cannot return a provisioning operation. The 'provisioningRefKey' was not specified.");var i=t.provisioningPromisesLookup[n],r=i&&i.promise;return r&&(t.provisioningPromisesLookup[n].wasAcquired=!0),Q.resolve({provisioningPromise:r,data:i&&i.data})}})},n.prototype._logWarning=function(n){c.warning(n)},n})();t.ShellProvisionerImpl=h})(e||(e={})),e}));define("MsPortalImpl/Services/Services.TelemetrySharing",
["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function h(n){return e.registerExtensionUnloadCallback(n),e}var o=r.Extension,u=i.Base,f=u.Constants,t=u.Rpc.Internal,s=(function(){function n(){var n=this;this._extensions={};t.client.registerRpcEndPoint(f.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:function(){n._extensions[t.messageContext.srcWindowId]=!0}})}return n.prototype.registerExtensionUnloadCallback=function(n){var t=this;n.onUnload((function(n){var i=o.getWindowId(n);return t._extensions[i]&&delete t._extensions[i],!0}))},n.prototype.traceBrowserInfo=function(){},n.prototype.trace=function(n){var i=n.extension,r=n.data&&n.data.srcExtension,u=f.TelemetrySharing.TraceTelemetry;this._extensions[i]&&t.client.invokeRpc(u,i,n);i!==r&&this._extensions[r]&&t.client.invokeRpc(u,r,n)},n.prototype.flush=function(){return i.Helpers.Deferred().resolve().promise()},n})(),e=new s;n.getProcessor=h})(u||(u={})),u}));define("MsPortalImpl/Services/Services.Util",
["require","exports","f","i","Fx/Pinner"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function l(n){s.register(t.client,null,a);c.register(t.client,null,(function(t,i){var u=r.Extension.getDescriptor(i.srcWindowId),f=t.options?t.options.notify:!0;return n.pinMultipleParts(t.parts,u.name,u.cloudName,f)}))}function a(n){var t={isBackgroundTask:!1,uri:h};return o.postJSON(t,n).then((function(n){return n.data}))}var f=i.Base.Resources,t=i.Base.Rpc.Internal,e=r.InternalCryptography,o=i.Base.Net2,s=e.getHmacSha256EndPoint,h=f.getAppRelativeUri("api/Utilities/gethmacsha256"),c=u.Internal.pinEndPoint;n.registerEndPoints=l})(f||(f={})),f}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Hubs.Common",["require","exports","f","o"],(function(n,t,i){"use strict";var r;return (function(n){var r=i.ViewModels.Internal.ContainerViewModel,u=ko.observable,f,t;(function(n){n.newNonGroupingList="50px"})(f=n.IconColumnWidth||(n.IconColumnWidth={}));t=(function(n){function t(){n.apply(this,arguments);this.failureMessage=
u()}return __extends(t,n),t.prototype.fail=function(n){this.failureMessage(n)},t})(r);n.BladeContainerViewModel=t})(r||(r={})),r}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",["require","exports","i","../../../Extension/ViewModelManager","./UI.Hubs.Common"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function s(n){var s=t+"All.Part",i,e;r.registerWithState("Browse$BrowseAllBlade$ServicesListPartViewModel",s,(function(t,i){return f.composePartViewModel((function(r){return new t.ServicesListPartViewModel(r,i,n)}),{initialState:i,logArea:s})}));r.registerWithState("Browse$BrowseServiceBladeViewModel",t+"Service.Blade",(function(t,i){var r=new u.BladeContainerViewModel,f=new t.BrowseServiceBladeViewModel(r,i,n);return new o(r,f,i)}));i=t+"Service.Part";r.registerWithState("Browse$BrowseServiceBlade$ServiceItemsListPartViewModel",i,(function(t,r){return f.composePartViewModel((function(i){return new t.ServiceItemsListPartViewModel(i,r,n)}),{logArea:i})}));e=t+
"Service.PinnedPart";r.registerWithState("Browse$BrowseServiceTileViewModel",e,(function(t,i){return f.composePartViewModel((function(r){return new t.BrowseServiceTileViewModel(r,i,n)}),{createHubsInternalCloudNameProperty:!0,logArea:e})}))}var e=i.ViewModels,o=e.CompositionViewModel,f=e.Part,t="./MsPortalImpl/UI/Hubs/ViewModels/UI.Browse";n.registerViewModels=s})(f||(f={})),f}));define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","f","i","o","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.AssetTypes","../Hubs/UI.BrowseManager","./UI.NotificationManager","../../Services/Services.BrowseCuration"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(t){function ct(n,t){var r=(t||"").toLowerCase(),i=n.assetTypeManifest.resourceType;return(t&&i&&i.kinds||[]).first((function(n){return n.name.toLowerCase()===r}))}function b(n,t,i,r){i===k.BrowseResourceGroupBlade&&(i=k.ResourceGroups);var u=y.getWindowId({name:t,cloudName:n},{forceCloudName:!0});return ni.
getAssetTypeOrResourceTypeIdByWindowId(u,i)+(r?"."+r.toLowerCase():"")}function g(n,t,i,r,u){var f=n.extension,e=n.assetTypeManifest.name,o=n.cloudName,s=r.some((function(n){var r=b(o,f,e,t)===n.id;return r&&(n.index=i),r})),h=function(r){var u=et(n,!0,!0);return u.id=b(r,f,e,t),u.cloudName=r,u.index=i,u};u(h(o),t,s)}function lt(n,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||ut.assetPlusKindFormat.format(n.compositeDisplayName.service,t.name))||n.compositeDisplayName.service}function at(n,t){return t&&t.icon||n.icon}function vt(n,t){return t&&t.keywords||n.assetTypeManifest.keywords}function yt(n,t){return rt(n.cloudName,t.cloudName)&&n.extension===t.extension&&n.assetTypeManifest.name===t.assetTypeManifest.name}function ci(n,t){return rt(n.cloudName,t.cloudName)&&n.extensionName===t.extension&&n.assetType===t.assetTypeManifest.name}function li(n,t,i){var o=[],u=[[],["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard",
"Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport",],["Microsoft_Azure_Expert_AzureAdvisor",],["HubsExtension_Dashboard",],],r;if(i&&n.version()<u.length-1){var f=n.favorites,s=f().toLowerCase(),e=a(f());for(r=(n.version()||0)+1;r<u.length;r++)u[r].forEach((function(n){var t=n.toLowerCase();s.indexOf(t)<0&&(r===3?e.unshift(n):e.push(n),o.push(n))}));f(v(e))}t(o);n.version(u.length-1)}function pt(n,t,i,r){var f=n.assetTypeManifest,o=f.browseType===gt.ServiceLink,u=ct(n,t),e=lt(n,u),s=!!w(r,(function(t){return t===n.id}));return{id:n.id,image:at(n,u),isFavorite:ko.observable(!1),isHome:ko.observable(!1),isFilteredOut:ko.observable(!1),isHidden:ko.observable(s),label:ko.observable(e),labelId:ko.observable(e.replace(ot,"")),keywords:vt(n,u),matches:l(),uri:i.assetTypeService.getAssetTypeDeepLink(n,t),opensExternal:o,opensDashboard:f.name===k.Dashboard&&n.extension===c.ExtensionNames.Hubs,cloudName:y.normalizeCloudName(n.cloudName),isPreview:n.isPreview,index:n.index,assetType:
n,kind:t}}function wt(n){var t=[];return n.forEach((function(n){t=i.union(t,(n.associated||[]).map((function(n){return b(n.cloudName||p,n.extensionName,n.assetType,n.kind)})))})),t}function ai(n){return new kt(n)}function bt(n,t){var u=[],i=function(n,t,i,r){u.push(b(n||p,t,i,r))},r;return n.length||(n=[p]),n.forEach((function(n){i(n,c.ExtensionNames.Hubs,k.Dashboard)})),r=fi.defaultFavorites,t?t.forEach((function(n){i(n.cloudName,n.extensionName,n.assetType,n.kind)})):r&&r.forEach((function(n){i(n.cloudName,n.extensionName,n.name)})),u}var nt=i.Base,dt=i.Extension,c=nt.Constants,k=c.AssetNames,gt=dt.BrowseType,y=r.Extension,ni=r.Assets,ti=r.TriggerableLifetimeManager,ii=i.Hubs.Notifications.NotificationStatus,ri=nt.Diagnostics,tt=undefined,ut=f.Favorites,ft=ut.Notification,ui=window,fi=ui.fx.environment,ei=ri.createLog(n),l=ko.observable,d=ko.observableArray,et=nt.Utilities.clone,p=c.DefaultCloudName,a=JSON.parse,v=JSON.stringify,oi=i.isFeatureEnabled("mergedassets"),si="uncurated",ot=/\s+/g,w=
i.find,st=i.remove,it=i.stableSort,rt=y.isEqualCloudName,ht=o.compareAssetTypeForSort,hi={},kt;r.getAssetTypeMappingData=function(){return hi};t.calculateHiddenAssetTypes=wt;t.createFavoritesManager=ai;kt=(function(){function n(n){var t=this;this.categories=d();this.categoriesLookup={};this.showCategories=l(!1);this.possibleFavorites=d();this.possibleFavoritesLookup={};this.favorites=d();this.selectedCloud=l();this._notificationsForItems=l();this._lifetime=new ti;this._extensionToDefaultCategoryMap={};this.remove=function(n){var i=a(t._savedFavorites())||[],r=i.indexOf(n);r!==-1&&(i.splice(r,1),t._savedFavorites(v(i)))};this.add=function(n){var i=a(t._savedFavorites())||[],r=i.indexOf(n);r===-1&&(i.push(n),t._savedFavorites(v(i)))};this.move=function(n){var i=a(t._savedFavorites())||[],r=t.favorites(),u=r[n],f=i.indexOf(u.id);i.splice(n,0,i.splice(f,1)[0]);t._savedFavorites(v(i))};this._services=n}return n.prototype.initialize=function(n,t){var r=this,o=this._savedFavorites=n.favorites,
p=o().length,u=e.getCloudNames(),s,b,f;return p?(i.isFeatureEnabled("skipfavoritesupgrade")||li(n,this._notificationsForItems,p),s=a(o())):(s=bt(u),o(v(s))),b=s.filter((function(n){return t.some((function(t){t.name===c.ExtensionNames.Hubs&&(t={name:t.name,cloudName:u[0]||c.HubsCloudName});var r=y.getWindowId(t,{forceCloudName:!0});return i.startsWith(n,r+"_")}))}))[0],f=[],h.getBrowseCuration().then((function(n){var y,g,s,h,c,a,nt;r._discoveryPolicy=n.discoveryPolicy||0;oi&&(y=n.mergedAssetTypes||[],f=wt(y));n.favorites&&!p&&o(v(bt(u,n.favorites)));var k=function(n,t){var i={id:n,showLabel:l(!0),isFilteredOut:l(!1),isHidden:ko.pureComputed((function(){var n=r.selectedCloud();return!i.possibleFavorites().some((function(t){return rt(t.cloudName,n)&&!t.isHidden()&&!t.isFilteredOut()}))})),label:e.provideCategoryName(n),possibleFavorites:d(),source:t};return i},tt=n.categories||[],t=tt.map((function(n){return k(n.id,n)}));return t&&t.length&&(g=r._uncuratedCategory=k(si),t.push(g)),r.categories(t),r.
possibleFavorites().forEach((function(n){var t=ct(n.assetType,n.kind),r=n.assetType,u=lt(r,t);n.label(u);n.labelId(u.replace(ot,""));n.image=at(r,t);n.keywords=vt(r,t);n.isHidden(n.isHidden()&&!!i.find(f,(function(t){return t===n.id})))})),s={},n.categories.forEach((function(n){n.discoveryExtensions&&n.discoveryExtensions.forEach((function(i){s[i]=w(t,(function(t){return t.id===n.id}))||r._uncuratedCategory}))})),r._extensionToDefaultCategoryMap=s,h=Q.defer(),r._addFavoriteTypes(u,f),c=r._lifetime.createChildLifetime(),r.favorites.subscribeAndRun(c,(function(n){(!b||n.length&&n[0].id===b)&&(h.resolve(),c.dispose())})),a=r._services.browseManager,nt=a.registerAssetTypesUpdateCallback((function(){r._addFavoriteTypes(u,f)})),r._lifetime.registerForDispose((function(){a.unregisterAssetTypesUpdateCallback(nt)})),h.promise})).catch((function(n){ei.warning(n);r._addFavoriteTypes(u,f)}))},n.prototype.loadSettings=function(){var e=this;this.possibleFavorites().forEach((function(n){n.isFavorite(!1);n.isHome(!1)}));var
u=this.possibleFavoritesLookup,n=[],f=a(this._savedFavorites())||[];f.forEach((function(t,i){var r=u[t];r&&(r.isFavorite()||(r.isFavorite(!0),n.push(r)),r.isHome(!i))}));var t=this._notificationsForItems,i=t()||[],r=i.slice(0);i.forEach((function(t){var i=w(n,(function(n){return t===n.id})),u,f;i&&(u=ft.titleFmt.format(i.label()),f=i.assetType.assetTypeManifest||{},s.getNotificationManager().addClientNotification({title:u,description:ft.Description[(f.name||"").toLowerCase()]||u,status:ii.Information,timestamp:new Date,cloudName:p,uri:i.uri}),r.remove(t))}));t(r);this.favorites(n)},n.prototype.dispose=function(){var n=this._lifetime;n&&n.dispose();this._lifetime=null},n.prototype._addFavoriteType=function(n,t,i,r){var u=pt(n,t,this._services,r);i.splice(n.index,0,u);this.possibleFavoritesLookup[u.id]=u},n.prototype._addFavoriteTypeToCategory=function(n,t,i,r,u,f){var e=pt(t,i,this._services,f),o=this.possibleFavoritesLookup[e.id],s;o&&(e.isFavorite=o.isFavorite,e.isHome=o.isHome,s=e.isHidden=
o.isHidden,s(s()||r));u.splice(t.index,0,e)},n.prototype._addFavoriteTypes=function(n,t){var f=this,r=this._services.browseManager.getFilteredAssetTypes()||[],k=this.possibleFavoritesLookup,c=this.possibleFavorites,e=c(),d=c(),o=!1,nt=[],rt=[],l,v,h,ft;r.forEach((function(t){t.cloudName===y.getHubsCloudName()&&(n.forEach((function(n){var i=et(t,!0,!0);i.id=b(n,t.extension,t.assetTypeManifest.name,tt);i.cloudName=n;nt.push(i)})),rt.push(t))}));rt.forEach((function(n){r.remove(n)}));r=r.concat(nt);r.forEach((function(n,i){g(n,tt,i,d,(function(n,i,r){r||(o=!0,f._addFavoriteType(n,i,e,t))}))}));l=[];e.forEach((function(n){w(r,(function(t){return yt(n.assetType,t)}))||l.push(n)}));l.forEach((function(n){o=!0;st(e,n)}));var s={},a={},ut=this.categories();this.showCategories(!!ut.length);v=u.keys(k).slice(0);ut.forEach((function(n){var h=n.possibleFavorites,i=a[n.id]=h(),y=h(),c=n.source,l=c&&c.items||[],u;l&&l.forEach((function(u,h){var c=-1,l,a;r.some((function(n){var t,i,r;return u.cloudName=u.cloudName||p,ci(
u,n)&&(t=n.assetTypeManifest.resourceType,i=(u.kind||"").toLowerCase(),i?(r=(t&&t.kinds||[]).some((function(n){return n.name.toLowerCase()===i})),r&&(c=h,l=n,a=u.kind)):(c=h,l=n)),c>-1}));c>-1&&(a&&g(l,a,e.length,d,(function(n,i,r){r||(o=!0,f._addFavoriteType(n,i,e,t))})),g(l,a,c,y,(function(r,e,o){v.remove(r.id);o||(s[n.id]=n,f._addFavoriteTypeToCategory(n,r,e,!!u.isHidden,i,t))})))}));u=[];i.forEach((function(n){w(r,(function(t){return yt(n.assetType,t)}))||u.push(n)}));u.forEach((function(t){s[n.id]=n;st(i,t)}))}));h=this._uncuratedCategory;h&&(ft=it(v.map((function(n){return k[n]})),(function(n,t){return ht(n.label(),t.label())})),ft.forEach((function(n){var r=n.assetType,u=f._extensionToDefaultCategoryMap[r.extension],i=u||h,c=!u&&f._discoveryPolicy===1,e=i.possibleFavorites,o=e(),l=e();g(r,tt,o.length,l,(function(n,r,u){u||(s[i.id]=i,f._addFavoriteTypeToCategory(h,n,r,c,o,t))}))})));i.forEachKey(s,(function(n,t){var i=t.possibleFavorites,r=a[t.id],u=a[t.id];u&&i(it(r,(function(n,t){return n.index-t.index})
))}));o&&c(it(e,(function(n,t){return ht(n.label(),t.label())})));this.loadSettings()},n})()})(c||(c={})),c}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration",["require","exports","f","../../../Extension/ViewModelManager"],(function(n,t,i,r){"use strict";var u;return (function(n){function f(){r.register("Gallery$CsmCommand",u+"UI.Gallery.CsmCommand",(function(n){return new n.CsmCommand(t.DefaultCloudName)}))}var t=i.Base.Constants,u="./MsPortalImpl/UI/Hubs/ViewModels/";n.registerViewModels=f})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks",["require","exports","i","FxHubs/HubsSettingsSchema"],(function(n,t,i,r){"use strict";var u;return (function(n){function f(n,i){var u=Q.defer(),r={},f={store:t,keys:i};return n.querySettings(f).then((function(n){i.forEach((function(t){r[t]=t in n?n[t]:undefined}));u.resolve(r)})),u.promise}function e(n,i,r){n.setSettings({store:t,settings:i},r)}function o(n){var t=n.settings,i=n.rpcClient,o=[u.getHubsWindowId()];r.readHubsUserSettings.
register(i,o,(function(n){return f(t,n)}));r.writeHubsUserSettings.register(i,o,(function(n){return e(t,n.settings,n.priority),undefined}))}var u=i.Extension,t=6;n.registerRpcCallbacks=o})(u||(u={})),u}));define("MsPortalImpl/UI/UI.NpsHelper",["require","exports","f","../Base/Telemetry"],(function(n,t,i,r){"use strict";var u;return (function(n){function f(r,f,c,l,a){return u||!h&&s&&!n.npsShownInSession?i.require("MsPortalImpl/Widgets/Widgets.Nps").then((function(i){t.Diagnostics.Telemetry.trace({source:o.ToastTray,action:e.NPSShown,data:t.Utilities.extend({productId:c},l)});i.showSurvey(r,f,c,a);n.npsShownInSession=!0})):Q(null)}function l(n,t){var i=t(),r=Date.now()-7776e6,e=i<r&&Math.random()<c;return u||e?f(n,null,null,{surveyLastCompleted:i},(function(){t(Date.now())})):Q(null)}var t=i.Base,e=r.Action,o=r.Source,u=i.isFeatureEnabled("testnps"),s=i.isFeatureEnabled("nps"),h=i.isFeatureEnabled("ci"),c=.01;n.npsShownInSession=!1;n.showNps=f;n.showPortalNps=l})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/UI.ResourceMapManagerRpc",
["require","exports","FxHubs/RpcEndPoints"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i){var e=r.getHubsWindowId(),f=function(n){return r.getDescriptor(n.srcWindowId).cloudName};r.mapAssetIdToResourceIdEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapAssetIdToResourceId(n,f(r))}))}));r.mapResourceIdToAssetIdEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToAssetId(n,f(r))}))}));u.mapResourceIdToAssetIdEndPoint.register(n,[e],(function(n){return i.getService(t).then((function(t){return t.mapResourceIdToAssetId(n.resourceId,n.cloudName)}))}));r.mapResourceIdToDynamicSelectionAndIconEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToDynamicSelectionAndIcon(n.resourceId,f(r),{reason:"mapResourceIdToDynamicSelectionAndIcon",extension:r.srcWindowId})}))}));u.mapResourceIdToDynamicSelectionAndIconEndPoint.register(n,[e],(function(n,r)
{return i.getService(t).then((function(t){return t.mapResourceIdToDynamicSelectionAndIcon(n.resourceId,n.cloudName,{reason:"mapResourceIdToDynamicSelectionAndIcon",extension:r.srcWindowId})}))}));r.getResourceAssetInformationEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceAssetInformation(n,f(r),{reason:"getResourceAssetInformation",extension:r.srcWindowId})}))}));u.getResourceAssetInformationEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceAssetInformation(n.data,n.cloudName,{reason:"getResourceAssetInformationForHubs",extension:r.srcWindowId})}))}));r.getResourceEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResource(n.resourceId,!1,f(r),{reason:n.caller+":getResource",extension:r.srcWindowId})}))}));r.signalResourcesChangedEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return Q(t.signalResourcesChanged(n,f(r)))}))}));u.
signalResourcesChangedEndPoint.register(n,null,(function(n){return i.getService(t).then((function(t){return Q(t.signalResourcesChanged(n.resourceIds,n.cloudName))}))}));u.mapAssetIdToResourceIdEndPoint.register(n,[e],(function(n){return i.getService(t).then((function(t){return t.mapAssetIdToResourceId(n.assetTriplet,n.cloudName)}))}));i.assetManager.onAssetDeleted((function(n,r,u){i.getService(t).then((function(t){t.processAssetDeletion(n,r,u)}))}))}var f=FxImpl,r=f.Extension,u=i.AssetTypes,t="ResourceMapManager";n.setupResourceMapManagerRpc=e})(r||(r={})),r}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports","f","i","../../../Extension/ViewModelManager","./UI.Hubs.Common"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function v(n){var r=u.registerWithState,h,s,v,y;r(c+"ViewModel",t+(i+"Blade"),(function(n,t){var i=new f.BladeContainerViewModel,r=new n.SettingsBladeViewModel(i,t);return new o(i,r,t)}));h=t+(i+"SettingsPart");r(c+"$SettingsPartViewModel",
h,(function(t,i){return e((function(r){return new t.SettingsPartViewModel(r,i,n)}),{createHubsInternalCloudNameProperty:!0,logArea:h})}));r(l+"ViewModel",t+(i+"LanguageSelectionBlade"),(function(n,t){var i=new f.BladeContainerViewModel,r=new n.LanguageSelectionBladeViewModel(i,t);return new o(i,r,t)}));s=t+(i+"LanguageGrid");r(l+"$LanguageGridViewModel",s,(function(n,t){return e((function(i){return new n.LanguageGridViewModel(i,t)}),{logArea:s})}));r(a+"ViewModel",t+(i+"LocaleSelectionBlade"),(function(n,t){var i=new f.BladeContainerViewModel,r=new n.LocaleSelectionBladeViewModel(i,t);return new o(i,r,t)}));v=t+(i+"LocaleGrid");r(a+"$LocaleGridViewModel",v,(function(n,t){return e((function(i){return new n.LocaleGridViewModel(i,t)}),{logArea:s})}));y=t+(i+"DiagnosticsPart");r("Help$HelpAndSupportBlade$DiagnosticsPartViewModel",y,(function(t,i){return e((function(r){return new t.DiagnosticsPartViewModel(r,i,n)}),{logArea:s})}))}var h=r.ViewModels,o=h.CompositionViewModel,e=h.Part.composePartViewModel,t="./MsPortalImpl/UI/Hubs/ViewModels/",
s="Settings$",c=s+"SettingsBlade",l=s+"LanguageSelectionBlade",a=s+"LocaleSelectionBlade",i="UI.Settings.";n.registerViewModels=v})(e||(e={})),e}));define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.SecurityTokens","../Base/Telemetry"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function v(n,t){return(n&t)===t}function et(n,t,i,r,u,f){return new y(n,t,i,r,u,f)}var h=i.Base,p=h.Diagnostics,w=p.Telemetry,tt=i.ViewModels.Dialogs,s=tt.MessageBoxButtons,o=f.Action,b=f.Source,it=window,c=p.createLog(n),k=h.Constants.Shell,d=r.Shell,l=d.Notifications,e=d.Dialogs,a=l.SessionEnding,g=l.TokenFailure,nt=l.VersionChanged,rt=3e4,ut=3,ft=[12e5,6e5],y;t.create=et;y=(function(){function n(n,t,i,r,u,f){this._pageBlockingPrompt=!1;this._isDialogVisible=!1;this._unknownNetworkErrorCount=0;this._unknownNetworkErrorCanceled=!1;this._getDialogManager=n;this._extensionVersionCache=t;this._initializationPromise=i;this.
_redirectFunc=r;this._showSplashScreenFunc=u;this._notify=f}return n.prototype.onLastTokenRefresh=function(n,t){var r=this,i=Date.now();if(t<=i)this.onStatus({code:2},n);ft.forEach((function(n){var u=t-n;it.setTimeout((function(){var t=Math.floor(n/6e4),i=t>10?a.messageFmt.format(t):a.message;r._notify(a.title,i)}),u-i)}))},n.prototype.onStatus=function(n,t){var p=this,r=Q.resolve(null),a,f,y,u,l,v;if(!n||this._pageBlockingPrompt)return r;a=t===k;f=a||t===h.Constants.ExtensionNames.Hubs;switch(n.code){case 0:break;case 1:a||this._extensionVersionCache.expireLatest(t);f?r=this._showDialog(t,o.ShellVersionChanged,e.newVersionMessageTitle,e.newVersionMessageDescription,e.newVersionDefaultButtonText,null,rt,s.OKCancel,5):(w.trace({source:b.Shell,action:o.ExtensionVersionChanged,data:t}),c.warning("Extension reporting incompatible server version. {0}:{1}".format(t,n.message)),this._notify(nt.title,nt.messageFmt.format(t)));break;case 2:y=o.ExtensionSignedOut;f?r=this._showDialog(t,y,e.signedOutTitle,
e.signedOutDescription,e.signedOutDefaultButtonText,null,0,s.OK,7):this._notify(g.title,g.messageFmt.format(t));break;case 4:if(u=n.message,c.verbose("Received a status code zero from extension {0} for URL '{1}'.".format(t,u)),!f)break;if(this._unknownNetworkErrorCount>ut||this._isDialogVisible||this._unknownNetworkErrorCanceled)break;this._unknownNetworkErrorCount++;i.isUriAbsolute(u)||(u="//"+t+"/"+u);l=document.createElement("a");l.href=u;l.innerText=e.connectionErrorMessagePlaceHolder;r=this._showDialog(k,o.UnknownNetworkError,e.connectionErrorMessageTitle,e.connectionErrorMessageDescription.format(l.outerHTML),null,e.connectionErrorCancelButtonText,0,s.OKCancel,0).then((function(n){p._unknownNetworkErrorCanceled=n===1}));break;case 5:r=this._showDialog(t,o.RelexDisconnected,e.relexDisconnectedMessageTitle,e.relexDisconnectedMessageDescription,e.relexDisconnectedDefaultButtonText,null,0,s.OKCancel,1);break;default:v="Received unknown extension event '{0}' for extension '{1}'.".format(
n.code,t);r=Q.reject(v);c.error(v)}return r},n.prototype._showDialog=function(n,t,i,r,f,e,o,s,h){var a=this,y,d=this._redirectFunc,p=v(h,2),c,k,l;return this._pageBlockingPrompt=v(h,1),t&&w.trace({source:b.Shell,action:t,data:n}),p&&u.updateAuthState(null),c=function(n){d({skipFlushBuffers:p,delayPromise:n&&o?Q.delay(o):null})},k=v(h,4)&&Q.isPending(this._initializationPromise),k?(y=Q.defer().promise,c(!1)):(l=Q.defer(),this._isDialogVisible=!0,y=this._getDialogManager().then((function(n){return n.showModalDialog({title:i,description:r,defaultButtonText:f,cancelButtonText:e,buttons:s,uiShield:{hidePromise:l.promise}})})).then((function(n){return a._pageBlockingPrompt?(a._showSplashScreenFunc(),l.resolve(),c(!0)):n===4?c(!1):l.resolve(null),n})).finally((function(){a._isDialogVisible=!1}))),y},n})();t.StatusHandlerImpl=y})(e||(e={})),e}));define("MsPortalImpl/UI/UI.ViewTimeTelemetry",["require","exports","f","../Base/Base.Events","../Base/Telemetry"],(function(n,t,i,r,u){"use strict";var f;return (function(
n){function st(n,i){e=n.desktop;tt=i&&i.increment||b;it=i&&i.tooSmall||k;nt=e.activeJourney.subscribe((function(n){n?c():o(l)}));e.getDashboardManager().then((function(n){p=n.currentDashboardId.subscribe((function(n){c();v=n;o(l)}));v=n.currentDashboardId()}));a(t.blur,d=function(){c()});a(t.focus,g=function(){o(l)});a(t.mousemove,y=function(){h(t.mousemove,y);o()})}function ht(){h(t.blur,d);h(t.focus,g);h(t.mousemove,y);nt.dispose();p&&p.dispose();c()}function o(n){f||e.activeJourney()||(n&&(ut=0,++rt),ft=Date.now(),f=setTimeout((function(){et();f=null;o()}),tt))}function c(){f!==null&&(clearTimeout(f),et());f=null}function et(){var n=Date.now()-ft;n>=it&&ot.trace({source:u.Source.Shell,action:u.Action.DashboardViewTime,data:{target:"Dashboard",trackId:v,timespan:n,sequenceId:rt,sequence:++ut,tileCount:e.startBoard.children.filter((function(n){return!n.dontSetupWidget})).length,fullscreen:!!r.isFullscreen()}})}var w=i.Base,ot=w.Diagnostics.Telemetry,t=w.EventTypes,s=window,l=!0,b=3e5,k=1e4,a=s.
addEventListener.bind(s),h=s.removeEventListener.bind(s),e,v="",y,d,g,nt,p,tt=b,it=k,rt=0,ut=0,f=null,ft;n.start=st;n.stop=ht})(f||(f={})),f}));define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-part-buttonpart-assetname,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart{height:100%;width:100%;box-sizing:border-box}.fxs-part-buttonpart-inner{display:-webkit-flex;display:flex;position:relative;height:100%;box-sizing:border-box;padding-top:28px;text-align:center;-webkit-align-items:center;align-items:center;-webkit-flex-direction:column;flex-direction:column}.fxs-part-buttonpart-iconcontainer{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-family:az_ea_font,wf_segoe-ui_normal,\"Segoe UI\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-size:12px;line-height:18px}.fxs-part-buttonpart-assetname{margin:0;font-family:az_ea_font,wf_segoe-ui_semibold,\"Segoe UI Semibold\",\"Segoe WP Semibold\",\"Segoe UI\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-size:10px;line-height:10px;text-transform:uppercase}.fxs-part-buttonpart-title{margin:10px 0 5px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-mini .fxs-part-buttonpart-title,.fxs-tilesize-small .fxs-part-buttonpart-title{margin:0}.fxs-part-buttonpart-title::after,.fxs-part-buttonpart-title::before,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{position:absolute;background-color:inherit}.fxs-part-buttonpart-title::before{content:'\\02026';top:18px;right:0}.fxs-part-buttonpart-title::after{content:'';height:100%;width:100%}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart-inner,.fxs-tilesize-wide .fxs-part-buttonpart-inner{padding-top:0;text-align:left;-webkit-flex-direction:row;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>svg{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{-webkit-flex:0 1 auto;flex:0 1 auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:center;justify-content:center}.fxs-tilesize-mini{font-family:az_ea_font,wf_segoe-ui_normal,\"Segoe UI\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-size:12px;line-height:normal}.fxs-tilesize-mini .fxs-part-buttonpart-inner{padding-top:5px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:32px;line-height:15px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:16px;right:0}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer{width:calc(100% - 51px)}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:18px;right:0}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{width:calc(100% - 85px)}.fxs-tilesize-wide .fxs-part-buttonpart-title{margin:0}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block;margin-top:10px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:90px}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after,.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{position:absolute;background-color:inherit}.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{content:'\\02026';top:72px;right:0}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after{content:'';height:100%;width:100%}.fxs-part-buttonpart-externallink{position:absolute;top:0;right:0;height:12px;width:12px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}.fxs-tilesize-mini .fxs-part-buttonpart-externallink{top:-5px;right:5px}.fxs-part-buttonpart,.fxs-part-buttonpart .fxs-part-buttonpart-desc,.fxs-part-buttonpart .fxs-part-buttonpart-inner,.fxs-part-buttonpart .fxs-part-buttonpart-textcontainer,.fxs-part-buttonpart .fxs-part-buttonpart-title{background-color:inherit}.fxs-part-buttonpart-adornment{position:absolute;top:0;left:33px;height:14px;width:14px}.fxs-tilesize-mini .fxs-part-buttonpart-adornment{position:absolute;top:0;left:17px;height:10px;width:10px}.fxs-tilesize-small .fxs-part-buttonpart-adornment{position:absolute;top:50% - 30px/2;left:0;height:10px;width:10px}.fxs-tilesize-wide .fxs-part-buttonpart-adornment{position:absolute;top:50% - 50px/2;left:0;height:14px;width:14px}html[lang^=ja] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=ko] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=zh] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title{font-size:11px;line-height:11px}")})
);define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","f","o","../Generated/SvgStartupDefinitions","./Parts","../../_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var r=i.Parts.PartSize,e=u.Content.SvgStartup;n.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-inner'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon'><\/div><!-- ko if: $data.adornmentUri --><img alt='' class='fxs-part-buttonpart-adornment' data-bind='attr: { src: adornmentUri }' /><!-- /ko --><div class='fxs-part-buttonpart-textcontainer'><h4 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' data-bind='text: _displayTitle, css: { \"fxs-should-use-single-line\": _assetNameVisible(),  \"fxs-can-use-multiline\": !_assetNameVisible() }'><\/h4><h5 data-bind='text: _assetName, visible: (_assetNameVisible())' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow fxs-text-title'><\/h5><div data-bind='text: description, visible: ((size() === MsPortalFx.Parts.PartSize.Wide) && description())' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'><\/div><\/div><!-- ko if: _isExternalLink --><div class='fxs-part-buttonpart-externallink azc-fill-heavy'>"+
e.hyperlink.data+"<\/div><!-- /ko --><\/div><\/div>";var o=ko.observable,t=ko.computed,s=(function(u){function f(){u.apply(this,arguments);this.template=n.template}return __extends(f,u),f.prototype._getContentForBinding=function(n,f){var v=this,s=f.content,h=f.container,e=h.clickableLink,c=function(n){return n.target()==="_self"||n.uri&&i.startsWith(n.uri(),"#")&&n.target()==="auto"},l=o(!!e&&!c(e)),y=s.size,a;t(n,(function(){v.ariaLabel(s.title())}));var w=t(n,(function(){var n=y&&y(),i=s.shortTitle(),t=s.title();return n===r.Mini||n===r.Small?i||t:t})),b=t(n,(function(){return!v.inContainerOfSameAsset()&&h.assetName()})),p=e&&e.target;return p&&p.subscribe(n,(function(){l(!c(e))})),a=e&&e.uri,a&&a.subscribe(n,(function(){l(!c(e))})),$.extend({},u.prototype._getContentForBinding.call(this,n,f),{_displayTitle:w,_assetName:h.assetName,_isExternalLink:l,_assetNameVisible:b})},f})(f.PartImpl);n.ButtonPart=s})(e||(e={})),e}));define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["require","exports",
"module"],(function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-part-collectionpart .azc-grid table td.azc-grid-cell:first-of-type,.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart-more-data,.fxs-part-collectionpart-rollup-count{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.fxs-part-collectionpart .azc-grid table thead tr th{height:28px;line-height:28px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td:last-child,.fxs-part-collectionpart .azc-grid table td:last-of-type{padding-right:15px}.fxs-part-collectionpart .azc-grid table .azc-grid-resizableColumn-handle{height:28px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{text-align:right;display:block;font-size:12px;line-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-collectionpart-more-data:hover{text-decoration:underline}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-family:az_ea_font,wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:10px;line-height:10px;text-transform:uppercase;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^=ja] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=ko] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=zh] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}')})
);define("MsPortalImpl/Parts/Parts.Collection",["require","exports","f","o","./Parts","MsPortalImpl/Resources/ImplScriptResources","../../_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var o=i.Parts.PartSize,s=f.Parts,t="fxs-part-collectionpart",h=t+"-rollup-forceshow",c=t+"-rollup-container",l=t+"-rollup-count",a=t+"-rollup-label",r=t+"-rollup-icon",e=t+"-no-rollup-count",v=t+"-part-title",y=t+"-more-data",p='<div class="'+t+'" data-bind="css: {\''+h+"': alwaysShowRollupCount()}\">"+('<div class="'+c+'">')+('<span class="'+l+'" data-bind="text: rollupCount, visible: !noRollupCount()"><\/span>')+('<span class="'+a+'" data-bind="text: rollupCountLabel"><\/span>')+('<img class="'+r+'" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {\''+e+'\': noRollupCount }" alt=""/>')+('<div class="'+r+'" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {\''+e+"': noRollupCount }\"><\/div>")+
('<h4 class="'+v+'" data-bind="text: _partTitle"><\/h4>')+'<\/div><!-- ko if: !!gridMode() --><div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"><\/div>'+('<div class="'+y+' fxs-text-primary" data-bind="visible: hasMoreData">'+s.more+"<\/div>")+"<!-- /ko --><\/div>",w=(function(n){function t(t,i,r,u){n.call(this,t,i,r,u);this.template=p;this._$partTitle=$(t).findByClassName("fxs-part-title")}return __extends(t,n),t.prototype._getContentForBinding=function(n,t){var i=this;return ko.reactor(n,(function(){var n=t.content.size();t.container.partTitle();i._$partTitle.toggle(n!==o.Mini)})),$.extend({},t.content,{_partTitle:t.container.partTitle})},t})(u.PartImpl);n.CollectionPart=w})(e||(e={})),e}));define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports","f","u","o","./UI.Composition.Part","./UI.Composition.PropertyBinding","./UI.Composition.CompositionBinder"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function it(n,t){var
i=n.parent&&n.getPartsContainer(),u=i&&i.getCompatibleSourceReferences&&i.getCompatibleSourceReferences.bind(i),o=function(n){if(u){var t=u(n);return t&&t[0]}},f,r;return t=t||[],f=n.overridesModel,r=[],t.forEach((function(n){var i=n.name,t;t=e.getModelValue(f,i).exists?null:o(n);r.push(h(n,t))})),r}function y(n){if(n.adapter){var i=p(n),t={},r=w(n,!1);return r.forEach((function(n){var r,f=n.compositionBindingDefinition,u=f&&f.source,e;u&&u.modelType===a&&(e=u.property,r=i[e]);r||(r={bindingSources:[],activeBindingSourceName:null});t[n.targetProperty]=r})),t}return p(n)}function rt(n,t,i){function f(f,o){var p,k,l,a;t&&r.turnOnInputsSetSuppressionOn(t);r.turnOnInputsSetSuppressionOn(i);try{var d=f.inputs,w=f.settings,g=f.inputsMetadata,b=n.getSettingsModel(),h=n.partDefinition&&n.partDefinition.partState,nt=h?(h.inputIdentityProperties||[]).concat((h.sharedProperties||[]).map((function(n){return n.property}))):[],tt=u.keys(w);nt.forEach((function(n){var r=v(e.getModelValue(b,n).value),t=n.startsWith(
"content.")?n.slice(8):n,i=s(e.getModelValue(w,t).value);c(i,r)||(e.setModelValue(b,n,i),p=!0);tt.remove(t)}));l=y(n);u.keys(l).forEach((function(t){var i=l[t],r=g[t],u=d[t];ft(n,t,i,r.activeBindingSourceName,u)&&(k=!0)}));k&&(n.widgetState.valueHasMutated(),ut(n),n.save())}finally{return a=(p?2:1)|(o?0:4),Q.all([t&&Q(r.turnOnInputsSetSuppressionOff(t,a,!0))||Q(),Q(r.turnOnInputsSetSuppressionOff(i,a,!0))])}}n.getViewModel().internal.updateConfigFn(f)}function ut(n){var t=n.widget;t&&t.element.trigger(f.fxpartinputchanged,{part:n})}function h(n,t){var r=n,i=n,e=i.targetProperty||r.name,o=!!n.optional,u;return t||(u=i.source&&i.source.property||r.name,t=f.createOverridesOrContainerModelSourceReference(u)),{targetProperty:e,optional:o,source:t,isDynamicBinding:!0}}function p(n){var t=n.parent&&n.getPartsContainer(),i=t&&t.getCompatibleSourceReferences&&t.getCompatibleSourceReferences.bind(t),r=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,s=function(n){var u,t;return r&&
i&&(t=r.first((function(t){return t.name===n})),t&&(u=i(t))),(u||[]).map((function(n){return{sourceReference:n,name:n.property,acceptsValueUpdates:!1}}))},u=n.overridesModel,h=function(n){if(!n||f.isDynamicBindingWithNonLocalSource(n))return!1;var t=n.source&&n.source.property;return u&&t&&e.getModelValue(u,t).exists},o={},c=w(n);return c.forEach((function(n){var r=n.targetProperty,u=s(r),t=n.compositionBindingDefinition,i=t&&t.source,f=!h(t)&&i&&(u||[]).first((function(n){var t=n.sourceReference;return t.modelType===i.modelType&&t.property===i.property}));o[r]={bindingSources:u,activeBindingSourceName:f&&f.name}})),o}function w(n,t){return t===void 0&&(t=!0),n.getNonDetailsContainerPropertyBindings(t).filter((function(n){var t=n.targetProperty;return!nt.isBladeCallerInput(t)&&t!==b.EditScopeId}))}function ft(n,t,i,u,f){var p=u&&i.bindingSources.first((function(n){return n.name===u})),w,o,k,d,ut,ft,b,rt;if(u&&!p){l.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".
format(u,t));return}if(w=n.getInputPropertyBindings(),o=w.properties.first((function(n){return n.targetProperty===t})),p?(ut=i.activeBindingSourceName,p.name!==ut&&(k=!0)):(ft=v(e.getModelValue(o.targetModel,o.targetProperty).value),c(s(f),ft)||(d=!0)),!(k||d))return!1;if(n.adapter){var et=n.bindings.first((function(n){return n.targetProperty===t})),g=et&&et.source,ot=g&&g.modelType===a&&g.property;if(ot)b=ot;else return l.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(n.toString(),t)),!1}else b=t;var nt=n.adapter?n.adapter.inputPropertyBindings:n.getInputPropertyBindings(),it=nt.properties.first((function(n){return n.targetProperty===b})),st=it.compositionBindingDefinition,ht=n.overridesModel,y;if(k){var ct=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,lt=ct.first((function(n){return n.name===b})),at=p.sourceReference;y=h(lt,at)}
return d&&(e.setModelValue(ht,it.sourceProperty,s(f)),y=h(st)),y&&(nt.removeProperty(it),rt=n.adapter?n.adapter.bindings:n.bindings,tt(rt,st),r.setupPropertyBindings(n,nt,[y],n.bindAgainstOverridesOrContainerModel.bind(n)),rt.push(y),n.adapter&&(w.removeProperty(o),r.setupPropertyBindings(n,w,o&&[o.compositionBindingDefinition],n.bindAdaptedInput.bind(n)))),!0}var b=i.Base.Constants.BladeParameterNames,k=i.Base.Diagnostics,d=i.Extension,g=d.ReferenceType,nt=i.ViewModels.Internal,r=o.CompositionBinder,tt=i.remove,c=i.deepEquals,l=k.createLog(n),a=g.AdapterInput,v=ko.unwrap,s=ko.toJS;t.inferInitialBindingsForInputDefinitions=it;t.getConfigurableInputsMetadata=y;t.listenForConfigurationChanges=rt})(s||(s={})),s}));define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","f","i","o","../../ViewModels/ViewModels.BladeCaller"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function c(n,t,i){var r={};ko.reactor(n,(function(){var f=t.internal,e=
f.registeredSelectables()||{},n=f.registeredSelectableOptions,s=u.keys(e),h=u.keys(r),c=s.filter((function(n){return!r.hasOwnProperty(n)})),w=h.filter((function(n){return!e.hasOwnProperty(n)})),o;ko.ignoreDependencies((function(){c.forEach((function(t){o=l(t,n);var f=v(t,n),u=a(t,n);y(t,r,i,o,f,u.openInContextPane,u.persistentContextPane)}));w.forEach((function(n){p(n,r)}))}))}))}function l(n,t){var i=t&&t.peek(),r=i&&i[n];return r&&r.parameterCollector?"{0}.{1}.parameterCollector".format(h,n):null}function a(n,t){var r=t&&t.peek(),i=r&&r[n],u,f;return i&&(u=i.openInContextPane,f=i.persistentContextPane),{openInContextPane:u,persistentContextPane:f}}function v(n,t){var r=t&&t.peek(),u=r&&r[n],i;if(u)return i=u.bladePairOptions,i?{actionName:n,shouldHideMasterBlade:!i.showParent,canNavigateMaster:!1,windowed:!i.fullScreen}:null}function y(n,i,r,u,o,h,c){var p=r.getBladeOpener(),w=r.getPartSettingsManager(),l={invocationInputArguments:[{valuesFrom:[{referenceType:t.Part,property:s+"."+n}]}]},a,y,v;
o&&$.extend(l,{pairInfo:o});h&&(l.openInContextPane=h);c&&(l.persistentContextPane=c);a=new e;u&&f.addBladeCallerBindings(u+".bladeCaller",l,t.Part);y=p.registerInvocationProperty(l,null,a);v=y.viewStatePropertyAdditions;v&&v.forEach((function(n){w.registerInstanceStateProperty(a,n)}));i[n]=a}function p(n,t){t[n].dispose();delete t[n]}var e=r.TriggerableLifetimeManager,o=i.Extension,t=o.ReferenceType,s="internal.registeredSelectables",h="internal.registeredSelectableOptions";n.listenForRegistrationChanges=c})(e||(e={})),e}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-formdialog,.fxs-formdialog h2{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.fxs-formdialog{font-size:14px;border:1px solid}.fxs-formdialog h2{font-size:110%}.fxs-formdialog .fxs-formdialog-description{margin-top:-10px}.fxs-formdialog .fxs-formdialog-form{margin:20px 0 0;padding:15px 25px;width:448px}.fxs-formdialog .fxs-formdialog-buttons{margin-left:25px}.fxs-formdialog .fxs-formdialog-buttons>button{margin-right:5px;margin-bottom:25px}.fxs-formdialog-header{border-bottom:1px solid;margin:0 25px;padding-bottom:10px}')})
);define("MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog",["require","exports","f","o","MsPortalImpl.Controls/Fields/Base/FormValidation","../../Interactions/Interactions.DismissHandler","../../Interactions/Interactions.KeyboardNavigation","../Widgets.WidgetBase","../Widgets.Common","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){var c=i.ViewModels.Controls.Forms.Button.ViewModel,p=i.ViewModels.Forms.Section,r=p.ViewModel,l=i.newGuid,a="fxs-formdialog",v="fxs-popup",w="<div class='fxs-formdialog-header fxs-br-default'><h2 data-bind='text: data.dialogOptions.title'><\/h2><div class='fxs-formdialog-description' data-bind='text: data.dialogOptions.description'><\/div><\/div><div class='fxs-formdialog-form msportalfx-form' data-bind='pcControl: func._formSection'><\/div><div class='fxs-formdialog-buttons'><button class='fxs-button-primary fxs-formdialog-okbutton' data-bind='text: data.okButtonText, pcButton: func._okButton'><\/button><button class='fxs-button-default fxs-formdialog-cancelbutton' data-bind='text: data.cancelButtonText, pcButton: func._cancelButton'><\/button><\/div>",
t=ko.observable,h=ko.observableArray,b=(function(n){function i(){n.apply(this,arguments);this.okButtonText=t();this.cancelButtonText=t();this.onOkClick=$.noop;this.onCancelClick=$.noop}return __extends(i,n),i})(o.ViewModel),y;n.ViewModel=b;y=(function(n){function i(t,i){var r=this,u;if(n.call(this,t,i),this._dismissHandle={dismissFn:function(){r._cancelButton&&r.options.onCancelClick()},shouldDismissOnMouseDownFn:$.noop,shouldDismissOnMouseWheelFn:$.noop,restoreFocus:function(){var n=r._previouslyFocusedElement;f.validatePreviousFocusedElement(r._dismissHandle,n)&&n.focus()},logName:"formdialog"},!i.dialogOptions)throw new Error("dialogOptions must be specified for rendering a form dialog.");t.addClass(a).addClass(v).html(w);this._previouslyFocusedElement=document.activeElement;u=new e.KeyboardNavigation(t,e.TabTrigger.TabKeys);f.register(this._dismissHandle);this.lifetimeManager.registerForDispose((function(){u.dispose();f.unregister(r._dismissHandle)}));this._initializeViewModels();this._bindDescendants(
);this._setAria();this.setFocus()}return __extends(i,n),i.prototype.setFocus=function(){var n=this.element;s.waitForBindings(n[0]).then((function(){var t=n.find("input"),i;i=t.length===0?n.findByClassName("fxs-formdialog-okbutton")[0]:t[0];i.focus()}))},i.prototype.dispose=function(){this._cleanElement(a,v);n.prototype.dispose.call(this)},i.prototype._setAria=function(){var t="aria-labelledby",i="aria-describedby",n=this.element,r=l(),u=l();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName("fxs-formdialog-description").attr({id:r,role:"document",tabindex:this.options.dialogOptions.description()?0:-1});this.lifetimeManager.registerForDispose((function(){n.removeAttr(["role",t,i].join(" "))}))},i.prototype._initializeViewModels=function(){var d=this,n=this.lifetimeManager,a=this.options,i=a.dialogOptions,v=3,f=0,e=new r(n,{style:t(v),children:h()}),o=new r(n,{style:t(v),children:h()}),y,p,w,b,s,k,l;i.row1column1&&(y=new r(n,{style:t(f),children:h([i.
row1column1])}),e.children.push(y));i.row1column2&&(p=new r(n,{style:t(f),children:h([i.row1column2])}),e.children.push(p));i.row2column1&&(w=new r(n,{style:t(f),children:h([i.row2column1])}),o.children.push(w));i.row2column2&&(b=new r(n,{style:t(f),children:h([i.row2column2])}),o.children.push(b));s=this._formSection=new r(n,{children:h()});e.children().length&&s.children.push(e);o.children().length&&s.children.push(o);k=this._cancelButton=new c(n);k.click=function(){a.onCancelClick()};l=this._okButton=new c(n);l.isDefault(!0);l.click=function(){u.ensureFormFieldValidation(d.element,!0).then((function(n){n&&a.onOkClick()}))};ko.computed(n,(function(){var n=s.valid();l.disabled(!n)}))},i})(o.Widget);n.Widget=y})(h||(h={})),h}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-listpopup{display:inline-block;cursor:default;position:absolute;left:0;width:200px;max-height:300px;z-index:200;overflow-y:auto;box-sizing:border-box}.fxs-listpopup .fxs-listpopup-list{list-style-type:none;margin:10px;padding:0;max-height:300px}.fxs-listpopup .fxs-listpopup-list .fxs-listpopup-item{padding:3px 0 5px;height:22px;max-height:22px;line-height:22px;margin:0;cursor:pointer;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-listpopup .fxs-listpopup-list .fxs-listpopup-item.fxs-listpopup-item-selected{padding-right:10px;padding-left:7px;border-left-width:3px;border-left-style:solid}")})
);define("MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup",["require","exports","f","o","../../Interactions/Interactions.DismissHandler","../../Interactions/Interactions.KeyboardNavigation","../../Base/Base.KeyboardHelper","../Widgets.WidgetBase","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){var c=i.Base.Diagnostics,r="fxs-listpopup",l=c.createLog(n),s="fxs-popup",a="<ul class='fxs-listpopup-list' data-bind='foreach: func._items'><li role='menuitem' class='fxs-listpopup-item fxs-has-hover' data-bind='text: text, css: { \"fxs-listpopup-item-selected fxs-is-selected fxs-br-primary\": text === $root.data.dialogOptions.selectedItem() }, event: { click: onClick, keydown: onKeyDown }, attr: { title: text }' tabindex='0'><\/li><\/ul>",v=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(o.ViewModel),h;t.ViewModel=v;h=(function(n){function t(t,i){var o=this,h;n.call(this,t,i);i.dialogOptions||
l.error("dialogOptions must be specified for rendering a list popup.");this._previouslyFocusedElement=document.activeElement;this._items=ko.computed(this.lifetimeManager,(function(){var t=i.dialogOptions.listItems(),n=function(n){typeof i.onItemSelected=="function"&&(i.dialogOptions.selectedItem(n),i.onItemSelected(),o._dismissHandle.restoreFocus())};return t.map((function(t){return{text:t,onClick:function(i,r){r.stopPropagation();n(t)},onKeyDown:function(i,r){r.keyCode===13&&e.getModifierKeys(r)===0&&(r.stopPropagation(),n(t))}}}))}));h=function(n){var t=o.element[0];return!(t===n)&&!$.contains(t,n)};this._dismissHandle={dismissFn:function(){o.options.onLostFocus&&o.options.onLostFocus()},shouldDismissOnMouseDownFn:h,shouldDismissOnMouseWheelFn:h,restoreFocus:function(){u.validatePreviousFocusedElement(o._dismissHandle,o._previouslyFocusedElement)&&o._previouslyFocusedElement.focus()},logName:"listpopup"};this._keyboardNavigation=new f.KeyboardNavigation(t);u.register(this._dismissHandle);
t.addClass([r,s].join(" ")).html(a);this._bindDescendants();t.findFirstTabbable().focus()}return __extends(t,n),t.prototype.dispose=function(){u.unregister(this._dismissHandle);this._cleanElement(r,s);this._keyboardNavigation&&(this._keyboardNavigation.dispose(),this._keyboardNavigation=null);this.element.removeAttr("tabindex");n.prototype.dispose.call(this)},t})(o.Widget);t.Widget=h})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-progressbox{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;color:#fff}')}));define("MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox",["require","exports","o","MsPortalImpl/Resources/ImplScriptResources","../Widgets.WidgetBase","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css"],(function(n,t,i,r,u){"use strict";
var f;return (function(n){var s=r.Dialogs.ProgressBar,i="fxs-progressbox",h="<h2 data-bind='text: data.title' class='fxs-progressbox-title'><\/h2><div data-bind='text: data.text' class='fxs-progressbox-text'><\/div><div data-bind='text: data.completionText' class='fxs-progressbox-progressbar'><\/div>",f="fxs-popup",t=ko.observable,e=ko.isObservable,c=(function(n){function i(i,r){var u=this;n.call(this);this.title=t();this.text=t();this.completionPercentage=t(-1);e(i)&&(this.text=i);e(r)&&(this.completionPercentage=r);this.completionText=ko.computed((function(){var n=u.completionPercentage();return n<0||n>100?"":s.percentComplete.format(n)}))}return __extends(i,n),i})(u.ViewModel),o;n.ViewModel=c;o=(function(n){function t(t,r){n.call(this,t,r);this.element.html(h).addClass(i).addClass(f);this._bindDescendants()}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(i,f);n.prototype.dispose.call(this)},t})(u.Widget);n.Widget=o})(f||(f={})),f}));define("MsPortalImpl/UI/UI.DialogManager",
["require","exports","f","o","../Widgets/Dialogs/Widgets.FormDialog","../Widgets/Dialogs/Widgets.ListPopup","../Widgets/Dialogs/Widgets.ProgressBox","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Compositions/UI.Composition","../Widgets/Widgets.WidgetBase","../Widgets/Dialogs/Widgets.MessageBox"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a;return (function(t){function a(n){return wt.format(n)}function bt(n){return w||(w=new et(n)),w}function kt(){w=null}function ft(n,t){var r=i.getUniqueId();return n.replaceAll(t,r).replaceAll("msportalfx-svg-c01",t).replaceAll(r,"msportalfx-svg-c01")}function dt(n,t,i){var r=new l.ViewModel;return r.title(t.title),r.text(t.text),r.buttons(t.buttons),r.onButtonClick=function(t){n(t)},r.modal=i,r.defaultButtonText=t.defaultButtonText,r.cancelButtonText=t.cancelButtonText,r.confirmationRequired=t.confirmationRequired,r.confirmationMessage=t.confirmationMessage,r}function gt(n,t){var i=new e.ViewModel(t.text,t.completionPercentage);return i.
title(t.title),i}function ni(n,t){var i=new u.ViewModel;return i.dialogOptions=t,i.okButtonText(g.okButtonText),i.cancelButtonText(g.cancelButtonText),i.onOkClick=function(){n(4)},i.onCancelClick=function(){n(1)},i}function ti(n,t){var i=new f.ViewModel;return i.dialogOptions=t,i.onItemSelected=function(){n(4)},i}function ot(n){var t=n.closest(".fxs-tile").data(h.CompositionInstanceDataName),i;return t&&h.isPartComposition(t)?i=t.locator:at.error("Unable to determine the extension that opened the dialog. "+ct.getCurrentCallStack(!0)),i}function st(n){var r=n.closest(".fxs-bladecontent"),t=c.Widget.getWidgets(r),i;return t&&t.length&&(i=t[0],n=p(i.getForm())),n}function ht(n){d.trace({source:it,name:n&&n.toFriendlyString(),action:rt.DialogOpened,extension:n&&n.getExtensionLocator().name})}function v(n,t){d.trace({source:it,name:n&&n.toFriendlyString(),action:rt.DialogClosed,extension:n&&n.getExtensionLocator().name,data:t+""})}var y=i.Base,k=y.Diagnostics,d=k.Telemetry,ct=y.Utilities,g=
i.Resources.Strings.Dialogs,lt=i.ViewModels.Dialogs,nt=o.Content.SvgStartup,p=jQuery,b=p("body"),at=k.createLog(n),vt="<div class='fxs-portal-shield'><div class='fxs-portal-shield-icon fxs-portal-shield-icon-on-topbar'><\/div><div class='fxs-portal-shield-modaldialog'><div/><\/div><\/div>",tt=40,yt="fxs-portal-shield-icon-warning",pt="fxs-portal-shield-icon-error",wt="The {0} used to render the dialog was not specified.",it=s.Source.Shell,rt=s.Action,w,ut=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(lt.MessageBox),et;t.MessageBox=ut;t.getOrCreate=bt;t.dispose=kt;et=(function(){function n(n){this._portalIdleSvc=n}return r.defineProperty(n.prototype,"hasOpenDialog",{get:function(){return!!this._dismissOpenDialog},enumerable:!0,configurable:!0}),n.prototype.dismissOpenDialog=function(){this._dismissOpenDialog&&(this._dismissOpenDialog(),this._dismissOpenDialog=null)},n.prototype.showModalDialog=function(n){var e=this,t=p(vt),i,c,o,u,s,r,h,l,f;return b.append(t),
i=t.findByClassName("fxs-portal-shield-icon"),c=t.findByClassName("fxs-portal-shield-modaldialog"),n.showErrorIcon?(o=ft(nt.error.data,"msportalfx-svg-c22"),u=pt):(o=ft(nt.warning.data,"msportalfx-svg-c10"),u=yt),i.html(o),i.addClass(u),s=b.findByClassName("fxs-topbar-content").width(),r=b.findByClassName("fxs-topbar-notifications").position(),s&&r&&(h=s-(r.left+tt),i.css({top:r.top,right:h}),c.css({top:r.top+tt,right:h})),this._currentCancelToken&&(this._currentCancelToken.cancel(),this._currentCancelToken=null),l=t.find(".fxs-portal-shield-modaldialog > div"),f=new ut(n.title,n.description,n.buttons),f.defaultButtonText=n.defaultButtonText,f.cancelButtonText=n.cancelButtonText,t.show(),this._portalIdleSvc.signalIdle(),this._showDialog(l,f,!0,null).then((function(r){var f=n.uiShield&&n.uiShield.hidePromise;return f?(e._currentCancelToken=new y.Promises.CancelationToken,y.Promises.wrapWithCancelablePromise(f,e._currentCancelToken).then((function(){t.hide()}))):t.hide(),i.removeClass(u),r})
).finally((function(){e._portalIdleSvc.signalBusy()}))},n.prototype.showDialog=function(n,t,i){return n?t?(this.dismissOpenDialog(),this._showDialog(n,t,!1,i)):Q.reject(a("options")):Q.reject(a("element"))},n.prototype.showDialogWithCallback=function(n,t,i,r){if(!n)throw new Error(a("element"));if(!t)throw new Error(a("options"));this.dismissOpenDialog();this._showDialogWithCallback(n,t,!1,i,r)},n.prototype.showShellDialog=function(n,t,r){var u=this;return t?r?n?(this.dismissOpenDialog(),i.require("MsPortalImpl.Controls/Controls/Balloon").then((function(i){var f=u._showDialog(p(t.getForm()),n,!0,null).then((function(n){return t.hideForm(),n})),e=i.getBox(r);return t.showForm(e),f}))):Q.reject(a("options")):Q.reject(a("sourceTarget")):Q.reject(a("formTarget"))},n.prototype._showDialog=function(n,t,i,r){var e=this,u=Q.defer(),o=function(n){u.resolve(n)},f;return r||i||(r=ot(n)),t.type!==4&&(n=st(n)),f=this._getWidget(n,t,i,o),ht(r),f?(this._dismissOpenDialog=function(){f.dispose();u.reject();v(
r,"Dismissed")},u.promise.then((function(n){f.dispose();e._dismissOpenDialog=null;v(r,n)}))):(v(r,"InvalidDialogType"),u.reject("Invalid type specified in dialogOptions.")),u.promise},n.prototype._showDialogWithCallback=function(n,t,i,r,u){var o=this,f,e;u||i||(u=ot(n));t.type!==4&&(n=st(n));e=function(n){f&&f.dispose();o._dismissOpenDialog=null;v(u,n);r&&r(n)};f=this._getWidget(n,t,i,e);ht(u);f?this._dismissOpenDialog=function(){f.dispose();v(u,"Dismissed")}:v(u,"InvalidDialogType")},n.prototype._getWidget=function(n,t,i,r){var h=this,o,s;switch(t.type){case 1:o=new l.Widget(n,dt(r,t,i));break;case 2:o=new e.Widget(n,gt(null,t));break;case 4:s=ti(r,t);s.onLostFocus=function(){h.dismissOpenDialog()};o=new f.Widget(n,s);break;case 3:o=new u.Widget(n,ni(r,t))}return o},n})()})(a||(a={})),a}));define("MsPortalImpl/UI/UI.Initialize",["require","exports","f","i","a","../Base/Base.KnockoutExtensions.FxParameterCollector","../Base/Base.ImplUtils","../Base/ClaimsIdentity","../CodeComponentSideLoad/CodeComponentSideLoadModels",
"../Controls/ControlBindings.Async","../Base/Base.GenericPopup","../Extension/DefinitionPreprocessor","../Extension/Extension","../Extension/ExtensionMetadataSource","Fx/Feedback","../GalleryPackage/GalleryPackageLoader","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.DismissHandler","../Interactions/Interactions.KeyboardShortcutHandler","../Base/Languages","../../MsPortalImpl.Controls/Controls/ResourceFilterHelper","../Services/Services.AssetTypes","../Services/Services.AzureStorage","../Services/Services.BrowseCuration","../Services/Services.Controller","../Services/Services.FileUploadEndpointRegistration","../Services/Services.FileUploadInitialization","../Services/Services.GalleryEndpoints","../Services/Services.GeneralSettings","../Services/Services.FavoritesSettings","../Services/Services.PortalIdentity","../Services/Services.PortalTips","../Services/Services.SharedSettings","../Services/Services.Storage","../Services/Services.PortalIdleState","../Services/Services.SecurityTokens",
"../Services/Services.SelectedSubscriptions","../Services/Services.Settings","../Services/Services.ShellProvisioner","../Services/Services.TelemetrySharing","../Services/Services.Util","../Base/Telemetry","./Hubs/UI.BrowseManager","./Hubs/ViewModels/UI.Browse.ViewModelRegistration","../UI/Compositions/UI.Composition","./Compositions/UI.Composition.Services","./Hubs/UI.FavoritesManager","./Hubs/ViewModels/UI.Gallery.ViewModelRegistration","./Hubs/UI.HubsRpcCallbacks","./UI.NpsHelper","./Hubs/UI.ResourceMapManagerRpc","./Hubs/ViewModels/UI.Settings.ViewModelRegistration","./UI.StatusHandler","./UI.ViewTimeTelemetry","../Extension/ViewModelManager","../Widgets/Widgets.Portal","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding",
"MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi){"use strict";var yi;return (function(t){function ur(n,t){t&&t.startsWith("#")&&n.route(t)}function le(n,t,i){return[n,t].forEach((function(n){var t=n.length;if(t!==1)throw new Error("Unexpected length '"+n.selector+"': "+t);})),new uf(n,t,i)}function ct(n,t,i){hr({source:n,action:t,data:i})}function ae(n){try{n()}catch(t){}}function ve(){return pi("./UI.Portal.Actions",n)}function hu(n,t){return Q(
).then(t).catch((function(n){yr.error(n)})).then((function(){return n.getCodeComponentsMetadata()}))}function ye(n){var e,o;if(n&&er&&er.getEntriesByType&&er.timing){var u=ki(),i=function(n,t,i){ff(n,{duration:t,endTime:Math.round(i+er.timing.navigationStart)})},f=er.getEntriesByType("resource").filter((function(n){var t=n.initiatorType;return t==="link"||t==="script"})),r=f.reduce((function(n,t){return Math.min(t.startTime,n)}),Infinity),t=f.reduce((function(n,t){return Math.max(t.responseEnd,n)}),0),s=t-r,h=t;return r=Math.max(r,n),t=Math.min(t,u),e=t-r,o=u-e-n,i("TotalTimeToSplashScreen",n,n),i("TotalStartupResourceDownload",s,h),i("StartupResourceDownload",e,t),i("StartupScriptExecution",o,u),pr.traceResourceDownloads(f),o}}function ff(n,t){t=t||{};var r=t.duration||ki(),i=t.data||{};return i.cdn="CdnIndex"+gr.index,i.bundling="Bundling"+gr.bundling,hr({timestamp:t.endTime,source:nr,action:n,actionModifier:sr.ActionModifier.Complete,duration:r,data:i}),r}function pe(n,t){var i=n.getValue(tf,
nf,dr);return t!==i&&n.setValue(tf,nf,t,dr),i}function we(){ai.registerPrefix(l.PinVMPrefix,"./MsPortalImpl/Extension/PinBladeInferred",(function(n,t,i,r){return n.createViewModel(t,i,r)}))}var cr=r,ef=cr.Data,cu=cr.Extension,of=cr.TriggerableLifetimeManager,fr=i.Base,tu=fr.Constants,sf=tu.ExtensionNames,iu=fr.Diagnostics,sr=iu.Telemetry,gi=fr.EventTypes,pr=r.NetDiagnostics,hf=fr.Resources,cf=fr.Rpc.Internal,lf=i.Hubs.Notifications,ru=lf.NotificationStatus,af=cr.Hubs.Notifications,vf=i.Services,lu=i.ViewModels,yf=lu.Dialogs,pf=yf.MessageBoxButtons,wf=lu.ParameterCollection.Internal,uu=tu.DefaultCloudName,au=fr.Net2,u=gt.Action,lr=gt.Source,bf=i.Helpers,tr=MsPortalImpl.Performance,wr=fr.UriBuilder,ir=window,er=ir.performance,vu=ir.fx,ki=vu.getTimestamp,hr=sr.trace,fu=cf.client,nr=lr.Shell,yi=vu.environment,kf=yi.chrome,or=yi.links,di=lr.TopBar,pi=i.require,ar="/",yu="Enabled",pu="false",rr="true",wu="<div/>",df=i.ensureSuffix,gf=i.pathJoin,br="MsPortalImpl/Widgets/Widgets.",kr=df(hf.getAppRelativeUri(
ar),ar),vr=jQuery,bu=ir.console,wi=ir.location,bi=yi.features,eu=w.Shell,ne=w.Controls.FileUpload,yr=iu.createLog(n),te=kr+"SignOut",ie=kr+"signin/index",re=yi.errorPageUri,ue=yi.isDevelopmentMode,fe=bi.hideavatartenant===rr,ee=bi.consoletelemetry==="true",ku=bi.showbugreportlink,oe=at.ComponentName.Relex,du=w.UiSettings.RelexToggleOption,se=bi.ldnstrace===rr,gu=bi.notificationspane===rr,nf="loadedPageVersion",tf=at.ComponentName.Telemetry,dr=0,gr=yi.cdn,he=i.forEachKey,ou=ko.observable,ce=ko.observableArray,rf=ht.getSignedInUser,su=bi.waitforpendingchanges===rr,nu,uf;au.setAjaxLogFunc(yr.warning.bind(yr));t.routeIfHash=ur;t.create=le;uf=(function(){function t(n,t,i){this._lifetime=new of;this._disposed=!1;this._dependencies=i;this._element=n;this._$splashScreen=t;this._idleSvc=vt.createInstance()}return t.prototype.initialize=function(){var r=this,l=this._lifetime,br=this._$splashScreen,eu=i.memoize((function(){return ri.getDialogManagerModule().then((function(n){return n.getOrCreate(r._idleSvc)})
)})),lu=function(n,t){return r._redirect({uri:n,skipFlushBuffers:t})},ai=this._dependencies,gt=ai.settings,fr=ai.extensionManager,cr=ai.storageService,ge=new wr(wi.href),vt=yt.extractAndClearAuthState(),bf,df=function(n,t,i){var r=new wr(n+wi.search+(i||"")),u=gr.forceIndex,f=r.query;u&&f.setParameter(gr.indexParameter,u);t&&he(t,(function(n,t){return f.setParameter(n,t)}));lu(r.toString())},vu,wu,yf,uf,ke,de;if(l.registerForDispose(eu),!vt){df(kr,{reAuth:rr},wi.hash);return}vu=!1;vt.createdOn||(vt.createdOn=Date.now(),vu=!0);vt.hash&&(wi.hash=vt.hash,vt.hash="",vu=!0);vu&&yt.updateAuthState(vt);yi.enableAnimations||vr.enableAnimations(!1);wu=this._idleSvc;sr.initialize(nr,!0);ot.init(gt);st.init(gt);pt.init(gt);var gf=wt.queryStores(gt,[8,4,7]),ne=yi.pageVersion,le=pe(cr,ne),rt={defaultRoute:!1,splashScreen:tr.splashScreenLoadTime,initializeStart:ki(),cdnFailedIndex:ai.cdnFailedIndex,loadedSameVersion:ne===le,previousVersion:le||""},of=ot.processor.initialized.then((function(c){function co(
n,t){ct(di,t);ur(pt,n)}function fo(n){return o.getAvatarImage(kt.avatarUri,kt.defaultAvatarUri,cr,n)}function ce(){return he.currentTheme().name}var ke=d.initialize(l,cr,c.rawLocale),kt,li,ro,au,vu,ut,ho,ci,nf,ef,ot,uo,of,vf,et,pt,wf,sr,ne,ee,gr,v,he,tu,le,ye,wt,pe,eo,oo;ke&&(su=!1,lu(ke,!0));rt.initializeGeneralSettings=ki();var no=d.currentLocaleContext,to=no.selectedDisplayLanguage,so=no.selectedFormatCulture;ct(nr,u.PortalInitializeLanguage,{language:to,formatCulture:so||to});ht.initialize(vt.user);kt=rf();li=kt.tenantId;ae((function(){bu.log(yi.version);bu.log("Session: "+yi.sessionId)}));ro=ht.getTenants();au=ou(!1);b.initialize();l.registerForDispose((function(){b.dispose()}));vu=new vi.ViewModel;ut=new vi.Widget(r._element,vu);l.registerForDispose((function(){r._element.css("display","none");ir.setTimeout((function(){ut.dispose()}),100)}));t=ri.initialize(l,ai,c,au,ut,lu,eu);h.initialize(t);ho=t.assetManager.assetMruList;ci=t.desktop;vu.sideBar.goToDashboard=function(n){return ut.showStartBoard(
),ci.getDashboardManager().then((function(t){var i=t.currentDashboardId();return t.switchDashboard({id:i,title:i},n||"SideBar")}))};g.initialize(t.assetTypeService,l);nf=Q(ht.getSubscriptions());nf.then((function(n){cf(n);au((n&&n.subscriptions||[]).some((function(n){return n.requireRdfe})))})).done();r._notificationManager=t.notificationManager;cu.extensionStatusEndPoint.register(fu,null,(function(n,t){n&&be(n,t.srcWindowId)}));ef=ut.options;ot=ef.topBar;i.isFeatureEnabled("azureconsole")&&(ot.getConsoleViewModel=function(){return pi("MsPortalImpl/Widgets/Widgets.Console").then((function(n){return new n.ViewModel({src:yi.consoleUri,getAuthToken:bf})}))});ot.exitDevMode=function(){br.show();MsPortalImpl.Extension.unregisterAll().then((function(){lu(kr)}))};uo="72f988bf-86f1-41af-91ab-2d7cd011db47";of=li===uo;ot.canReportBug(ku==="force"||ku===rr&&of);ot.reportBug=function(){ve().then((function(n){return pi("MsPortalImpl/Base/Base.DiagnosticsPopup").then((function(i){return n.reportBug(t,(function(){return yf(
i)}),ge)}))}))};vf=ui.createFavoritesManager(t);et=ef.sideBar;et.attachFavoritesManager(vf);pt=t.router;et.launchBlade=function(n){pt.route(n)};wf=!1;sr=hu(hf,(function(){return hf.registerTestExtensionsFromUri(wi.href)}));s.canModifyExtensions&&(sr=sr.then((function(n){return pi("MsPortalImpl/Extension/ExtensionPatch").then((function(n){var i=n.initializeTestPatch([],t,br);return hu(i,(function(){return i.registerTestPatchesFromUri(wi.href).then((function(){return i.listTestPatches().then((function(n){n=n||[];a.patchUris=n.map((function(n){return n.uri}));wf=!!n.length}))}))}))})).then((function(){return n}))})));rt.preGetExtensionMetadata=ki();ee=sr.then((function(n){rt.getExtensionMetadata=ki();ne=st.processor.initialized.then((function(t){rt.favoritesManagerInitialized=ki();var i=t.favorites(),r=i&&JSON.parse(i);return ct(lr.SideBar,"SideBarSettings",{collapsed:c.sideBarCollapsedKey(),favorites:r,favoritesCount:r.length}),vf.initialize(t,n)}));nt.setCloudNames(n.filter((function(n){return n.name!==sf.Hubs})
).map((function(n){return n.cloudName})).unique());nt.getCloudNames().length===0&&nt.setCloudNames([uu]);et.cloudOptions(nt.getCloudNames().map((function(n){var t=cu.normalizeCloudName(n);return{text:ou(t),value:t}})));fr.initialize({extensions:n,useCachedManifests:!0,onRelexDisconnected:io});tf.registerGetAuthorizationTokenEndpoint(n);ht.initializeRpc(n);lt.initializeRpc();it.initializeRpc();tt.registerSasEndPoint();dt.registerEndPoints(t.desktop);fr.on("assetTypes").then((function(){rt.allAssetTypesLoaded=ki();et.allAssetTypesLoaded(!0)}));var i=function(t){var i=n.some((function(n){return n.isTestExtension||n.isTestStamp}));return ot.inDevMode(i||t||wf),ci.initialize(n,gf,rt)};return s.canAddGalleryPackages?pi("MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource").then((function(n){var i=n.initializeTestGalleryPackage([],t,br);return hu(i,(function(){return i.registerTestGalleryPackagesFromUri(wi.href)}))})).then((function(n){var t=p.initialize(fr);return t.loadGalleryPackages(n),n&&n.length>
0})).then((function(n){return rt.galleryPackagesSideload=ki(),i(n)})):i(!1)})).then((function(){rt.desktopAndExtensionManagerInitialize=ki();var n=pt.initialRoute((function(){return rt.defaultRoute=!0,i.isFeatureEnabled("userdefineddefaultview")?ne.then((function(){if(!et.openFavorite(0))throw new Error("Couldn't open first favorite.");})):et.goToDashboard()}));if(i.isFeatureEnabled("skipwaitonrouter"))return n})).then((function(){var t,u;rt.setupInitialRoute=ki();br.hide();tr.pageLoaded();t=new wr(wi.href);rt.locationHash=t.fragment;rt.hiddenTime=tr.getHiddenTime();u={data:vr.extend(rt,pr.traceDocumentNavigation())};fr.getHubsExtension().then((function(){nu=ff("TotalTimeToPortalReady",u);var t=1;!i.isFeatureEnabled("ci")&&i.isFeatureEnabled("userdefineddefaultview")&&c.whatsNewVersion()<t&&pi("../Services/Services.PortalTips",n).then((function(n){n.setup(l,ne,t)}))}));r._idleHandle=wu.addCallbacks({onIdle:function(){var n=ir.navigator;n&&n.onLine!==!1&&(v.avatarImage(fo(!0)),bi.prefetch!==pu&&pi("MsPortalImpl/Services/Services.PortalPrefetch",
null,!0).then((function(n){n.start(l,wu,cr,nu)})),yi.useCachedManifests&&fr.refreshManifests().catch((function(){})),se&&pi("ldns",null,!0));wu.removeCallbacks(r._idleHandle)},onBusy:i.noop})}),(function(n){r._redirect({uri:re+"/LoadFailed?stack="+encodeURIComponent(n&&n.stack).substr(0,1e3)})}));gf.then((function(n){var t="userDefaultDirectory",i=n[7],r=i&&i[t];r!==li&&gt.setSetting(7,t,li)}));ee.then((function(){var n,i,u,t,f;if(r._notificationManager.listenForClientNotifications(),ft.init(gt),bi.internalonly===pu||bi.canmodifyextensions||of||(n=yi.trustedParentOrigin,i=n.replace(/^([^\/]+\/\/).+\.([^\.]+\.[^\.]+\.[^\.]+)$/,"$1$2"),n!==i&&(u=w.Portal,r._notificationManager.addClientNotification({status:ru.Information,title:u.preview,description:u.unsupportedEnvironment.format(n),uri:i,timestamp:new Date,cloudName:null,uriAction:af.ClientNotificationUriAction.OpenInCurrentTab}))),t=er&&er.timing,t&&!cr.getValue(oe,yu,dr)&&bi.showrelexdialog===rr)return f=t.requestStart-t.fetchStart,(de>400||nu>
7e3)&&f<300?eu().then((function(n){var t=w.EnableRelexDialog;return n.showModalDialog({title:t.title,description:t.description,buttons:pf.YesNo})})).then((function(n){var t=n===6?du.enable:du.disable;cr.setValue(at.ComponentName.Relex,yu,t,dr);n===6&&ir.location.reload()})):void 0}));nt.setupAssetTypeServiceRpc(t);si.setupResourceMapManagerRpc(fu,t);bt.create(t);iu.ErrorReporter.initialize((function(){yr.debug(ci.getDiagnosticsData())}));f.initialize(ci,t);gr=gu?ut.getToastVM():ut.getNotificationMenuWidget().getToastVM();r._initializeTopBar(ut,t,nf,gr,et.selectedCloud);y.Internal.showNpsEndpoint.register(t.rpcClient,null,(function(n,t){oi.showNps(gr,n.productDisplayName,(t.srcWindowId||"")+"_"+n.productId)}));y.Internal.canShowNpsEndpoint.register(t.rpcClient,null,(function(){return!oi.npsShownInSession}));oi.showPortalNps(gr,c.npsTimeMs);v=ot.avatarMenu;v.userIdentity(kt);v.hideTenant(fe);ht.getUserInfo().then((function(n){v.userInfo(n)}));ro.done((function(n){lf(n);v.listOfTenants(n)}));v.showDiagnostics=
uf;v.signedOut=function(){yt.updateAuthState(null);lu(te)};v.openAccountPortal=function(){var n=or.accountPortal;co(n.startsWith("#")?n:n+"subscriptions",u.AvatarMenuOpenBilling)};v.avatarImage(fo());he=t.themeManager;ct(nr,u.SelectedTheme,ce());ut.element.on(gi.fxrotatetheme,(function(){var t=ce(),n;he.rotateTheme();n=ce();ct(nr,u.RotateTheme,{fromTheme:t,toTheme:n})}));return et.saveCollapseState=function(n){c.sideBarCollapsedKey(n)},v.giveFeedback=function(){ct(di,u.AvatarMenuOpenFeedback);ur(pt,or.giveFeedback)},v.showMyAccessBlade=function(){ct(di,u.AvatarMenuOpenAccessDetails);ur(pt,or.accessDetails)},v.switchedTenant=function(n,t){var i=e.getHashQueryStringSegment(wi.href);df(ie+ar+"@"+t.tenant.domainName,null,"#"+i)},tu=i.memoize((function(){return pi("../Base/Base.DebugInfo",n).then((function(n){return n.initialize(l,t)}))})),!i.isFeatureEnabled("ci")&&(ue||yi.clientOptimizations&&yi.clientOptimizations!==rr||bi.canmodifyextensions)&&tu().then((function(n){return n.startErrorDetection(
l)})),l.registerForDispose(tu),le=kf.hideShortcuts?null:k.setup(ut,t,uf,(function(){tu().then((function(n){return n.toggleStickys(nu)}))})),l.registerForDispose(le),r._initializeHelpMenu(ut,pt,uf,le,t.contextPane),!bi.nodirectory||v.dropMenu.isMenuOpen(!0),ye="data-click-telemetry",wt=ut.element[0],wt.addEventListener(gi.mousedown,oo=function(n){pe=n.target},!0),wt.addEventListener(gi.mouseup,eo=function(n){var i=pe,r,t;if(pe=null,n.target===i&&(r=vr(i),t=r.closest("["+ye+"]",wt),t.length)){var o=t.attr(ye)+"",f=t.closest(".fxs-tile",wt).data(ii.CompositionInstanceDataName),e=f&&f.locator,s=e&&e.toFriendlyString()||nr;hr({source:s,action:u.CustomClick,name:o})}},!0),l.registerForDispose((function(){wt.removeEventListener(gi.mousedown,oo,!0);wt.removeEventListener(gi.mouseup,eo,!0)})),t.browseManager.initialize(),ti.registerViewModels(t),fi.registerViewModels(),hi.registerViewModels({portalServices:t,securityTokensManager:tf,subscriptions:cf,tenants:lf}),ei.registerRpcCallbacks(t),we(),ni.subscribeToMruItems(
t),ni.registerRpcEndpoints(t),ee})),nf=ci.create(eu,ai.extensionVersionCache,of,(function(n){r._redirect(n)}),(function(){br.show()}),(function(n,t){r._notificationManager.addClientNotification({title:n,description:t,status:ru.Information,timestamp:new Date,correlationIds:[i.newGuid()],asset:null,cloudName:uu})})),no=function(n,t){return nf.onLastTokenRefresh(n,t)},to=function(n){nf.onStatus({code:2},n)},io=function(){nf.onStatus({code:5},tu.Shell)},be=function(n,t){nf.onStatus(n,t)},tf=yt.createSecurityTokensManager(yt.createOAuthTokenProvier(vt),no,to),hf=v.initializeTestExtension(ai.extensionsMetadata.map((function(n){return s.ExtensionMetadataExt.create(n)})),gt,cr,eu,br),t,cf=ou(),lf=ce();return new et.GalleryEndpointsService(fu,fr,hf),yf=function(n){return n.getDiagnosticsData(t,cf,lf,tf)},uf=function(){c.showPopup({provideText:function(){return pi("MsPortalImpl/Base/Base.DiagnosticsPopup").then((function(n){return yf(n)})).then((function(n){return JSON.stringify(n,null,2)}))}})},ef.registerTelemetrySubmissionHandler(
),pr.registerTelemetrySubmissionHandler(),wf.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),au.status.subscribe((function(n){be(n,nr)})),sr.addProcessor(kt.getProcessor(fr)),ee&&(ke=vf.getConsoleTelemetryEventProcessor(),sr.addProcessor(ke)),MsPortalEarly.initializedTelemetry(hr.bind(sr)),de=ye(tr.splashScreenLoadTime),of.then((function(){li.start(t)})).then((function(){function i(n){yr.warning("Injecting {0}blockable untrusted content : {1} from {2}".format(n.blockable?"":"un",n.tag,n.src));ct(nr,"UntrustedSource",n)}function t(t){var r=t.src,s=t.tag,u=r!=="document.write",f,e,o;return u&&s==="SCRIPT"&&(f=document.createElement("a"),f.href=r,r=f.href,e=/(.*?)[#\?]|$/.exec(r)[1]||r,o=!!n.filter((function(n){return!!~e.indexOf(n||null)})).length,u=!r||o||!!i(t)&&!1),u}var n=tr.allowList=tr.allowList.concat(yi.cdnPrefixes);n.push(wi.host);n.push("about:blank");tr.sourceLogger=t;tr.sourceBacklog.forEach(t)})),l.registerForDispose(li.stop),bf=tf.initializeSecurityForShell(vt),ut.registerFileUploadEndpoints(
),ft.uploadSettingsManager=gt,of},t.prototype.dispose=function(){var n,t;this._disposed=!0;n=this._idleSvc;n&&(n.dispose(),this._idleSvc=null);cr.GlobalStateManager.resetGlobalState();t=this._lifetime;t&&(t.dispose(),this._lifetime=null);pr.resetTelemetryTimer();yt.writeAuthState()},t.prototype.beforeUnload=function(){var u=this,n=[],t,r,i;return su&&(t=rt.flush(this._dependencies.settings),r=t.isPending(),t.then((function(){var n=u._notificationManager;n&&n.addClientNotification({title:eu.customizationsSavedLabel,description:eu.customizationsSavedDescription,status:ru.Success,timestamp:new Date,cloudName:uu})})),r&&n.push(eu.waitForPendingChangesMessage)),i=ft.hasFileUploads,i&&i()&&n.push(ne.unloadInfo),n.length?n.join("\n\n"):void 0},t.prototype._redirect=function(n){var t=n.uri,r=bf.Deferred(),i;this._$splashScreen.show();hr({source:nr,action:u.PortalRedirect,actionModifier:gt.ActionModifier.Redirect,data:t});i=function(){su=!1;r.resolve()};n.skipFlushBuffers?i():(rt.flush(this._dependencies.
settings).finally(i),ir.setTimeout(i,5e3));Q.allSettled([n.delayPromise,r]).finally((function(){if(!t){var n=new wr(wi.href);n.path=gf(ar,n.path,rf().tenantId,ar);t=n.toString()}wi.href=t}))},t.prototype._initializeHelpMenu=function(n,t,r,f,e){var s=n.getHelpMenuWidget(),o=s.options,h=i.memoize((function(){return pi(br+"KeyboardShortcutsPane").then((function(n){return n.create(e,f)}))}));o.openKeyboardShortcutsPane=function(){h().then((function(n){ct(di,u.HelpMenuOpenKeyboardShortcuts);n.toggle()}))};o.openHelpAndSupport=function(){ct(di,u.HelpBladeOpen);ur(t,or.helpAndSupport)};o.openSupportRequestBlade=function(){ct(di,u.HelpMenuOpenSupportRequest);ur(t,or.createSupportRequest)};o.openManageSupportRequestsBlade=function(){ct(di,u.HelpMenuOpenManageSupportRequest);ur(t,or.manageSupportRequests)};s.options.openPrivacyAndTerms=function(){ct(di,u.HelpMenuOpenLegal);ur(t,or.privacyAndTerms)};o.showDiagnostics=function(){r()}},t.prototype._initializeTopBar=function(n,t,r,f,e){var g=this,s=this._lifetime,
v=this._notificationManager,y=i.memoize((function(){return pi(br+"SettingsPane").then((function(n){var i=new n.ViewModel;return new n.Widget(vr(wu),i,t,r)}))})),h,o,a,d;s.registerForDispose(y);var c=n.getTopBarWidget(),l=n.getSearchWidget(),p=n.getSideBarWidget();c.element.on(gi.fxsettingsbuttonclick,(function(){y().then((function(n){ct(lr.TopBar,u.SettingsPaneOpen);n.toggleSettingsContextPane()}))}));h=c.options;h.feedbackButtonClick=function(){t.getService("FeedbackPane").then((function(n){var t=n.widget;ct(di,u.FeedbackSmileyClicked,{isPaneOpen:t.isVisible()});t.toggle()}))};var w=h.breadCrumb,b=h.journeysMenu,k=function(n){return pi(br+"SharedOptionsInit").then((function(t){n(t)}))};if(l.initOptions((function(){return k((function(n){n.initSearchWidgetOptions(s,l,t,e)}))})),p.initOptions((function(){return k((function(n){n.initSideBarWidgetOptions(s,p,t)}))})),o=t.desktop,b.activateJourney=function(n){ct(di,u.JourneyActivated,undefined,n);o.activateJourney(n)},w.clicksEventsHandlers.push((function(n,t){
o.activeJourney().goToBlade(t.bladeId)})),b.discardJourney=function(n){ct(di,u.JourneyDiscarded,undefined,n);o.tryDiscardJourney(n)},o.populateJourneysInJourneysMenu(),ko.computed(s,(function(){var n=o.activeJourney();l.options.journeysShown(!!n);w.breadCrumbs(n?n.getBreadCrumbs():[])})).extend({throttle:100}),gu)pi(br+"NotificationsPane").then((function(n){var i=new n.ViewModel,r=new n.Widget(vr(wu),i,t,f);c.element.on(gi.fxnotificationsbuttonclick,(function(){hr({source:lr.TopBar,action:u.NotificationMenuOpen});r.toggleNotificationsContextPane()}))}));else{a=n.getNotificationMenuWidget();a.register(v.notifications);a.element.on(gi.fxnotificationclickinmenu,(function(n,t){v.handleNotificationClick(t)}))}d={events:gi.fxtoastclick,handler:function(n,t){g._notificationManager.handleNotificationClick(t)}};f.eventHandlers.push(d)},t})()})(yi||(yi={})),yi}));define("MsPortalImpl/Init",["require","exports","f","o","./Base/Base.Router","./Extension/ExtensionManager","./Extension/Extension.Manifest","./Services/Services.PortalIdentity",
"./Services/Services.EditScopeManagement","./Services/Services.Settings","./Base/Telemetry","./UI/UI.Initialize","./Services/Services.Storage","../_generated/Less/MsPortalImpl/Base/Base.Images.css","../_generated/Less/MsPortalImpl/Widgets/HighContrastMode.css","../_generated/Less/MsPortalImpl/Themes/Themes.Universal.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var v;return (function(){function ot(n){var i={fx:t.version};n||d.getInitializedExtensions().forEach((function(n){i[n.name]=n.extension.getVersion()}));vt.custom("Session",kt,dt++,gt,i)}var y=i.Base,ct=y.Diagnostics,lt=y.Rpc.Internal,at=y.UriBuilder,nt=a.ComponentName,v=window,t=v.fx.environment,vt=ct.createLog(n),tt=t.cdn,yt=nt.Cdn,it=nt.Redirect,b=1,rt=i.ensureSuffix,pt=i.pathJoin,p="/",ut=new y.UriBuilder(v.location.href),k=ut.query,wt="flight.",bt=i.union(["pageVersion",tt.indexParameter,t.localeQueryStringParameterName]),ft,w,c,et;k.removeParameters(bt);ft=r.keys(k.getParameters()).filter((function(n){return i.startsWith(
n,wt)}));k.removeParameters(ft);u.history_replaceState(null,v.document.title,ut.toString());w=jQuery;c=a.create();tt.enabled||(et=c.clearValue(yt,"FailedIndex",b));c.clearValue(it,"IdpRedirectCount",b);t.extensionUnloadTimeout>=6e4&&t.extensionUnloadTimeout<=6e5&&(lt.timeToDelayWindowUnload=t.extensionUnloadTimeout);var kt=1,dt=0,gt=c.clearValue(it,"Referrers",b)||"";ot(!0);v.setInterval(ot,36e5);var st=new e.ExtensionVersionCache(c),d=f.create(st),ht=h.createUserSettingsManager(c),g=l.create(w("#web-container"),w("body").find("> .fxs-splashscreen"),{storageService:c,settings:ht,extensionManager:d,extensionVersionCache:st,editScopeManager:s.createEditScopeManager(d),extensionsMetadata:t.extensionsMetadata,hubsMetadata:t.hubsMetadata,openWindow:function(n){var t=v.open();return Q(n).then((function(n){if(n){var r=new at(n),f=r.path,u=rt(f,p);i.localeCompareIgnoreCase(u,rt(location.protocol+"//"+location.host,p))||(r.path=pt(p,u,o.getSignedInUser().tenantId,p),n=r.toString())}t.location.href=
n}))},cdnFailedIndex:et});g.initialize();w(v).on("beforeunload",(function(){return g.beforeUnload()})).on("unload",(function(){ht.dispose();g.dispose()}))})(v||(v={})),v}))