FxImpl.setupRequire({bundles:{"***0MsPortalImpl/Init":["Fx/Feedback","FxHubs/CloudNameCommon","FxHubs/HubsSettingsSchema","FxHubs/MarketplaceRpc","FxHubs/Permissions","FxHubs/ResourceProvider","FxHubs/RpcEndPoints"],"**0MsPortalImpl/Init":["Viva.Controls/Util/Viva.Util.Private","Viva.Controls/Util/Viva.Util","_generated/Less/MsPortalImpl.Controls/Controls/Base.css","Viva.Controls/Controls/Base/Viva.Image","Viva.Controls/Controls/Base/Viva.KnockoutExtensions","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.CssSelectorParser","MsPortalImpl/Base/Telemetry","_generated/Less/MsPortalImpl/Themes/Themes.Reset.css","_generated/Less/MsPortalImpl/Themes/Themes.Blue.css","_generated/Less/MsPortalImpl/Themes/Themes.LightMode.css","MsPortalImpl/Base/Themes","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.KnockoutBindingSanitizer","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding",
"MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl.Controls/Controls/Base/OptionsBase","MsPortalImpl.Controls/Controls/Base/Loadable","MsPortalImpl/Base/JQueryHelper","_generated/Less/Viva.Controls/Controls/Base/Viva.Base.css","Viva.Controls/Controls/Base/Viva.Base","Viva.Controls/Util/Viva.Positioning","_generated/Less/Viva.Controls/Controls/Viva.Balloon.css","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","Viva.Controls/Controls/Viva.Balloon","MsPortalImpl.Controls/Controls/Balloon","MsPortalImpl/Base/Base.LruMap","MsPortalImpl.Controls/Controls/Base/WidgetBindingHandler","Viva.Controls/Util/Viva.DateUtil","MsPortalImpl/Base/Base.KeyboardHelper","Viva.Controls/Controls/Base/Viva.Validators","Viva.Controls/Controls/Base/Viva.EditableControl","Viva.Controls/Controls/Base/Viva.ValidatableControl","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Generated/SvgStartupDefinitions",
"MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Widgets/Widgets.Common","_generated/Less/Viva.Controls/Controls/Forms/Viva.Button.css","Viva.Controls/Controls/Base/Viva.ValueUpdateTrigger","Viva.Controls/Controls/Base/Viva.TypableControl","_generated/Less/Viva.Controls/Controls/Forms/Viva.TextBox.css","Viva.Controls/Controls/Forms/Viva.TextBox","MsPortalImpl/Base/Base.Selectable2.ClickContext","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/UI/Compositions/UI.Composition.Pipeline","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.Events","MsPortalImpl/Services/Services.PortalIdentity","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Extension/AddCloudName","MsPortalImpl/ViewModels/ViewModels.BladeCaller","MsPortalImpl/Extension/DefinitionPreprocessor",
"MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.BreadCrumb.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css",
"_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Base/Base.Router","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Base/Languages","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.SettingsProcessor","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/UI/Compositions/UI.Composition.CloudName","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/Commands/FileDownloadUtil","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Commands/UI.ExtensionCommands",
"MsPortalImpl/Widgets/Widgets.CommandBarBase","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","_generated/Templates/WidgetsContextMenu","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/Interactions/Interactions.FocusHandler","_generated/Templates/PartError","_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css","MsPortalImpl/Widgets/Widgets.PartError","_generated/Templates/Part","_generated/Less/MsPortalImpl/Parts/Parts.Part.css","_generated/Less/MsPortalImpl/CustomPart.css","_generated/Less/MsPortalImpl/CustomForm.css","MsPortalImpl/Parts/Parts","MsPortalImpl/Interactions/Interactions.RightClick","_generated/Templates/WidgetsTileActionBar","MsPortalImpl/Widgets/Widgets.TileActionBar","_generated/Templates/WidgetsTile","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/UI/Commands/UI.ShellCommands",
"MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/Parts/Parts.Error","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","_generated/Templates/WidgetsDropMenu","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.FlowLayout"],"*0MsPortalImpl/Init":["MsPortalImpl.Controls/Controls/ResourceFilterHelper","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Base/Base.GenericPopup","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Controls/ControlBindings.Async","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Controls/ControlBindings","_generated/Less/MsPortalImpl/Widgets/CopyField.css","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand","MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector",
"MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/ClaimsIdentity","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.Permissions","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter","_generated/Templates/WidgetsStartboard","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Dashboard/DashboardRepository","MsPortalImpl/UI/Dashboard/ArmDashboardRepository","MsPortalImpl/UI/Dashboard/DashboardCompressor","MsPortalImpl/UI/Dashboard/PrivateDashboardRepository","MsPortalImpl/UI/Dashboard/DashboardClient","MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository","_generated/Templates/WidgetsAvatarMenu","_generated/Templates/WidgetsAvatarMenuButton",
"MsPortalImpl/Widgets/Widgets.AvatarMenu","MsPortalImpl/Widgets/Widgets.BreadCrumbViewModel","_generated/Templates/WidgetsBreadCrumb","_generated/Templates/WidgetsBreadCrumbOverFlow","MsPortalImpl/Widgets/Widgets.BreadCrumb","_generated/Templates/WidgetsTopBar","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/UI/Dashboard/DashboardManager","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop","_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css","MsPortalImpl/UI/UI.DesktopModeManager","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager","MsPortalImpl/Services/Services.FileUploadInitialization","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/_generated/Common/Relex.Channel","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/ExtensionManager",
"MsPortalImpl/Extension/ExtensionMetadataSource","MsPortalImpl/GalleryPackage/GalleryPackageLoader","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css","MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Services/Services.AzureStorage","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Services.Controller","MsPortalImpl/Services/Services.FileUploadEndpointRegistration","MsPortalImpl/Services/Services.GalleryEndpoints","MsPortalImpl/Services/Services.FavoritesSettings","_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/Services/Services.PortalTips","MsPortalImpl/Services/Services.SharedSettings","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.ShellProvisioner","MsPortalImpl/Services/Services.TelemetrySharing","MsPortalImpl/Services/Services.Util","MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",
"MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration","MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks","MsPortalImpl/UI/UI.NpsHelper","MsPortalImpl/UI/Hubs/UI.ResourceMapManagerRpc","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration","MsPortalImpl/UI/UI.StatusHandler","MsPortalImpl/UI/UI.ViewTimeTelemetry","MsPortalImpl/Interactions/Interactions.ContextMenuTouch","MsPortalImpl/Widgets/Widgets.ContextPane","_generated/Templates/WidgetsNotificationMenu","_generated/Templates/WidgetsNotificationMenuButton","MsPortalImpl/Widgets/Widgets.ToastViewModel","_generated/Templates/WidgetsToast","MsPortalImpl/Widgets/Widgets.Toast","MsPortalImpl/Widgets/Widgets.NotificationMenu","_generated/Templates/WidgetsPanorama","MsPortalImpl/Widgets/Widgets.Panorama","_generated/Templates/WidgetsSearch","MsPortalImpl/Widgets/Widgets.Search","_generated/Templates/WidgetsSideBar","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.Portal",
"_generated/Templates/WidgetsHelpMenu","_generated/Templates/WidgetsHelpMenuButton","MsPortalImpl/Widgets/Widgets.HelpMenu","_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css","MsPortalImpl/Parts/Parts.Intrinsics","_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css","MsPortalImpl/Parts/Parts.ButtonPart","_generated/Less/MsPortalImpl/Parts/Parts.Collection.css","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration","_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css","MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog","_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css","MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup","_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css","MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox","MsPortalImpl/UI/UI.DialogManager",
"MsPortalImpl/UI/UI.Initialize","_generated/Less/MsPortalImpl/Base/Base.Images.css","_generated/Less/MsPortalImpl/Themes/Themes.Universal.css","MsPortalImpl/Init"],"**1MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2":["Viva.Controls/Util/Viva.TemplateEngine","MsPortalImpl/Base/Base.Timers","_generated/Less/Viva.Controls/Util/Viva.Resize.css","Viva.Controls/Util/Viva.Resize","MsPortalImpl/UI/Commands/UI.Commands.Base","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ActionHandler","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ExtensibleControl","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Base","MsPortalImpl/Base/Base.FeatureDetection"],"*1MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2":["MsPortalImpl.Controls/Controls/Controls.ContextMenuHelpers","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Focus","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Formatters","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Selection",
"_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Formatters.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Base","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Plugins","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Impl","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.ContextMenu.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.ContextMenu","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Scrolling.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Scrolling","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Focus.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Focus","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Selection.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Selection","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Sorting.css",
"MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Sorting","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Resizing.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Resizing","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2"],"**3MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1":["Viva.Controls/Controls/Base/Viva.ExtensibleControl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters.Helpers","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Formatters.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.PercentFormatter.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.FocusableRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow","_generated/Less/Viva.Controls/Controls/Forms/Viva.CheckBox.css","Viva.Controls/Controls/Forms/Viva.CheckBox",
"MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid1.Formatters.css","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Formatter","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SelectableRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.EditableRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.EditableRow","MsPortalImpl.Controls/Controls/Base/Formatters","_generated/Less/Viva.Controls/Controls/Viva.DockedBalloon.css","Viva.Controls/Controls/Viva.DockedBalloon","Viva.Controls/Controls/Forms/Viva.Button","MsPortalImpl.Controls/Fields/Base/LabelAndBalloonWidget","_generated/Less/Viva.Controls/Controls/Base/Viva.ValidationPlacements.css","Viva.Controls/Controls/Base/ValidationPlacements/Viva.Base","Viva.Controls/Controls/Base/ValidationPlacements/Viva.Css","Viva.Controls/Controls/Base/ValidationPlacements/Viva.DockedBalloon",
"MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SelectableRowActivate.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRowActivate","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.SelectableRow","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.RightClickableRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.RightClickableRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ContextMenuShortcut.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ContextMenuShortcut","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ContextMenuShortcut","MsPortalImpl/Controls/Helpers/Validation","_generated/Less/MsPortalImpl.Controls/Fields/Fields.css","MsPortalImpl.Controls/Fields/Base/Field","MsPortalImpl.Controls/Fields/TextField","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.EditableRow","_generated/Less/Viva.Controls/Controls/Forms/Viva.SearchBox.css","Viva.Controls/Controls/Forms/Viva.SearchBox","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Filterable.css",
"Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Filterable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Filterable","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRowHover","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRowHover","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FormatterHtmlBindings","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Groupable.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Groupable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Groupable","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Hierarchical.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Hierarchical","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Hierarchical","_generated/Less/Viva.Controls/Controls/Viva.Pager.css","Viva.Controls/Controls/Viva.Pager","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Pageable.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Pageable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Pageable",
"_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ReorderRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ReorderRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ReorderRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ResizableColumn.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ResizableColumn","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ResizableColumn","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Scrollable.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Scrollable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Scrollable","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SortableColumn.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SortableColumn","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.SortableColumn","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1"],"**MsPortalImpl/Generated/SvgDefinitions":["MsPortalImpl/Generated/SvgDefinitions"],"*_generated/Templates/WidgetsPortal":["_generated/Templates/WidgetsPortal"],
"*_generated/Templates/SplashScreen":["_generated/Templates/SplashScreen"],"*_generated/Templates/AttachmentControlIcon":["_generated/Templates/AttachmentControlIcon"],"*_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css":["_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Light.css":["_generated/Less/MsPortalImpl/Themes/Themes.Light.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.HighContrastMode.css":["_generated/Less/MsPortalImpl/Themes/Themes.HighContrastMode.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.DarkMode.css":["_generated/Less/MsPortalImpl/Themes/Themes.DarkMode.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Dark.css":["_generated/Less/MsPortalImpl/Themes/Themes.Dark.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Azure.css":["_generated/Less/MsPortalImpl/Themes/Themes.Azure.css"],"*_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Reordering.css":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Reordering.css"],
"*_generated/Less/CoBrand/Site.css":["_generated/Less/CoBrand/Site.css"],"*_generated/Less/CoBrand/rtl/Site.css":["_generated/Less/CoBrand/rtl/Site.css"],"*_generated/Content/Scripts/_oss/monaco-editor/0.8.1/min/vs/editor/editor.main.css":["_generated/Content/Scripts/_oss/monaco-editor/0.8.1/min/vs/editor/editor.main.css"],"*Viva.Controls/Controls/Viva.MouseCompanion":["_generated/Less/Viva.Controls/Controls/Viva.MouseCompanion.css","Viva.Controls/Controls/Viva.MouseCompanion"],"*Viva.Controls/Controls/Viva.Command":["Viva.Controls/Controls/Viva.Command"],"**Viva.Controls/Controls/Visualization/Viva.SvgBase":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.SvgBase.css"],"*Viva.Controls/Controls/Visualization/Viva.SvgBase":["Viva.Controls/Controls/Visualization/Viva.SvgBase"],"*Viva.Controls/Controls/Visualization/Viva.SparkLine":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.SparkLine.css","Viva.Controls/Controls/Visualization/Viva.SparkLine"],"**Viva.Controls/Controls/Visualization/Viva.BarGauge":
["Viva.Controls/Controls/Visualization/Viva.GaugeBase"],"*Viva.Controls/Controls/Visualization/Viva.BarGauge":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.BarGauge.css","Viva.Controls/Controls/Visualization/Viva.BarGauge"],"*Viva.Controls/Controls/Visualization/Graph/GraphEntitiesAddition":["Viva.Controls/Controls/Visualization/Graph/GraphEntitiesAddition"],"*Viva.Controls/Controls/Visualization/Graph/Commands/ICommand":["Viva.Controls/Controls/Visualization/Graph/Commands/ICommand"],"**Viva.Controls/Controls/Forms/Viva.Password.StrengthIndicator":["_generated/Less/Viva.Controls/Controls/Forms/Viva.Password.css","Viva.Controls/Controls/Forms/Viva.Password"],"*Viva.Controls/Controls/Forms/Viva.Password.StrengthIndicator":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.ColorBar.css","Viva.Controls/Controls/Visualization/Viva.ColorBar","Viva.Controls/Controls/Forms/Viva.Password.StrengthIndicator"],"*Viva.Controls/Controls/Forms/Viva.CommandButton":["_generated/Less/Viva.Controls/Controls/Forms/Viva.CommandButton.css",
"Viva.Controls/Controls/Forms/Viva.CommandButton"],"*Viva.Controls/Controls/Base/Viva.Sanitizer":["Viva.Controls/Controls/Base/Viva.Sanitizer"],"**MsPortalImpl/Widgets/Widgets.WhatsNew":["MsPortalImpl/Widgets/Widgets.Cutout","_generated/Less/MsPortalImpl/Widgets/Widgets.Modal.css","MsPortalImpl/Widgets/Widgets.Modal"],"*MsPortalImpl/Widgets/Widgets.WhatsNew":["_generated/Templates/ModalWhatsNew","_generated/Less/MsPortalImpl/Widgets/ModalWhatsNew.css","MsPortalImpl/Widgets/Widgets.WhatsNew"],"*MsPortalImpl/Widgets/Widgets.WelcomeSequence":["_generated/Templates/ModalWelcomePrompt","_generated/Templates/ModalToolTip","_generated/Less/MsPortalImpl/Widgets/ModalWelcomePrompt.css","_generated/Less/MsPortalImpl/Widgets/ModalToolTip.css","MsPortalImpl/Widgets/Widgets.WelcomeSequence"],"*MsPortalImpl/Widgets/Widgets.SideBarFlyout":["_generated/Templates/WidgetsSideBarFlyout","_generated/Templates/WidgetsSideBarFlyoutCategoryView","_generated/Templates/WidgetsSideBarFlyoutNameView","_generated/Templates/WidgetsSideBarFlyoutDropMenu",
"_generated/Templates/WidgetsSideBarFlyoutDropMenuButton","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBarFlyout.css","MsPortalImpl/Widgets/Widgets.SideBarFlyout"],"*MsPortalImpl/Widgets/Widgets.SharedOptionsInit":["MsPortalImpl/Widgets/Widgets.SharedOptionsInit"],"**MsPortalImpl/Widgets/Widgets.ShareDashboardPane":["MsPortalImpl/UI/UI.PartGalleryDataClient"],"*MsPortalImpl/Widgets/Widgets.ShareDashboardPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.ShareDashboardPane.css","MsPortalImpl/Widgets/Widgets.ShareDashboardPane"],"*MsPortalImpl/Widgets/Widgets.SettingsPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.SettingsPane.css","MsPortalImpl/Widgets/Widgets.SettingsPane"],"*MsPortalImpl/Widgets/Widgets.SearchDefered":["_generated/Less/MsPortalImpl/Widgets/Widgets.SearchDefered.css","MsPortalImpl/Widgets/Widgets.SearchDefered"],"*MsPortalImpl/Widgets/Widgets.Nps":["MsPortalImpl/Widgets/Widgets.Nps"],"*MsPortalImpl/Widgets/Widgets.NotificationsPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationsPane.css",
"MsPortalImpl/Widgets/Widgets.NotificationsPane"],"*MsPortalImpl/Widgets/Widgets.KeyboardShortcutsPane":["MsPortalImpl/Widgets/Widgets.KeyboardShortcutsPane"],"***MsPortalImpl/Widgets/Widgets.HelpPane":["Fx/Controls/Button"],"*MsPortalImpl/Widgets/Widgets.HelpPane":["_generated/Templates/WidgetshelpPane","_generated/Less/MsPortalImpl/Widgets/Widgets.HelpPane.css","MsPortalImpl/Widgets/Widgets.HelpPane"],"*MsPortalImpl/Widgets/Widgets.FilterPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.FilterPane.css","MsPortalImpl/Widgets/Widgets.FilterPane"],"*MsPortalImpl/Widgets/Widgets.FeedbackPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.FeedbackPane.css","MsPortalImpl/Widgets/Widgets.FeedbackPane"],"*MsPortalImpl/Widgets/Widgets.DebugHub.Performance.Timeline":["_generated/Less/MsPortalImpl/Widgets/Widgets.DebugHub.Performance.Timeline.css","MsPortalImpl/Widgets/Widgets.DebugHub.Performance.Timeline"],"*MsPortalImpl/Widgets/Widgets.Console":["_generated/Less/MsPortalImpl/Widgets/Widgets.Console.css",
"MsPortalImpl/Widgets/Widgets.Console"],"*MsPortalImpl/ViewModels/ViewModels.Forms":["MsPortalImpl/ViewModels/ViewModels.Forms"],"*MsPortalImpl/UI/UI.Portal.Actions":["MsPortalImpl/UI/UI.Portal.Actions"],"**MsPortalImpl/UI/UI.PartGalleryManager":["Viva.Controls/Controls/Base/Viva.ItemList","_generated/Less/Viva.Controls/Controls/Forms/Viva.DropDown.css","Viva.Controls/Controls/Forms/Viva.GroupDropDown"],"*MsPortalImpl/UI/UI.PartGalleryManager":["MsPortalImpl/Interactions/Interactions.PartGalleryDragDrop","MsPortalImpl/UI/UI.PartGalleryHelper","MsPortalImpl/Widgets/Widgets.PartGalleryPivots","_generated/Less/MsPortalImpl/Widgets/Widgets.PartGallery.css","MsPortalImpl/Widgets/Widgets.PartGallery","MsPortalImpl/UI/UI.PartGalleryPivotControllers","MsPortalImpl/UI/UI.PartGalleryManager"],"*MsPortalImpl/UI/UI.DragDropCompositionManager":["MsPortalImpl/UI/UI.DragDropCompositionManager"],"*MsPortalImpl/UI/UI.Desktop.Actions":["MsPortalImpl/UI/Compositions/UI.Composition.Util","MsPortalImpl/UI/UI.Desktop.Actions"],
"*MsPortalImpl/UI/UI.BladeLauncher":["MsPortalImpl/UI/UI.BladeLauncher"],"*MsPortalImpl/UI/UI.AzureMobile":["MsPortalImpl/UI/UI.AzureMobile"],"*MsPortalImpl/UI/UI.AssetBladeLauncher":["MsPortalImpl/UI/UI.AssetBladeLauncher"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.SettingsPart":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.SettingsPart"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleSelectionBlade":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleSelectionBlade"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleGrid":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleGrid"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageSelectionBlade":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageSelectionBlade"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageGrid":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageGrid"],"**MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.DiagnosticsPart":["MsPortalImpl/Base/Base.ImageHelper"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.DiagnosticsPart":
["MsPortalImpl/UI/Hubs/UI.HubsDiagnostics","MsPortalImpl/Services/Services.AssetTypes.Diagnostics","MsPortalImpl/Base/Base.DiagnosticsPopup","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.DiagnosticsPart"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.Blade":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.Blade"],"**MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.PinnedPart":["MsPortalImpl/UI/Hubs/UI.BrowseManagerDelayed"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.PinnedPart":["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.PinnedPart"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Part":["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Part"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Blade":["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Blade"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseAll.Part":["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseAll.Part"],"*MsPortalImpl/UI/Hubs/UI.ResourceMapManager":["MsPortalImpl/UI/Hubs/UI.ResourceMapManager"],"*MsPortalImpl/UI/Hubs/UI.CreateManager":
["MsPortalImpl/UI/Hubs/UI.CreateManager"],"*MsPortalImpl/UI/Dashboard/SessionDashboardRepository":["MsPortalImpl/UI/Dashboard/SessionDashboardRepository"],"*MsPortalImpl/UI/Dashboard/BrowseDashboardsPane":["_generated/Less/MsPortalImpl/Widgets/BrowseDashboardsPane.css","MsPortalImpl/UI/Dashboard/BrowseDashboardsPane"],"*MsPortalImpl/UI/Compositions/UI.Composition.Journey":["MsPortalImpl/Base/Base.HierarchyMap","MsPortalImpl/UI/Commands/UI.Commands.Blade","MsPortalImpl/UI/Commands/UI.CommandBarManager","MsPortalImpl/UI/Compositions/UI.Composition.Blade.Actions","MsPortalImpl/UI/Compositions/UI.Composition.Lens","MsPortalImpl/UI/Compositions/UI.Composition.Blade","MsPortalImpl/UI/Compositions/UI.Composition.Journey"],"**MsPortalImpl/UI/Compositions/UI.Composition.Journey":["MsPortalImpl/Base/Base.Router.Blade","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Helpers","MsPortalImpl/UI/Compositions/UI.Composition.BladeInvocationHandler","_generated/Templates/WidgetsBladeContent","_generated/Templates/WidgetsCommandBar",
"_generated/Templates/WidgetsCommandBarItem","_generated/Less/MsPortalImpl/Widgets/Widgets.CommandBar.css","MsPortalImpl/Widgets/Widgets.CommandBar","_generated/Templates/WidgetsLens","_generated/Less/MsPortalImpl/Widgets/Widgets.Lens.css","MsPortalImpl/Widgets/Widgets.Lens","MsPortalImpl/Widgets/Widgets.StackLayout","MsPortalImpl/Widgets/Widgets.BladeContent","_generated/Templates/WidgetsBlade","_generated/Less/MsPortalImpl/Widgets/Widgets.Blade.css","MsPortalImpl/Widgets/Widgets.Blade","_generated/Less/MsPortalImpl/Widgets/Widgets.Journey.css","MsPortalImpl/Widgets/Widgets.Journey","MsPortalImpl/UI/Compositions/UI.Composition.DelayedBladeManager","MsPortalImpl/UI/Compositions/UI.Composition.SelectableSetBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableSet2Binder","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener","MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar"],"*MsPortalImpl/UI/Compositions/UI.Composition.DefinitionChangeMonitor":["MsPortalImpl/UI/Compositions/UI.Composition.DefinitionChangeMonitor"],
"*MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuV2":["MsPortalImpl/UI/Commands/UI.Commands.Lists","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer.DemandLoad","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuV2"],"*MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Selectable2":["MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Selectable2"],"*MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.PendingBlade":["MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.PendingBlade"],"*MsPortalImpl/UI/Compositions/UI.Composition.BladeActionBar":["_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.ActionBarBase.css","MsPortalImpl/Controls/ActionBars/Controls.ActionBarBase","MsPortalImpl/Controls/ActionBars/Controls.ErrorInfoBoxActionBar","_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.CreateActionBar.css","MsPortalImpl/Controls/ActionBars/Controls.CreateActionBar","MsPortalImpl/Controls/ActionBars/Controls.DeleteActionBar","MsPortalImpl/Controls/ActionBars/Controls.FilterActionBar",
"MsPortalImpl/Controls/ActionBars/Controls.FormActionBar","_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.GenericActionBar.css","MsPortalImpl/Controls/ActionBars/Controls.GenericActionBar","_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.PickerActionBar.css","MsPortalImpl/Controls/ActionBars/Controls.PickerActionBar","_generated/Less/MsPortalImpl/Widgets/Widgets.BladeActionBar.css","MsPortalImpl/Widgets/Widgets.BladeActionBar","MsPortalImpl/UI/Compositions/UI.Composition.BladeActionBar"],"*MsPortalImpl/Services/Services.PortalPrefetch":["MsPortalImpl/Services/Services.PortalPrefetch"],"**MsPortalImpl/Services/Services.IntuneAppFileUpload":["MsPortalImpl/Services/Services.FileUploadSettings","MsPortalImpl/Services/Services.FileUpload"],"*MsPortalImpl/Services/Services.IntuneAppFileUpload":["MsPortalImpl/Services/Services.IntuneAppEncrypt","MsPortalImpl/Services/Services.IntuneAppFileUpload"],"*MsPortalImpl/Services/Services.BrowserTelemetry":["MsPortalImpl/Services/Services.BrowserTelemetry"],
"*MsPortalImpl/Services/Services.AssetTypesDelayed":["MsPortalImpl/Services/Services.AssetTypesDelayed"],"*MsPortalImpl/Services/BrowseCuration/oms":["MsPortalImpl/Services/BrowseCuration/oms"],"*MsPortalImpl/Services/BrowseCuration/intune-edu":["MsPortalImpl/Services/BrowseCuration/intune-edu"],"*MsPortalImpl/Services/BrowseCuration/endpoint":["MsPortalImpl/Services/BrowseCuration/endpoint"],"*MsPortalImpl/Services/BrowseCuration/aad":["MsPortalImpl/Services/BrowseCuration/default","MsPortalImpl/Services/BrowseCuration/aad"],"*MsPortalImpl/Parts/Parts.SingleValueGauge":["_generated/Less/MsPortalImpl/Parts/Parts.SingleValueGauge.css","MsPortalImpl/Parts/Parts.SingleValueGauge"],"**MsPortalImpl/Parts/Parts.ResourceSummary":["_generated/Less/MsPortalImpl/Parts/Parts.Properties.css"],"*MsPortalImpl/Parts/Parts.ResourceSummary":["MsPortalImpl/Parts/Parts.Properties","_generated/Less/MsPortalImpl/Parts/Parts.ResourceSummary.css","MsPortalImpl/Parts/Parts.ResourceSummary"],"*MsPortalImpl/Parts/Parts.QuotaGauge":
["_generated/Less/MsPortalImpl/Parts/Parts.QuotaGauge.css","MsPortalImpl/Parts/Parts.QuotaGauge"],"*MsPortalImpl/Parts/Parts.QuickStart":["_generated/Less/MsPortalImpl/Parts/Parts.QuickStart.css","MsPortalImpl/Parts/Parts.QuickStart"],"*MsPortalImpl/Parts/Parts.Provisioning":["_generated/Less/MsPortalImpl/Parts/Parts.Provisioning.css","MsPortalImpl/Parts/Parts.Provisioning"],"*MsPortalImpl/Parts/Parts.InfoList":["_generated/Less/MsPortalImpl/Parts/Parts.InfoList.css","MsPortalImpl/Parts/Parts.InfoList"],"***MsPortalImpl/Parts/Parts.Frame":["Fx/Composition/ViewModelBase","Fx/Composition/PartBase","Fx/Composition/FramePart"],"*MsPortalImpl/Parts/Parts.Frame":["_generated/Less/MsPortalImpl/Parts/Parts.Frame.css","MsPortalImpl/Parts/Parts.Frame"],"***MsPortalImpl/Parts/Parts.Donut":["Fx/Controls/Legend"],"**MsPortalImpl/Parts/Parts.Donut":["Viva.Controls/Controls/Base/Viva.CompositeControl","Viva.Controls/Controls/Forms/Viva.ComboDropBase","_generated/Less/Viva.Controls/Controls/Viva.SingleSetting.css",
"Viva.Controls/Controls/Viva.SingleSetting","_generated/Less/Viva.Controls/Controls/Forms/Viva.MultiSelectDropDown.css","Viva.Controls/Controls/Forms/Viva.MultiSelectDropDown","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Gauge.css","Viva.Controls/Controls/Visualization/Viva.Gauge","_generated/Less/Viva.Controls/Controls/Visualization/Viva.UsageGauge.css","Viva.Controls/Controls/Visualization/Viva.UsageGauge","_generated/Less/Viva.Controls/Controls/Visualization/Viva.QuotaGauge.css","Viva.Controls/Controls/Visualization/Viva.QuotaGauge","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Donut.css","Viva.Controls/Controls/Visualization/Viva.Donut"],"*MsPortalImpl/Parts/Parts.Donut":["_generated/Less/MsPortalImpl/Parts/Parts.Donut.css","MsPortalImpl/Parts/Parts.Donut"],"*MsPortalImpl/Parts/Parts.CollectionSummary":["_generated/Less/MsPortalImpl/Parts/Parts.CollectionSummary.css","MsPortalImpl/Parts/Parts.CollectionSummary"],"**MsPortalImpl/Parts/Parts.Chart":["MsPortalImpl.Controls/Controls/Visualization/ChartViewModelConversionHelper"],
"*MsPortalImpl/Parts/Parts.Chart":["_generated/Less/MsPortalImpl/Parts/Parts.Chart.css","MsPortalImpl/Parts/Parts.Chart"],"*MsPortalImpl/Parts/Parts.Asset":["_generated/Less/MsPortalImpl/Parts/Parts.Asset.css","MsPortalImpl/Parts/Parts.Asset"],"*MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize":["MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize"],"*MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource":["MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource"],"*MsPortalImpl/ExtensionHostInit":["MsPortalImpl/ExtensionHostInit"],"*MsPortalImpl/Extension/PinBladeInferred":["MsPortalImpl/Extension/PinBladeInferred"],"*MsPortalImpl/Extension/ExtensionPatch":["MsPortalImpl/Extension/ExtensionPatch"],"***MsPortalImpl/Controls/Forms/IntuneAppFileUpload":["Fx/Internal/Controls/IntuneAppFileUpload"],"**MsPortalImpl/Controls/Forms/IntuneAppFileUpload":["MsPortalImpl/Services/Services.FileUploadManager","MsPortalImpl/Controls/Helpers/Validators","_generated/Less/MsPortalImpl/Controls/Forms/AsyncFileUpload.css"],
"*MsPortalImpl/Controls/Forms/IntuneAppFileUpload":["MsPortalImpl/Services/Services.IntuneAppCfbParser","MsPortalImpl/Services/Services.IntuneAppParse","MsPortalImpl/Controls/Forms/IntuneAppFileUpload"],"**MsPortalImpl/Controls/Forms/GroupDropDown":["MsPortalImpl.Controls/Controls/Base/ViewModelBase"],"*MsPortalImpl/Controls/Forms/GroupDropDown":["_generated/Less/MsPortalImpl/Controls/Forms/GroupDropDown.css","MsPortalImpl/Controls/Forms/GroupDropDown"],"**MsPortalImpl/Controls/Forms/Controls.TokenComboBox":["_generated/Less/Viva.Controls/Controls/Forms/Viva.EditableCombo.css","Viva.Controls/Controls/Forms/Viva.EditableCombo","_generated/Less/Viva.Controls/Controls/Forms/Viva.FilterCombo.css","Viva.Controls/Controls/Forms/Viva.FilterCombo"],"*MsPortalImpl/Controls/Forms/Controls.TokenComboBox":["MsPortalImpl/Base/Base.Text","MsPortalImpl/Controls/Forms/TokenParsing","_generated/Less/MsPortalImpl/Controls/Forms/Controls.TokenComboBox.css","MsPortalImpl/Controls/Forms/Controls.TokenComboBox"],
"*MsPortalImpl/Controls/Forms/Controls.FileUpload":["_generated/Less/Viva.Controls/Controls/Forms/Viva.FileUpload2.css","Viva.Controls/Controls/Forms/Viva.FileUpload2","MsPortalImpl/Controls/Forms/Controls.FileUpload"],"*MsPortalImpl/Controls/Forms/AsyncFileUpload":["MsPortalImpl/Controls/Forms/AsyncFileUpload"],"*MsPortalImpl/Controls/Controls.Wizard":["_generated/Less/MsPortalImpl/Controls/Controls.Wizard.css","MsPortalImpl/Controls/Controls.Wizard"],"*MsPortalImpl/Controls/Controls.PillList":["_generated/Less/MsPortalImpl/Controls/Controls.PillList.css","MsPortalImpl/Controls/Controls.PillList"],"*MsPortalImpl/Controls/Controls.PickerV3":["_generated/Less/MsPortalImpl/Controls/Controls.PickerV3.css","MsPortalImpl/Controls/Controls.PickerV3"],"*MsPortalImpl/Controls/Controls.Picker":["_generated/Less/MsPortalImpl/Controls/Controls.Picker.css","MsPortalImpl/Controls/Controls.Picker"],"*MsPortalImpl/Controls/Controls.Notice":["_generated/Less/MsPortalImpl/Controls/Controls.Notice.css",
"MsPortalImpl/Controls/Controls.Notice"],"*MsPortalImpl/Controls/Controls.InfoBox":["_generated/Less/MsPortalImpl/Controls/Controls.HotSpot.css","MsPortalImpl/Controls/Controls.HotSpot","_generated/Less/MsPortalImpl/Controls/Controls.InfoBox.css","MsPortalImpl/Controls/Controls.InfoBox"],"*MsPortalImpl/Controls/Controls.HeroBanner":["_generated/Less/MsPortalImpl/Controls/Controls.HeroBanner.css","MsPortalImpl/Controls/Controls.HeroBanner"],"**MsPortalImpl/Controls/Controls.FileDownloadButton":["Viva.Controls/Controls/Toolbars/Viva.ToolbarItem","_generated/Less/Viva.Controls/Controls/Toolbars/Viva.ToolbarButton.css","Viva.Controls/Controls/Toolbars/Viva.ToolbarButton","Viva.Controls/Controls/Toolbars/Viva.ExecutableButtonBase","_generated/Less/Viva.Controls/Controls/Toolbars/Viva.CommandButton.css","Viva.Controls/Controls/Toolbars/Viva.CommandButton"],"*MsPortalImpl/Controls/Controls.FileDownloadButton":["MsPortalImpl/Commands/Commands.FileDownloadCommand","_generated/Less/MsPortalImpl/Controls/Controls.FileDownloadButton.css",
"MsPortalImpl/Controls/Controls.FileDownloadButton"],"*MsPortalImpl/Controls/Controls.Essentials":["_generated/Less/MsPortalImpl/Controls/Controls.Essentials.css","MsPortalImpl/Controls/Controls.Essentials"],"*MsPortalImpl/Controls/Controls.DeleteAssetConfirmation":["MsPortalImpl/Controls/Controls.DeleteAssetConfirmation"],"*MsPortalImpl/Commands/SafariDownloadUtil":["MsPortalImpl/Commands/SafariDownloadUtil"],"*MsPortalImpl/Base/Template":["MsPortalImpl/Base/Template"],"*MsPortalImpl/Base/Base.Selectable2.Pipeline":["MsPortalImpl/Base/Base.Selectable2.Pipeline"],"*MsPortalImpl/Base/Base.Selectable2.Common":["MsPortalImpl/Base/Base.Selectable2.Common"],"*MsPortalImpl/Base/Base.SafeMarkup":["MsPortalImpl/Base/Base.SafeMarkup"],"*MsPortalImpl/Base/Base.PartGallery":["MsPortalImpl/Base/Base.PartGallery"],"*MsPortalImpl/Base/Base.KnockoutExtensions.Controls":["MsPortalImpl/Base/Base.KnockoutExtensions.Controls"],"*MsPortalImpl/Base/Base.DebugInfo":["_generated/Templates/ConsoleErrorInfo","MsPortalImpl/Widgets/Widgets.DebugHub.Performance",
"_generated/Less/MsPortalImpl/Widgets/Widgets.DebugHub.css","MsPortalImpl/Widgets/Widgets.DebugContextPane","_generated/Less/MsPortalImpl/Base/Base.DebugInfo.css","MsPortalImpl/Base/Base.DebugInfo"],"*MsPortalImpl.Controls/Fields/TriStateCheckBox":["MsPortalImpl.Controls/Fields/TriStateCheckBox"],"**MsPortalImpl.Controls/Fields/TimePickerField":["Viva.Controls/Controls/Forms/Viva.TimePicker"],"*MsPortalImpl.Controls/Fields/TimePickerField":["MsPortalImpl.Controls/Fields/TimePickerField"],"*MsPortalImpl.Controls/Fields/StringListField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.StringList.css","Viva.Controls/Controls/Forms/Viva.StringList","_generated/Less/MsPortalImpl.Controls/Controls/Forms/StringList.css","MsPortalImpl.Controls/Fields/StringListField"],"*MsPortalImpl.Controls/Fields/Splitter":["_generated/Less/Viva.Controls/Controls/Forms/Viva.Splitter.css","Viva.Controls/Controls/Forms/Viva.Splitter","MsPortalImpl.Controls/Fields/Splitter"],"**MsPortalImpl.Controls/Fields/SliderField":
["MsPortalImpl.Controls/Fields/Base/SliderBaseField","_generated/Less/Viva.Controls/Controls/Forms/Viva.Slider.css","Viva.Controls/Controls/Base/Viva.SliderBase","Viva.Controls/Controls/Forms/Viva.Slider"],"*MsPortalImpl.Controls/Fields/SliderField":["MsPortalImpl.Controls/Fields/SliderField"],"**MsPortalImpl.Controls/Fields/SelectorField":["MsPortalImpl.Controls/Controls/Base/ValidatableControl","_generated/Less/MsPortalImpl.Controls/Fields/Selector.css","_generated/Less/MsPortalImpl.Controls/Fields/CreatorAndSelector.css","MsPortalImpl.Controls/Controls/Forms/SelectorBase"],"*MsPortalImpl.Controls/Fields/SelectorField":["MsPortalImpl.Controls/Controls/Forms/Selector","MsPortalImpl.Controls/Fields/SelectorField"],"*MsPortalImpl.Controls/Fields/SectionField":["MsPortalImpl.Controls/Fields/SectionField"],"*MsPortalImpl.Controls/Fields/Section":["_generated/Less/MsPortalImpl.Controls/Fields/Section.css","MsPortalImpl.Controls/Fields/Section"],"**MsPortalImpl.Controls/Fields/RangeSliderField":
["Viva.Controls/Controls/Forms/Viva.RangeSlider"],"*MsPortalImpl.Controls/Fields/RangeSliderField":["MsPortalImpl.Controls/Fields/RangeSliderField"],"*MsPortalImpl.Controls/Fields/PasswordField":["_generated/Less/MsPortalImpl/Controls/ValidationPopup.css","MsPortalImpl/Controls/Helpers/ValidationPopup","MsPortalImpl.Controls/Fields/PasswordField"],"*MsPortalImpl.Controls/Fields/OptionsGroupField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.OptionPicker.css","Viva.Controls/Controls/Forms/Viva.OptionPicker","MsPortalImpl.Controls/Fields/OptionsGroupField"],"*MsPortalImpl.Controls/Fields/OAuthButtonField":["MsPortalImpl/Commands/Commands.OAuthCommand","_generated/Less/MsPortalImpl.Controls/Fields/OAuthButton.css","MsPortalImpl.Controls/Fields/OAuthButtonField"],"*MsPortalImpl.Controls/Fields/NumericTextBoxField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.NumericTextBox.css","Viva.Controls/Controls/Forms/Viva.NumericTextBox","MsPortalImpl.Controls/Fields/NumericTextBoxField"],
"*MsPortalImpl.Controls/Fields/MultiselectDropDownField":["MsPortalImpl.Controls/Fields/MultiselectDropDownField"],"*MsPortalImpl.Controls/Fields/MultiLineTextField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.MultiLineTextBox.css","Viva.Controls/Controls/Forms/Viva.MultiLineTextBox","MsPortalImpl.Controls/Fields/MultiLineTextField"],"*MsPortalImpl.Controls/Fields/HtmlEditorField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.ContentEditable.css","Viva.Controls/Controls/Forms/Viva.ContentEditable","MsPortalImpl.Controls/Fields/HtmlEditorField"],"*MsPortalImpl.Controls/Fields/FilterComboField":["MsPortalImpl.Controls/Fields/FilterComboField"],"*MsPortalImpl.Controls/Fields/DurationPickerField":["_generated/Less/MsPortalImpl.Controls/Fields/DurationPicker.css","MsPortalImpl.Controls/Fields/DurationPickerField"],"*MsPortalImpl.Controls/Fields/DropDownField":["MsPortalImpl.Controls/Fields/DropDownField"],"*MsPortalImpl.Controls/Fields/DayPickerField":["_generated/Less/MsPortalImpl.Controls/Fields/DayPicker.css",
"MsPortalImpl.Controls/Fields/DayPickerField"],"**MsPortalImpl.Controls/Fields/DateTimeRangePickerField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.DatePanel.css","Viva.Controls/Controls/Forms/Viva.DatePanel","Viva.Controls/Util/Viva.ArrayUtil","_generated/Less/Viva.Controls/Controls/Forms/Viva.DatePicker.css","Viva.Controls/Controls/Forms/Viva.DatePicker","_generated/Less/Viva.Controls/Controls/Forms/Viva.DateTimePicker.css","Viva.Controls/Controls/Forms/Viva.DateTimePicker"],"*MsPortalImpl.Controls/Fields/DateTimeRangePickerField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.DateTimeRangePicker.css","Viva.Controls/Controls/Forms/Viva.DateTimeRangePicker","MsPortalImpl.Controls/Fields/DateTimeRangePickerField"],"*MsPortalImpl.Controls/Fields/DateTimePickerField":["MsPortalImpl.Controls/Fields/DateTimePickerField"],"**MsPortalImpl.Controls/Fields/DateTimeComboField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.DateTimeCombo.css","Viva.Controls/Controls/Forms/Viva.DateTimeCombo"],
"*MsPortalImpl.Controls/Fields/DateTimeComboField":["MsPortalImpl.Controls/Fields/DateTimeComboField"],"*MsPortalImpl.Controls/Fields/DatePickerField":["MsPortalImpl.Controls/Fields/DatePickerField"],"*MsPortalImpl.Controls/Fields/CustomValueSliderField":["MsPortalImpl.Controls/Fields/CustomValueSliderField"],"*MsPortalImpl.Controls/Fields/CustomRangeSlider":["MsPortalImpl.Controls/Fields/CustomRangeSlider"],"*MsPortalImpl.Controls/Fields/CustomHtmlField":["MsPortalImpl.Controls/Fields/CustomHtmlField"],"**MsPortalImpl.Controls/Fields/CreatorAndSelectorFieldV2":["MsPortalImpl.Controls/Controls/Forms/CreatorAndSelector"],"*MsPortalImpl.Controls/Fields/CreatorAndSelectorFieldV2":["MsPortalImpl.Controls/Fields/CreatorAndSelectorFieldV2"],"*MsPortalImpl.Controls/Fields/CreatorAndSelectorField":["MsPortalImpl.Controls/Fields/CreatorAndSelectorField"],"*MsPortalImpl.Controls/Fields/CheckBoxField":["MsPortalImpl.Controls/Fields/CheckBoxField"],"*MsPortalImpl.Controls/Controls/Visualization/SingleValueGauge":
["Viva.Controls/Controls/Visualization/Viva.SingleValueGauge","MsPortalImpl.Controls/Controls/Visualization/SingleValueGauge"],"*MsPortalImpl.Controls/Controls/Visualization/QuotaGauge":["MsPortalImpl.Controls/Controls/Visualization/QuotaGauge"],"***MsPortalImpl.Controls/Controls/Visualization/PairedTimeline":["Fx/Controls/PairedTimelineBadges","Fx/Controls/RangeSelection","Fx/Controls/PairedTimeline"],"**MsPortalImpl.Controls/Controls/Visualization/PairedTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/List.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.List.FocusableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.List.GroupableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.List.SelectableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.FocusableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.GroupableExtension.css",
"_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.SelectableExtension.css","Viva.Controls/Controls/Lists/List1/Viva.List","Viva.Controls/Controls/Lists/List1/Viva.List.Focusable","Viva.Controls/Controls/Lists/List1/Viva.List.Selectable","Viva.Controls/Controls/Lists/List1/Viva.List.Groupable","Viva.Controls/Controls/Lists/List1/Viva.List.ContextMenu","_generated/Less/MsPortalImpl.Controls/Controls/Lists/ListView.css","MsPortalImpl.Controls/Controls/Lists/List1/ListView","Viva.Controls/Util/Viva.Hatching","_generated/Less/Viva.Controls/Controls/Visualization/Viva.ChartBase.css","Viva.Controls/Controls/Visualization/Viva.ChartBase"],"*MsPortalImpl.Controls/Controls/Visualization/PairedTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Visualization/RangeSelection.css","MsPortalImpl.Controls/Controls/Visualization/RangeSelection","_generated/Less/MsPortalImpl.Controls/Controls/Visualization/PairedTimelineBadges.css","MsPortalImpl.Controls/Controls/Visualization/PairedTimelineBadges",
"_generated/Less/MsPortalImpl.Controls/Controls/Visualization/PairedTimeline.css","MsPortalImpl.Controls/Controls/Visualization/PairedTimeline"],"***MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MonitorChart":["Fx/Internal/Controls/MonitorChart","Fx/Pinner"],"*MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MonitorChart":["MsPortalImpl.Controls/Controls/Visualization/MonitorChart/Tools/Config","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/Tools/Ajax","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/Base.Provider","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/Base.ProviderFactory","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/Interfaces","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/Dummy.Provider","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/Tools/Common","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/Tools/Timespan",
"MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/Legacy.Provider","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/LegacyIEC.Provider","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/Mdm.Provider","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/MdmIEC.Provider","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/Tools/Errors","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/Sql.ProviderFactory","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/Storage.Provider","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/Tools/Logger","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/VirtualMachine.Provider","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/Website.ProviderFactory",
"MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BackendProviders/Root.ProviderFactory","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/MetricsProvider","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/Tools/BladeReferences","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/Tools/Chart","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MonitorChart.Main","_generated/Less/MsPortalImpl.Controls/Controls/Visualization/MonitorChart.css","MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MonitorChart"],"*MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BatchHelper":["MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MetricsProvider/BatchHelper"],"*MsPortalImpl.Controls/Controls/Visualization/Metrics":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.Metrics.css","Viva.Controls/Controls/Visualization/Viva.Metrics","MsPortalImpl.Controls/Controls/Visualization/Metrics"],
"*MsPortalImpl.Controls/Controls/Visualization/MapV2":["MsPortalImpl.Controls/Controls/Visualization/MapV2"],"*MsPortalImpl.Controls/Controls/Visualization/Map":["Viva.Controls/Controls/Visualization/Viva.MapCoordinateConverter","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Map.css","Viva.Controls/Controls/Visualization/Viva.Map","Viva.Controls/Controls/Visualization/Viva.Hexagon","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Map.HexagonLayoutExtension.css","Viva.Controls/Controls/Visualization/Viva.Map.HexagonLayoutExtension","MsPortalImpl.Controls/Controls/Visualization/Map"],"*MsPortalImpl.Controls/Controls/Visualization/Legend":["_generated/Less/MsPortalImpl.Controls/Controls/Visualization/Legend.css","MsPortalImpl.Controls/Controls/Visualization/Legend"],"*MsPortalImpl.Controls/Controls/Visualization/Graph":["Viva.Controls/Controls/Visualization/Graph/GraphEntityViewModel","Viva.Controls/Controls/Visualization/Graph/GraphViewModel","Viva.Controls/Controls/Visualization/Graph/GraphWidget.Constants",
"Viva.Controls/Controls/Visualization/Graph/Animation","Viva.Controls/Controls/Visualization/Graph/MouseCapture","Viva.Controls/Controls/Visualization/Graph/Geometry","Viva.Controls/Controls/Visualization/Graph/Commands/MoveNodes","Viva.Controls/Controls/Visualization/Graph/SvgUtils","_generated/Less/Viva.Controls/Controls/Visualization/Graph.css","_generated/Less/Viva.Controls/Controls/Visualization/Graph.Skins.css","Viva.Controls/Controls/Visualization/Graph/GraphWidget","MsPortalImpl.Controls/Controls/Visualization/Graph"],"*MsPortalImpl.Controls/Controls/Visualization/Gauge":["MsPortalImpl.Controls/Controls/Visualization/Gauge"],"**MsPortalImpl.Controls/Controls/Visualization/Donut":["_generated/Less/MsPortalImpl/Controls/LoadingAndNoData.css","MsPortalImpl/Controls/Helpers/LoadingAndNoData"],"*MsPortalImpl.Controls/Controls/Visualization/Donut":["MsPortalImpl.Controls/Controls/Visualization/Donut"],"*MsPortalImpl.Controls/Controls/Visualization/CsmTopology":["_generated/Less/MsPortalImpl.Controls/Controls/Visualization/CsmTopology.css",
"MsPortalImpl.Controls/Controls/Visualization/CsmTopology"],"*MsPortalImpl.Controls/Controls/Visualization/Chart":["Viva.Controls/Controls/Visualization/Viva.ChartViewImpl","Viva.Controls/Controls/Visualization/Viva.StackedChartViewImpl","Viva.Controls/Controls/Visualization/Viva.StackedAreaChartViewImpl","Viva.Controls/Controls/Visualization/Viva.ScatterChartViewImpl","Viva.Controls/Controls/Visualization/Viva.LineChartViewImpl","Viva.Controls/Controls/Visualization/Viva.AreaChartViewImpl","Viva.Controls/Controls/Visualization/Viva.BarChartViewImpl","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Chart.css","Viva.Controls/Controls/Visualization/Viva.Chart","_generated/Less/MsPortalImpl.Controls/Controls/Visualization/Chart.css","MsPortalImpl.Controls/Controls/Visualization/Chart"],"*MsPortalImpl.Controls/Controls/Toolbars/Toolbar":["Viva.Controls/Controls/Toolbars/Viva.ToolbarGroup","Viva.Controls/Controls/Toolbars/Viva.ToolbarOptionsGroup","_generated/Less/Viva.Controls/Controls/Toolbars/Viva.Toolbar.css",
"_generated/Less/Viva.Controls/Controls/Toolbars/Viva.ToggleCommandButton.css","Viva.Controls/Controls/Toolbars/Viva.ToggleCommandButton","Viva.Controls/Controls/Toolbars/Viva.ClickableLink","Viva.Controls/Controls/Toolbars/Viva.OpenLinkButton","Viva.Controls/Controls/Toolbars/Viva.Toolbar","_generated/Less/MsPortalImpl.Controls/Controls/Toolbars/Toolbar.css","MsPortalImpl.Controls/Controls/Toolbars/Toolbar"],"**MsPortalImpl.Controls/Controls/TextBlock":["_generated/Less/MsPortalImpl.Controls/Controls/TextBlock.css"],"*MsPortalImpl.Controls/Controls/TextBlock":["MsPortalImpl.Controls/Controls/TextBlock"],"*MsPortalImpl.Controls/Controls/TerminalEmulator":["_generated/Less/MsPortalImpl.Controls/Controls/TerminalEmulator.css","MsPortalImpl.Controls/Controls/TerminalEmulator"],"*MsPortalImpl.Controls/Controls/SpecComparisonTable":["_generated/Less/MsPortalImpl.Controls/Controls/SpecComparisonTable.css","MsPortalImpl.Controls/Controls/SpecComparisonTable"],"*MsPortalImpl.Controls/Controls/SingleSetting":
["MsPortalImpl.Controls/Controls/SingleSetting"],"*MsPortalImpl.Controls/Controls/SimpleButton":["_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css","MsPortalImpl.Controls/Controls/SimpleButton"],"*MsPortalImpl.Controls/Controls/Settings":["_generated/Less/Viva.Controls/Controls/Viva.Settings.css","Viva.Controls/Controls/Viva.Settings","MsPortalImpl.Controls/Controls/Settings"],"*MsPortalImpl.Controls/Controls/SearchBox":["_generated/Less/MsPortalImpl.Controls/Controls/SearchBox.css","MsPortalImpl.Controls/Controls/SearchBox"],"**MsPortalImpl.Controls/Controls/Scrollbar":["_generated/Less/Viva.Controls/Controls/Viva.Scrollbar.css","Viva.Controls/Controls/Viva.Scrollbar"],"*MsPortalImpl.Controls/Controls/Scrollbar":["MsPortalImpl.Controls/Controls/Scrollbar"],"*MsPortalImpl.Controls/Controls/ResourceFilter":["_generated/Less/MsPortalImpl.Controls/Controls/ResourceFilter.css","MsPortalImpl.Controls/Controls/ResourceFilter"],"*MsPortalImpl.Controls/Controls/PreviewTag":["MsPortalImpl.Controls/Controls/PreviewTag"],
"*MsPortalImpl.Controls/Controls/PartPinner":["_generated/Less/MsPortalImpl.Controls/Controls/PartPinner.css","MsPortalImpl.Controls/Controls/PartPinner"],"*MsPortalImpl.Controls/Controls/MarkdownHtmlToReact":["MsPortalImpl.Controls/Controls/MarkdownHtmlToReact"],"***MsPortalImpl.Controls/Controls/Markdown":["Fx/Controls/Video"],"*MsPortalImpl.Controls/Controls/Markdown":["MsPortalImpl.Controls/Controls/Video","_generated/Less/MsPortalImpl.Controls/Controls/Markdown.css","MsPortalImpl.Controls/Controls/Markdown"],"**MsPortalImpl.Controls/Controls/LogStream":["MsPortalImpl.Controls/Controls/Controls.CommandHelpers","_generated/Less/Viva.Controls/Controls/Viva.TextStream.css","Viva.Controls/Controls/Viva.TextStream","_generated/Less/Viva.Controls/Controls/Viva.LogStream.css","Viva.Controls/Controls/Viva.LogStream"],"*MsPortalImpl.Controls/Controls/LogStream":["_generated/Less/MsPortalImpl.Controls/Controls/LogStream.css","MsPortalImpl.Controls/Controls/LogStream"],"*MsPortalImpl.Controls/Controls/Lists/Tree1/TreeView":
["_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.FocusableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.LoadByContinuationToken.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.OnDemandLoadableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.RightClickable.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.Selectable.css","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Focusable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Selectable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.OnDemandLoadable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.RightClickable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.LoadByContinuationToken","MsPortalImpl.Controls/Controls/Lists/Tree1/TreeView"],"***MsPortalImpl.Controls/Controls/Lists/Menu":["Fx/Controls/HotSpot"],"*MsPortalImpl.Controls/Controls/Lists/Menu":
["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Menu.css","MsPortalImpl.Controls/Controls/Lists/Menu"],"*MsPortalImpl.Controls/Controls/Lists/List1/Gallery":["MsPortalImpl.Controls/Controls/Lists/List1/Gallery"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Search":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Search.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Search"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Paging":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Paging.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Paging"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Hierarchical":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Hierarchical.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Hierarchical"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Grouping":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Grouping.css",
"MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Grouping"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Editing":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Editing.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Editing"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.DemandLoading":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.DemandLoading.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.DemandLoading"],"*MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ContextMenu":["MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ContextMenu"],"*MsPortalImpl.Controls/Controls/IFrameV2":["_generated/Less/MsPortalImpl.Controls/Controls/IFrameV2.css","MsPortalImpl.Controls/Controls/IFrameV2"],"*MsPortalImpl.Controls/Controls/IFrame":["_generated/Less/MsPortalImpl.Controls/Controls/IFrame.css","MsPortalImpl.Controls/Controls/IFrame"],"***MsPortalImpl.Controls/Controls/HeatMap":
["Fx/Controls/Batch/HeatMap"],"*MsPortalImpl.Controls/Controls/HeatMap":["_generated/Less/MsPortalImpl.Controls/Controls/HeatMap.css","MsPortalImpl.Controls/Controls/HeatMap"],"*MsPortalImpl.Controls/Controls/Forms/TextBox":["MsPortalImpl.Controls/Controls/Forms/TextBox"],"*MsPortalImpl.Controls/Controls/Forms/Obsolete.GroupDropDown":["MsPortalImpl.Controls/Controls/Forms/Obsolete.GroupDropDown"],"*MsPortalImpl.Controls/Controls/Forms/FileUpload":["_generated/Less/MsPortalImpl.Controls/Controls/Forms/ProgressOverlay.css","Viva.Controls/Controls/Visualization/Viva.Progress","_generated/Less/MsPortalImpl.Controls/Controls/Visualization/ProgressBar.css","MsPortalImpl.Controls/Controls/Visualization/ProgressBar","_generated/Less/Viva.Controls/Controls/Forms/Viva.FileUpload.css","Viva.Controls/Controls/Forms/Viva.FileUpload","_generated/Less/MsPortalImpl.Controls/Controls/Forms/FileUpload.css","MsPortalImpl.Controls/Controls/Forms/FileUpload"],"*MsPortalImpl.Controls/Controls/Forms/DateTimeCombo":
["MsPortalImpl.Controls/Controls/Forms/EditableCombo","MsPortalImpl.Controls/Controls/Forms/DateTimeCombo"],"*MsPortalImpl.Controls/Controls/Forms/CopyableLabel":["_generated/Less/MsPortalImpl.Controls/Controls/DockedBalloon.css","MsPortalImpl.Controls/Controls/DockedBalloon","_generated/Less/MsPortalImpl.Controls/Controls/Forms/CopyableLabel.css","MsPortalImpl.Controls/Controls/Forms/CopyableLabel"],"*MsPortalImpl.Controls/Controls/Forms/Button":["_generated/Less/MsPortalImpl.Controls/Controls/Forms/Button.css","MsPortalImpl.Controls/Controls/Forms/Button"],"**MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiscussionThread.css","MsPortalImpl.Controls/Controls/Documents/DiscussionThread"],"*MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline.css","MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline"],"*MsPortalImpl.Controls/Controls/Documents/DiffList":
["_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiffView.css","MsPortalImpl.Controls/Controls/Documents/DiffView","_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiffList.css","MsPortalImpl.Controls/Controls/Documents/DiffList"],"*MsPortalImpl.Controls/Controls/Documents/DiffEditor":["MsPortalImpl.Controls/Controls/Documents/Editor.Extension","_generated/Less/MsPortalImpl.Controls/Controls/Documents/Editor.DiscussionExtension.css","MsPortalImpl.Controls/Controls/Documents/Editor.DiscussionExtension","_generated/Less/MsPortalImpl.Controls/Controls/Documents/Editor.css","MsPortalImpl.Controls/Controls/Documents/Editor","MsPortalImpl.Controls/Controls/Documents/DiffEditor"],"*MsPortalImpl.Controls/Controls/Data/QueryBuilder":["_generated/Less/MsPortalImpl.Controls/Controls/Data/QueryBuilder.css","_generated/Less/Viva.Controls/Controls/Forms/Viva.CommandLink.css","Viva.Controls/Controls/Forms/Viva.CommandLink","MsPortalImpl.Controls/Controls/Data/QueryBuilder"],"*MsPortalImpl.Controls/Controls/ConsoleV2":
["_generated/Less/MsPortalImpl.Controls/Controls/ConsoleV2.css","MsPortalImpl.Controls/Controls/ConsoleV2"],"*MsPortalImpl.Controls/Controls/Console":["_generated/Less/Viva.Controls/Controls/Viva.Console.css","Viva.Controls/Controls/Viva.Console","_generated/Less/MsPortalImpl.Controls/Controls/Console.css","MsPortalImpl.Controls/Controls/Console"],"*MsPortalImpl.Controls/Controls/AzureMediaPlayer":["MsPortalImpl.Controls/Controls/AzureMediaPlayer"],"*FxHubs/Dashboard":["FxHubs/Dashboard"],"*FxHubs/BrowseCuration":["FxHubs/BrowseCuration"],"*FxHubs/BrowseCollectionResourceItem":["FxHubs/BrowseCollectionResourceItem"],"*Fx/Specs/DropDown":["Fx/Specs/DropDown"],"**Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/BaseProjection","Fx/Internal/Data/MapProjection","Fx/Internal/Data/QueryBaseNavigator"],"*Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/QueryListNavigator"],"*Fx/Internal/Data/QueryDemandLoadNavigator":["Fx/Internal/Utils/KnockoutArrayUtils","Fx/Internal/Data/PageMapProjection",
"Fx/Internal/Data/QueryDemandLoadNavigator"],"*Fx/Internal/Data/OData":["Fx/Internal/Data/OData"],"*Fx/Internal/Data/LifetimeMapProjection":["Fx/Internal/Data/LifetimeMapProjection"],"**Fx/Internal/Data/GroupNavigator":["Fx/Internal/Data/ClientFilters","Fx/Internal/Data/FilterProjection","Fx/Internal/Data/PageProjection"],"*Fx/Internal/Data/GroupNavigator":["Fx/Internal/Data/GroupProjection","Fx/Internal/Data/GroupNavigator"],"*Fx/Internal/Data/Expressions":["Fx/Internal/Data/Expressions"],"**Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/SortProjection","Fx/Internal/Data/ArrayBaseNavigator"],"*Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/ArrayListNavigator"],"*Fx/Internal/Data/ArrayDemandLoadNavigator":["Fx/Internal/Data/ContinuationProjection","Fx/Internal/Data/ArrayDemandLoadNavigator"],"*Fx/Internal/Controls/Grid2/Grid2":["Fx/Internal/Controls/Grid2/ViewModels.Grid2.Base","Fx/Internal/Controls/Grid2/ViewModels.Grid2.ContextMenu","Fx/Internal/Controls/Grid2/ViewModels.Grid2.DemandLoading",
"Fx/Internal/Controls/Grid2/ViewModels.Grid2.Editing","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Focus","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hover","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Grouping","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hierarchical","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Paging","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Reordering","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Resizing","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Scrolling","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Search","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Selection","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Sorting","Fx/Internal/Controls/Grid2/Grid2"],"*Fx/Internal/Composition/ViewModelAdapters":["Fx/Internal/Composition/ViewModelAdapters"],"*Fx/Internal/Composition/MenuBlade":["Fx/Internal/Composition/MenuBlade"],"*Fx/Internal/Commands/ListCommand":["Fx/Internal/Commands/ListCommand"],"*Fx/Cryptography":["Fx/Cryptography"],"*Fx/Controls/Validations":["Fx/Controls/Validations"],
"**Fx/Controls/TriStateCheckBox":["Fx/Internal/Controls/FormsBase"],"*Fx/Controls/TriStateCheckBox":["Fx/Controls/TriStateCheckBox"],"*Fx/Controls/Toolbar/MoveResourceToolbarButton":["Fx/Controls/Toolbar/MoveResourceToolbarButton"],"*Fx/Controls/TimePicker":["Fx/Controls/TimePicker"],"*Fx/Controls/TextBox":["Fx/Controls/TextBox"],"*Fx/Controls/TabControl":["Fx/Controls/TabControl"],"*Fx/Controls/Slider":["Fx/Controls/Slider"],"*Fx/Controls/Section":["Fx/Controls/Section"],"*Fx/Controls/RangeSlider":["Fx/Controls/RangeSlider"],"*Fx/Controls/RadioButtons":["Fx/Controls/RadioButtons"],"*Fx/Controls/PasswordBox":["Fx/Controls/PasswordBox"],"*Fx/Controls/OptionsGroup":["Fx/Controls/OptionsGroup"],"*Fx/Controls/NumericTextBox":["Fx/Controls/NumericTextBox"],"*Fx/Controls/MultiLineTextBox":["Fx/Controls/MultiLineTextBox"],"*Fx/Controls/FormBase":["Fx/Controls/FormBase"],"*Fx/Controls/FileUpload":["Fx/Controls/FileUpload"],"*Fx/Controls/Essentials":["Fx/Controls/Essentials"],"*Fx/Controls/DurationPicker":
["Fx/Controls/DurationPicker"],"*Fx/Controls/DropDown":["Fx/Controls/DropDown"],"*Fx/Controls/DayPicker":["Fx/Controls/DayPicker"],"*Fx/Controls/DateTimeRangePicker":["Fx/Controls/DateTimeRangePicker"],"*Fx/Controls/DateTimePicker":["Fx/Controls/DateTimePicker"],"*Fx/Controls/DatePicker":["Fx/Controls/DatePicker"],"*Fx/Controls/CustomHtml":["Fx/Controls/CustomHtml"],"*Fx/Controls/CheckBox":["Fx/Controls/CheckBox"],"*Fx/Composition/TemplatePart":["Fx/Composition/TemplatePart"],"**Fx/Composition/TemplateBlade":["Fx/Composition/BladeBase"],"*Fx/Composition/TemplateBlade":["Fx/Composition/TemplateBlade"],"*Fx/Composition/Permissions":["Fx/Composition/Permissions"],"*Fx/Composition/Pdl/Blade":["Fx/Composition/Pdl/Blade"],"*Fx/Composition/Part":["Fx/Composition/Part"],"*Fx/Composition/MenuBlade":["Fx/Controls/Menu","Fx/Composition/Pdl/MenuBlade","Fx/Composition/MenuBlade"],"*Fx/Composition/FrameBlade":["Fx/Composition/FrameBlade"],"*Fx/Composition/DataContext":["Fx/Composition/DataContext"],
"*Fx/Composition/Blade":["Fx/Composition/Blade"],"*Fx/Base/Base.Net.Batch":["Fx/Base/Base.Net.Batch"],"*Fx/Assets/Assets":["Fx/Assets/Assets"],"*Extensions/Hubs/PillList":["Extensions/Hubs/PillList"],"*primaryPartitioning":["primaryPartitioning"],"*secondaryPartitioning":["secondaryPartitioning"]}},{bundles:{"***0MsPortalImpl/Init":["Fx/Feedback","FxHubs/CloudNameCommon","FxHubs/HubsSettingsSchema","FxHubs/MarketplaceRpc","FxHubs/Permissions","FxHubs/ResourceProvider","FxHubs/RpcEndPoints"],"***MsPortalImpl/Widgets/Widgets.HelpPane":["Fx/Controls/Button"],"***MsPortalImpl/Parts/Parts.Frame":["Fx/Composition/ViewModelBase","Fx/Composition/PartBase","Fx/Composition/FramePart"],"***MsPortalImpl/Parts/Parts.Donut":["Fx/Controls/Legend"],"***MsPortalImpl/Controls/Forms/IntuneAppFileUpload":["Fx/Internal/Controls/IntuneAppFileUpload"],"***MsPortalImpl.Controls/Controls/Visualization/PairedTimeline":["Fx/Controls/PairedTimelineBadges","Fx/Controls/RangeSelection","Fx/Controls/PairedTimeline"],
"***MsPortalImpl.Controls/Controls/Visualization/MonitorChart/MonitorChart":["Fx/Internal/Controls/MonitorChart","Fx/Pinner"],"***MsPortalImpl.Controls/Controls/Markdown":["Fx/Controls/Video"],"***MsPortalImpl.Controls/Controls/Lists/Menu":["Fx/Controls/HotSpot"],"***MsPortalImpl.Controls/Controls/HeatMap":["Fx/Controls/Batch/HeatMap"],"*FxHubs/Dashboard":["FxHubs/Dashboard"],"*FxHubs/BrowseCuration":["FxHubs/BrowseCuration"],"*FxHubs/BrowseCollectionResourceItem":["FxHubs/BrowseCollectionResourceItem"],"*Fx/Specs/DropDown":["Fx/Specs/DropDown"],"**Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/BaseProjection","Fx/Internal/Data/MapProjection","Fx/Internal/Data/QueryBaseNavigator"],"*Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/QueryListNavigator"],"*Fx/Internal/Data/QueryDemandLoadNavigator":["Fx/Internal/Utils/KnockoutArrayUtils","Fx/Internal/Data/PageMapProjection","Fx/Internal/Data/QueryDemandLoadNavigator"],"*Fx/Internal/Data/OData":["Fx/Internal/Data/OData"],"*Fx/Internal/Data/LifetimeMapProjection":
["Fx/Internal/Data/LifetimeMapProjection"],"**Fx/Internal/Data/GroupNavigator":["Fx/Internal/Data/ClientFilters","Fx/Internal/Data/FilterProjection","Fx/Internal/Data/PageProjection"],"*Fx/Internal/Data/GroupNavigator":["Fx/Internal/Data/GroupProjection","Fx/Internal/Data/GroupNavigator"],"*Fx/Internal/Data/Expressions":["Fx/Internal/Data/Expressions"],"**Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/SortProjection","Fx/Internal/Data/ArrayBaseNavigator"],"*Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/ArrayListNavigator"],"*Fx/Internal/Data/ArrayDemandLoadNavigator":["Fx/Internal/Data/ContinuationProjection","Fx/Internal/Data/ArrayDemandLoadNavigator"],"*Fx/Internal/Controls/Grid2/Grid2":["Fx/Internal/Controls/Grid2/ViewModels.Grid2.Base","Fx/Internal/Controls/Grid2/ViewModels.Grid2.ContextMenu","Fx/Internal/Controls/Grid2/ViewModels.Grid2.DemandLoading","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Editing","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Focus","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hover",
"Fx/Internal/Controls/Grid2/ViewModels.Grid2.Grouping","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hierarchical","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Paging","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Reordering","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Resizing","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Scrolling","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Search","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Selection","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Sorting","Fx/Internal/Controls/Grid2/Grid2"],"*Fx/Internal/Composition/ViewModelAdapters":["Fx/Internal/Composition/ViewModelAdapters"],"*Fx/Internal/Composition/MenuBlade":["Fx/Internal/Composition/MenuBlade"],"*Fx/Internal/Commands/ListCommand":["Fx/Internal/Commands/ListCommand"],"*Fx/Cryptography":["Fx/Cryptography"],"*Fx/Controls/Validations":["Fx/Controls/Validations"],"**Fx/Controls/TriStateCheckBox":["Fx/Internal/Controls/FormsBase"],"*Fx/Controls/TriStateCheckBox":["Fx/Controls/TriStateCheckBox"],
"*Fx/Controls/Toolbar/MoveResourceToolbarButton":["Fx/Controls/Toolbar/MoveResourceToolbarButton"],"*Fx/Controls/TimePicker":["Fx/Controls/TimePicker"],"*Fx/Controls/TextBox":["Fx/Controls/TextBox"],"*Fx/Controls/TabControl":["Fx/Controls/TabControl"],"*Fx/Controls/Slider":["Fx/Controls/Slider"],"*Fx/Controls/Section":["Fx/Controls/Section"],"*Fx/Controls/RangeSlider":["Fx/Controls/RangeSlider"],"*Fx/Controls/RadioButtons":["Fx/Controls/RadioButtons"],"*Fx/Controls/PasswordBox":["Fx/Controls/PasswordBox"],"*Fx/Controls/OptionsGroup":["Fx/Controls/OptionsGroup"],"*Fx/Controls/NumericTextBox":["Fx/Controls/NumericTextBox"],"*Fx/Controls/MultiLineTextBox":["Fx/Controls/MultiLineTextBox"],"*Fx/Controls/FormBase":["Fx/Controls/FormBase"],"*Fx/Controls/FileUpload":["Fx/Controls/FileUpload"],"*Fx/Controls/Essentials":["Fx/Controls/Essentials"],"*Fx/Controls/DurationPicker":["Fx/Controls/DurationPicker"],"*Fx/Controls/DropDown":["Fx/Controls/DropDown"],"*Fx/Controls/DayPicker":["Fx/Controls/DayPicker"],
"*Fx/Controls/DateTimeRangePicker":["Fx/Controls/DateTimeRangePicker"],"*Fx/Controls/DateTimePicker":["Fx/Controls/DateTimePicker"],"*Fx/Controls/DatePicker":["Fx/Controls/DatePicker"],"*Fx/Controls/CustomHtml":["Fx/Controls/CustomHtml"],"*Fx/Controls/CheckBox":["Fx/Controls/CheckBox"],"*Fx/Composition/TemplatePart":["Fx/Composition/TemplatePart"],"**Fx/Composition/TemplateBlade":["Fx/Composition/BladeBase"],"*Fx/Composition/TemplateBlade":["Fx/Composition/TemplateBlade"],"*Fx/Composition/Permissions":["Fx/Composition/Permissions"],"*Fx/Composition/Pdl/Blade":["Fx/Composition/Pdl/Blade"],"*Fx/Composition/Part":["Fx/Composition/Part"],"*Fx/Composition/MenuBlade":["Fx/Controls/Menu","Fx/Composition/Pdl/MenuBlade","Fx/Composition/MenuBlade"],"*Fx/Composition/FrameBlade":["Fx/Composition/FrameBlade"],"*Fx/Composition/DataContext":["Fx/Composition/DataContext"],"*Fx/Composition/Blade":["Fx/Composition/Blade"],"*Fx/Base/Base.Net.Batch":["Fx/Base/Base.Net.Batch"],"*Fx/Assets/Assets":["Fx/Assets/Assets"],
"*Extensions/Hubs/PillList":["Extensions/Hubs/PillList"]}});define("MsPortalImpl.Controls/Controls/ResourceFilterHelper",["require","exports","f","i","ko","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function c(n){t.getOrSet(n.cloudName,[]).push(n)}function a(n){if(n){var i=t.get(n.cloudName),r=i&&i.first((function(t){return t.id===n.id}));r&&i.remove(r);i.length?t.set(n.cloudName,i):t.set(n.cloudName,[])}}function v(){return n.Internal.assetTypeService.assetTypes().forEach((function(n){c(n)})),t}function y(t,i){n.Internal.assetTypeService=t;t.assetTypes.subscribeArrayChanges(o,(function(n){c(n)}),(function(n){a(n)}));i.registerForDispose(o)}function p(n,r){var o=[],f,h;return r&&r.length?(f=u.observable(),o=r.map((function(n){return{name:n.compositeDisplayName.plural,key:n.resourceType.toLowerCase()}})),f(i.stableSort(o,(function(n,t){return n.name.localeCompareIgnoreCase(t.name)}))),f):(f=s.get(n),f||(f=u.observable(),s.set(n,f),h=t.get(n)?t:v(),o=(h.get(n)||
[]).filter((function(n){var t=n.assetTypeManifest.browseType;return(t===1||t===4)&&n.lowerCaseResourceType!==e.Constants.ResourceTypes.ResourceGroups.toLowerCase()})).map((function(n){return{name:n.compositeDisplayName.plural,key:n.lowerCaseResourceType}})),f(i.stableSort(o,(function(n,t){return n.name.localeCompareIgnoreCase(t.name)})))),f)}function w(n){var t=h.get(n),u;return t?Q.resolve(t):(u=[],Q(f.Location.locationEndpoint.invoke(r.Rpc.client,e.Constants.ExtensionNames.Hubs,{cloudName:n,onlyAllowedRegions:!0})).then((function(r){return i.forEachKey(r,(function(n,t){u.push({displayName:t,name:n})})),t=i.stableSort(u,(function(n,t){return n.displayName.localeCompareIgnoreCase(t.displayName)})),h.set(n,t),Q.resolve(t)})))}var e=i.Base,l=r.TriggerableLifetimeManager,o=new l;n.Internal={};var t=r.getCloudMap(),s=r.getCloudMap(),h=r.getCloudMap();n.initialize=y;n.getResourceTypes=p;n.getLocations=w})(e||(e={})),e}));define("MsPortalImpl/Services/Services.SelectedSubscriptions",["require","exports","f",
"i","a","ko","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){function g(){h=r.getCloudMap();t=r.getCloudMap()}function nt(t){var i=(t||[]).map((function(n){return n.subscriptionId})).join(";");n.userSettingsManager.setSetting(d,w,i)}function lt(n,t){var r=(n.state||"").toLowerCase(),u=(t.state||"").toLowerCase(),i;if(r!==u){if(r===b)return 1;if(u===b)return-1}return i=n.displayName.localeCompareIgnoreCase(t.displayName),i===0&&(i=n.subscriptionId.localeCompareIgnoreCase(t.subscriptionId)),i}function c(n,t){var u=n||[],r=[],f;return t&&t.length&&(f=i.convertArrayToMap(t,(function(n){return n})),r=u.filter((function(n){return!!f[n.subscriptionId]}))),(r.length?r:u).stableSort(lt)}function at(t){g();n.userSettingsManager=t;rt.getSelectedSubscriptionsEndPoint.register(u.client,null,(function(n,t){return t.srcWindowId!==v.Shell&&t.srcWindowId!==y.getHubsWindowId()&&(n=y.getDescriptor(t.
srcWindowId).cloudName),tt(n)}));n.selectedSubsUpdateTriggered.subscribe(ct,(function(n){et.pingSelectedSubscriptionsListEndPoint.invoke(u.client,ht,n)}))}function tt(i){var r=h.get(i),f;return r?Q(r):(t.get(i)||(f=Q(l.getAllSubscriptions(u.client,i)).then((function(t){return n.userSettingsManager.querySetting(d,w).then((function(r){var e=(r||"").split(";"),u=c(t,e),f;return u.length>n.selectedSubscriptionsCap&&(u=u.slice(0,n.selectedSubscriptionsCap),nt(u),f=t.length,ot.publish({status:st.Information,title:k.cappedTitleFmt.format(n.selectedSubscriptionsCap,f),description:k.cappedFmt.format(n.selectedSubscriptionsCap,f),uri:"#menu/settings"})),h.set(i,u),u}))})),t.set(i,f.catch((function(n){return t.set(i,null),Q.reject(n)})))),t.get(i))}function vt(t,i){return l.getAllSubscriptions(u.client,i).then((function(r){var u=c(r,t);h.set(i,u);n.selectedSubsUpdateTriggered({cloudName:i,selectedSubscriptions:u});nt(u.length===r.length?[]:u)}))}var l=r.Azure,it=e.Keys,a=r,rt=a.Azure,ut=i.Base,v=ut.Constants,
u=r.Rpc,ft=a.TriggerableLifetimeManager,et=o.SelectedSubscriptions,y=r.Extension,p=i.Hubs.Notifications,ot=p.ClientNotification,st=p.NotificationStatus,w=it.subscriptionsSelected,b="disabled",ht=v.ExtensionNames.Hubs;n.selectedSubscriptionsCap=60;var k=s.SubscriptionsNotification,d=6,ct=new ft,t,h;n.selectedSubsUpdateTriggered=f.observable();n.resetState=g;n.getValidSelectedSubscriptions=c;n.init=at;n.getSelectedSubscriptions=tt;n.setSelectedSubscriptions=vt})(h||(h={})),h}));define("MsPortalImpl/Services/Services.Settings",["require","exports","f","o","ko","FxHubs/HubsSettingsSchema","./Services.Settings.Schema","MsPortalImpl/Resources/ImplScriptResources","./Services.Storage"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function k(n){return function(t){this[t]=n}}function ot(){var n={};return e.generalSettingsKeys.forEach(k(!0),n),n}function pt(){return i.map(c,i.identity)}function wt(n){return l[n+1e3]}function bt(n){return c[n]}function kt(n){var t={manager:new w.
InMemorySettingsManagerImpl,stores:[8,9,13,]};return w.createUserSettingsManager(new w.UserSettingsManagerImpl(n),[t])}function dt(n,t){if(!t||!t.length)return Q({});var i=t.map(n.queryStore,n);return Q.all(i).then((function(n){var i={};return n.forEach((function(n,r){i[t[r]]=n})),i}))}var h=i.Base,ut=h.Constants,ft=h.Diagnostics,a=i.Hubs.Notifications.NotificationStatus,et=h.Net2,st=window,d=st.fx,f=o.Services.Settings,b=d.environment,g=i.isFeatureEnabled,ht=g("inmemorysettings"),v=b.version,nt=h.getVersionFromString(v),y=b.settingsBaseUri+"{0}"+b.settingsUriQuery,ct=y.format("/Update"),lt=y.format("/Select"),at=y.format("/Clear"),vt=y.format("/ClearAll"),p=ft.createLog(n),tt=e.settingsVersionSettingKey,it=ot(),rt=d.early,yt=rt&&rt.preloadSettings,c,l,w;nt.revision=0;c={General:0,Blade:1,Part:2,LensState:3,Startboard:4,SharedPart:5,HubsExtension:6,CrossTenant:7,JourneySession:8,EditScopeSession:9,Favorites:10,DashboardInventory:11,FileUpload:12};l=[];i.forEachKey(c,(function(n,t){l[t]=n})),
(function(){for(var t,i,n=0;n<100;n++)t="Dashboard"+n,i=n+1e3,c[t]=i,l[i]=t})();t.getAllStoreIds=pt;t.getDashboardStoreName=wt;t.getDashboardStoreId=bt;t.createUserSettingsManager=kt;t.queryStores=dt,(function(n){function kt(n,t,i){return new d(new b(new y(w.createWithWriteDeleteBufferTimeout(n,i),t)))}function o(n){var t=l[n];if(!t)throw new Error("Invalid store: "+n);return t}function ft(n){var i={},t;return n.keys.forEach(k(null),i),t={},t[n.store]=i,t}function dt(n,t){var u=i.merge(n,t),r={settingsToSet:{},settingsToDelete:{}};return r=u.reduce((function(n,t){return c(n.settingsToSet,n.settingsToDelete,t.settingsToSet),c(n.settingsToDelete,n.settingsToSet,t.settingsToDelete),n}),r),[r]}function c(n,t,r){r&&i.forEachKey(r,(function(u){var f=parseInt(u),o=r[f],e;n&&(n[f]||(n[f]={}),ot(o,n[f]));t&&(e=t[f],e&&(st(o,e),i.isEmpty(e)&&delete t[f]))}))}function ot(n,t){i.forEachKey(n,(function(n,i){t[n]=i}))}function st(n,t){i.forEachKey(n,(function(n){delete t[n]}))}function pt(n,t,i){var r={};return r[
t]=i,{store:n,settings:r}}function rt(n){return JSON.parse(JSON.stringify(n))}var e,t,wt,y,bt,w,b,d;n.createUserSettingsManager=kt;n.getSettingStoreName=o;n.convertSettingQueryToDictionary=ft;n.updateDictionary=c;n.updateSettingsDictionary=ot;n.sanitizeSettingsDictionary=st;e=(function(){function n(){this._eventsTriggered=u.observableArray()}return r.defineProperty(n.prototype,"eventsTriggered",{get:function(){var n=this._baseManager;return n?n.eventsTriggered:this._eventsTriggered},enumerable:!0,configurable:!0}),n.prototype._fireEvent=function(n,t,i){var r={status:i,title:n,description:t,timestamp:new Date,cloudName:ut.DefaultCloudName};this.eventsTriggered.push(r)},n.prototype._fireError=function(n){this._fireEvent(f.useInMemorySettings,n||f.settingsCallFailed,a.Error)},n})();n.SettingsManagerVeryBase=e;t=(function(n){function t(t){n.call(this);this._baseManager=t}return __extends(t,n),t.prototype.flushSettings=function(){return this._baseManager?this._baseManager.flushSettings():Q()},
t.prototype.dispose=function(){this._baseManager&&(this._baseManager.dispose(),this._baseManager=null)},t})(e);n.SettingsManagerBase=t;wt=(function(n){function t(){n.apply(this,arguments);this._maps={}}return __extends(t,n),t.prototype.setSettings=function(n){var t=n.settings,r;t&&(r=this._getMap(n.store),i.forEachKey(t,(function(n,t){r.set(n,JSON.stringify(t))})))},t.prototype.queryStore=function(n){var i=this._getMap(n),t={};return i.forEach((function(n,i){t[i]=JSON.parse(n)})),Q(t)},t.prototype.deleteSettings=function(n){if(n.keys){var t=this._getMap(n.store);n.keys.forEach((function(n){t.delete(n)}))}},t.prototype.clearSettings=function(){return Q(this._maps={})},t.prototype._getMap=function(n){return this._maps[n]=this._maps[n]||new i.Map},t})(t);n.InMemorySettingsManagerImpl=wt;y=(function(n){function t(t,i){n.call(this,t);this._initialize(i)}return __extends(t,n),t.prototype.queryStore=function(n){return this._getManager(n).queryStore(n)},t.prototype.deleteSettings=function(n){this._getManager(
n.store).deleteSettings(n)},t.prototype.setSettings=function(n,t){this._getManager(n.store).setSettings(n,t)},t.prototype.clearSettings=function(){return Q.all(this._managers.map((function(n){return n.clearSettings()})))},t.prototype._initialize=function(n){var t=this;this._managersDictionary={};this._managers=[this._baseManager];n&&n.forEach((function(n){t._managers.push(n.manager);n.stores.forEach((function(i){t._managersDictionary[i]=n.manager}))}))},t.prototype._getManager=function(n){return this._managersDictionary[n]||this._baseManager},t})(t);n.RoutingSettingsManager=y;bt=(function(n){function t(t,r){var f=this,u;r===void 0&&(r=yt);n.call(this);this._didSettingsCallFail=!1;this._storageService=t;r&&(u={},i.forEachKey(r,(function(n,t){u[n]=Q(t).catch((function(t){return p.error(t,1,"Failed to preload store '"+n+"'."),delete u[n],f._queryStoreInternal(n)}))})),this._preloadStores=u)}return __extends(t,n),t.prototype._ajax=function(n,t){var i=this;return Q(et.ajaxExtended({uri:n,headers:{"x-ms-user-settings-session":
this._storageService.getValue(s.ComponentName.UserSettingsService,"x-ms-user-settings-session",1)||""},type:"POST",dataType:"json",data:t&&JSON.stringify(t),contentType:"application/json;charset=utf-8",performRetry:!0})).then((function(n){return i._storageService.setValue(s.ComponentName.UserSettingsService,"x-ms-user-settings-session",n.jqXHR.getResponseHeader("x-ms-user-settings-session"),1),n}))},t.prototype._queryStoreInternal=function(n){var t=this,i=Date.now();return this._ajax(lt,[n]).then((function(t){var u=t&&t.content&&t.content[n]||{},r=Date.now()-i;return r>5e3&&p.warning("Request to store '"+n+"' took more than 5s to complete.\n                                                        Request time: "+r+"ms.\n                                                        Response size: "+(t&&t.jqXHR&&t.jqXHR.responseText.length)),u}),(function(){return t._didSettingsCallFail=!0,t._fireEvent(f.useInMemorySettings,f.querySettingsCallFailed,a.Error),Q({})}))},t.prototype.queryStore=function(
n){var t=o(n),i,r;return this._didSettingsCallFail?(p.error("Failed to query store '"+t+"'.",1),Q({})):(i=this._preloadStores,r=i&&i[t],r||this._queryStoreInternal(t))},t.prototype.clearSettings=function(){var n=this;return this._clearPreloadPromises(),this._ajax(g("clearallusersettings")?vt:at).catch((function(){n._fireError(f.clearSettingsCallFailed)}))},t.prototype.updateSettings=function(n){var t=this;if(this._didSettingsCallFail)return Q();var r=!1,u=function(n){var u={};return i.forEachKey(n||{},(function(n,i){var e=o(n),f;u[e]=i;f=t._preloadStores;f&&delete f[e];r=!0})),u},f={save:u(n.settingsToSet),remove:u(n.settingsToDelete)};return r?this._ajax(ct,f).catch((function(n){return t._didSettingsCallFail=!0,Q.reject(n)})):Q()},t.prototype._clearPreloadPromises=function(){var n=this._preloadStores;n&&r.keys(n).forEach((function(t){delete n[t]}))},t})(e);n.UserSettingsManagerImpl=bt;w=(function(n){function t(t,i,r,u){var f=this;n.call(this,null);this._primitiveSettingsManager=t;this._sequencer=
i(dt,(function(n){return f._executeMethod(n[0])}),r,!0,{optionalDataInterval:u})}return __extends(t,n),t.createWithWriteDeleteBufferTimeout=function(n,i,r){var u=i!==undefined?i:5e3,f=r!==undefined?r:3e5;return new t(n,function(n,t,i,r,u){return new h.Debouncer(n,t,i,r,u)},u,f)},t.prototype.queryStore=function(n){return this._primitiveSettingsManager.queryStore(n)},t.prototype.setSettings=function(n,t){if(!i.isEmpty(n.settings)){var r={};r[n.store]=n.settings;this._sequencer.execute([{settingsToSet:r,settingsToDelete:{}}],t===1)}},t.prototype.deleteSettings=function(n,t){n.keys&&n.keys.length&&this._sequencer.execute([{settingsToDelete:ft(n),settingsToSet:{}}],t===1)},r.defineProperty(t.prototype,"eventsTriggered",{get:function(){return this._primitiveSettingsManager.eventsTriggered},enumerable:!0,configurable:!0}),t.prototype.flushSettings=function(){return this._sequencer.flush()},t.prototype.clearSettings=function(){var t=this,n=Q.defer();return this.flushSettings().finally((function()
{t._primitiveSettingsManager.clearSettings().finally((function(){n.resolve()}))})),n.promise},t.prototype.dispose=function(){this.flushSettings();n.prototype.dispose.call(this)},t.prototype._executeMethod=function(n){return this._primitiveSettingsManager.updateSettings(n)},t})(t);n.SequencingSettingsManager=w;b=(function(n){function t(t){n.call(this,t);this._cache={};this._cachedStores={};this._activeQueryPromises={};this._activeUpdatePromises={};this._isSettingsVersionChecked=!1;this._isSettingsVersionVerified=!1;this._uniqueId=1}return __extends(t,n),t.prototype.queryStore=function(n){var r=this,t,u;return this._belongsToCache(n)?Q(this._getSettingsFromCache(n)):(t=this._activeQueryPromises,u=t[n],u||(u=i.tryImmediateResolve(this._canCallBaseManager(),(function(i){return!i||r._belongsToCache(n)?r._getSettingsFromCache(n):t[n]||(t[n]=r._baseManager.queryStore(n).then((function(t){return r._updateCaches(n,t)})).finally((function(){t[n]=null})))}))),u)},t.prototype.setSettings=function(n,t,i){this.
_execute(this._setSettingsInternal,n,t,i)},t.prototype._setSettingsInternal=function(n,t,i,r){var f=this,u=this._writeSettingsToCache(n,!0);r?(this._baseManager.setSettings(u,t),this._resolveSetPromise(i)):this._executeIfBaseManagerCallIsAllowed((function(){f._baseManager.setSettings(u,t)}),i)},t.prototype._resolveSetPromise=function(n){this._activeUpdatePromises[n].resolve();delete this._activeUpdatePromises[n]},t.prototype._execute=function(n,t,i,r){var o=this,e=this._uniqueId++,u,f;this._activeUpdatePromises[e]=Q.defer();t&&(u=t.store,f=[t,i,e,r],this._belongsToCache(u)?n.apply(this,f):this.queryStore(u).then((function(){n.apply(o,f)})))},t.prototype.deleteSettings=function(n,t){this._execute(this._deleteSettingsInternal,n,t)},t.prototype._deleteSettingsInternal=function(n,t,i){var r=this;this._deleteSettingsFromCache(n);this._executeIfBaseManagerCallIsAllowed((function(){r._baseManager.deleteSettings(n,t)}),i)},t.prototype.clearSettings=function(){var t=this,i=this._baseManager?this._baseManager.
clearSettings():Q(),n=Q.defer();return this.flushSettings().finally((function(){i.finally((function(){t._cache={};n.resolve()}))})),n.promise},t.prototype.flushSettings=function(){var t=this,n=r.keys(this._activeUpdatePromises).map((function(n){return t._activeUpdatePromises[parseInt(n)].promise})),i=function(){return t._baseManager.flushSettings()};return n&&n.length?Q.all(n).finally(i):i()},t.prototype._updateCaches=function(n,t){return this._cachedStores[n]=!0,this._writeSettingsToCache({store:n,settings:t}),this._cache[n]},t.prototype._canCallBaseManager=function(){return this._isSettingsVersionChecked?Q(this._isSettingsVersionVerified):(this._settingsVerificationPromise||(this._settingsVerificationPromise=this._verifySettings()),this._settingsVerificationPromise)},t.prototype._verifySettings=function(){var n=this,t=0;return ht||!this._baseManager?(this._fireEvent(f.useInMemorySettings,this._baseManager?f.inMemorySettingsMode:f.noBaseManager,a.Warning),this._isSettingsVersionVerified=!1,
this._isSettingsVersionChecked=!0,Q(!1)):i.tryImmediateResolve(this._baseManager.queryStore(t),(function(i){var r=i[tt],u;return r?(u=h.getVersionFromString(r),u.revision=0,n._isSettingsVersionVerified=nt.compareTo(u)>=0):n._isSettingsVersionVerified=!0,n._isSettingsVersionChecked=!0,n._isSettingsVersionVerified?(n._updateCaches(t,i),n.setSettings(pt(t,tt,v),0,!0),n._processGeneralSettings(i),!0):(n._fireEvent(f.useInMemorySettings,f.portalVersionMismatch.format(r,v),a.Warning),p.error("Current version '"+v+"' does not match with the version '"+r+"' saved in user settings",3),!1)}))},t.prototype._executeIfBaseManagerCallIsAllowed=function(n,t){if(!this._isSettingsVersionChecked)throw new Error("_canCallBaseManagerSync has been called before completing async verification.");this._isSettingsVersionVerified&&n();this._resolveSetPromise(t)},t.prototype._deleteSettingsFromCache=function(n){var t=this._cache[n.store];n.keys&&t&&n.keys.forEach((function(n){delete t[n]}))},t.prototype._getSettingsFromCache=
function(n){return this._cache[n]||(this._cache[n]={}),this._cache[n]},t.prototype._belongsToCache=function(n){return!!this._cachedStores[n]},t.prototype._writeSettingsToCache=function(n,t){if(n){var r=this._cache[n.store]||(this._cache[n.store]={}),u={};return n.settings&&i.forEachKey(n.settings,(function(n,i){t&&(r[n]===i||JSON.stringify(r[n])===JSON.stringify(i))||(r[n]=u[n]=i)})),{store:n.store,settings:u}}return null},t.prototype._processGeneralSettings=function(n){if(n){var t=r.keys(n).filter((function(n){return!it[n]}));t.length&&this.deleteSettings({store:0,keys:t})}},t})(t);n.CachingSettingsManagerImpl=b;d=(function(n){function t(t){n.call(this,t)}return __extends(t,n),t.prototype.queryStore=function(n,t){return this._baseManager.queryStore(n).then((function(n){return t?n:rt(n)}))},t.prototype.querySettings=function(n){return n.keys&&n.keys.length>0?this.queryStore(n.store,!0).then((function(t){var i={},r;return t&&(r=n.keys.filter((function(n){return n in t})),r.forEach((function(n){i[n]=
t[n]}))),rt(i)})):this.queryStore(n.store)},t.prototype.querySetting=function(n,t){return this.querySettings({store:n,keys:[t]}).then((function(n){if(n){var i=n[t];return i===undefined?null:i}return null}))},t.prototype.setSettings=function(n,t){this._baseManager.setSettings(rt(n),t)},t.prototype.setSetting=function(n,t,i,r){this.setSettings(pt(n,t,i),r)},t.prototype.deleteSettings=function(n,t){this._baseManager.deleteSettings(n,t)},t.prototype.clearSettings=function(){return this._baseManager.clearSettings()},t})(t);n.ExtendedSettingsManager=d})(w=t.Internal||(t.Internal={}))})(h||(h={})),h}));define("MsPortalImpl/Base/Base.GenericPopup",["require","exports"],(function(){"use strict";var n;return (function(n){function i(n){var i=t.open("about:blank","_blank","location=no,toolbar=no,menubar=no");if(i)return n.provideText().then((function(n){$(i).ready((function(){var t=i.document.createElement("pre");t.className="fxs-popup-diagnostics";t.textContent=n;i.document.body.appendChild(t)}))}))}var t=window;
n.showPopup=i})(n||(n={})),n}));define("MsPortalImpl/Base/Base.KnockoutExtensions",["require","exports","f","ko","$"],(function(n,t,i,r,u){"use strict";var f;return (function(){var n=i.Base.EventTypes;r.bindingHandlers.commands={update:function(t,i){var e=u(t),f=i(),o,s;if(f&&f.group){e.on(n.fxcontextmenurequest,o=function(t){var o,i;o=r.unwrap(f.viewModel);i=u.Event(n.fxrightclick);i.clientX=t.clientX;i.clientY=t.clientY;e.trigger(i,{commandGroup:f.group,viewModel:o,entityType:2});t.preventDefault();t.stopPropagation()});r.utils.domNodeDisposal.addDisposeCallback(t,s=function(){e.off(n.fxcontextmenurequest,o)})}}}})(f||(f={})),f}));define("MsPortalImpl/Controls/ControlBindings.Async",["require","exports","ko","../Widgets/Widgets.Common"],(function(n,t,i,r){"use strict";var u;return (function(n){function o(n,t,i,r){e.push({name:t,moduleId:n+i,initOptions:r})}function t(n,t,i){o("MsPortalImpl.Controls/",n,t,i)}function u(n,t,i){o("MsPortalImpl/Controls/",n,t,i)}function s(t){n.portalControlBindings.
forEach((function(n){i.bindingHandlers[n.name]=r.getAsyncBindingHandler(n.moduleId,n.initOptions,t)}))}var e=[],f={controlsDescendantBindings:!1};t("pcButton","Controls/Forms/Button",f);t("pcChart","Controls/Visualization/Chart");t("pcCheckBoxField","Fields/CheckBoxField");t("pcConsole","Controls/Console");t("pcConsoleV2","Controls/ConsoleV2");t("pcCopyableLabel","Controls/Forms/CopyableLabel");t("pcCreatorAndSelector","Fields/CreatorAndSelectorField");t("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2");t("pcCsmTopology","Controls/Visualization/CsmTopology");t("pcCustomHtmlField","Fields/CustomHtmlField");t("pcCustomValueSlider","Fields/CustomValueSliderField");t("pcCustomRangeSlider","Fields/CustomRangeSlider");t("pcDatePickerField","Fields/DatePickerField");t("pcDateTimeCombo","Controls/Forms/DateTimeCombo");t("pcDateTimeComboField","Fields/DateTimeComboField");t("pcDateTimePickerField","Fields/DateTimePickerField");t("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField");
t("pcDayPickerField","Fields/DayPickerField");t("pcDiffEditor","Controls/Documents/DiffEditor");t("pcDiffList","Controls/Documents/DiffList");t("pcDiffView","Controls/Documents/DiffView");t("pcDiscussionTimeline","Controls/Documents/DiscussionTimeline");t("pcDockedBalloon","Controls/DockedBalloon");t("pcDonut","Controls/Visualization/Donut");t("pcDropDownField","Fields/DropDownField");t("pcDurationPickerField","Fields/DurationPickerField");t("pcEditor","Controls/Documents/Editor");t("pcFileUpload","Controls/Forms/FileUpload");t("pcFilterComboField","Fields/FilterComboField");t("pcFormSection","Fields/SectionField",f);t("pcGallery","Controls/Lists/List1/Gallery");t("pcGauge","Controls/Visualization/Gauge");t("pcGraph","Controls/Visualization/Graph");t("pcGrid","Controls/Lists/Grid1/Grid1");t("pcGrid2","Controls/Lists/Grid2/Controls.Grid2");t("pcGroupDropDown","Controls/Forms/Obsolete.GroupDropDown");t("pcHeatMap","Controls/HeatMap");t("pcHtmlEditorField","Fields/HtmlEditorField");t("pcIFrame",
"Controls/IFrame");t("pcIFrame2","Controls/IFrameV2");t("pcLegend","Controls/Visualization/Legend");t("pcListView","Controls/Lists/List1/ListView");t("pcLogStream","Controls/LogStream");t("pcMap","Controls/Visualization/Map");t("pcMapV2","Controls/Visualization/MapV2");t("pcMediaPlayer","Controls/AzureMediaPlayer");t("pcMenu","Controls/Lists/Menu");t("pcMetrics","Controls/Visualization/Metrics");t("pcMonitorChart","Controls/Visualization/MonitorChart/MonitorChart");t("pcMultiLineTextField","Fields/MultiLineTextField");t("pcMultiselectDropDownField","Fields/MultiselectDropDownField");t("pcNumericTextBoxField","Fields/NumericTextBoxField");t("pcOAuthButtonField","Fields/OAuthButtonField");t("pcOptionsGroupField","Fields/OptionsGroupField");t("pcPairedTimeline","Controls/Visualization/PairedTimeline");t("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges");t("pcPartPinner","Controls/PartPinner");t("pcPasswordField","Fields/PasswordField");t("pcPreviewTag","Controls/PreviewTag");
t("pcProgressBar","Controls/Visualization/ProgressBar");t("pcQueryBuilder","Controls/Data/QueryBuilder");t("pcQuotaGauge","Controls/Visualization/QuotaGauge");t("pcRangeSliderField","Fields/RangeSliderField");t("pcScrollbar","Controls/Scrollbar",f);t("pcSearchBox","Controls/SearchBox");t("pcResourceFilter","Controls/ResourceFilter");t("pcSection","Fields/Section");t("pcSelector","Controls/Forms/Selector");t("pcSelectorField","Fields/SelectorField");t("pcSettings","Controls/Settings");t("pcSimpleButton","Controls/SimpleButton");t("pcSingleSetting","Controls/SingleSetting");t("pcSingleValueGauge","Controls/Visualization/SingleValueGauge");t("pcSliderField","Fields/SliderField");t("pcSpecComparisonTable","Controls/SpecComparisonTable");t("pcSplitter","Fields/Splitter",f);t("pcStringListField","Fields/StringListField");t("pcTerminalEmulator","Controls/TerminalEmulator");t("pcTextBlock","Controls/TextBlock");t("pcTextBox","Controls/Forms/TextBox");t("pcTextField","Fields/TextField");t("pcTimePickerField",
"Fields/TimePickerField");t("pcToolbar","Controls/Toolbars/Toolbar");t("pcTreeView","Controls/Lists/Tree1/TreeView");t("pcTriStateCheckBox","Fields/TriStateCheckBox");t("pcMarkdown","Controls/Markdown");t("pcVideo","Controls/Video");u("pcAsyncFileUpload","Forms/AsyncFileUpload");u("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation");u("pcEssentials","Controls.Essentials");u("pcFileDownloadButton","Controls.FileDownloadButton");u("pcFileUploadWidget","Forms/Controls.FileUpload");u("pcGroupDropDownField","Forms/GroupDropDown");u("pcHeroBanner","Controls.HeroBanner");u("pcHotSpot","Controls.HotSpot",f);u("pcInfoBox","Controls.InfoBox");u("pcNotice","Controls.Notice");u("pcPicker","Controls.Picker");u("pcPickerV3","Controls.PickerV3");u("pcPillList","Controls.PillList");u("pcTokenComboBox","Forms/Controls.TokenComboBox");u("pcWizard","Controls.Wizard");u("pcIntuneAppFileUpload","Forms/IntuneAppFileUpload");n.portalControlBindings=e;n.initialize=s})(u||(u={})),u}));define("MsPortalImpl/Services/Services.PortalIdleState",
["require","exports","f"],(function(){"use strict";var n;return (function(n){function r(){return new t.PortalIdleStateServiceImpl(window,i)}var t,i;(function(n){var t=(function(){function n(n,t){var i=this;this._win=n;this._defaultPollMS=t;this._state=0;this._handleId=1;this._iteration=0;this._actions=[];this._win.addEventListener("blur",this._blurFunc=function(){i._state=1;i._processCallbacks(i._defaultPollMS)});this._win.addEventListener("focus",this._focusFunc=function(){i.signalBusy()})}return n.prototype.dispose=function(){var n=this._win;return n?(this._win=null,n.removeEventListener("blur",this._blurFunc),n.removeEventListener("focus",this._focusFunc),this._state=0,!0):!1},n.prototype.addCallbacks=function(n){var t=this._handleId++;return this._actions.push({key:t,value:n}),t},n.prototype.removeCallbacks=function(n){var t=this._actions,i=t.firstIndex((function(t){return n===t.key}));return i!==-1?(t.splice(i,1),!0):!1},n.prototype.signalBusy=function(){this._state===1&&(this._state=2,
this._processCallbacks(5e3))},n.prototype.signalIdle=function(){this._state=1;this._processCallbacks(0)},n.prototype._processCallbacks=function(n){var t=this,i;this._win&&(i=this._timeoutHandle,i&&this._win.clearTimeout(i),this._timeoutHandle=this._win.setTimeout((function(){t._timeoutHandle=null;try{t._processIteration()}finally{t._state!==0&&t._processCallbacks(t._defaultPollMS)}}),n))},n.prototype._processIteration=function(){var f=this,t,n;switch(this._state){case 2:this._state=0;t=function(n){n.onBusy(new Date)};break;case 1:this._state=1;t=function(n){n.onIdle(new Date)};break;default:case 0:return}var i=function(n){var i=f._actions[n];i&&t(i.value)},r=this._actions.length,u=this._iteration%r;for(this._iteration++,n=u;n<r;n++)i(n);for(n=0;n<u;n++)i(n)},n})();n.PortalIdleStateServiceImpl=t})(t=n.Internal||(n.Internal={}));i=18e5;n.createInstance=r})(n||(n={})),n}));define("MsPortalImpl/Controls/ControlBindings",["require","exports","ko"],(function(n,t,i){"use strict";var r;return (function(
){function n(n,i){t[n]=i}function f(n,t){var r=i.unwrap(n()),f;if(r){if(f=t[r.controlType],!f)throw new Error("Unsupported ControlType in formControl binding handler: "+r.controlType+".");return u[f]}}function e(n,t,i,r,u,e){var s=f(t,e),o;if(s)return o=$(n),o.attr("data-formelement",o.attr("data-bind")),s.init(n,t,i,r,u)}function o(n,t,i,r,u,e){if(n){var o=f(t,e);if(o)return o.update(n,t,i,r,u)}}var u=i.bindingHandlers,t={},r;n(20,"pcArtifactLinks");n(106,"pcAsyncFileUpload");n(16,"pcAttachment");n(38,"pcButton");n(63,"pcChart");n(7,"pcCheckBoxField");n(75,"pcConsole");n(90,"pcConsoleV2");n(40,"pcCopyableLabel");n(83,"pcCreatorAndSelector");n(85,"pcCreatorAndSelectorV2");n(64,"pcCsmTopology");n(23,"pcCustomHtmlField");n(91,"pcCustomValueSlider");n(111,"pcCustomRangeSlider");n(25,"pcDatePickerField");n(14,"pcDateTimeComboField");n(26,"pcDateTimePickerField");n(27,"pcDateTimeRangePickerField");n(92,"pcDayPickerField");n(76,"pcDeleteAssetConfirmation");n(33,"pcDiffEditor");n(34,"pcDiffList");
n(35,"pcDiffView");n(36,"pcDiscussionTimeline");n(32,"pcDockedBalloon");n(65,"pcDonut");n(3,"pcDropDownField");n(99,"pcDurationPickerField");n(15,"pcSection");n(37,"pcEditor");n(120,"pcEssentials");n(82,"pcFileDownloadButton");n(28,"pcFileUpload");n(81,"pcFileUploadWidget");n(12,"pcFilterComboField");n(55,"pcGallery");n(66,"pcGauge");n(67,"pcGraph");n(103,"pcGrid2");n(98,"pcGroupDropDownField");n(77,"pcHeroBanner");n(19,"pcHistory");n(84,"pcHotSpot");n(18,"pcHtmlEditorField");n(108,"pcIFrame");n(113,"pcIFrame2");n(78,"pcInfoBox");n(121,"pcIntuneAppFileUpload");n(118,"pcLegend");n(88,"pcHotSpot");n(87,"pcInfoBox");n(104,"pcList2");n(58,"pcLogStream");n(68,"pcMap");n(96,"pcMapV2");n(109,"pcMediaPlayer");n(115,"pcMenu");n(69,"pcMetrics");n(122,"pcMonitorChart");n(13,"pcMultiLineTextField");n(8,"pcMultiselectDropDownField");n(79,"pcNotice");n(10,"pcNumericTextBoxField");n(29,"pcOAuthButtonField");n(4,"pcOptionsGroupField");n(70,"pcPairedTimeline");n(94,"pcPairedTimelineBadges");n(5,"pcPasswordField");
n(39,"pcCheckBox");n(41,"pcDateTimeCombo");n(42,"pcDropDown");n(43,"pcFilterCombo");n(54,"pcGrid");n(44,"pcGroupDropDown");n(56,"pcListView");n(110,"pcMarkdown");n(45,"pcMultiLineTextBox");n(46,"pcMultiselectDropDown");n(47,"pcNumericTextBox");n(48,"pcOptionPicker");n(49,"pcPassword");n(50,"pcRangeSlider");n(51,"pcSelector");n(52,"pcSlider");n(53,"pcTextBox");n(57,"pcTreeView");n(112,"pcPartPinner");n(80,"pcPicker");n(123,"pcPillList");n(89,"pcPreviewTag");n(71,"pcProgressBar");n(31,"pcQueryBuilder");n(72,"pcQuotaGauge");n(9,"pcRangeSliderField");n(59,"pcScrollbar");n(93,"pcSearchBox");n(114,"pcResourceFilter");n(1,"pcFormSection");n(11,"pcSelectorField");n(60,"pcSettings");n(100,"pcSimpleButton");n(97,"pcChart");n(61,"pcSingleSetting");n(73,"pcSingleValueGauge");n(6,"pcSliderField");n(95,"pcSpecComparisonTable");n(21,"pcSplitter");n(17,"pcStringListField");n(102,"pcTerminalEmulator");n(101,"pcTextBlock");n(2,"pcTextField");n(24,"pcTimePickerField");n(30,"pcTokenComboBox");n(62,"pcToolbar");
n(105,"pcTree2");n(22,"pcTriStateCheckBox");n(116,"pcVideo");n(107,"pcWizard");n(119,"pcHeatMap");r={};[20,16,7,83,85,23,91,111,25,14,26,27,92,3,99,15,120,81,12,98,19,18,108,113,110,13,8,10,29,4,5,123,89,9,1,11,6,21,17,2,112,24,30,22].forEach((function(n){return r[n]=t[n]}));u.pcControl={init:function(n,i,r,u,f){return e(n,i,r,u,f,t)},update:function(n,i,r,u,f){return o(n,i,r,u,f,t)}};u.formElement={init:function(n,t,i,u,f){return e(n,t,i,u,f,r)},update:function(n,t,i,u,f){return o(n,t,i,u,f,r)}}})(r||(r={})),r}));define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield-container .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:0;margin:0;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{padding:0}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}")})
);define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","f","i","ko","../../_generated/Less/MsPortalImpl/Widgets/CopyField.css"],(function(n,t,i,r,u){"use strict";var f;return (function(t){function l(n,t){var r=$(n),i,u,e=function(){i&&i.dispose();i=null;clearTimeout(u);u=null},o=function(){u=setTimeout((function(){e();i=new c(n,t())}),w)},s=function(){e()};r.mouseenter(o).mouseleave(s);h.domNodeDisposal.addDisposeCallback(n,(function(){e();r.off(f.mouseenter,o);r.off(f.mouseleave,s)}))}var a=r.TriggerableLifetimeManager,o=i.Base,v=o.Diagnostics,f=o.EventTypes,y=i.ViewModels.Controls,b=v.createLog(n),e="fxs-copyfield",p=e+"-container",s=e+"-copied",w=400,h=u.utils,c=(function(){function n(n,t){var o=$(n),l=this._lifespan=new a,r=$('<div class="'+e+'-wrapper" data-bind="stopBindings: true"><\/div>'),v=$('<div data-bind="pcCopyableLabel: $data" class="'+e+'"><\/div>'),c;v.appendTo(r);r.appendTo(o);c=new y.Forms.CopyableLabel.ViewModel(l);c.disabled(!0);u.reactor(l,(function(
){var n=u.unwrap(t);c.value(n);o.toggleClass(p,!i.isNullOrWhiteSpace(n))}));u.applyBindingsToDescendants(c,r[0]);l.registerForDispose([o.setEvents([f.fxcopybuttonclick,function(){o.addClass(s)}],[f.mouseleave,function(){o.removeClass(s)}]),function(){r&&(h.cleanDescendantNodes(r),r.remove())}])}return n.prototype.dispose=function(){this._lifespan.dispose()},n})();t.CopyField=c;t.initializeCopyBinding=l;u.bindingHandlers.copy={init:function(n,t){l(n,t)}}})(f||(f={})),f}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","../UI.NotificationManager"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){var s=i.Azure.ResourceManager,a=i.Base,v=a.Diagnostics,y=i.Services.Gallery,h=y.Constants,o=u.Gallery.Notifications,e=v.createLog(n),c=h.GalleryParametersKey,l=i.clone,p=r.observable,w=(function(){function n(n){this.status=p();this._cloudName=n}return n.prototype.execute=function(t){var f;if("data"in t&&
"options"in t){if(f=t.data,c in f.outputParameters){var i=f.outputParameters[c],r=t.options[h.GalleryOptionsKey],u=r&&r.launchingContext||{},a=this._getGalleryItemId(r.galleryItem);if(a||(e.warning("Null GalleryItemId."),a=i.deploymentName),u=l(u,!0),u.oldCreateApi=!0,u.galleryItemId=u.galleryItemId||a,this._validateOptions(i,r,f)){var y=l(f.outputParameters[i.selectedTemplateId],!0),p=n._findPropInObject(i.selectedTemplateId,r.deploymentTemplateFileUris),w={subscriptionId:i.subscriptionId,deploymentName:i.deploymentName||r.deploymentName,resourceGroupName:i.resourceGroupName,resourceGroupLocation:i.resourceGroupLocation,resourceProviders:JSON.parse(i.resourceProviders||null),parameters:y,templateLinkUri:!i.templateJson&&p||undefined,templateJson:i.templateJson,deploymentMode:1,launchingContext:u,cloudName:this._cloudName},v=new Date;return s.Deployments.deployTemplate(w).then((function(n){if(n===void 0&&(n={}),n.deploymentStatusCode===s.DeploymentStatusCode.Success){var i=(n.deployment||
{}).properties||{},t=new Date(i.timestamp&&i.timestamp.valueOf()||n.timestamp&&n.timestamp.valueOf());return t&&t.getTime()<=v.getTime()&&(t=new Date(v.getTime()+1)),{correlationId:i.correlationId||n.correlationId,timestamp:t}}return Q.reject()}))}return this._notify(o.createArgumentsValidationFailedMessage),Q.reject()}return this._notify(o.createOptionsNotSpecifiedMessage),e.error("Create options are not specified in the output parameters."),Q.reject()}return this._notify(o.createCommandMissingArgumentsMessage),e.error("The data or the options needed by the deployment command are not specified."),Q.reject()},n.prototype._validateOptions=function(t,i,r){var u="CsmCommand was rejected because ";if(t){if(!t.templateJson&&!t.selectedTemplateId)return e.error(u+"neither templateJson nor selectedTemplateId were specified."),!1;if(t.templateJson)try{JSON.parse(t.templateJson)}catch(f){return e.error(u+"templateJson was malformed."),!1}if(!t.subscriptionId)return e.error(u+"subscriptionId not specified."),
!1;if(!t.resourceGroupName)return e.error(u+"resourceGroupName not specified."),!1;if(!t.resourceGroupLocation)return e.error(u+"resourceGroupLocation not specified."),!1;if(i){if("subscriptionId"in i&&i.subscriptionId!==t.subscriptionId)return e.error(u+"subscriptionId was changed in the create process."),!1;if("resourceGroupName"in i&&i.resourceGroupName!==t.resourceGroupName)return e.error(u+"resourceGroupName was changed in the create process."),!1;if("resourceGroupLocation"in i&&i.resourceGroupLocation!==t.resourceGroupLocation)return e.error(u+"resourceGroupLocation was changed in the create process."),!1}}else return e.error(u+"galleryParameters not specified."),!1;if(i){if(i.deploymentTemplateFileUris){if(!t.templateJson&&!n._findPropInObject(t.selectedTemplateId,i.deploymentTemplateFileUris))return e.error(u+"templateJson wasn't defined and selectedTemplateId isn't defined in the deploymentTemplateFileUris."),!1}else return e.error(u+"deploymentTemplateFileUris not specified."),
!1;if(!("deploymentName"in i))return e.error(u+"deploymentName not specified."),!1}else return e.error(u+"configurationOptions not specified."),!1;return r?!0:(e.error(u+"create outputs not specified."),!1)},n._findPropInObject=function(n,t){n=n.toLowerCase();for(var i in t)if(t.hasOwnProperty(i)&&n===(i+"").toLowerCase())return t[i];return null},n.prototype._notify=function(n){var t={title:o.createResourceFailedLabel,description:n,status:i.Hubs.Notifications.NotificationStatus.Error};f.getNotificationManager().addClientNotification(t)},n.prototype._getGalleryItemId=function(n){var t=n&&n.id,r=(n||{}).launchingContext,i;return t=r&&r.galleryItemId||t,t&&(i=t.split("."),i.length>1&&(t="{0}.{1}".format(i[0],i[1]))),t},n.prototype._deployTemplate=function(n){var t=new Date;return s.deployTemplate(n).then((function(n){var i=n&&n.timestamp&&new Date(n.timestamp.valueOf());return i&&i.getTime()<=t.getTime()&&(i=new Date(t.getTime()+1)),{correlationId:n.correlationId,timestamp:i}}))},n})();t.CsmCommand=
w})(e||(e={})),e}));define("MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector",["require","exports","f","i","o","ko","../Extension/Extension.Definition.Locator","../UI/Hubs/ViewModels/UI.Gallery.CsmCommand","../Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function k(){return u||(u=i.require("MsPortalImpl/UI/Hubs/UI.CreateManager")),u}function d(n,t){f.bindingHandlers.fxParameterCollector={init:function(){return{controlsDescendantBindings:!1}},update:function(i,r,u,e,o){var s=f.unwrap(r()),c=o.$data.cloudName||f.observable();s&&new h($(i),s,n,t,c)}}}var a=e.Locator,v=r.Extension.CloudName,y=i.Base.Constants.ExtensionNames.Hubs,p=i.Base.Diagnostics,w=i.Parts.PartSize,c=i.Resources.Strings.Part.Provisioning,b=p.createLog(n),u,l=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(s.ViewModel),h;t.ViewModel=l;h=(function(n){function t(t,r,u,e,s){var h,p,d;n.call(this,t,r||new l);h=r.privatePcPrBI;h.triggerProvisioningInStartboardPart.
subscribe(this.ltm,(function(n){var t;if(n){var r=h.provisioningPartExtensionName(),f=h.provisioningPartName(),e=a.forExtension(r,s.peek()).withPartType(f);r===y&&(n=i.clone(n,!0),v.addToModel(s.peek(),n));u.addPartToStartBoard({originPartLocator:e,model:n,modelContainsSensitiveData:!0,initialSize:w.Normal});t=u.getActiveJourney();t&&h.forceDiscardJourney()&&u.forceDiscardJourney(t.id)}}));p=function(){var n=new o.CsmCommand(s.peek());h.provisioningCommand(n)};h.triggerProvisioningCommand.subscribe(this.ltm,p);h.triggerProvisioningCommand.peek()&&f.ignoreDependencies(p);h.provisioningAttempted.subscribe(this.ltm,(function(n){if(n){var t=u.getActiveJourney();t&&h.forceDiscardJourney()&&u.forceDiscardJourney(t.id)}}));d=function(n){n&&(n.galleryParameters?k().then((function(t){return t.processResourceGroupChange(e,n.galleryParameters,n.configurationOptions,n.deploymentResponse,s.peek()).then((function(){h.provisioningCompleted({succeeded:!0})}),(function(n){h.provisioningCompleted({succeeded:!1,
statusUnavailable:n===c.deploymentStatusUnavailable,pollingFailed:n===c.pollingFailed,errorMessage:n})}))})):b.error("galleryParameters should be specified in the provisioningStarted object."))};h.provisioningStarted.subscribe(this.ltm,(function(n){d(n)}));d(h.provisioningStarted())}return __extends(t,n),t})(s.Widget);t.Widget=h;t.initialize=d})(h||(h={})),h}));define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",["require","exports","f","o","a","ko","./Base.KnockoutTemplateSanitizer"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(){function s(n,t){var i=f.unwrap(n()),r=a(i,t);return function(){return r}}function a(n,t){var f;if(n&&typeof n=="object")return f={},r.getOwnPropertyNames(n).forEach((function(r){i.isSerializableProperty(r)&&(e.isAllowedCssClassName(r)?f[r]=n[r]:r&&t.push(r))})),f;var o=String(n||""),s=o.split(" "),h=u.prototype.map.call(s,(function(n){return n=String(n||""),e.isAllowedCssClassName(n)?n:(n&&t.push(n),"")}));return h.join(" ")}function v(n,
t){var i=n.getAttribute("data-bind")||"None",r=l.format(String(n.tagName),i,t.join(", "));c.error(r)}var h=i.Base.Diagnostics,c=h.createLog(n),l="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",o=f.bindingHandlers,t=o.css;o.sanitizedCss={init:function(n,i,r,u,f){if(t.init){var e=s(i,[]);return t.init(n,e,r,u,f)}return null},update:function(n,i,r,u,f){var e=[],o=s(i,e);return e.length&&v(n,e),t.update(n,o,r,u,f)}}})(o||(o={})),o}));define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","f","a","../Services/Services.Storage"],(function(n,t,i,r,u){"use strict";var f;return (function(t){function s(n,t){var i=Q.defer(),r=new FileReader,u="data:image/jpeg;base64,";return r.onload=function(n){for(var r=n.target.result,f="",o=new Uint8Array(r),e=0;e<o.byteLength;e++)f+=String.fromCharCode(o[e]);try{atob(f);r=u+f}catch(s){r=s.code===5?u+btoa(f):t}i.resolve(r)},r.onerror=function(n){o.error("Error {0} reading thumbnail photo".
format(n.target.error));i.resolve(t)},r.readAsArrayBuffer(n),i.promise}function h(n,t,i,r){var f=t,o,h;return n&&(o=u.ComponentName.Avatar,h=0,f=!r&&i.getValue(o,n,h),!f)?e.ajax({uri:n,type:"GET",dataType:"binary",responseType:"arraybuffer",isBackgroundTask:!0,setAuthorizationHeader:{resourceName:"graph"}}).then((function(n){return s(n,t)})).catch((function(n){if(n.jqXHR.status===404)return t;throw n;})).then((function(t){return i.setValue(o,n,t,h),t})):Q(f)}var r=i.Base,f=r.Diagnostics,e=r.Net2,o=f.createLog(n);t.getAvatarImage=h})(f||(f={})),f}));define("MsPortalImpl/Base/JQueryExtensions",["require","exports","f","$","MsPortalImpl/Base/JQueryHelper"],(function(n,t,i,r,u){"use strict";var f;return (function(){function c(t,r,u){var f=i.find(t,(function(t){var i=n(t);return!i.hasClass(s)&&i.is(":tabbable")&&(!u||u(i))}),r?-1:0);return n(f||[])}function e(t){return function(i){var r=n(h,this).toArray();return c(r,t,i)}}var f=i.Base.EventTypes,r=u.findByClassName,o=window,n=jQuery,s="msportalfx-skip-initial-focus",
t=n.fn,h="input, textarea, select, button, a, [tabindex=0]";t.setEvents=function(){for(var n,i,r=[],t=0;t<arguments.length;t++)r[+t]=arguments[t];return n=this,i=function(t){var i=n[t].bind(n);r.forEach((function(n){var u=n[0],t=n[1],f=typeof t,r;f==="function"?i(u,t):(r=n[2],r&&i(u,t,r))}))},i("on"),{dispose:function(){n&&(i("off"),n=null)}}};t.findByClassName=function(n){return r(this,n)};t.findFirstTabbable=e();t.findLastTabbable=e(!0);t.isInScrollView=function(n){var u,t=n?this.closest("."+n):u=this.scrollParent();if(!t[0].offsetParent||!t.is(u||this.scrollParent())&&!this.isInScrollView())return!1;var i=t.offset().top,f=i+t.height(),r=this.offset().top,e=r+this.height(),o=r>=i&&r<=f,s=e<=f&&e>=i;return o&&s};t.handleTransitionEndOnce=function(t,i,r){var s=this,u,h=!1,e;this.on(f.transitionend,u=function(n){for(var e,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];(e=n&&n.originalEvent,e&&e.propertyName!==t)||h||(h=!0,s.off(f.transitionend,u),r.apply(s,[n].concat(o)))});return e=
function(){var i=n.Event("transitionend",{originalEvent:{propertyName:t}});u(i)},n.fx.off?e():o.setTimeout(e,i),this};n.enableAnimations=function(t){var i="fxs-transition-off-style-head-marker",f=n("<style/>").addClass(i).append("* {transition: none !important;-webkit-animation-iteration-count: .5 !important;animation-iteration-count: .5 !important;-webkit-animation-duration: 0s !important;animation-duration: 0s !important;-webkit-animation-delay: 0s !important;animation-delay: 0s !important;}"),u=n("head");n.fx.off=!t;t?r(u,i).remove():r(u,i).length===0&&u.append(f)}})(f||(f={})),f}));define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(t){function w(n){return s.test(n)}var a=r.Extension,f=i.Base,v=f.Constants,y=f.Diagnostics,u=y.createLog(n),e="^[a-zA-Z][\\w]*$",p=window,o=p.fx.environment,s,h,c,l;t.canModifyExtensions=o.features.canmodifyextensions==="true";s=/^(https?:)?\/\/localhost(\:\d+)?(\/|$)/;
t.isLocalhostUri=w;t.canAddGalleryPackages=o.features.canaddgallerypackages==="true";h=(function(){function n(){}return n.prototype._normalizeCloudNameHelper=function(n){return n||v.EmptyCloudName},n.prototype.isValid=function(){var n,t,i;return typeof this.name!="string"?(u.error("Invalid name specified for extension",1,this),!1):typeof this.uri!="string"||!this.uri?(u.error("Invalid uri specified for extension",1,this),!1):(n=new RegExp(e),t=n.test(this.name),!t)?(i="Invalid extension name '{0}' specified. Extension names must match the following expression '{1}'.",u.error(i.format(this.name,e),8),!1):!0},n.prototype.isEqual=function(n){var t=n;return a.isEqualDescriptor(this,t)},n.prototype.updateWith=function(n){var t=n;this.name=t.name;this.uri=t.uri;this.obsoleteBundlesBitmask=t.obsoleteBundlesBitmask;this.features=t.features;this.trustedHost=t.trustedHost;this.startBoardParts=t.startBoardParts;this.isTestExtension=t.isTestExtension},n.prototype.markAsTestExtension=function(){this.
isTestExtension=!0},n.prototype.logUsageWarning=function(){u.warning("Extension '{0}' is running untrusted code from '{1}'".format(this.name,this.uri),7,this)},n.prototype.normalizeCloudName=function(){this.cloudName=this._normalizeCloudNameHelper(this.cloudName);this.trustedHost||(this.trustedHost="*")},n.create=function(t){var i=new n;return i.cacheability=t.cacheability,i.cloudName=t.cloudName,i.tokenSettings=t.tokenSettings,i.features=t.features,i.feedbackEmail=t.feedbackEmail,i.isTestExtension=t.isTestExtension,i.isTestStamp=t.isTestStamp,i.name=t.name,i.startBoardParts=t.startBoardParts,i.trustedHost=t.trustedHost,i.uri=t.uri,i.obsoleteBundlesBitmask=t.obsoleteBundlesBitmask,i.redirectTo=t.redirectTo,i},n})();t.ExtensionMetadataExt=h;c=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n;return(this.uri&&this.uri.toLowerCase())===(t&&t.uri&&t.uri.toLowerCase())},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.
prototype.logUsageWarning=function(){u.warning("Untrusted gallery package '{0}' is running".format(this.uri),7,this)},n.create=function(t){var i=new n;return i.uri=t.uri,i},n})();t.GalleryPackageExt=c;l=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n;return(this.uri&&this.uri.toLowerCase())===(t&&t.uri&&t.uri.toLowerCase())},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted patch '{0}' is running".format(this.uri),7,this)},n})();t.PatchExt=l})(u||(u={})),u}));define("MsPortalImpl/Services/Services.AssetManagement",["require","exports","f","i","o","a","ko","$","../Base/Base.LruMap","../Services/Services.AssetTypes","../Services/Services.PortalIdentity","./Services.Settings.Schema"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a;return (function(t){function ot(n){return rt(n)||ut(n)||lt(n)}function at(n,t,i){return new b(c.getSignedInUser(),n,t,i,st.client)}
function vt(n,t){return t}function yt(n,t){var i=n;return i&&f.isArray(i)?(i.reverse().forEach((function(n){var i=h.getMruItemKey({cloudName:n.cloudName,name:n.extension},n.assetType,n.resourceId||n.assetId);t.addOrUpdate(i,n)})),!0):!1}var d=r,y=d.Extension,v=i.Base,st=r.Rpc,a=i.ViewModels.Services.ResourceTypes,p=d.AssetManager,g=v.Constants.ResourceTypes,ht=v.Constants.ExtensionNames.Hubs,ct=v.Diagnostics,nt=l.assetMruListKey,tt="fulfilled",w=ct.createLog(n),it="MRU entry with no mapping view model",rt=a.isSubscriptionId,ut=a.isResourceGroupId,lt=a.isResourceId,ft=a.tryBuildResourceManagerKey,et=a.parseResourceDescriptor,b,k;t.createAssetManager=at;b=(function(){function n(n,t,r,u,f,e){var c=this,s;this._assetDeletedCallbacks=o.Callbacks();this._hubsWindowId=y.getHubsWindowId();this._extensionManager=t;this._settingsService=r;this._assetTypeService=u;this._portalIdentity=n;this._assetMruList=e;s=function(n,t,i){var f,r,e,o,s;i.reason=i.reason||"Received asset deletion notification from the extension '"+
n+"'";f=c.handleAssetDeleted.bind(c);i.extensionName===ht&&(t.cloudName=i.cloudName);r=i.assetId;e=i.assetType;e===p.resourceAssetType?(o=t.cloudName,s=void 0,s=rt(r)?g.Subscriptions:ut(r)?g.ResourceGroups:a.buildResourceTypeFromResourceId(r),s&&u.mapResourceIdToAssetId(r,o).then((function(n){f({cloudName:o,name:n.extensionName},n.assetType,n.assetId,i.reason)})).catch((function(n){var t=n&&n.message||"";t.indexOf(h.failedToFindAssetTypePrefix)!==0&&w.warning(n)}))):f(t,e,r,i.reason)};f&&(p.notifyAssetDeletedDefinition.register(f,null,(function(n,t){var u=i.makeArray(n),r=t.srcWindowId,f=y.getDescriptor(r);u.forEach((function(n){s(r,f,n)}))})),p.hubsNotifyAssetDeletedDefinition.register(f,[this._hubsWindowId],(function(n,t){var r=i.makeArray(n),u=t.srcWindowId;r.forEach((function(n){s(u,{cloudName:n.cloudName,name:n.extensionName},n)}))})));this._notifyDeletedResources()}return n.prototype.onAssetDeleted=function(n){this._assetDeletedCallbacks.add(n)},n.prototype.markAssetDeleted=function(n,t,i,r)
{this.handleAssetDeleted(n,t,i,r)},n.prototype.getDiagnosticsData=function(){return{mruList:this.assetMruList.mruList.peek()}},n.prototype.handleAssetDeleted=function(n,t,i,r){this._assetDeletedCallbacks.fire(n,t,i,r)},u.defineProperty(n.prototype,"assetMruList",{get:function(){var n=this._assetMruList;if(!n){n=this._assetMruList=this._createMruList();this.onAssetDeleted((function(t,i,r){return n.removeAssetEntry(t,i,r)}))}return n},enumerable:!0,configurable:!0}),n.prototype._createMruList=function(){return new k(this._portalIdentity,this._settingsService,this._assetTypeService)},n.prototype._notifyDeletedResources=function(){var t=this,n={},i=[];this.assetMruList.mruList.peek().filter((function(n){return!ot(n.assetId)})).forEach((function(r){var f=r.assetType,e=r.extension,o=r.cloudName,u=((o||"")+":"+e+f).toLowerCase(),s;n[u]||(s=t._assetTypeService.getAssetTypePromise(e,f,o).then((function(n){return{assetType:n,mapKey:u}})),i.push(s),n[u]=[]);n[u].push(r)}));Q.allSettled(i).then((function(i)
{i.forEach((function(i){var r,u;i.state===tt&&(r=i.value,r&&(u=r.assetType&&r.assetType.assetTypeManifest.resourceType,u&&!u.mappingViewModel&&n[r.mapKey].forEach((function(n){w.debug("Removing "+it+": "+JSON.stringify(n));t._assetMruList.removeEntry({name:n.extension,cloudName:n.cloudName},n.assetType,n.assetId)}))))}))}))},n})();t.AssetManagerImpl=b;k=(function(){function n(n,t,r,u){var f=this;this._list=new s.LruMap(50);this._observableList=null;this._settingsService=t;this._assetTypeService=r;this._logDelay=i.isNullOrUndefined(u)?1e4:u;this._debouncer=new v.Debouncer(vt,function(n){return f._logAssetAccess(n)},this._logDelay);this.initialSettingsSyncPromise=this._startSyncSettingsFromCloud().then((function(){f.updateObservableList()}))}return n.prototype.logAssetAccess=function(n,t,i,r){var u={cloudName:n.cloudName,extension:n.name,assetType:t,assetId:i,assetName:r,timeStamp:Date.now()};return this._logDelay?(this._debouncer.execute([u]),Q(!0)):this._logAssetAccess([u])},u.defineProperty(n.
prototype,"mruList",{get:function(){var n=this._observableList;return n||(n=this._observableList=e.observableArray(),this.updateObservableList()),n},enumerable:!0,configurable:!0}),n.prototype.removeAssetEntry=function(n,t,i){var f=this,r,u=ft(i);return r=u?Q(u):Q(this._assetTypeService.mapAssetIdToResourceId({extensionName:n.name,assetType:t,assetId:i},n.cloudName).then((function(n){return et(n),n}),(function(){return null}))),r.then((function(r){f.removeEntry(n,t,r||i)}))},n.prototype.clear=function(){this._list.getList().forEach((function(n){n.removedTimeStamp=Date.now()}));this.updateObservableList();this._startSyncSettingsFromCloud()},n.prototype.removeEntry=function(n,t,i){var u=h.getMruItemKey(n,t,i),r=this._list.get(u);r&&(r.removedTimeStamp=Date.now(),this.updateObservableList(),this._startSyncSettingsFromCloud())},n.prototype.onCloudSyncFinished=function(n){this._cloudSyncCompletedCallback=n},n.prototype._logAssetAccess=function(n){var t=this,i=[];return n.forEach((function(n){var r=ft(
n.assetId);r?i.push(Q({resourceId:r,entry:n})):i.push(Q(t._assetTypeService.mapAssetIdToResourceId({extensionName:n.extension,assetType:n.assetType,assetId:n.assetId},n.cloudName).then((function(t){return et(t),{resourceId:t,entry:n}}),(function(){return{resourceId:null,entry:n}}))))})),Q.allSettled(i).then((function(n){var i=!1;n.forEach((function(n){var e,o,y,u;if(n.state===tt){var s=n.value,f=s.resourceId,r=s.entry,c=r.assetId,l=r.cloudName,a=r.extension,v=r.assetType;if(!f&&!ot(c)&&(e=t._assetTypeService.getAssetType(a,v,l),o=e&&e.assetTypeManifest.resourceType,o&&!o.mappingViewModel)){w.warning("Not adding "+it+": "+JSON.stringify(r));return}i=!0;y=h.getMruItemKey({cloudName:l,name:a},v,f||c);u=t._list.getOrAdd(y,(function(){return r}));u.resourceId=f;u===r||u.removedTimeStamp&&Date.now()-u.removedTimeStamp<2e4||(u.removedTimeStamp=undefined,u.assetName=r.assetName,u.timeStamp=r.timeStamp)}}));i&&(t.updateObservableList(),t._startSyncSettingsFromCloud())}))},n.prototype.updateObservableList=
function(){var i=this,n=this._observableList,t;n&&(t=this._list.getList().filter((function(n){if(typeof n.removedTimeStamp=="number")return!1;var t=i._assetTypeService.getAssetType(n.extension,n.assetType,n.cloudName,0);return!(t&&t.assetTypeManifest.browseType===1&&!n.resourceId&&typeof n.assetId!="string")})),n.splice.apply(n,[0,n().length].concat(t)))},n.prototype._startSyncSettingsFromCloud=function(){var n=this,u=function(){n._settingsService.setSetting(0,nt,n._list.getList());var t=n._cloudSyncCompletedCallback;t&&t()},t,r=this._querySettingsCalledDeferred;return r?t=r.promise():(this._querySettingsCalledDeferred=i.Helpers.Deferred(),t=this._settingsService.querySetting(0,nt).then((function(t){var i=new s.LruMap(50);yt(t,i)&&(n._list=i);return}))),Q(t).then((function(){u();n._querySettingsCalledDeferred.resolve();return}))},n})();t.AssetMruListImpl=k})(a||(a={})),a}));define("MsPortalImpl/Services/Services.Permissions",["require","exports","f","i","FxHubs/Permissions"],(function(n,t,i,r,u)
{"use strict";var f;return (function(t){function b(n,t){return new a(n,t)}function k(n,t,i){return s.hasPermissionsToHubs.invoke(f.client,e,{entityId:n,requestedActions:t,providedActions:null,cloudName:i})}function d(n,t){return s.getPermissionsToHubs.invoke(f.client,e,{entityId:n,cloudName:t})}function g(n){return s.isCoAdminEndpoint.invoke(f.client,e,{cloudName:n})}var v=r,o=v.Extension,h=i.Base,y=h.Diagnostics,f=r.Rpc,p=i.ViewModels.Services.ResourceTypes,c=u.PermissionChecker,s=u.Rpc,w=window,nt=!!w.fx.environment.isDevelopmentMode,e=o.getHubsWindowId(),l=y.createLog(n),a;t.Internal={};t.createPermissionsManager=b;a=(function(){function n(n,t){var r=this,i;this._extensionManager=n;this._assetTypeService=t;i=u.createCachedPermissionsGetter(d);this._cachedPermissionsGetter=i;this._getPermissionsCallback=i.getPermissions.bind(i);o.hasPermissionsToShell.register(f.client,null,(function(n,t){var i=t.srcWindowId;return i!==e&&i!==h.Constants.Shell&&(n.cloudName&&l.warning("{0} should not pass cloud name".
format(i)),n.cloudName=o.getDescriptor(t.srcWindowId).cloudName),r.hasPermission(n.entityId,n.requestedActions,n.cloudName)}))}return n.prototype.isCoAdmin=function(n){return g(n)},n.prototype.hasPermission=function(n,i,r){return t.Internal.hasPermissionOverride?t.Internal.hasPermissionOverride(n,i):c.isRDFEAction(i)?k(n,i,r):p.isResourceManagerId(n,!0)?c.hasPermission(n,i,null,r,this._getPermissionsCallback):(l.error("HasPermissionInvalidEntityId"),Q(!0))},n.prototype.getCachedPermissions=function(n){return this._cachedPermissionsGetter.getCachedPermissions(n)},n})()})(f||(f={})),f}));define("MsPortalImpl/UI/Hubs/UI.BrowseManager",["require","exports","f","i","u","ko","FxHubs/RpcEndPoints","../../Services/Services.AssetTypes"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function et(n,t){var i=n.toLocaleLowerCase(),r=t.toLocaleLowerCase();return i===r?0:i<r?-1:1}function gt(n){ut||(ut=n.assetManager.assetMruList.mruList.subscribe((function(){var t=c.pingMruAssetsListEndPoint;
n.extensionManager.getHubsExtension().then((function(){t.invoke(p.client,y,tt).catch((function(n){if(!p.errorIsRpcTimeout(n,t.getName(),y))throw n;}))}))})))}function ni(n){if(!ft){ft=!0;var t=n.rpcClient,f=n.assetManager,i=n.assetTypeService,r=[wt],u=f.assetMruList;c.clearMruAssetsListEndPoint.register(t,r,(function(){return u.clear(),Q(!0)}));c.removeMruAssetEndPoint.register(t,r,(function(n){return u.removeAssetEntry({cloudName:n.cloudName,name:n.extension},n.assetType,n.assetId).then((function(){return!0}))}));c.getMruAssetsListEndPoint.register(t,r,(function(){var t=u.mruList().slice(0),n=[];return t.forEach((function(t){var r=t.cloudName,u=t.extension,f=t.assetType,s,e,h;(u===ht&&f===st||i.hasAssetType(u,f,r,1))&&(s=t.resourceId||t.assetId,e=i.getAssetType(u,f,r),e?(h={key:o.getMruItemKey({cloudName:r,name:u},f,s),isResourceTypeBrowse:e.assetTypeManifest.browseType===d,id:s,isPreview:e.isPreview,name:t.assetName,resourceTypeAssetTypeInformation:i.mapAssetTypeToResourceTypeAssetTypeInformation(
e),timeStamp:t.timeStamp,cloudName:r},n.push(h)):l.warning("Could not find the asset type for the MRU entry. AssetTypeId : <"+r+":"+u+":"+f+"> : ID: <"+JSON.stringify(s)+">"))})),n}))}}function ti(n,t,i,r){return new ot(n,t,i,r)}var v=i.Base,h=v.Constants,st=h.AssetNames.SubscriptionDetail,y=h.ExtensionNames.Hubs,ht=h.ExtensionNames.Billing,ct=h.ResourceTypes.ResourceGroups,lt=v.Diagnostics,p=r.Rpc,w=i.ViewModels.Services,at=w.Browse,vt=w.GridColumns,c=e.Mru,a=r.Extension,b=i.getUniqueId,yt=window.fx.environment,l=lt.createLog(n),pt=ct.toLowerCase(),wt=a.getHubsWindowId(),s=l.verbose.bind(l),k=i.forEachKey,bt=4,d=1,g=3,nt=0,tt=u,it="The asset type does not have a ",rt=" service view model was already disposed.",kt=i.isFeatureEnabled("supportthirdpartyresources"),ut=null,ft=!1,dt=r.getErrorMap({badCriteria:""}),ot;t.compareAssetTypeForSort=et;t.subscribeToMruItems=gt;t.registerRpcEndpoints=ni;t.createBrowseManager=ti;ot=(function(){function n(n,t,i,r){var e=this,u;this._browsePackages={};this.
_registeredResourceProviders=f.observableArray(["*"]);this._haveRdfeAccess=!1;this._callbacks={};this._isCoAdmin=!1;this._extensionManager=n;this._assetTypeService=t;this._permissionsService=i;u=this._executeCallbacks.bind(this);this._registeredResourceProviders.subscribe(u);this._haveRdfeAccess=r();r.subscribe((function(n){e._haveRdfeAccess=n;u()}));n.on("assetTypes").then((function(){u();t.assetTypes.subscribe(u)}))}return n.prototype._executeCallbacks=function(){var n=this._callbacks;n&&k(n,(function(n,t){t()}))},n.prototype._assetTypeSupportsCriteria=function(n,t){return n.extension===t.assetOwner&&n.assetTypeManifest.name===t.assetType&&a.isEqualCloudName(n.cloudName,t.cloudName)},n.prototype._releaseViewModel=function(n,t){i.disposeViewModelProperties(t);n.releaseViewModel(t)},n.prototype._assetTypeMeetsRequirements=function(n){var r,c,l,u,f,e,o,s,h,a;if(!n)return!1;var t=n.browseType,v=n.browseRequirements&1,y=!v||this._isCoAdmin;if(t===tt||!y)return!1;r=this._haveRdfeAccess;c=!n.browseRequiresRdfe||
r;switch(t){case g:case bt:if(l=n.browseLinkUri||"",u=function(n){return n+="Portal",l.indexOf("{"+n+"}")>=0&&(i.getFeatureValue(n)==="false"||!yt.links[n])},u("classic")||u("account"))return!1;case nt:case d:if(!c)return!1}return(f=n.resourceType,!f)?!0:(e=f.resourceTypeName,o=e.toLowerCase(),o===pt)?!0:!kt&&!r&&!o.startsWith("microsoft.")?!1:(s=e.split("/"),s.length<2)?!1:t===g?!0:(h=this._registeredResourceProviders,h().some((function(n){return n.toLowerCase()==="*"})))?!0:(a=s[0].toLowerCase(),h().some((function(n){return n.toLowerCase()===a})))},n.prototype.dispose=function(){k(this._browsePackages,(function(n,t){t.cancel();t.dispose()}));this._browsePackages=null},n.prototype.initialize=function(){this._extensionManager.getHubsExtension()},n.prototype.registerAssetTypesUpdateCallback=function(n){var t=b();return this._callbacks[t]=n,t},n.prototype.unregisterAssetTypesUpdateCallback=function(n){var t=this._callbacks;t[n]&&delete t[n]},n.prototype.addRegisteredResourceProvider=function(n)
{this._registeredResourceProviders.push(n)},n.prototype.initiateBrowse=function(n){var t=this,r;return n||dt.badCriteria(),r=new at.ResultsViewModel(n,[]),i.require("MsPortalImpl/UI/Hubs/UI.BrowseManagerDelayed").then((function(i){var o="All browse operations returned.",h="browse-"+b(),u=new i.BrowsePackage(r,t),y=u.ltm;t._browsePackages[h]=u;var f=0,e=0,c=!1,v=[];return t._assetTypeService.assetTypes().forEach((function(i){var p,h;if(!u.canceled&&t._assetTypeSupportsCriteria(i,n)&&(p=i.assetTypeManifest,p.browseType===nt)){var r=function(){++e;c&&e===f&&(s(o),u.allOperationsReturned())},w=p.browseServiceViewModel,b=a.getWindowId({name:i.extension,cloudName:i.cloudName})+"."+p.name+"."+w;s("Browse provider "+b+" using optimized browse.");h="browse operation from "+b+" browse provider";v.push(t._extensionManager.getExtensionByName(i.extension,i.cloudName).then((function(f){return Q(f.getViewModel(w)).then((function(e){var o=e.content,c,a,l;o?(c=!1,y.registerForDispose((function(){c=!0;t._releaseViewModel(
f,e)})),c?(s("The "+h+" was already disposed."),r()):(a=function(n,t){u.canceled||(s("Got "+h+"."),u.addOperation(i,n,t));r()},l=void 0,typeof o.onInputsSet=="function"&&(l=o.onInputsSet({criteria:n})),Q(l||!0).then((function(){a(b,o)})).catch((function(n){s("The "+h+" rejected the load promise: "+n);r()})))):(s("$Failed to get the "+h+"."),r())})).catch((function(n){s("Failed to get browse operation "+w+": "+n+".");r()}))})).catch((function(n){l.error("Failed to get extension for browse operation "+w+": "+n);r()})));s("Getting "+h+".");++f}})),c=!0,e===f&&(s(o),u.allOperationsReturned()),Q.all(v).then((function(){return h}))}))},n.prototype.getViewModelForBrowse=function(n){var t=this._browsePackages;return n in t?t[n].viewModel:null},n.prototype.releaseBrowse=function(n){var t=this._browsePackages,i;n in t&&(i=t[n],i.cancel(),i.dispose(),delete t[n])},n.prototype.getFilteredAssetTypes=function(){var n=this,t,r;return this._isCoAdminPromise||(this._isCoAdminPromise=Q(this._permissionsService.isCoAdmin(
h.DefaultCloudName)).then((function(t){n._isCoAdmin!==t&&(n._isCoAdmin=t,n._executeCallbacks())}))),t=[],r=[],this._assetTypeService.assetTypes().forEach((function(i){var r=i.assetTypeManifest;n._assetTypeMeetsRequirements(r)&&(r.privateBrowse||t.push(i))})),t.length&&i.stableSort(t,(function(n,t){return et(n.compositeDisplayName.service,t.compositeDisplayName.service)})).forEach((function(n){r.push(n)})),r},n.prototype.getGridColumnsPromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.gridColumnsServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then((function(n){return Q(n.getViewModel(i)).then((function(i){var e=!1,u,f;return(t.registerForDispose((function(){e=!0;r._releaseViewModel(n,i)})),!e)?(u=i.content,f=void 0,typeof u.onInputsSet=="function"&&(f=u.onInputsSet({usage:vt.Usage.Default})),f)?f.then((function(){return u})):u:Q.reject("The grid columns"+rt)}))})):Q.reject(it+"have a grid columns service view model.")},n.prototype.getDynamicBladePromiseForAssetType=
function(n,t){var r=this,i=n.assetTypeManifest.dynamicBladeServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then((function(n){return Q(n.getViewModel(i)).then((function(i){var u=!1;return(t.registerForDispose((function(){u=!0;r._releaseViewModel(n,i)})),!u)?i.content:Q.reject("The dynamic blade"+rt)}))})):Q.reject(it+"have a dynamic blade service view model.")},n})()})(s||(s={})),s}));define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","f","i","$","MsPortalImpl.Controls/Controls/Balloon","../../Interactions/Interactions.DismissHandler","./UI.Commands","../Compositions/UI.Composition","../../Widgets/Widgets.ContextMenu"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){function k(n){return new c(n)}function a(n){var r,f,i;if((b?n.metaKey:n.ctrlKey)||(r=p.getSelection(),r.rangeCount&&!r.getRangeAt(0).collapsed)||(f=u(n.target),f.filter("input,textarea").length))return!0;n.preventDefault();n.stopPropagation();i=
u.Event(t.fxcontextmenurequest);i.pageX=n.pageX;i.pageY=n.pageY;i.clientX=n.clientX;i.clientY=n.clientY;f.trigger(i)}var v=r.TriggerableLifetimeManager,t=i.Base.EventTypes,l=i.ViewModels.Controls.Balloon,y=l.ViewModel,p=window,w="<div class='fxs-commands-contextMenu'><\/div>",b=navigator.platform.indexOf("Mac")!==-1,c;n.createCommandManager=k;n.onContextMenu=a;c=(function(){function n(n){var t=this,r;this._ltm=new v;this._body=u("body");this._desktop=n;this._initializeContextMenu();this._handleDesktopModeChange();r=function(n){var i=t._balloonContentElement;return!(i===n)&&!u.contains(i,n)};this._dismissHandle={dismissFn:function(){i.require("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox").then((function(n){n.cancelMessageBox(u(t.getForm()));t.hideForm()}))},shouldDismissOnMouseDownFn:r,shouldDismissOnMouseWheelFn:r,restoreFocus:function(){e.validatePreviousFocusedElement(t._dismissHandle,t._previouslyFocusedElement)&&t._previouslyFocusedElement.focus()},logName:"commandmanager"}}return n.
prototype.dispose=function(){this.stopListeningForEvents();e.unregister(this._dismissHandle);this._ltm.dispose()},n.prototype.startListeningForEvents=function(){var f=this,n=this._body;n.on(t.fxcontextmenu,this._fxMenuEventHandler=function(n,t){f._showContextMenu(n,t)}).on(t.contextmenu,this._browserMenuEventHandler=function(n){a(n)});var i=this._contextMenuElement,r=this._desktop.portalWidget,u=r&&r.element;return u?u.append(i):n.append(i),this},n.prototype.stopListeningForEvents=function(){var n=this._body;this._fxMenuEventHandler&&(n.off(t.fxcontextmenu,this._fxMenuEventHandler),this._fxMenuEventHandler=null);this._browserMenuEventHandler&&(n.off(t.contextmenu,this._browserMenuEventHandler),this._browserMenuEventHandler=null);this._contextMenu.hide();this._contextMenuElement.detach()},n.prototype.getForm=function(){if(!this._balloonContentElement){var n=u("<div/>"),t=this._balloonViewModel=new y(this._ltm);t.position(l.Position.Top);t.content("<div><\/div>");u("body").append(n);new f.
Widget(n,t);n.addClass("fxs-dialogballoon");this._balloonContentElement=n.findByClassName("azc-balloon-content").children()[0].children[0]}return this._balloonContentElement},n.prototype.showForm=function(n){var t=this;this._previouslyFocusedElement=document.activeElement;this._balloonViewModel.box(n);this._balloonViewModel.visible(!0);i.require("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox").then((function(n){setTimeout((function(){n.setFocusOnMessageBox(u(t.getForm()))}),125)}));e.register(this._dismissHandle)},n.prototype.hideForm=function(){this._balloonViewModel&&(this._balloonViewModel.visible(!1),u(this._balloonContentElement).empty());e.unregister(this._dismissHandle)},n.prototype._initializeContextMenu=function(){this._contextMenuElement=u(w);this._contextMenu=new h.Widget(this._contextMenuElement);this._contextMenu.hide()},n.prototype._showContextMenu=function(n,t){var v=this,e=t.contextMenu?t.contextMenu:this._contextMenu,l=e.options.menuItems,i,r,a,h=n.clientX,c=n.clientY,f;
if(t.commands&&t.commands.length!==0){a=t.formTarget&&t.formTarget.length>0?o.getBladeContentWidget(t.formTarget):this;e.hide();l.splice(0,l().length);do r=r?r.parentNode:n.target,i=u(r).data(s.CompositionInstanceDataName);while(!i&&r.parentNode);(s.isContextMenuContainer(i)&&i.beforeActivateCommandMenuItems(t),t.commands.forEach((function(t){v._shouldShowCommand(t)&&(t.activate(),t.bind(new o.CompositionInstanceCommandContext(n.target,a,i)),l.push(t))})),e.options.hasVisibleCommands())&&(h||c||(f=n.target.getClientRects()[0],h=f&&f.left||h,c=f&&f.bottom||c),e.show(h,c,t&&t.forceLeft))}},n.prototype._handleDesktopModeChange=function(){var n=this;this._desktop.mode.subscribe(this._ltm,(function(t){t===1&&n.hideForm()}))},n.prototype._shouldShowCommand=function(n){return this._desktop.mode()!==1||!this._isExtensionCommand(n)},n.prototype._isExtensionCommand=function(n){return!!n._extension},n})();n.PortalCommandManager=c})(c||(c={})),c}));define("MsPortalImpl/UI/UI.ContextPane",["require","exports",
"f","o","ko","$","../Interactions/Interactions.DismissHandler"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function h(n,i){return new t(n,i)}var s=i.Base,o=s.EventTypes,t;n.create=h;t=(function(){function n(n,t){var h=this,i,r,s;this._widget=n;i=this._viewModel=n.options;this.collapsed=i.collapsed;r=function(n){n.stopPropagation();h.close()};n.element.on(o.fxcontextpaneclosing,r);s={dismissFn:function(){h.close()},shouldDismissOnMouseDownFn:f.noop,shouldDismissOnMouseWheelFn:f.noop,logName:"contextPane"};u.reactor(t,(function(){i.opened()?e.register(s):e.unregister(s)}));t.registerForDispose((function(){n.element.off(o.fxcontextpaneclosing,r)}))}return r.defineProperty(n.prototype,"opened",{get:function(){return this._viewModel.opened},enumerable:!0,configurable:!0}),n.prototype.hasContent=function(n){return this._contentProvider===n},n.prototype.getContent=function(){return this._contentProvider},n.prototype.tryOpen=function(n){var r=this,t,i;return this._contentProvider===
n?(this._widget.setFocus(),Q(!0)):(t=this._tryRemoveContent(),t)?(this._contentProvider=n,this._previouslyFocusedElement=document.activeElement,i=this._viewModel,i.opened(!0),i.loading(!0),n.onAddingContent(this._widget).finally((function(){i.loading(!1)})).then((function(){return r._widget.setFocus(),t}))):Q(t)},n.prototype.close=function(n){var t=!0,i;return n?this._clearContent():t=this._tryRemoveContent(),t&&(i=this._viewModel,i.opened(!1),i.loading(!1),this._restoreFocus()),t},n.prototype._clearContent=function(){var n=this._contentProvider;n&&n.onRemovingContent(this._widget);this._contentProvider=null},n.prototype._tryRemoveContent=function(){var n=this._contentProvider,t;return n?(t=!n.canRemoveContent||n.canRemoveContent(),t&&this._clearContent(),t):!0},n.prototype._restoreFocus=function(){var n=this._previouslyFocusedElement;n&&n.focus()},n})();n.ContextPaneImpl=t})(o||(o={})),o}));define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports","f","o"],
(function(n,t,i,r){"use strict";var u;return (function(n){var t={pending:"pending"},u=(function(){function n(n,t){this.deferred=i.Helpers.Deferred();this.targetId=n;this.isSource=t}return n})(),f=(function(){function n(n){this._awaitableCompositions=[];this.resolvedCompositions=[];this._trackResolvedCompositions=n}return n.prototype.await=function(n,i){var f=this,r=new u(n&&n.toString(),i),e=this.resolvedCompositions.firstIndex((function(n){return i(n)}));if(e>=0)r.deferred.resolve(this.resolvedCompositions[e]);else if(this._awaitableCompositions.push(r),n)n.onDispose((function(){var n;r.deferred.state()===t.pending&&(r.deferred.reject(),n=f._awaitableCompositions.indexOf(r),n>=0&&f._awaitableCompositions.splice(n,1))}));return r.deferred.promise()},n.prototype.resolve=function(n){var r=this,t,i;if(this._trackResolvedCompositions){this.resolvedCompositions.push(n);n.onDispose((function(){var t=r.resolvedCompositions.indexOf(n);t>=0&&r.resolvedCompositions.splice(t,1)}))}for(t=this._awaitableCompositions.
length-1;t>=0;t--)i=this._awaitableCompositions[t],i.isSource(n)&&(i.deferred.resolve(n),this._awaitableCompositions.splice(t,1))},r.defineProperty(n.prototype,"waitingCompositions",{get:function(){return this._awaitableCompositions.map((function(n){return n.targetId}))},enumerable:!0,configurable:!0}),n})();n.CompositionAwaiter=f})(u||(u={})),u}));define("_generated/Templates/WidgetsStartboard",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-loadanimation"> <div class="fxs-splashscreen-loader-container fxs-loading5dots-container"> <div><\/div><div><\/div><div><\/div><div><\/div><div><\/div> <\/div> <\/div> <div class="fxs-startboard-header"> <div class="fxs-startboard-title fxs-startboard-title-next fxs-portal-border" id="startboard-title"><\/div> <div class="fxs-startboard-dropdown"><\/div> <input type="text" class="fxs-startboard-title-edit fxs-hide-in-normal" maxlength="200"> <div class="fxs-startboard-migration" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-migrate"><\/button> <\/div> <div class="fxs-startboard-actions" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-new"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-edit"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-share"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-fullscreen"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-clone"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-delete"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-filter"><\/button> <\/div> <\/div> <div class="fxs-startboard-layout"><\/div> <div class="fxs-startboard-message-container"><\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","f","o","ko","../Base/Base.Events","../Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.RightClick","MsPortalImpl/Base/JQueryHelper","../Base/Base.KeyboardHelper","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Widgets.DropMenu","./Widgets.FlowLayout","./Widgets.LayoutBase","../../_generated/Templates/WidgetsStartboard","./Widgets.Tile","./Widgets.UIElementBase","MsPortalImpl/Base/Base.SvgHelper","../../_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){"use strict";var g;return (function(t){var et=i.Base,ot=et.Diagnostics,st=ot.Telemetry,tt=et.EventTypes,g=l.Content.SvgStartup,ht=a.Source,ct=a.Action,gt=window,ni=ot.createLog(n),r=o.Dashboard,lt="fxs-theme-context-start",kt,dt;t.widgetClass="fxs-startboard";var ti="fxs-startboard-header",ii="fxs-startboard-layout",at="fxs-startboard-title",
ri="fxs-startboard-title-next",vt="fxs-startboard-title-edit";t.headerButtonClass="fxs-startboard-button";var ui="fxs-startboard-dropdown",it="fxs-startboard-button-text",rt="fxs-startboard-button-icon",fi="fxs-startboard-button-new",yt="fxs-startboard-button-filter",ei="fxs-startboard-button-clone",oi="fxs-startboard-button-delete",si="fxs-startboard-button-share",hi="fxs-startboard-button-edit",ci="fxs-startboard-button-fullscreen",li="fxs-startboard-button-migrate",pt="fxs-startboard-button-browse",ut="fxs-startboard-header-normal",ft="fxs-startboard-header-migration",ai="fxs-startboard-notfound",vi="fxs-startboard-loading",yi="fxs-startboard-message-container",pi="fxs-startboard-message-title",wi="fxs-startboard-message-body",nt="fxs-startboard-dropdown-item",bi="fxs-startboard-dropdown-dashboard",ki="fxs-startboard-dropdown-browseall",di="fxs-startboard-dropdown-subscriptions",wt=gt.fx.environment,gi=wt.features.filterdashboard==="true",nr=i.isFeatureEnabled("skipautofocus"),bt="aria-label";
t.fxstartboardtitlechanged="fxstartboardtitlechanged";t.fxmigratestartboard="fxmigratestartboard";kt=(function(n){function t(t,i){n.call(this,t);this.commands=[];this.filterButtonText=u.observable("");this.title=u.observable(o.NavBar.home);this.dashboardList=u.observableArray();this.loading=u.observable(!1);this.notFound=u.observable(!1);this.isShared=u.observable(!1);this.notFoundMessage=u.observable("");this.subscriptionsInfo=u.observable("");this.locked(!1);var r=this.flowLayoutOptions=new y.ViewModel("fxs-flowlayout-instanceid");r.allowReorder=!0;r.allowOverflow=!0;r.allowGaps=!0;r.resolutionGuides=!0;r.resolutionGuidesOffset.y=-88;r.orientation=p.Orientation.Horizontal;r.childWidgetType=b.Widget;r.minColumns(4);r.minRows(4);r.maxRows(4);r.locked(!1);this.headerMode=u.observable(0);this.applyViewSettings(i)}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}},t.prototype.applyViewSettings=function(
n){n&&n.NormalState&&n.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(n.NormalState.layoutSettings)},t})(k.ViewModel);t.ViewModel=kt;dt=(function(n){function i(i,f){var e,o;n.call(this,i,f);this._layout=null;e=this.ltm;this._isSharedToArm=f.isShared;i.addClass(lt).addClass(t.widgetClass).html(w());u.reactor(e,(function(){var n=f.title();i.findByClassName(at).text(n);i.findByClassName(vt).val(n)}));u.reactor(e,(function(){var t=f.headerMode(),n=i.findByClassName(ti);switch(t){case 1:n.addClass(ut).removeClass(ft);break;case 2:n.removeClass(ut).addClass(ft);break;case 0:default:n.removeClass(ut).removeClass(ft)}}));u.reactor(e,(function(){var n=f.notFound();i.toggleClass(ai,n)}));u.reactor(e,(function(){var n=f.loading();i.toggleClass(vi,n)}));u.reactor(e,(function(){var n=f.title();document.title=n}));this._layout=new y.Widget(i.findByClassName(ii),f.flowLayoutOptions);this._initializeCommands(e,i);o=i.findByClassName(yi);o.html('<div class="'+pi+'">'+r.NotFound.title+"<\/div>"+
('<div class="'+wi+'" data-bind="text: data.notFoundMessage"><\/div>'));u.applyBindings({data:f},o[0]);this._attachEventHandlers(i);e.registerForDispose(s.setup(i,u.observableArray(f.commands)))}return __extends(i,n),i.prototype.dispose=function(){this._layout.dispose();this._cleanElement(t.widgetClass,lt);n.prototype.dispose.call(this)},i.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this._layout.addChild(n)},i.prototype.removeChild=function(n){return this._layout.removeChild(n)},i.prototype.moveChild=function(n,t,i,r){this._layout.moveChild(n,t,i,r)},i.prototype.setFocus=function(){var n,t;nr||(n=this._layout.element.findFirstTabbable(),n.length===1?n.focus():(t=this._selectorMenu,t&&t.setFocus()))},i.prototype.saveViewSettings=function(){return this.options.getViewSettings()},i.prototype.discardStateOfUnusedChildren=function(){return ni.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:
!1}},i.prototype.getDomOrderedChildren=function(){return this._layout.getDomOrderedChildren()},i.prototype._attachEventHandlers=function(n){var i=this,t=function(t){n.trigger(k.Widget.viewSettingsChanged,i.saveViewSettings());t.stopPropagation()};n.on(p.Widget.layoutUpdatedEventName,t);this.ltm.registerForDispose({dispose:function(){n.off(p.Widget.layoutUpdatedEventName,t)}})},i.prototype._initializeCommands=function(n,i){var ni="title",p="aria-disabled",ti=r.create,ii=r.delete,ai=r.edit,vi=r.filter,yi=this._isSharedToArm?r.unshare:r.share,ut=r.fullscreen,pi=r.clone,o=this.options,w=function(n,t){n.attr(ni,t).findByClassName(it).html(t)},wi='<div class="fxs-startboard-button-container">'+('<div class="'+rt+'"><\/div>')+('<div class="'+it+'"><\/div>')+"<\/div>",s=function(n,t,r,u,f){f===void 0&&(f=!1);var e=i.findByClassName(n).html(wi);w(e,t);e.findByClassName(rt).html(d.getSvgDataWithInheritPalette(r));e.on(tt.click,(function(n){n.stopPropagation();$(n.currentTarget).attr(p)!=="true"&&
u(n)}));return f&&h.hide(e),e},ft=s(hi,ai,g.customize,(function(){st.trace({source:ht.Dashboard,action:ct.CustomizeModeEntered});st.trace({source:ht.Dashboard,action:ct.DashboardEditCommandClicked});o.addPartsCommand.execute(!1)})),y,l,a,b,k,et,ot,lt;u.computed(n,(function(){var n=o.addPartsCommand,t=n&&n.enabled();t?ft.removeAttr(p):ft.attr(p,"true")}));gi||i.findByClassName(yt).remove();y=i.findByClassName(vt);y.attr(bt,r.titleLabel);y.on(tt.change,(function(){o.title(y.val());i.trigger(t.fxstartboardtitlechanged)}));l=new v.ViewModel('<div class="fxs-startboard-button-container">'+('<div class="'+at+'" data-bind="text: data.title, attr: { title: data.title }"><\/div>')+('<div class="'+rt+'">'+d.getSvgDataWithInheritPalette(g.caretDown)+"<\/div>")+"<\/div>","<div class='fx-dropmenu-dropdown'>"+('<ul class="fxs-dropmenu-list-system" role="menu" aria-label="'+r.recentMenuLabel+'">')+"<!-- ko ifnot: data.dashboardList -->"+("<li class='"+nt+'\' role="menuitem" tabindex="0">')+'<div class="fxs-tile-progress-transparent"><div><\/div><div><\/div><div><\/div><div><\/div><div><\/div><\/div><\/li><!-- /ko --><!-- ko if: data.dashboardList --><!-- ko ifnot: data.dashboardList().length -->'+
("<li class='"+nt+'\' role="menuitem" tabindex="0">')+("<div class='fxs-dropmenu-list-content'>"+r.emptynext+"<\/div>")+"<\/li><!-- /ko --><!-- ko foreach: data.dashboardList -->"+("<li class='"+nt+" "+bi+' fxs-portal-hover msportalfx-tooltip-overflow\' role="menuitem" data-bind="attr: { \'aria-label\': $parent.func.altText(title, id) }, event: { click: $parent.func.clickHandler, keydown: $parent.func.clickHandler }" tabindex="0">')+'<div class=\'fxs-dropmenu-list-content fxs-startboard-item-container\'><div class="fxs-startboard-item-icon"><!-- ko if: id.indexOf("private") === -1 -->'+d.getSvgReferenceOrFallBackToData(g.share)+"<!-- /ko --><\/div><div class=\"fxs-startboard-item-title\" data-bind='text: title'><\/div><\/div><\/li><!-- /ko --><!-- /ko -->"+('<li class="'+nt+" "+ki+' fxs-portal-hover" role="menuitem" tabindex="0">')+('<div class="'+di+'" data-bind="text: data.subscriptionsInfo"><\/div>')+('<a href="#" class="'+pt+' fxs-portal-text-primary">'+r.browseAll+"<\/a>")+"<\/li><\/ul><\/div>");
a=i.findByClassName(ui);l.alignMenu=0;b=this._selectorMenu=new v.Widget(a,l);l.isMenuOpen.subscribe(n,(function(n){n&&o.refreshDashboardList?(k=new e.KeyboardNavigation(b.element),o.dashboardList(undefined),o.refreshDashboardList((function(n){o.dashboardList(n)}))):k&&k.dispose()}));u.reactor(this.ltm,(function(){a.find(".fxs-dropmenu-button").attr(bt,r.switcherLabel.format(o.title()))}));et=function(n,t){(t.type!==tt.keydown||(t.keyCode===13||t.keyCode===32)&&c.getModifierKeys(t)===0)&&(t.preventDefault(),t.stopPropagation(),i.findByClassName(ri).text(n.title),o.switchDashboard&&o.switchDashboard(n).then((function(){var n=Math.min(Math.max(a.outerWidth()+50,400),560);a.find(".fxs-dropmenu-content").css({minWidth:n})})),l.close())};u.applyBindings({data:o,func:{clickHandler:et,altText:function(n,t){return n+" "+(t.indexOf("private")===-1?r.sharedStatusLabel:"")}}},b.element[0]);s(fi,ti,g.add,(function(){o.newCommand.execute(!1)}));o.filterButtonText(vi);ot=s(yt,o.filterButtonText(),g.filter,(function(
){o.filterCommand.execute(!1)}));o.filterButtonText.subscribe(n,(function(n){ot.findByClassName(it).html(n)}));s(ei,pi,g.clone,(function(){o.cloneCommand.execute(!1)}));lt=s(si,yi,g.share,(function(){o.shareCommand.execute(!1)}),wt.chrome.hideDashboardShare);u.reactor(n,this._isSharedToArm,(function(n){var t=n?r.unshare:r.share;w(lt,t)}));s(oi,ii,g.trashOutline,(function(){o.deleteCommand.execute(!1)}));var nr=s(ci,ut,g.fullscreen,(function(){o.fullscreenCommand.execute(!1)})),kt=function(){var n=f.isFullscreen()?r.exitFullscreen:ut;w(nr,n)},dt=$(document),gt=f.fullscreen;dt.on(gt,kt);n.registerForDispose((function(){dt.off(gt,kt)}));s(li,r.migrate,g.clone,(function(){i.trigger(t.fxmigratestartboard)}));i.findByClassName(pt).click((function(n){n.preventDefault();o.browseCommand.execute(!1)}))},i})(k.Widget);t.Widget=dt})(g||(g={})),g}));define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.Settings.Schema",
"../../Base/Telemetry","../Commands/UI.Commands","./UI.Composition","./UI.Composition.Base","./UI.Composition.CompositionAwaiter","./UI.Composition.PartSettingsManager","./UI.Composition.PropertyBinding","./UI.Composition.StartboardPart","../Commands/UI.ShellCommands","../../Widgets/Widgets.StartBoard","../../Widgets/Widgets.UIElementBase"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";var d;return (function(t){function rt(n){return n!==o.desktopSettingsKey&&n!==o.startBoardSettingsKey&&!i.startsWith(n,v.partIdentityStatePrefix)}function ht(n){var t=new d(n);return t.save(),t}var g=i.Base,nt=g.Diagnostics,ut=nt.Telemetry,tt=g.EventTypes,ft=i.Parts.PartSize,et=c.CompositionType,ot=y.ReferenceScope,it=nt.createLog(n),st=c.getIdMatchFunc,d;t.startboardName="Startboard";t.fxstartboardsettingchanged="fxstartboardsettingchanged";t.isStartboardPartKey=rt;d=(function(n){function l(i,r,f){n.call(this,i,null,r,f,o.startBoardSettingsKey);this._partAwaiter=new a.CompositionAwaiter(!0);
this._containerAwaiter=new a.CompositionAwaiter;this.masterContainer=null;this.detailContainers=[];this.notFound=u.observable(!1);this._name=t.startboardName;this._store=4}return __extends(l,n),l.prototype.getCompositionType=function(){return et.Startboard},l.prototype.setGetDashboard=function(n){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=n},l.prototype.removeGetDashboard=function(){this._getDashboard=null},l.prototype.getDashboard=function(){var n=this._getDashboard;return n?n():null},l.prototype.onDetailContainersChanged=function(){},l.prototype.getDeepLink=function(){return Q("")},l.fromJSON=function(n,t,i){return c.createCompositionFromJSON(i,(function(){return l._fromJSON(n,t,i)}),(function(t,i){var r=new l(n);return r.unrecoverableErrorMessage=i,r}))},l.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this),r=this._getDashboard?this._getDashboard():null,f;return r&&(t.dashboardId=r.id,t.dashboardTitle=r.title,
f=r.model,t.dashboardModel=f?{model:u.toJS(f.model),metadata:i.clone(f.metadata,!0)}:undefined),delete t.children,t},r.defineProperty(l.prototype,"eligibleForBinding",{get:function(){return!1},enumerable:!0,configurable:!0}),l.prototype.getInputPropertyBindings=function(){throw new Error("Unreachable code");},l.prototype.getViewModel=function(n){var r,t;if(n=i.isNullOrUndefined(n)?8:n,n===8){if(t=this._getDashboard&&this._getDashboard().model,!t)throw new Error("There is no current Dashboard.");r=t.model}return r||{}},l.prototype.getViewModelAsync=function(n){return f.Deferred().resolve(this.getViewModel(n)).promise()},l.prototype.getCompatibleSourceReferences=function(n){var u=this._getDashboard&&this._getDashboard().model,t=u&&u.metadata,i,f;return t&&(i=n.type,i)?(f=r.keys(t).filter((function(n){var r=t[n];return r===i})),f.map((function(n){return{property:n,modelType:8,scope:ot.CurrentContainer,cardinality:y.ReferenceCardinality.OneToOne}}))):null},l.prototype.logChildren=function(){this.
children.forEach((function(n){var t=n&&n.widgetState(),i=t&&t.NormalState?ft[t.NormalState.size]:"";ut.trace({extension:n.locator.getExtensionLocator().name,source:s.Source.StartBoardPart,action:s.Action.StartBoardPartLoaded,name:n.locator.toFriendlyString(),data:i})}))},l._fromJSON=function(n,t,i){var f=r.keys(t).map((function(i){return rt(i)?p.Instance.fromJSON(n,t[i]):null})).filter((function(n){return!!n})),u=new l(n,f,i.widgetState);return u.logChildren(),u.loadFromJson(i),u},l.prototype._compose=function(n,r){var s=this,f=new b.ViewModel(this.id,this.widgetState()),e=this.services,o,l;u.utils.arrayPushAll(f.commands,this._getShellCommands());var v=f.addPartsCommand=i.find(f.commands,(function(n){return n.commandName===w.CommandNames.EnterOrganizeMode})),y=f.newCommand=new w.NewDashboard(e),p=f.cloneCommand=new w.CloneDashboard(e),d=f.filterCommand=new w.FilterDashboard(e,this),g=f.fullscreenCommand=new w.FullscreenDashboard(e),nt=f.deleteCommand=new w.DeleteDashboard(e),rt=f.shareCommand=
new w.ShareDashboard(e),ut=f.browseCommand=new w.OpenBrowseDashboardsPane(e),a=this._getDashboard?this._getDashboard().title:null;a&&f.title(a);this.widget=new b.Widget(n.getStartBoardArea(),f);o=this.widget.element;l=function(n,t){n.bind(new h.CompositionInstanceCommandContext(o.findByClassName(t)[0],null,s))};l(v,b.widgetClass+"-title");[[y,"new"],[p,"clone"],[d,"filter"],[g,"fullscreen"],[nt,"delete"],[rt,"share"],[ut,"browse"],].forEach((function(n){var t=n[0],i=n[1];l(t,b.headerButtonClass+"-"+i)}));o.data(c.CompositionInstanceDataName,this);o.on(k.Widget.viewSettingsChanged,this._viewSettingsUpdateHandler=function(n,i){n.stopPropagation();s.widgetState(i);o.trigger(t.fxstartboardsettingchanged)});o.on(tt.fxunpin,this._tileUnpinHandler=function(n,t){var i=s.children.first(st(t.tileId));i&&(it.warning("Part '{0}' is about to be removed due to user unpin operation.".format(i)),s.services.desktop.removeTile(i.id));setTimeout((function(){var n=s.widget;n&&n.setFocus()}),50)});r.resolve()}
,l.prototype.matchesLocatorAndModel=function(){return!1},l.prototype.resetLayout=function(){this.services.desktop.resetStartBoard()},l.prototype.dispose=function(){var t=this.widget.element;this._viewSettingsUpdateHandler&&t.off(k.Widget.viewSettingsChanged,this._viewSettingsUpdateHandler);this._tileUnpinHandler&&t.off(tt.fxunpin,this._tileUnpinHandler);this._viewSettingsUpdateHandler=null;this._tileUnpinHandler=null;it.warning("UI.Composition.Startboard.dispose() has been called.");n.prototype.dispose.call(this,!0)},r.defineProperty(l.prototype,"journeyPath",{get:function(){return[]},enumerable:!0,configurable:!0}),l.prototype.getComposedParts=function(){return this._partAwaiter.resolvedCompositions},l.prototype.awaitComposedPart=function(n,t){return this._partAwaiter.await(n,t)},l.prototype.notifyPartComposed=function(n){this._partAwaiter.resolve(n)},l.prototype.awaitContainer=function(n,t){return this._containerAwaiter.await(n,t)},l.prototype.notifyContainer=function(n){this._containerAwaiter.
resolve(n)},l.prototype.onInvocationStarted=function(){},l.prototype.getDiagnosticsData=function(){return f.extend(n.prototype.getDiagnosticsData.call(this),{detailBlades:this.detailContainers.map((function(n){return n.toString()}))})},l.prototype._getShellCommands=function(){var n=[],t=new w.EnterOrganizeMode(this.services,!0);return t.text(e.Dashboard.edit),n.push(new w.ResetStartBoardCommand(this.services)),n.push(t),n.push(new w.ExitOrganizeMode(this.services)),n},l})(l.Instance);t.Instance=d;t.create=ht})(d||(d={})),d}));define("MsPortalImpl/UI/Dashboard/DashboardRepository",["require","exports"],(function(){"use strict";var n;return (function(n){n.ArmDashboardRepository="ArmDashboardRepository";n.PrivateDashboardRepository="PrivateDashboardRepository";n.RecommendedDashboardRepository="RecommendedDashboardRepository";n.SessionDashboardRepository="SessionDashboardRepository"})(n||(n={})),n}));define("MsPortalImpl/UI/Dashboard/ArmDashboardRepository",["require","exports","f","o","./DashboardRepository",
"MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function c(n){try{return nt.parseResourceDescriptor(n)}catch(t){return l.error(t,0,"Failed to parse ARM dashboard id '"+n+"'."),null}}function y(n){var e=n.tags&&n.tags[a]||n.name,t=n.properties,u=t&&t.metadata,o=u&&u.model||{},i=t&&t.lenses,f=i&&i["0"]&&i["0"].parts||{};return{title:e,model:o,parts:r.keys(f).map((function(n){return f[n]}))}}function e(n){var t=n.substr(h.length);return i.ensurePrefix(t,"/")}function p(n){return n.startsWith("/")&&(n=n.substr(1)),""+h+n}function w(n){return i.startsWith(n,h)}function it(n,t){return t.length?n.filter((function(n){if(!w(n.id))return!0;var r=e(n.id),i=c(r);return i?t.indexOf(i.subscription)>-1:!1})):n}function k(n,t){var r={};return r[a]=n,i.extend2(t,r)}var s=i.Base,d=s.Diagnostics,g=s.Promises.cancelOnDispose,o=s.Constants.DefaultCloudName,nt=i.ViewModels.Services.ResourceTypes,tt="Dashboard$DashboardViewModel",l=d.createLog(n),h="arm/",
a="hidden-title",v=f.Dashboard.NotFound,b;t.normalizedDashboard=y;t.getArmDashboardId=e;t.buildDashboardId=p;t.filterDashboards=it;b=(function(){function n(n,t,i,r){var u=this;this._lifetime=n;this._extensionManager=t;this._permissionsManager=i;this._compressor=r;this._isDisposed=!1;n.registerForDispose((function(){u._dispose()}))}return n.prototype.getTypeName=function(){return u.ArmDashboardRepository},n.prototype.createDashboard=function(n){var t=this;return this._connect().then((function(){var r=t._compressor.compress({id:"",title:"",settings:n.settings}),u={name:i.getUniqueId(),model:r.model,parts:r.parts,subscriptionId:n.extras.subscriptionId,resourceGroupName:n.extras.resourceGroupName,tags:k(n.title)};return t._provider.createDashboard(u,o)})).then((function(n){return t._convertToDashboard(n)}))},n.prototype.readDashboard=function(n){var t=this;return this._connect().then((function(){var i=e(n);return t._provider.readDashboard(i,o)})).then((function(n){return t._convertToDashboard(n)}))},
n.prototype.updateDashboard=function(n,t){var i=this,r=e(n);return this._connect().then((function(){return t.title?i._provider.readDashboard(r,o).then((function(n){return n.tags})):Q()})).then((function(n){var u=i._compressor.compress({id:"",title:"",settings:t.settings}),f={model:u.model,parts:u.parts,tags:!t.title?undefined:k(t.title,n)};return i._provider.updateDashboard(r,f,o)})).then((function(n){return i._convertToDashboard(n)}))},n.prototype.deleteDashboard=function(n){var t=this;return this._connect().then((function(){var i=e(n);return t._provider.deleteDashboard(i,o)}))},n.prototype.readDashboards=function(){var n=this;return this._connect().then((function(){return n._provider.readDashboards(o)})).then((function(t){return t.map((function(t){return n._convertToDashboard(t)}))}))},n.prototype.isDashboardWritable=function(n){return this._permissionsManager.hasPermission(e(n),["Microsoft.Portal/dashboards/write"],o)},n.prototype.identifyDashboard=function(n){return w(n)},n.prototype.getDashboardProperties=
function(n){var t=n.id,u=n.title,i=e(t),r=c(i)||{subscription:"",resourceGroup:""};return{id:t,title:u,originalId:i,subscription:r.subscription,resourceGroup:r.resourceGroup}},n.prototype.getNotFoundMessage=function(n){var r=n.id,i=n.title,u=e(r),t=c(u);return t?v.armMessageFormat.format(i,t.resourceGroup,t.subscription):v.defaultMessageFormat.format(i)},n.prototype._dispose=function(){this._isDisposed||(this._isDisposed=!0,this._isConnected=null,i.disposeViewModelProperties(this._viewModel),this._extension&&this._viewModel&&this._extension.releaseViewModel(this._viewModel),this._extension=null,this._viewModel=null)},n.prototype._connect=function(){var n=this;return this._isConnected||(this._isConnected=g(this._lifetime,(function(){return n._extensionManager.getHubsExtension().then((function(t){return n._extension=t,Q(t.getViewModel(tt))})).then((function(t){n._viewModel=t;n._provider=t.content})).catch((function(t){return n._isConnected=null,l.error(t,0,"Failed to connect ARM dashboard repository to its data provider from hubs extension."),
Q.reject(t)}))})))},n.prototype._convertToDashboard=function(n){var t=p(n.id);return this._compressor.uncompress(t,y(n))},n})();t.ArmDashboardRepository=b})(e||(e={})),e}));define("MsPortalImpl/UI/Dashboard/DashboardCompressor",["require","exports","f","i","o","ko","../../Extension/Extension.Definition.Locator","../Compositions/UI.Composition","../Compositions/UI.Composition.Base","../Compositions/UI.Composition.PropertyBinding","../Compositions/UI.Composition.Part","./../Compositions/UI.Composition.StartBoard","../Compositions/UI.Composition.PartSettingsManager","../../Services/Services.Settings.Schema","../../Widgets/Widgets.FlowLayout"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";var p;return (function(t){function et(n,t){var y=t[b],k=y.widgetState,d=k.NormalState.layoutSettings.positions,r=d.first((function(t){return t.id===n})),v,u;if(!r)return p.warning("Cannot compress part '"+n+"', because it does not have position in startboard."),null;var i=t[n],g=i.adapterBindings||i.bindings,
s=f.toJS(tt(i.containerModel)),it=f.toJS(tt(i.overridesModel)),l=(g||[]).map((function(n){var t=n.source,f=t&&t.property,e=n.targetProperty,r=t&&t.modelType,u,i,l,a;if(c.isDynamicBindingWithNonLocalSource(n))if(r===8)u={name:e,binding:f};else return p.error("For binding for property '{0}', encountered unsupported reference type '{1}'.".format(e,o.referenceTypeMap[r]||r)),null;else i=void 0,l=h.getModelValue(it,f),l.exists?i=nt(l.value):r===5?i=t.constantValue:(a=h.getModelValue(s,f),a.exists&&(i=nt(a.value))),u={name:e,value:i};return!n.optional||(u.isOptional=!0),u}));if(l.firstIndex((function(n){return!n}))>=0)return null;v=s[o.PartContainerModelIdProperty];u={};u[o.PartContainerModelIdProperty]=v;var rt=e.Locator.fromJSON(i.locator),ut=a.buildIdentitySettingKey(rt,u),ft=t[ut]||undefined,et=st(i.locator),ot=ct(i.partState),ht=at(i.assetInstanceDefinition);return{position:{x:r.position.col,y:r.position.row,colSpan:w(r.colSpan),rowSpan:w(r.rowSpan)},metadata:{inputs:l,type:et,settings:ft,isAdapter:
i.adapterBindings?!0:undefined,viewState:ot,asset:ht,defaultMenuItemId:i.defaultMenuItemId}}}function ot(n,t,i,u){var h=n.metadata,y=ht(h.type),g=lt(h.viewState),nt=vt(h.asset),p=rt.getDefaultSize().name,tt={NormalState:{size:p}},c={},b;c[o.PartContainerModelIdProperty]=f.observable(t);var w=e.Locator.fromJSON(y),it=s.createIdentifier(ut.StartboardPart,w,i),l={locator:y,partState:g,assetInstanceDefinition:nt,initialSize:p,widgetState:tt,id:it,bindingsInitialized:!0,dontSetupWidget:!1,defaultMenuItemId:h.defaultMenuItemId,childSettings:{},children:[],containerModel:r.toSerializableObject(c),overridesModel:undefined,editScopeId:undefined,bindings:undefined,adapterBindings:undefined,errorMessage:undefined,originalPartLocator:undefined},v=[];return h.inputs.forEach((function(n){var r=n.name,t,i=n.binding,u;i?t={property:i,modelType:8,cardinality:k.OneToOne,scope:d.CurrentContainer}:(u=n.value,t={property:r,constantValue:u,modelType:5,cardinality:k.OneToOne,scope:d.CurrentContainer});v.push(
{source:t,targetProperty:r,optional:!!n.isOptional,isDynamicBinding:i?!0:undefined})})),h.isAdapter?l.adapterBindings=v:l.bindings=v,h.settings&&(b=a.buildIdentitySettingKey(w,c),u(b,h.settings)),l}function st(n){var r=encodeURIComponent,f=[],t=n,i,u,o;do i=r(e.LocatorType[t.type]),u=t.cloudName?r(t.cloudName):undefined,u&&(i=i+"["+u+"]"),o=[i,r(t.name)],f.unshift(o.join("/")),t=t.parent;while(t);return f.join("/")}function ht(n){var i=decodeURIComponent,u=[],r=[],t;return n.split("/").forEach((function(n,t){r.push(n);t%2==1&&(u.push(r),r=[])})),u.forEach((function(n){var s=i(n.pop()),r=n.pop(),f,o=r.match(/\[(.*?)\]/),u;o&&(r=r.substring(0,r.lastIndexOf(o[0])),f=i(o[1]));r=i(r);u={name:s,type:e.LocatorType[r]};f&&(u.cloudName=f);t&&(u.parent=t);t=u})),t}function ct(n){n=r.isSerializedObject(n)?r.fromSerializableObject(n):n;var f=u.keys(n).filter((function(n){return n!=="container"&&n!=="internal"})),t={};return i.shallowCopyFromObject(t,n,f),g(t)?undefined:t}function lt(n){return r.toSerializableObject(
n||{})}function at(n){return g(n)?undefined:{idInputName:n.assetIdInputProperty,type:n.assetType}}function vt(n){return n?{assetIdInputProperty:n.idInputName,assetType:n.type}:{}}function yt(n){if(!n)return undefined;var t=n.model,r=n.metadata,i={};return u.keys(t).forEach((function(n){i[n]={value:t[n],type:r[n]}})),i}function pt(n){if(!n)return undefined;var t={},i={};return u.keys(n).forEach((function(r){var u=n[r];t[r]=u.value;i[r]=u.type})),{model:t,metadata:i}}var it=i.Base.Diagnostics,k=h.ReferenceCardinality,d=h.ReferenceScope,rt=i.Parts.PartSizeHelper,ut=o.CompositionType,g=i.isEmpty,nt=f.unwrap,p=it.createLog(n),w=function(n){return Math.min(Math.max(n,1),25)},tt=c.createContainerModel,b=v.startBoardSettingsKey,ft=(function(){function n(){}return n.prototype.compress=function(n){var t=n.settings,i=n.title,r=t[b],f=yt(r.dashboardModel),e=u.keys(t).filter((function(n){return l.isStartboardPartKey(n)})).map((function(n){return et(n,t)})).filter((function(n){return!!n}));return{title:i,model:
f,parts:e}},n.prototype.uncompress=function(n,t,r,u){var f={},e=[],h;t.parts.forEach((function(n,t){var c=r?r(t):i.getUniqueId(),l=u?u(t):undefined,s=ot(n,c,l,(function(n,t){f[n]=t})),o,h;f[s.id]=s;o=n.position;h={id:s.id,colSpan:w(o.colSpan),rowSpan:w(o.rowSpan),position:{col:o.x,row:o.y}};e.push(h)}));try{var o=y.validateGrid(e),c=o.success,s=o.result;c||(h=s.overlappedParts.join(", "),p.warning("Part '"+s.misplacedPart+"' is misplaced and overlaps with '"+h+"'."))}catch(l){p.error(l,1)}var a={NormalState:{layoutSettings:{positions:e}}},v=pt(t.model),k={id:b,childSettings:{},locator:null,errorMessage:undefined,widgetState:a,dashboardId:n,dashboardTitle:t.title,dashboardModel:v};return f[b]=k,{id:n,title:t.title,settings:f}},n})();t.DashboardCompressor=ft})(p||(p={})),p}));define("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository",["require","exports","f","o","./DashboardRepository","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.Settings","../../Services/Services.Settings.Schema"],
(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function v(n){var i=r.keys(n);if(i.length>=100)throw new Error("There are no more dashboard stores available.");for(var f=i.map((function(t){return n[t].storeName})),u=0,t=w(u);f.indexOf(t)>-1;)t=w(++u);return t}function b(n){for(var f=r.keys(n).map((function(t){return n[t].title.toLowerCase()})),e=function(n){return f.indexOf(n.toLowerCase())>=0},i=function(n){return n<=1?a:a+" ("+n+")"},u=1,t=i(u);e(t);)t=i(++u);return t}function k(n,t,i,r){var u=r.settings[o.startBoardSettingsKey];u.dashboardId=i;n.setSetting(h(t),i,r);n.setSetting(s,i,{storeName:t,id:r.id,title:r.title});n.flushSettings()}function d(){var n=i.getUniqueId();return""+y+n}function g(n,t){return n[t]&&n[t].storeName}function nt(n){return!!h(n)}function tt(n){return n.queryStore(s).then((function(n){return n||{}}))}var rt=i.Base,ut=rt.Diagnostics,c=f.Dashboard,ft=ut.createLog(n),y="private/",l="recentDashboards",p=10,s=11,a=c.defaultTitle,w=e.getDashboardStoreName,
h=e.getDashboardStoreId,et=i.forEachKey,it;t.buildNextStoreName=v;t.createDashboardTitle=b;it=(function(){function n(n){this._settingsManager=n}return n.prototype.getTypeName=function(){return u.PrivateDashboardRepository},n.prototype.createDashboard=function(n){var r=this,t=n.extras&&n.extras.id||d(),i={id:t,title:n.title,settings:n.settings};return this._getDashboards().then((function(n){return k(r._settingsManager,v(n),t,i),i}))},n.prototype.readDashboard=function(n){var t=this;return this._getDashboards().then((function(i){var r=g(i,n);if(r)return t._settingsManager.querySetting(h(r),n)}))},n.prototype.updateDashboard=function(n,t){var r=this;return this.readDashboard(n).then((function(u){if(u){var f={};return i.shallowCopyFromObject(f,u),i.shallowCopyFromObject(f,t),r._getDashboards().then((function(t){var i=g(t,n)||v(t);return k(r._settingsManager,i,n,f),f}))}return r.createDashboard({title:t.title,settings:t.settings,extras:{id:n}})}))},n.prototype.deleteDashboard=function(n){var t=this.
_settingsManager;return tt(t).then((function(i){var f=i[n],u,e,o;u=f?f.storeName:r.keys(i).filter(nt).first((function(t){return(i[t]||{}).id===n}));u&&t.deleteSettings({store:h(u),keys:[n]});e=u&&i[u]&&i[u].id===n;o=e?[u,n]:[n];t.deleteSettings({store:s,keys:o});t.flushSettings()}))},n.prototype.readDashboards=function(){return this._getDashboards().then((function(n){return r.keys(n).map((function(t){return n[t]}))}))},n.prototype.identifyDashboard=function(n){return i.startsWith(n,y)},n.prototype.isDashboardWritable=function(){return Q(!0)},n.prototype.getNotFoundMessage=function(n){return c.NotFound.privateMessageFormat.format(n.title)},n.prototype.canCreateNewDashboard=function(){return this._getDashboards().then((function(n){return r.keys(n).length<100}))},n.prototype.cloneDashboard=function(n,t){return this.createDashboard({settings:n,title:c.cloneTitleFormat.format(t)})},n.prototype.getRecentDashboards=function(){return this._settingsManager.querySetting(s,l).then((function(n){var t=(n||[])
.slice(0,p).filter((function(n){return!!n.id}));return i.unique(t,(function(n,t){return n.id.toLowerCase()===t.id.toLowerCase()}))}))},n.prototype.addToRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.id.toLowerCase()}));return u===0?r:(u>0&&r.splice(u,1),r.unshift({id:n.id,title:n.title}),r=r.slice(0,p),t._settingsManager.setSetting(s,l,r),r)}))},n.prototype.removeFromRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.toLowerCase()}));return u>=0&&(r.splice(u,1),t._settingsManager.setSetting(s,l,r)),r}))},n.prototype.createDefaultDashboard=function(n){var t;return t=n?Q(n):this._getDashboards().then((function(n){return b(n)})).catch((function(n){return ft.error(n,0,"Failed to generate a dashboard title with index."),a})),t.then((function(n){var t=d();return{id:t,title:n}}))},n.prototype._getDashboards=function(){var n=
this;return tt(this._settingsManager).then((function(t){var i={};return et(t,(function(t,r){if(r){var u;n.identifyDashboard(t)?(u=r,i[u.id]=u):nt(t)&&(u=r,i[u.id]||(i[u.id]=u))}})),i}))},n})();t.PrivateDashboardRepository=it})(s||(s={})),s}));define("MsPortalImpl/UI/Dashboard/DashboardClient",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function u(n){return new t(new r(n))}var r=(function(){function n(n){this._extensionManager=n}return n.prototype.connect=function(n,t,r,u){var f,e;return this._extensionManager.getExtensionByName(n,t).then((function(n){return f=n,Q(f.getViewModel(r(f)))})).then((function(n){return e=n,Q(u(n.content))})).finally((function(){i.disposeViewModelProperties(e);f&&e&&f.releaseViewModel(e)}))},n})(),t;n.ViewModelConnectorImpl=r;n.create=u;t=(function(){function n(n){this._connector=n}return n.prototype.getDashboard=function(n,t,i){return this._connector.connect(t,i,(function(n){return n.definition.dashboardProvider.viewModel}),(function(t){return t.
getDashboard(n)}))},n})();n.DashboardClientImpl=t})(r||(r={})),r}));define("MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository",["require","exports","f","./DashboardRepository","FxHubs/CloudNameCommon"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function f(n){var i=n.substr(t.length),f=u.getCloudNameFromId(i),r;return i=u.removeCloudNameFromId(i),r=i.split("/"),{cloudName:f,dashboardParam:r.slice(1).join("/"),extensionName:r[0]}}var t="recommended/",e;n.parseDashboardId=f;e=(function(){function n(n,t){this._dashboardClient=n;this._compressor=t}return n.prototype.createDashboard=function(){return Q.reject(new Error("Cannot create a recommended dashboard"))},n.prototype.readDashboard=function(n){var i=this,t=f(n);return this._dashboardClient.getDashboard(t.dashboardParam,t.extensionName,t.cloudName).then((function(t){return i._compressor.uncompress(n,t)}))},n.prototype.updateDashboard=function(){return Q.reject(new Error("Cannot update a recommended dashboard"))},n.prototype.
deleteDashboard=function(){return Q()},n.prototype.readDashboards=function(){return Q([])},n.prototype.getTypeName=function(){return r.RecommendedDashboardRepository},n.prototype.identifyDashboard=function(n){return i.startsWith(n,t)},n.prototype.isDashboardWritable=function(){return Q(!1)},n})();n.RecommendedDashboardRepository=e})(f||(f={})),f}));define("_generated/Templates/WidgetsAvatarMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-dropdown"> <ul class="fxs-avatarmenu-list-system" role="presentation"> <li class="fxs-portal-hover" role="presentation"> <a href="" class="fxs-avatarmenu-signout" role="menuitem" data-bind=\'attr: { title: text.signOutLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: text.signOutLabel"><\/div> <div class="fxs-dropmenu-image fxs-fill-error" data-bind="image: data.icons.signout"><\/div> <\/a> <\/li> <\/ul> <div class="fxs-avatarmenu-scrollviewer"> <div class="fxs-avatarmenu-list-system"> <ul role="presentation"> <li class="fxs-portal-hover" data-bind="visible: changePasswordLink" role="presentation"> <a class="fxs-avatarmenu-changepassword" role="menuitem" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: changePasswordLink, title: text.changePasswordLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: text.changePasswordLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.launchCurrent"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.accessDetails" role="presentation"> <a class="fxs-avatarmenu-myaccess" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.accessDetails, title: data.text.myAccessLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.myAccessLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.person"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.giveFeedback" role="presentation"> <a class="fxs-avatarmenu-feedback" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.giveFeedback, title: data.text.feedbackLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.feedbackLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.feedback"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: data.links.accountPortal" role="presentation"> <a class="fxs-avatarmenu-billing" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: {href: data.links.accountPortal || ""}\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.billingLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="visible: data.links.accountPortal && !data.links.accountPortal.startsWith(\'#\'), image: data.icons.launchCurrent"><\/div> <\/a> <\/li> <\/ul> <\/div> <div class="fxs-avatarmenu-list-tenant fxs-portal-border fxs-dropmenu-line-separator" data-bind="visible: listOfTenants().length"> <!-- ko if: listOfTenants().length --> <div class="fxs-avatarmenu-dropdown-title" id="avatarMenuTenantListId" data-bind="text: text.tenant"><\/div> <ul data-bind="foreach: listOfTenants" aria-labelledby="avatarMenuTenantListId" role="group"> <li class="fxs-portal-hover" role="presentation"> <a role="menuitemradio" data-bind="css: { \'fxs-avatarmenu-current-tenant fxs-portal-selected\': $index() === 0 }, attr: { href: $index() === 0 ? \'#\' : \'\', \'aria-checked\': $index() === 0 }"> <div class="fxs-avatarmenu-tenant-name fxs-portal-text" data-bind="text: displayName, attr: { title: displayName }"><\/div> <div data-bind="text: domainName, attr: { title: domainName }" class="fxs-avatarmenu-tenant-uri"><\/div> <\/a> <\/li> <\/ul> <!-- /ko --> <\/div> <\/div> <\/div>'}
}));define("_generated/Templates/WidgetsAvatarMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-header fxs-trim-hover" data-bind="attr: { title: tooltip }"> <div class="fxs-avatarmenu-tenant-container"> <div class="fxs-avatarmenu-username" data-bind="text: displayName"><\/div> <div class="fxs-avatarmenu-tenant" data-bind="text: currentTenantDisplayName"><\/div> <\/div> <img class="fxs-avatarmenu-tenant-image" data-bind="attr: { src: avatarUri }" alt=""/> <\/div>'}}));define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","../Base/Telemetry","../../_generated/Templates/WidgetsAvatarMenu","../../_generated/Templates/WidgetsAvatarMenuButton","./Widgets.WidgetBase","./Widgets.DropMenu","../../_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a;return (function(n){function t(n){return(n||"").toLowerCase(
)}function a(n,t,i){var u=n.element.findByClassName(t);if(i)u.on(r.click,i);return u}function bt(n){var t=n.userIdentity(),i=t&&(t.displayName||kt(t));return i||n.text.defaultDisplayName}function kt(n){var t=n.firstName||"",i=n.lastName||"";return!t&&!i?"":nt.test(t)&&nt.test(i)?"":e.AvatarMenu.displayNameFormat.format(t,i)}function dt(n,t){return t().first((function(t){return n().tenantId===t.id}))}function gt(n,i){return u.pureComputed((function(){var f=n(),u=f&&t(f.tenantId),r=i();return r.length===1&&r[0]&&t(r[0].id)===u?[]:r.sort((function(n,i){var o=t(n.id),e,r,f;return o===u?-1:(e=t(i.id),e===u)?1:(r=n.displayName,f=i.displayName,r<f?-1:r>f?1:0)}))}))}var y=i.Base,ct=y.Diagnostics.Telemetry,r=y.EventTypes,p=y.Images,lt=MsPortalImpl.Resources.Images,at=window,w=at.fx.environment.links,b=o.Source.TopBar,k=o.Action,d=ct.trace,vt=lt.getAvatarMenu().defaultAvatarSmall,tt="fxs-avatarmenu",yt="fxs-avatarmenu-header",it="fxs-avatarmenu-list-tenant",g="fxs-avatarmenu-signout",rt="fxs-avatarmenu-billing",
ut="fxs-avatarmenu-feedback",ft="fxs-avatarmenu-myaccess",pt="fxs-menu-account",et="signOut",ot="switchedTenant",st="showDiagnostics",v=r.click,wt=(function(n){function t(){n.apply(this,arguments);this.dropMenu=new l.ViewModel(h(),s());this.userIdentity=u.observable();this.userInfo=u.observable();this.hideTenant=u.observable();this.listOfTenants=u.observableArray();this.showDiagnostics=null;this.openMenu=null;this.signOut=null;this.signedOut=null;this.switchTenant=null;this.switchedTenant=null;this.text=e.AvatarMenu;this.links=w;this.icons={feedback:p.Feedback(),signout:p.Signout(),person:p.Person({palette:y.ImagePalette.Inherit}),launchCurrent:p.LaunchCurrent()};this.avatarImage=u.observable();this.showDiagnosticsDelay=3e3}return __extends(t,n),t})(c.ViewModel),nt,ht;n.ViewModel=wt;nt=/^(f(irst)?|l(ast)?)\s?name$/i;ht=(function(n){function i(i,r){var o=this;n.call(this,i,r);this._lastTouchMillis=0;var f=this.element,s=this.ltm,h=r.dropMenu;f.addClass(tt);h.buttonClass=pt;this._dropMenuWidget=
new l.Widget(f,h);var a=u.pureComputed((function(){return bt(r)})),v=u.pureComputed((function(){var n=r.userInfo();return r.hideTenant()||!n?"":n.uniqueDirectoryName})),y=u.pureComputed((function(){var n=r.userIdentity(),u,e,s,h;if(!n)return"";var f=r.text.Tooltip,c=f.tenant,i=[];return(n.firstName||n.lastName)&&i.push(f.name.format(n.firstName||"",n.lastName||"")),n.displayName&&i.push(f.email.format(n.displayName)),u=dt(r.userIdentity,r.listOfTenants),u&&!r.hideTenant()&&(i.push(c.format(u.displayName,u.id)),e=u.domainName||"",s=n.tenantDomain,i.push(s&&t(e)!==t(s)?c.format(e,s):f.domain.format(e))),h=i.join("\n"),o._dropMenuWidget.options.buttonTooltip(h),h})),e=u.observable(vt),c=u.observable();u.reactor(s,(function(){var n=r.userIdentity(),t;n&&(c(n.changePasswordUri),n.isAnonymous||(e(n.defaultAvatarUri),t=r.avatarImage(),t&&t.then((function(n){e(n)}))))}));u.applyBindingsToDescendants({data:r,func:this,displayName:a,listOfTenants:gt(r.userIdentity,r.listOfTenants),text:r.text,currentTenantDisplayName:
v,tooltip:y,avatarUri:e,changePasswordLink:c},f[0]);u.reactor(s,r.dropMenu.isMenuOpen,(function(n){n&&o._reactToMenuOpen()}));this._attachEventHandlers()}return __extends(i,n),i.prototype.dispose=function(){this._dropMenuWidget.dispose();this._cleanElement(tt);n.prototype.dispose.call(this)},i.prototype._signOut=function(n){var t=f.Event(et),i=this.trigger(et,t,{completed:!!n});(d({source:b,action:k.AvatarMenuSignOut}),i)&&this.trigger("signedOut")},i.prototype._switchTenant=function(n){var i=this.options.userIdentity(),r=i&&t(i.tenantId);if(t(n.id)!==r){var u=f.Event(ot),e=this.trigger("switchTenant"),o={tenant:n};if(d({source:b,action:k.AvatarMenuSwitchTenant}),!e)return;this.trigger(ot,u,o)}},i.prototype._attachEventHandlers=function(){var n=this,i=this.options,t=this.element,u;this._holdStartHandler=function(){n._lastTouchMillis=Date.now()};this._holdEndHandler=function(t){var r,u;n._lastTouchMillis&&(r=Math.abs(Date.now()-n._lastTouchMillis),n._lastTouchMillis=0,r>i.showDiagnosticsDelay&&
(u=f.Event(st),n.trigger(st,u),t.preventDefault()))};this._accountPortalHandler=function(n){i.openAccountPortal();w.accountPortal.startsWith("#")&&n.preventDefault()};this._feedbackHandler=function(n){i.giveFeedback();w.giveFeedback.startsWith("#")&&n.preventDefault()};u=a(this,yt);u.on([r.touchstart,r.mousedown].join(" "),this._holdStartHandler);u.on([r.touchend,r.mouseup].join(" "),this._holdEndHandler);a(this,rt,this._accountPortalHandler);a(this,ut,this._feedbackHandler);this.ltm.registerForDispose((function(){t.off(v,g,n._signOutHandler);t.off(v,rt,n._accountPortalHandler);t.off(v,ut,n._feedbackHandler);t.off(v,it,n._tenantHandler);t.off(v,ft,n._myAccessHandler)}))},i.prototype._reactToMenuOpen=function(){var n=this,t=a(this,g);if(t[0].focus(),d({source:b,action:k.AvatarMenuOpen}),this._signOutHandler||a(this,g,this._signOutHandler=function(t){n._signOut(!1);t.preventDefault()}),!this._tenantHandler)a(this,it).on(r.click,"a",this._tenantHandler=function(t){t.preventDefault();n._switchTenant(
u.dataFor(t.target))});this._myAccessHandler||a(this,ft,this._myAccessHandler=function(t){w.accessDetails.startsWith("#")&&t.preventDefault();n.options.showMyAccessBlade()})},i})(c.Widget);n.Widget=ht})(a||(a={})),a}));define("MsPortalImpl/Widgets/Widgets.BreadCrumbViewModel",["require","exports","o","ko","./Widgets.WidgetBase"],(function(n,t,i,r,u){"use strict";var f;return (function(n){var t=r.observableArray,i=(function(n){function i(){n.apply(this,arguments);this.breadCrumbs=t();this.clicksEventsHandlers=t()}return __extends(i,n),i})(u.ViewModel);n.ViewModel=i})(f||(f={})),f}));define("_generated/Templates/WidgetsBreadCrumb",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-breadcrumb-wrapper"> <div class="fxs-breadcrumb-dropmenu"><\/div> <!-- ko foreach: func.breadCrumbsVisibleUI --> <!-- ko if: $index() --> <div class="fxs-breadcrumb-divider fxs-trim-svg-secondary" data-bind="image: $data.caretUp, visible: $data.visible"><\/div> <!-- /ko --> <a href="" class="fxs-breadcrumb-crumb fxs-trim-text fxs-trim-hover" data-bind="attr: { \'data-blade-id\': $data.bladeId }, text: $data.bladeTitle, visible: $data.visible"><\/a> <!-- /ko --> <\/div>'}
}));define("_generated/Templates/WidgetsBreadCrumbOverFlow",["require","exports"],(function(){"use strict";return function(){return'<ul class="fxs-breadcrumb-overflow"> <!-- ko foreach: breadCrumbsOverFlow --> <li class="fxs-portal-hover"> <a href="" class="fxs-breadcrumb-crumb" data-bind="attr: { \'data-blade-id\': $data.bladeId }, text: $data.bladeTitle"><\/a> <\/li> <!-- /ko --> <\/ul>'}}));define("MsPortalImpl/Widgets/Widgets.BreadCrumb",["require","exports","f","o","a","ko","../Base/Telemetry","./Widgets.WidgetBase","../../_generated/Templates/WidgetsBreadCrumb","../../_generated/Templates/WidgetsBreadCrumbOverFlow","./Widgets.DropMenu","../../_generated/Less/MsPortalImpl/Widgets/Widgets.BreadCrumb.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){function y(n,t,i,r){f.computed(n,t,(function(){var h=t(),c=r?h.reverse():h,l=c.length,a=l-i().length,e,v,o,n,u,s;if(a>0){for(e=[],n=0,v=Math.max(a,5);n<v;n++)e.push({bladeId:f.observable(),bladeTitle:f.observable(),
visible:f.observable(),caretUp:it});i.push.apply(i,e)}for(o=i(),n=0;n<o.length;n++)u=o[n],n<l?(s=c[n],u.bladeId(s.bladeId),u.bladeTitle(s.bladeTitle),u.visible(!0)):u.visible(!1)}))}function u(n,t,i){var r=i().first();r&&n.width()>=t.width()&&(r.visible(!1),u(n,t,i))}var l=i.Base,p=l.Diagnostics.Telemetry,t=l.EventTypes,a=window,w=e.Source.Desktop,b=e.Action,k=p.trace,r="fxs-breadcrumb",d=r+"-wrapper",g=r+"-divider",nt=r+"-dropmenu",tt="&#171",v={deferred:!0},it=i.Base.Images.CaretUp(),rt=(function(n){function i(i,r){var ut=this,p,it,ft,ot,st,ht;n.call(this,i,r);var e=this.element,ct=this.options,o=this.ltm,l=ct.breadCrumbs.map(o,(function(n,t){return{bladeId:t.bladeId,bladeTitle:t.bladeTitle,visible:f.observable()}}));l.extend(v);p=l.filter(o,(function(n){return!n.visible()}));it=this.breadCrumbsVisible=l.filter(o,(function(n){return n.visible()}));this.breadCrumbsVisibleUI=f.observableArray([]);ft=f.observableArray([]);e.html(s());this._bindDescendants();var lt=this._visibleBreadCrumbs=e.findByClassName(
d),at=e.findByClassName(g),rt=this._dropMenuElement=e.findByClassName(nt),et=new c.ViewModel(tt,h(),!0);et.alignMenu=0;o.registerForDispose(new c.Widget(rt,et));f.applyBindings({breadCrumbsOverFlow:f.pureComputed((function(){return p().reverse()}))},rt[0]);f.computed(o,p,(function(){return p().length>0})).subscribeAndRun(o,(function(n){rt.css("display",n?"":"none")}));e.on(t.click,"a",ot=function(n){var i=f.dataFor(n.target),r=i&&f.unwrap(i.bladeId);n.preventDefault();k({source:w,action:b.BreadCrumbClicked});r&&e.trigger(t.fxbreadcrumbclick,{bladeId:r})});f.computed(o,l,ht=function(){var n=l();n.length&&(n.forEach((function(n){n.visible(!0)})),u(lt,e,it))}).extend(v);$(a).on(t.resize,st=function(){if(ut.options.breadCrumbs().length>0){var t=e.width(),n=ut._visibleBreadCrumbs;n.width()>=t?u(n,e,it):ht()}});r.clicksEventsHandlers.map(o,(function(n,i){e.on(t.fxbreadcrumbclick,i);n.registerForDispose((function(){e.off(t.fxbreadcrumbclick,i)}))}));o.registerForDispose((function(){e.off(t.click,"a",ot);$(
a).off(t.resize,st)}));y(o,it,this.breadCrumbsVisibleUI,!1);y(o,p,ft,!0)}return __extends(i,n),i})(o.Widget);n.Widget=rt})(l||(l={})),l}));define("_generated/Templates/WidgetsTopBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-exit-customize"> <div class="fxs-topbar-exit-customize-message" data-bind="text: data.text.exitCustomizeText"><\/div> <div type="button" class="fxs-topbar-exit-customize-button fxs-button fxs-portal-button-primary" data-bind="text: data.text.exitCustomizeButton"><\/div> <\/div> <div class="fxs-topbar-content fxs-hide-in-customize" role="banner"> <div class="fxs-topbar-internal fxs-bg-warning" data-bind="visible:data.showPreview, text: data.text.internalText"><\/div> <a href="#" class="fxs-topbar-home fxs-trim-text-primary fxs-trim-hover" role="button" data-bind="text: data.productName, attr: { title: data.dashboardTooltip }"><\/a> <div class="fxs-breadcrumb" data-bind="stopBindings: true"><\/div> <!-- ko if: data.inDevMode --> <a class="fxs-topbar-exitdevmode fxs-trim-hover fxs-bg-warning" href="#" role="button" data-bind="text: data.text.exitDevModeLinkText, click: func._exitDevMode"><\/a> <!-- /ko --> <!-- ko if: data.canReportBug --> <a href="#" class="fxs-topbar-reportbug fxs-trim-hover fxs-bg-warning" role="button" data-bind="text: data.text.reportBug, click: func._reportBug, attr: { title: data.text.reportBugTitle, \'aria-label\': data.text.reportBug }"><\/a> <!-- /ko --> <div class="fxs-topbar-search" data-bind="stopBindings: true, attr: { title: data.searchTooltip }"><\/div> <!-- ko ifnot: data.notificationsContextPane --> <div class="fxs-topbar-notifications" data-bind="stopBindings: true"><\/div> <!-- /ko --> <!-- ko if: data.notificationsContextPane --> <div class="fxs-topbar-notifications fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.notifications }"> <div data-bind="image: data.notificationsIcon"><\/div> <div class=\'fxs-notificationspane-progressbar fxs-display-none\'><div><\/div><\/div> <\/div> <div class="fxs-topbar-toast"><\/div> <!-- /ko --> <a role="button" class="fxs-topbar-console fxs-topbar-button fxs-trim-hover fxs-trim-svg" data-bind="attr: { title: data.text.console }, image: data.consoleIcon"><\/a> <a href="#" class="fxs-topbar-settings fxs-menu-settings fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.settings }, image: data.settingsIcon"><\/a> <!-- ko if: data.showFeedbackButton --> <a href="#" class="fxs-topbar-feedback fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.feedback }, image: data.feedbackIcon, click: func._feedbackButtonClick"><\/a> <!-- /ko --> <!-- ko if: data.showContextualHelp --> <a href="#" class="fxs-topbar-helpmenu fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.helpTooltip }, image: data.helpIcon"><\/a> <!-- /ko --> <!-- ko ifnot: data.showContextualHelp --> <div role="button" class="fxs-topbar-helpmenu" data-bind="stopBindings: true, attr: { title: data.helpTooltip }"><\/div> <!-- /ko --> <div class="fxs-topbar-avatarmenu" data-bind="stopBindings: true"><\/div> <\/div> <div class="fxs-topbar-dashboard"> <div class="fxs-topbar-dashboard-message" data-bind="text: data.dashboardMessage"><\/div> <button type="button" class="fxs-button fxs-topbar-dashboard-done-customize" data-bind="text: data.text.exitCustomizeButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-view" data-bind="text: data.text.viewDashboardButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-save" data-bind="text: data.dashboardSaveButtonText"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-discard" data-bind="text: data.text.discardDashboardButton"><\/button> <\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Widgets.AvatarMenu","./Widgets.BreadCrumbViewModel","./Widgets.BreadCrumb","./Widgets.WidgetBase","../../_generated/Templates/WidgetsTopBar","../../_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";var p;return (function(n){var k=i.Base,st=k.Diagnostics.Telemetry,t=k.EventTypes,ht=k.Images,p=s.Content.SvgStartup,tt=o.findByClassName,it=window.fx.environment,w=it.features,ct="fxs-breadcrumb",rt="fxs-topbar",lt="fxs-topbar-exit-customize-button",at="fxs-topbar-home",vt="fxs-topbar-notifications",yt="fxs-topbar-settings",pt="fxs-topbar-devmode",d="fxs-topbar-helpmenu",wt="fxs-topbar-dashboard",bt="fxs-topbar-dashboard-visible",kt="fxs-topbar-dashboard-changed",dt="fxs-topbar-dashboard-save",gt="fxs-topbar-dashboard-discard",
ni="fxs-topbar-dashboard-view",ut="fxs-topbar-dashboard-done-customize",ti="fxs-topbar-console",ii=h.Source.TopBar,r=h.Action,ri=st.trace,ft=e.KeyboardShortcuts,b=e.TopBar,g=t.fxexitorganizemode,nt,et,ot;n.fxfinishdashboardedit="fxfinishdashboardedit";nt=i.isFeatureEnabled("helpenabled");et=(function(n){function t(){n.apply(this,arguments);this.breadCrumb=new l.ViewModel;this.avatarMenu=new c.ViewModel;this.productName=i.htmlEncode(it.branding.productName);this.showPreview=u.observable(i.isNullOrUndefined(w.internalonly)||w.internalonly==="true");this.text=e.TopBar;this.dashboardTooltip=ft.GoTo.dashboard;this.searchTooltip=ft.search;this.canReportBug=u.observable(!1);this.reportBug=f.noop;this.showFeedbackButton=w.feedback==="true";this.inDevMode=u.observable(!1);this.exitDevMode=f.noop;this.exitDevModeIcon=ht.Discard();this.settingsIcon=p.settings;this.helpIcon=p.help;this.consoleIcon=p.console;this.notificationsContextPane=w.notificationspane==="true";this.showContextualHelp=nt;this.notificationsIcon=
p.notifications;this.feedbackIcon=p.smileyHappy;this.dashboardMessage=u.observable("");this.dashboardSaveButtonText=u.observable("");this.dashboardChanged=u.observable(!1);this.dashboardWritable=u.observable(!1);this.dashboardVisible=u.observable(!1);this.isInOrganizeMode=u.observable(!1)}return __extends(t,n),t})(v.ViewModel);n.ViewModel=et;ot=(function(f){function e(n,r,e){var l=this,h,s,v,p,w,k;if(f.call(this,n,r),h=this.ltm,n.addClass(rt).html(y()),h.registerForDispose(new a.Widget(n.findByClassName(ct),this.options.breadCrumb)),h.registerForDispose(new c.Widget(n.findByClassName("fxs-topbar-avatarmenu"),this.options.avatarMenu)),this._feedbackButtonClick=function(){r.feedbackButtonClick()},this._helpButtonClick=function(){r.helpButtonClick&&r.helpButtonClick()},s=this.ltm,u.reactor(s,(function(){n.toggleClass(pt,!!r.inDevMode()).toggleClass("fxs-bg-warning",!!r.inDevMode())})),u.reactor(s,(function(){var n=r.dashboardWritable(),i=n?b.saveDashboardButton:b.saveDashboardCopyButton,t;r.dashboardSaveButtonText(
i);t=n?b.saveMessage:b.saveCopyMessage;r.dashboardMessage(t)})),v=tt(n,ut),p=tt(n,wt),u.reactor(s,(function(){n.toggleClass(kt,!!r.dashboardChanged());n.toggleClass(bt,!!r.dashboardVisible());o.toggle(v,!!r.isInOrganizeMode());var i="fxs-portal-button-primary",u="fxs-button-default",f=p.findByClassName("fxs-button"),t=f.filter(o.getUnhideSelector());t&&t.length&&(t.slice(1).removeClass(i).addClass(u),t.first().removeClass(u).addClass(i))})),this._bindDescendants(),this._attachEventHandlers(n),i.isFeatureEnabled("azureconsole")){w=i.memoizeQ((function(){var n;return i.require("MsPortalImpl/Widgets/Widgets.Console").then((function(t){return n=t})).then((function(){return l.options.getConsoleViewModel()})).then((function(t){return new n.Widget(e,t)}))}));n.findByClassName(ti).css("display","flex").on(t.click,(function(){w().then((function(n){return n.toggle()}))}))}if(nt){k=n.findByClassName(d);k.on(t.click,(function(n){n.preventDefault();l._helpButtonClick()}))}}return __extends(e,f),e.prototype.dispose=
function(){this._cleanElement(rt);f.prototype.dispose.call(this)},e.prototype._reportBug=function(n,t){t.preventDefault();n.data.reportBug()},e.prototype._exitDevMode=function(n,t){t.preventDefault();n.data.exitDevMode()},e.prototype._attachEventHandlers=function(i){function f(n,t){var r=t&&{action:t}||undefined;i.trigger(n,r)}function u(n,r){i.on(t.click,n,r)}function e(n,t){ri({source:ii,action:n,data:t})}function o(n,t,i){return function(r){r.preventDefault();t&&e(t,i);f(n)}}var s=this.options;u("."+lt+", ."+ut,o(g,r.CustomizeModeExited,{dashboardChanged:!!s.dashboardChanged(),onDashboard:!!s.dashboardVisible()}));u("."+at,o(t.fxhomebuttonclick,r.HomeButtonClicked));u("."+yt,o(t.fxsettingsbuttonclick));u("."+vt,o(t.fxnotificationsbuttonclick));u("."+dt,(function(){var t=s.dashboardWritable(),i=t?1:2,u=t?r.DashboardPublish:r.DashboardSaveACopy;e(u);f(n.fxfinishdashboardedit,i);i===1&&f(g)}));u("."+gt,(function(){e(r.DashboardDiscard);f(n.fxfinishdashboardedit,3);f(g)}));u("."+ni,(function(
){e(r.DashboardView);f(t.fxhomebuttonclick)}))},e})(v.Widget);n.Widget=ot})(p||(p={})),p}));define("MsPortalImpl/UI/Dashboard/DashboardManager",["require","exports","f","i","o","ko","$","./../../Base/Base.Router","./ArmDashboardRepository","./DashboardCompressor","./DashboardRepository","../../Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","./PrivateDashboardRepository","../../Services/Services.SelectedSubscriptions","../../Services/Services.Settings.Schema","../../Base/Telemetry","../Compositions/UI.Composition","../Compositions/UI.Composition.Base","../Compositions/UI.Composition.CompositionBinder","../Compositions/UI.Composition.Part","../Compositions/UI.Composition.PartSettingsManager","../Compositions/UI.Composition.StartBoard","../Compositions/UI.Composition.StartboardPart","./DashboardClient","./RecommendedDashboardRepository","../UI.DesktopManager","../../Widgets/Widgets.Common","../../Widgets/Widgets.StartBoard","../../Widgets/Widgets.TopBar"],
(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st){"use strict";var ht;return (function(t){function wi(n){var r=n||{},u=r.model,f=r.metadata;return{model:i.extend2(t.defaultDashboardModelJson.model,u),metadata:i.extend2(t.defaultDashboardModelJson.metadata,f)}}function ht(n,t,i){return new ri(n,t||new Error,i)}function er(n){var t=n.services,e=new di(t.settings),o=new ei(t),i=new h.DashboardCompressor,r=new oi(e,n.services.desktop.portalWidget.getTopBarWidget(),n.lifetime,o,i,n.services.storageService),c=new s.ArmDashboardRepository(n.lifetime,t.extensionManager,t.permissionsManager,i),u,f;return r.addRepository(c),u=rt.create(t.extensionManager),f=new ut.RecommendedDashboardRepository(u,i),r.addRepository(f),r}function bi(n){return n.id.toLowerCase().replace(/\/\/+/g,"/")}function pt(n,t){return bi(n)===bi(t)}function ui(n){return Q(n)}function fi(n,t){return nt.buildIdentitySettingKey(n,t)}function dt(n){return yt.start({source:nr.Dashboard,action:n,actionModifier:
tr.Start})}function or(n){var t={},r=n[wt],e=r.widgetState||{},o=e.NormalState&&e.NormalState.layoutSettings||{},s=[];return u.keys(n).filter((function(n){return tt.isStartboardPartKey(n)})).forEach((function(r){var u=n[r],c=l.Locator.fromJSON(u.locator),y=ai(u.containerModel),b=fi(c,y),p=f.toJS(y),a,e,v,w,h;p[ti]=i.getUniqueId();a=ii(p);u.containerModel=g.getSerializableContainerModel(a,!1);e=k.createIdentifier(gt.StartboardPart,c);u.id=e;t[e]=u;v=n[b];v&&(w=fi(c,a),t[w]=v);h=(o.positions||[]).first((function(n){return n.id===r}));h&&(h.id=e,s.push(h))})),o.positions=s,t[wt]=r,JSON.parse(JSON.stringify(t))}function sr(n){var r=n&&n.relative,f=n&&n.absolute,t="",i,u;if(r){i=r.duration;u=r.timeUnit;switch(u){case ni.Week:i===1&&(t=bt.pastWeek);break;case ni.Hour:i===1?t=bt.pastHour:i===24&&(t=bt.past24Hours)}}else f&&(t=bt.custom);return t}function hr(n){var t=n&&n.model&&n.model.model;return t&&t.timeRange}function vt(n,t){n&&o.updateDashboardUri(n.id,t)}function ft(n,t){n._startboard.widget.
options.loading(t)}var si=i.Base,hi=si.Diagnostics,ki=i.Hubs.Notifications.NotificationStatus,di=v.PrivateDashboardRepository,gt=b.CompositionType,ci=i.Composition.Configuration,gi=d.CompositionBinder,ni=ci.TimeUnit,yt=hi.Telemetry,nr=w.Source,li=w.Action,tr=yt.ActionModifier,ir=window,at=ir.fx,ct=hi.createLog(n),wt=p.startBoardSettingsKey,rr=10,ti=b.PartContainerModelIdProperty,ur=nt.partIdentityStatePrefix,lt=a.Dashboard,bt=a.Filter.Option,fr=a.NavBar.home,kt=si.Constants.DefaultCloudName,ii=gi.createObservableModel,ai=g.createContainerModel,vi="create",yi="clone",pi="unpublish",ri,ei,oi;t.defaultDashboardModelJson={model:{timeRange:{relative:{duration:24,timeUnit:ni.Hour}}},metadata:{timeRange:ci.TimeRangeValueType}};t.backfillDashboardModel=wi;ri=(function(n){function t(t,i,r){n.call(this,{code:t,data:r||{},message:i.message,stack:i.stack,innerErrors:i})}return __extends(t,n),t.TypeName="MsPortalImpl.UI.DashBoardError",t})(i.Errors.Error);t.create=er;t.isSameDashboard=pt;t.startTrace=
dt;ei=(function(){function n(n){this._desktopManager=n.desktop;this._settingsManager=n.settings;this._notificationManager=n.notificationManager}return n.prototype.collectDashboardSettings=function(n){var o=this,u={},s=n.toJSON(),t=n.children.filter((function(n){return!n.dontSetupWidget&&!n.isDisposed()})),f=n.widget.getDomOrderedChildren(),r;return t.length!==f.length&&ct.error("There should be the same number of composed parts to save ("+t.length+") as the number of positioned elements in the layout ("+f.length+"). The settings will be incorrect."),r=[],f.forEach((function(n){var u=i.remove(t,(function(t){return t.id===n}));if(u.length!==1){ct.error("There should be a composed part with ID '"+n+"' yet none was found. The saved content will be incorrect. The settings will be incorrect.");return}r.push(o.getPartSettings(u[0]))})),t.length>0&&t.forEach((function(n){ct.error("Part '"+n.id+"' should have a position defined in the layout, yet none was found. The settings will be incorrect.");r.push(
o.getPartSettings(n))})),Q.allSettled(r).then((function(n){return n.forEach((function(n){e.extend(u,n.value)})),u[wt]=s,JSON.parse(JSON.stringify(u))}))},n.prototype.getPartSettings=function(n){var t=this;return Q(n.awaitComposed()).then((function(){var o;if(n.isDisposed())return{};var s={},r=n.toJSON(),u=n.containerModel;return u[ti]||(o=f.toJS(ai(r.containerModel)),o[ti]=i.getUniqueId(),u=ii(o),r.containerModel=g.getSerializableContainerModel(u,!1)),s[r.id]=r,t.getPartIdentitySettings(n,u).then((function(n){return e.extend(s,n)}))})).catch((function(t){return ct.error(t,8,"part: '"+n.id+"'."),{}}))},n.prototype.getPartIdentitySettings=function(n,t){var r=n.partDefinition,i;return!r||!r.partState?Q({}):(i=fi(n.locator,t),n.getPartSettingsManager().getStartboardPartIdentitySettings().then((function(n){if(!n)return{};var t={};return t[i]=n,t})).catch((function(t){return ct.error(t,9,"Failed to get part '"+n.id+"' identify settings for key '"+i+"'."),{}})))},n.prototype.clearStartboard=function(n,t){var
i=this._desktopManager;n.children.filter((function(n){return!n.dontSetupWidget})).forEach((function(n){return i.removeTile(n.id,{force:!0,skipSave:t})}))},n.prototype.renderStartboard=function(n,t,r){var f=r.delayRendering,s=r.isCurrentDashboardShared,e=u.keys(t),h=function(n,t){var r={};return i.shallowCopyFromObject(r,n,t),r},c=e.filter((function(n){return i.startsWith(n,ur)})),o;this._settingsManager.setSettings({store:13,settings:h(t,c)});o=t[wt];n.widget.options.applyViewSettings(o.widgetState);e.filter((function(n){return tt.isStartboardPartKey(n)})).forEach((function(i){var h=t[i],u=it.Instance.fromJSON(n.services,h),e,o;u.isOnSharedDashboard=s;e=u.locator.getExtensionLocator();o=n.services.extensionManager.getExtension(e.name,e.cloudName);(o||!r.isDefault)&&(n.addChild(u),f||(u.compose(n.widget),u.save()))}));f||(n.discardWidgetStateOfUnusedChildren(),n.save())},n.prototype.readDashboardsOfMaxCount=function(n,t,i,r){n=n.slice();i=i.slice();var u=[],e=i.map((function(n){return n.id.toLowerCase(
)})),f=function(){var i=n.shift();return i.readDashboards().then((function(n){return r(n,i.getTypeName()),n.filter((function(n){return e.indexOf(n.id.toLowerCase())<0})).slice(0,t-u.length)})).catch((function(n){var t=i.getTypeName();return ct.error(n,10,"Failed to read dashboards from '"+t+"' repository."),[]})).then((function(i){return u.push.apply(u,i),u.length>=t||!n.length?Q():f()}))};return f().then((function(){return u}))},n.prototype.enterOrganizeMode=function(n){var t=this._desktopManager;t.mode(1);n&&t.portalWidget.options.sideBar.isCollapsed(!n)},n.prototype.isStartboardReady=function(){return this._desktopManager.startBoardPartsLoaded()},n.prototype.getStartboardReadyPromise=function(){return this._desktopManager.getStartboardPartsLoadedPromise()},n.prototype.popNotification=function(n,t,i){i===void 0&&(i=ki.Error);this._notificationManager.addClientNotification({title:n,description:t,cloudName:kt,status:i,timestamp:new Date})},n})();t.DashboardHelperImpl=ei;oi=(function(){function n(n,
t,i,r,u,e){this.currentDashboardId=f.observable("");this._privateRepo=n;this._topbarWidget=t;this._lifetime=i;this._helper=r;this._compressor=u;this._storage=e;this._otherRepos=[];this._isStartboardChanging=!1;this._isMigrated=!1;this._armDashboardCache=[];this._isStartboardShared=f.observable(!1)}return n.prototype.resetLayout=function(n){var t=this._helper,i=s.normalizedDashboard(at.environment.defaultDashboard||{}),r=this._compressor.uncompress(lt.defaultTitle,i);t.clearStartboard(n);t.renderStartboard(n,r.settings,{delayRendering:!1,isDefault:!0,isCurrentDashboardShared:this.isCurrentDashboardShared()})},n.prototype.isCurrentDashboardShared=function(){var n=this._curDashboard&&this._findOwningRepo(this._curDashboard.id);return n&&n.getTypeName()===c.ArmDashboardRepository},n.prototype.isCurrentDashboardWritable=function(){return this._isWritable(this._curDashboard.id)},n.prototype.getCurrentDashboardProperties=function(){var n=this._curDashboard,t=this._findOwningRepo(n.id);return t&&
t.getDashboardProperties?t.getDashboardProperties(n):{id:n.id,title:n.title}},n.prototype.initialize=function(n,t,r,u,f){var e=this,h,s;return this._startboard=n,this._registerEventHandlers(this._lifetime),h=i.isFeatureEnabled("addsessiondashboardrepository")?i.require("MsPortalImpl/UI/Dashboard/SessionDashboardRepository").then((function(n){var t=new n.SessionDashboardRepository(e._storage);e.addRepository(t)})):Q(),s=h.then((function(){return t?(e._isMigrated=!0,e._initDashboard(t,f)):e._migrateStartboard().then((function(){return f.dashboardMigration=at.getTimestamp(),r?e.switchDashboard({id:r,title:r},"DeepLinkAfterMigration"):Q()}))})).then((function(){f.dashboardInitialized=at.getTimestamp();(o.isDashboardRoute()||o.isDashboardUri()&&!t)&&vt(e._curDashboard,!0)})).catch((function(n){e._handleError(n,"initializeDashboard")})).finally((function(){e._endDashboardRevealedTrace(u,"PortalLoad").then((function(){f.dashboardRevealed=at.getTimestamp()}))})),s.finally((function(){e._preloading()})),s},n.prototype.
addRepository=function(n){this._otherRepos.push(n)},n.prototype.readDashboardsForType=function(n){return this._getRepositoryByType(n).readDashboards()},n.prototype.startNewDashboard=function(){var n=this;return this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw ht(6,null,{action:vi});})).then((function(){return ft(n,!0),n._addToRecent(n._curDashboard)})).then((function(){return n._privateRepo.createDefaultDashboard()})).then((function(t){return n._setCurDashboard(t,!0),vt(t),n._isStartboardChanging=!0,n._helper.clearStartboard(n._startboard),n._isStartboardChanging=!1,n._startboard.save(),n._saveDashboard(n._curDashboard)})).then((function(){n._helper.enterOrganizeMode(!0)})).catch((function(t){n._handleError(t,"startNewDashboard")})).finally((function(){ft(n,!1)}))},n.prototype.saveCurrentDashboard=function(){var n=this;return this._saveDashboard(this._curDashboard).catch((function(t){n._handleError(t,"saveCurrentDashboard")}))},n.prototype.cloneCurrentDashboard=function(
n){var t=this;return n===void 0&&(n=!0),this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw ht(6,null,{action:yi});})).then((function(){return t._isStartboardChanging=!0,ft(t,!0),t._collectDashboardSettings(n,!0)})).then((function(n){return t._addToRecent(t._curDashboard).then((function(){return n}))})).then((function(n){return t._privateRepo.cloneDashboard(n,t._curDashboard.title)})).then((function(n){return vt(n),t._loadDashboard(n,!1,!0)})).then((function(){t._helper.enterOrganizeMode()})).catch((function(n){t._handleError(n,"cloneCurrentDashboard")})).finally((function(){t._isStartboardChanging=!1;ft(t,!1)}))},n.prototype.deleteCurrentDashboard=function(n){var t=this,i="deleteCurrentDashboard";return this._isStartboardChanging=!0,ft(this,!0),this._readNextDashboards(1).then((function(n){if(n.length<=0)throw ht(2);return n[0]})).then((function(r){return t._deleteDashboard(t._curDashboard,n).catch((function(n){return t._handleError(n,i)})).then((function(){return r}))})).then((function(
n){return vt(n,!0),t._loadDashboard(n)})).catch((function(n){t._handleError(n,i)})).finally((function(){t._isStartboardChanging=!1;ft(t,!1)}))},n.prototype.restoreCurrentDashboard=function(){var n=this;return this._isStartboardChanging=!0,ft(this,!0),this._loadDashboard(this._curDashboard).catch((function(t){n._handleError(t,"restoreCurrentDashboard")})).finally((function(){n._isStartboardChanging=!1;ft(n,!1)}))},n.prototype.switchDashboard=function(n,t){var i=this,r=pt(this._curDashboard,n),u;return(vt(n,r),r)?Q():(u=dt("DashboardRevealed"),ft(this,!0),Q(this._switchDashboard(n,!1)).finally((function(){ft(i,!1);i._endDashboardRevealedTrace(u,t)})))},n.prototype._endDashboardRevealedTrace=function(n,t){var i=this._curDashboard.id;return Q.allSettled(this._startboard.children.map((function(n){return Q(n.awaitComposed()).then((function(){return n.awaitOnInputsSetComplete()})).then((function(){return n}),(function(){return n}))}))).then((function(r){yt.completeTrace(n,{success:!0,dashboardId:i,parts:r.map((function(
n){var t=n.value;return{name:t.locator.toFriendlyString(),visible:et.isElementFullyInViewport(t.widget.element[0]).fullyVisible}})),interactionSource:t})}))},n.prototype.populateQuickDashboards=function(n){var t=this;return this._readNextDashboards(rr,(function(i){i=t._curDashboard.id?[t._curDashboard].concat(i):i;n(i)}))},n.prototype.shareCurrentDashboard=function(n,t,i){var r=this,u=this._curDashboard;return ft(this,!0),this.shareCurrentDashboardToArm(n,t,i).then((function(n){return vt(n,!0),r._switchDashboard(n,!0)})).then((function(){return r._deleteDashboard(u,2)})).finally((function(){ft(r,!1)}))},n.prototype.unshareCurrentDashboard=function(){var n=this,i="unshareCurrentDashboard",t=this._curDashboard;return this._privateRepo.canCreateNewDashboard().then((function(t){if(t)return Q();var r=ht(6,null,{action:pi});n._handleError(r,i);throw r;})).then((function(){return ft(n,!0),n._shareCurrentDashboard(c.PrivateDashboardRepository,t.title)})).then((function(t){return vt(t,!0),n._switchDashboard(t)})
).then((function(){return n._deleteDashboard(t,3)})).finally((function(){ft(n,!1)}))},n.prototype.shareCurrentDashboardToArm=function(n,t,i){var r=this,u=dt(li.DashboardPublishNew);return this._shareCurrentDashboard(c.ArmDashboardRepository,n,{subscriptionId:t,resourceGroupName:i}).then((function(n){return yt.completeTrace(u,{success:!0,dashboardId:n.id}),n})).catch((function(f){yt.completeTrace(u,{success:!1});var e=ht(7,f,{dashboardId:r._curDashboard.id,dashboardTitle:n,subscriptionId:t,resourceGroupName:i});r._handleError(e,"shareCurrentDashboardToArm");throw e;}))},n.prototype.shareCurrentDashboardToSession=function(n){var t=this;return this._shareCurrentDashboard(c.SessionDashboardRepository,n).catch((function(i){var r=ht(7,i,{dashboardId:t._curDashboard.id,dashboardTitle:n});t._handleError(r,"shareCurrentDashboardToSession");throw r;}))},n.prototype._registerEventHandlers=function(n){var t=this,o=this._startboard,w=this._topbarWidget.element,k=this._topbarWidget.options,h=o.widget,u=h.element,
c,l,s,a,v,p,e;o.setGetDashboard((function(){return i.clone(t._curDashboard)}));f.reactor(n,(function(){var n,i,r;t.currentDashboardId();n=hr(t._curDashboard);i=sr(n&&n());i&&(r=lt.filterButtonTextFormat.format(i),h.options.filterButtonText(r))}));c=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()};u.on(tt.fxstartboardsettingchanged,c);l=function(n,i){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&i.part.getCompositionType()===gt.StartboardPart&&t._notifyDashboardChanged()};u.on(b.fxreplacedpartcomposing,l);s=function(n,i){var r,u,f;n.stopPropagation();r=i.part;r.getCompositionType()===gt.StartboardPart&&(u=r.getViewModel(),u&&!u.container.operations.inProgress.peek()&&(f=t._privateRepo.identifyDashboard(t._curDashboard.id),(k.dashboardVisible()||f)&&t._notifyDashboardChanged()))};u.on(nt.fxpartsettingchanged,s);u.on(g.fxpartinputchanged,s);a=function(n){n.stopPropagation();var i=h.options;
i.title().length===0&&(o.services.desktop.mode(1),i.title(lt.untitled));t._notifyDashboardChanged()};u.on(ot.fxstartboardtitlechanged,a);v=function(n,i){if(n.stopPropagation(),k.dashboardChanged(!1),!o.notFound())switch(i.action){case 1:t.saveCurrentDashboard();break;case 2:t.cloneCurrentDashboard(!1);break;case 3:t.restoreCurrentDashboard()}};w.on(st.fxfinishdashboardedit,v);p=function(n){n.stopPropagation();t._migrateStartboard()};u.on(ot.fxmigratestartboard,p);e=h.options;e.refreshDashboardList=function(n){return t.populateQuickDashboards(n)};e.switchDashboard=function(n){return t.switchDashboard(n,"RecentList")};e.title.subscribe(n,(function(n){t._curDashboard.title=n}));o.notFound.subscribe(n,(function(n){e.notFound(n)}));e.isShared(this.isCurrentDashboardShared());this._isStartboardShared.subscribe(n,e.isShared,(function(n){e.isShared(n)}));y.selectedSubsUpdateTriggered.subscribe(n,(function(){var n=r.Azure.getAllSubscriptions(r.Rpc.client,kt),t=y.getSelectedSubscriptions(kt);Q.all([n,t]).
spread((function(n,t){var i=n.length,r=t.length;e.subscriptionsInfo(r>=i?lt.browseForAllSubs.format(i):lt.browseForSelectedSubs.format(r,i))}))})).callback(null);n.registerForDispose((function(){o.removeGetDashboard();u.off(tt.fxstartboardsettingchanged,c);u.off(b.fxreplacedpartcomposing,l);u.off(nt.fxpartsettingchanged,s);u.off(g.fxpartinputchanged,s);u.off(ot.fxstartboardtitlechanged,a);u.off(ot.fxmigratestartboard,p);w.off(st.fxfinishdashboardedit,v)}))},n.prototype._notifyDashboardChanged=function(){if(!this._startboard.notFound()){var n=this._privateRepo.identifyDashboard(this._curDashboard.id);n?this.saveCurrentDashboard():this._topbarWidget.options.dashboardChanged(!0)}},n.prototype._setCurDashboard=function(n,t,i){var r,u,f,e;i===void 0&&(i=!1);n=n||{id:"",title:fr};n&&(u=n.settings,f=u&&u[wt],r=f&&f.dashboardModel);r=wi(r);e={model:ii(r.model),metadata:r.metadata};this._curDashboard={id:n.id,title:n.title,isWritable:t,model:e};this._startboard.widget.options.title(n.title);this._topbarWidget.
options.dashboardWritable(t);this.currentDashboardId(n.id);this._startboard.notFound(i);this._isStartboardShared(this.isCurrentDashboardShared())},n.prototype._switchDashboard=function(n,t){var i=this;return this._isStartboardChanging=!0,this._addToRecent(this._curDashboard).then((function(){return i._loadDashboard(n,!1,t)})).catch((function(n){i._handleError(n,"switchDashboard")})).finally((function(){i._isStartboardChanging=!1}))},n.prototype._findOwningRepo=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first((function(t){return t.identifyDashboard(n)}))},n.prototype._getRepositoryByType=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first((function(t){return t.getTypeName()===n}))},n.prototype._readDashboard=function(n){var i=this,t=n.id;return ui(this._findOwningRepo(t)).then((function(n){return n.readDashboard(t)})).then((function(n){if(!n)throw new Error("It succeeded in reading dashboard '"+t+"'. But the result is "+n+".");return n})).catch((function(
r){throw ht(1,r,{dashboardId:t,dashboardTitle:n.title,initDashboardIdFromStore:i.initDashboardIdFromStore});}))},n.prototype._collectDashboardSettings=function(n,t){var i=this,r=n?this._readDashboard(this._curDashboard):Q(null);return r.catch((function(){return null})).then((function(n){return n?n.settings:i._helper.collectDashboardSettings(i._startboard)})).then((function(n){return t?or(n):n}))},n.prototype._saveDashboard=function(n){var r=this,t=n.id,i=n.title;return this._collectDashboardSettings().then((function(n){return ui(r._findOwningRepo(t)).then((function(r){return r.updateDashboard(t,{settings:n,title:i})}))})).catch((function(t){throw ht(5,t,{dashboardId:n.id,dashboardTitle:i});}))},n.prototype._deleteDashboard=function(n,t){var e=this,r=n.id,f,u;return i.remove(this._armDashboardCache,(function(n){return n.id.toLowerCase()===r.toLowerCase()})),f=dt(li.DashboardDelete),u=!0,this._removeFromRecent(r).then((function(){var n=e._findOwningRepo(r);return n.deleteDashboard(r)})).catch((function(t)
{u=!1;throw ht(4,t,{dashboardId:r,dashboardTitle:n.title});})).finally((function(){yt.completeTrace(f,{success:u,dashboardId:r,reason:t})}))},n.prototype._readNextDashboards=function(n,t){var r=this;t||(t=i.noop);var u=function(t,i){return t=i?s.filterDashboards(t,i):t,t.filter((function(n){return!pt(n,r._curDashboard)})).slice(0,n)},f=y.getSelectedSubscriptions(kt).catch((function(){return[]})),e=this._privateRepo.getRecentDashboards().catch((function(){return[]}));return Q.all([f,e]).spread((function(f,e){var o=f.map((function(n){return n.subscriptionId}));return(e=u(e,o),e.length>=n)?(t(e),Q(e)):r._privateRepo.readDashboards().catch((function(){return[]})).then((function(f){var s=i.union(e,f,pt);return(s=u(s),s.length>=n)?(t(s),s):(s=i.union(s,r._armDashboardCache,pt),s=u(s,o),t(s),s.length>=n)?s:r._helper.readDashboardsOfMaxCount(r._otherRepos,n-s.length,s,(function(n,f){f===c.ArmDashboardRepository&&(r._armDashboardCache=n);s=i.union(s,n,pt);s=u(s);t(s)})).then((function(){return s}))}))}))},n.prototype.
_preloading=function(){var n=this;return this.readDashboardsForType(c.ArmDashboardRepository).then((function(t){n._armDashboardCache=t}))},n.prototype._isWritable=function(n){return ui(this._findOwningRepo(n)).then((function(t){return t.isDashboardWritable(n)})).catch((function(){return!0}))},n.prototype._addToRecent=function(n){return this._startboard.notFound()?Q():this._privateRepo.addToRecent(n).catch(e.noop)},n.prototype._removeFromRecent=function(n){return this._privateRepo.removeFromRecent(n).catch(e.noop)},n.prototype._loadDashboard=function(n,t,i,r){var u=this,f=n.id,o=i?Q(n):this._readDashboard(n),e=this._helper;return r=r||{},Q.all([this._removeFromRecent(f).then((function(){r.dashboardRemoveFromRecent=at.getTimestamp()})),this._isWritable(f).then((function(n){return r.dashboardIsWritable=at.getTimestamp(),n})),o.then((function(n){return r.dashboardRead=at.getTimestamp(),n}))]).spread((function(n,i,r){u._setCurDashboard(r,i);e.clearStartboard(u._startboard);e.renderStartboard(u._startboard,
r.settings,{delayRendering:t,isCurrentDashboardShared:u.isCurrentDashboardShared()})})).catch((function(t){u._setCurDashboard(n,!0,!0);u._startboard.notFound()||u._startboard.save();throw t;}))},n.prototype._migrateStartboard=function(){var n=this,t=this._startboard.widget.options,i=a.NavBar.home;return this._helper.getStartboardReadyPromise().then((function(){return n._privateRepo.createDefaultDashboard(i)})).then((function(t){return n._setCurDashboard(null,!0),n._startboard.save(),n._saveDashboard(t).then((function(){return t}))})).then((function(i){t.headerMode(1);n._setCurDashboard(i,!0);n._startboard.save();n._isMigrated=!0})).catch((function(n){throw ht(3,n);}))},n.prototype._initDashboard=function(n,t){var i=this,r=this._startboard.widget.options;return r.headerMode(1),this._loadDashboard(n,!0,!1,t).then((function(){i._startboard.logChildren()}))},n.prototype._shareCurrentDashboard=function(n,t,i){var r=this._getRepositoryByType(n);return this._collectDashboardSettings(!0,!0).then((function(n){
return r.createDashboard({title:t,settings:n,extras:i})}))},n.prototype._handleError=function(n,t){var o=this,e=this._startboard.widget.options,r=this._helper,u=lt.Notification.errorTitle,i=lt.Error,f=function(n,i){ct.error(n,n.code,t+": "+i)},s=function(n){var u=n.data,i=u.dashboardId,f=u.dashboardTitle;ct.warning(n,n.code,t+": Failed to find dashboard '"+i);var r=o._findOwningRepo(i),s={id:i,title:f},h=r&&r.getNotFoundMessage?r.getNotFoundMessage(s):lt.NotFound.defaultMessageFormat.format(f);e.notFoundMessage(h)},h=function(){r.popNotification(u,i.cannotDelete)},c=function(n){f(n,"Failed to migrate startboard.");e.headerMode(2)},l=function(n){var t=n.data;f(n,"Failed to delete dashboard '"+t.dashboardId+"'");r.popNotification(u,i.failToDeleteFormat.format(t.dashboardTitle,n.message))},a=function(n){var t=n.data;f(n,"Failed to save dashboard '"+t.dashboardId+"'.");r.popNotification(u,i.failToSaveFormat.format(t.dashboardTitle))},v=function(n){var f=n.data.action,t="";switch(f){case vi:
t=i.cannotCreate;break;case yi:t=i.cannotClone;break;case pi:t=i.cannotUnpublish}r.popNotification(u,t)},y=function(n){var t=n.data,e=t.dashboardId,o=t.dashboardTitle,s=t.resourceGroupName,h=t.subscriptionId;f(n,"Failed to publish dashboard '"+e+"'");r.popNotification(u,i.failToPublishFormat.format(o,s,h,n.message))},p=function(){ct.error(n,0,t);r.popNotification(u,i.unknown)};if(n instanceof ri)switch(n.code){case 1:s(n);break;case 2:h();break;case 3:c(n);break;case 4:l(n);break;case 5:a(n);break;case 6:v(n);break;case 7:y(n)}else p()},n})();t.DashboardManagerImpl=oi})(ht||(ht={})),ht}));define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","f","i","o","ko","../Extension/Extension.Definition.Locator","../Base/Telemetry","./UI.DesktopManager"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function v(n,t){s.isTraceEnabled&&b.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(n,t.toString(),f.toJSON(t.getInputsOnlyViewModel())))}function k(n,t){return new
h(n,t)}var y=e.LocatorType,p=r.Extension,c=i.Base.Diagnostics,w=c.Telemetry,l=i.Base.EventTypes,a=window,b=c.createLog(n),h;t.showConfirmDialog=a.confirm.bind(a);h=(function(){function n(n,t){var i=this;this._portalWidget=n;this._panoramaWidget=n.getPanorama();this._contextPane=t;this._portalWidget.element.on(l.fxautosettings,(function(n,t){i._autoOpenedBy=t}))}return u.defineProperty(n.prototype,"portalWidget",{get:function(){return this._portalWidget},enumerable:!0,configurable:!0}),n.prototype.composeJourney=function(n){n&&(n.compose(this._panoramaWidget),n.isStartedWithContextBlade()||this._portalWidget.showJourney())},n.prototype.composeStartBoard=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.addPartToStartBoard=function(n){n.compose(this._panoramaWidget.getStartBoardWidget())},n.prototype.addBlade=function(n,t){var f,r,u;return(v("Adding blade to desktop.",n),f=n.parent,r=f.blades,w.trace({action:"JourneyLength",source:o.Source.Desktop,data:{count:r.length,blades:r.map(
(function(n){var t=n.locator;return{bladeName:t.name,extension:p.getWindowId(t.getExtensionLocator())}}))}}),n.flags&1)?this._contextPane.tryOpen(n).then(i.noop):(this._autoOpenedBy&&(u=n.masterContainer,u&&u.instanceId===this._autoOpenedBy.masterBladeId&&(t||(t={}),t.autoOpenedByBlade=this._autoOpenedBy.masterBladeId,t.autoOpenedByPart=this._autoOpenedBy.masterPartId),this._autoOpenedBy=null),n.compose(this._panoramaWidget.getJourneyWidget(),t),t&&t.focus&&n.awaitWidgetReadyToDisplay().done((function(){var i=n.containerWidget;i.element.trigger(l.fxensureviewportvisible,{widget:i,alignStart:t.alignToStart})})),Q())},n.prototype.removeBlade=function(n){v("Removing blade from desktop.",n);var t=this._contextPane;t.hasContent(n)?t.close(!0):this._panoramaWidget.removeChild(n.id)},n.prototype.removeAllBlades=function(n){var t=this._panoramaWidget.getJourneyWidget();t&&t.removeChildren(n);var i=this._contextPane,r=i.getContent(),u=r&&r.locator;u&&u.type===y.Blade&&i.close(!0)},n.prototype.showConfirmDialog=
function(n){return!!t.showConfirmDialog(n)},n})();t.DesktopManagerViewImpl=h;t.create=k})(h||(h={})),h}));define("MsPortalImpl/Extension/ViewModelManager",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i,r){t[n]={name:n,modulePath:i,factory:r}}function o(n,t,i){r[n]={name:n,modulePath:t,factoryWithState:i}}function s(n,t,i){u[n]={name:name,modulePath:t,factoryWithPrefix:i}}function h(n,e,o){var s=null,h=null,c=i.Helpers.Deferred();return(e in t?(s=t[e].modulePath,h=t[e].factory):e in r&&(s=r[e].modulePath,h=function(n){return r[e].factoryWithState(n,o)}),f(u,(function(t,i){e.startsWith(t)&&(s=i.modulePath,h=function(t){return i.factoryWithPrefix(t,o,e,n)})})),s)?(i.require(s).then((function(n){c.resolve(h(n))}),(function(n){c.reject(n.message)})),c.promise()):null}var t={},r={},u={},f=i.forEachKey;n.register=e;n.registerWithState=o;n.registerPrefix=s;n.resolve=h})(r||(r={})),r}));define("MsPortalImpl/UI/UI.DesktopManagerImpl",["require","exports","f",
"o","ko","$","../Base/Base.Events","../Base/Base.Router","../Extension/DefinitionPreprocessor","../Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.Settings.Schema","../Services/Services.EditScopeManagement","../Base/Telemetry","./Compositions/UI.Composition","./Compositions/UI.Composition.Base","./Compositions/UI.Composition.Part","./Compositions/UI.Composition.StartBoard","./Compositions/UI.Composition.StartboardPart","./Dashboard/DashboardManager","./UI.DesktopManager","./UI.DesktopManagerView","../Extension/ViewModelManager","./Compositions/UI.Composition.Base"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){"use strict";var it;return (function(t){function ii(n,t,i,r){return ct.startTrace({source:n,action:t,name:i,assetType:r})}function ri(){return lt("MsPortalImpl/UI/UI.Desktop.Actions")}function ar(n,t){var i=nt.create(n,t.contextPane);return new fi(i,t)}function vr(){return null}function yr(n,t){var i=[],r={},u=
ur[y.CompositionType.StartboardPart];return or(n,(function(n,t){var f=b.isStartboardPartKey(n),e=ti(n,u+"-"+wt)||ti(n,u+"-"+bt);!f||e?r[n]=t:i.push(n)})),i.length&&t.deleteSettings({store:4,keys:i}),r}function pr(n){var t=n[l.startBoardSettingsKey]||{},i=t.dashboardId;return!i?null:{id:i,title:t.dashboardTitle||c.NavBar.home}}function pi(n,t){if(!t)return n;if(n){var i=t.toLowerCase(),r=(n.id||"").toLowerCase()===i;return r?n:{id:i,title:i}}return null}function ui(n,t,i){n.removeChild(t,!1,!i&&!t.dontSetupWidget)}function wi(n){return n&&n.locator&&n.locator.toFriendlyString()}function wr(t){var r=gi.composePartViewModel,u=tt.registerWithState,f=n.normalize("./UI.BladeLauncher"),i;u("Shell$BladeLauncherViewModel",f,(function(n,t){return r((function(i){return new n.BladeLauncher(i,t)}),{initialState:t,createSelectable:!0,logArea:f})}));i=n.normalize("./UI.AssetBladeLauncher");u("Shell$AssetBladeLauncherViewModel",i,(function(n,u){return r((function(i){return new n.AssetBladeLauncher(i,u,t)}),{initialState:
u,createSelectable:!0,logArea:i})}))}function br(n,t,i,r){var u,f="Unable to replace part '"+(n&&n.toString())+"', ";return n&&t?n.isDisposed()?u=f+"it has already been disposed.":n.getPartsContainer()?n.widget&&n.parent&&n.parent.widget||(u=f+"the part or its parent have not been composed."):u=f+"it is not a child of a PartsContainerComposition.":u="Replace part requires a part and a new locator.",u&&r&&r(u),!!u==!1}var bi=h.Locator,ot=h.LocatorType,at=FxImpl,st=at.Extension,ki=st.CloudName,di=at.TriggerableLifetimeManager,gi=at.ViewModels.Part,ut=i,vt=ut.Base,nr=vt.Constants,tr=nr.ExtensionNames,yt=tr.Hubs,ei=vt.Diagnostics,ir=ei.Telemetry,pt=vt.EventTypes,oi=ut.Parts.PartSize,rr=ut.ViewModels.Dialogs.MessageBoxButtons,ur=y.CompositionType,it=g.DesktopManagerEvents,si=a.EditScopeState,ft=ut.Helpers,fr=h.DefinitionFinderImpl,hi=i.deepEquals,ci=i.getUniqueId,et=i.tryImmediateResolve,wt="AssetBladeLauncher",bt="BladeLauncher",kt=window,p=ei.createLog(n),dt=v.Source.Desktop,gt=v.Action,ht=
c.Desktop,rt={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."},ni=l.desktopSettingsKey,ct=ir,kr=kt.fx.environment,li=8,er=4,or=ut.forEachKey,ti=ut.startsWith,lt=ut.require,ai=bi.forExtension,sr=it.journeyDeactivated,dr=it.journeyActivated,hr=it.journeyDiscarded,vi=it.journeyCreated,cr=it.settingsLoaded,lr="./Compositions/UI.Composition.Journey",yi="./Compositions/UI.Composition.Blade",fi;t.organizeModeModules={dragDrop:"MsPortalImpl/UI/UI.DragDropCompositionManager"};t.createDesktopManager=ar;t.getCurrent=vr;t.resolveInitialDashboard=pi;fi=(function(){function h(n,t){this._previousActiveJourney="";this._startboardPartsLoadedDeferred=Q.defer();this._loadedStartBoardPartIds={};this._mode=u.observable(0);this._lifetime=new di;this._hubsCloudName=st.getHubsCloudName();this._dashboardMgrDeferred=Q.defer();this.activeJourney=u.observable(null);this.commandsEnabled=
u.observable(!0);this._loadingJourneyGuid=null;this._view=n;this._services=t;this._initDeferred=ft.Deferred();this._sharedSettings=t.settings;this._portalServices=t;wr(this._services.assetTypeService)}return h.prototype.startBoardPartsLoaded=function(){return Q.isFulfilled(this.getStartboardPartsLoadedPromise())},h.prototype.getStartboardPartsLoadedPromise=function(){return this._startboardPartsLoadedDeferred.promise},r.defineProperty(h.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),r.defineProperty(h.prototype,"isJourneyLoading",{get:function(){return this._loadingJourneyGuid!==null},enumerable:!0,configurable:!0}),h.prototype.initialize=function(n,i,r){var u=this;this._setupOrganizeModeComponents(t.organizeModeModules);this._extensionsMetadata=n;this._services.assetManager.onAssetDeleted((function(n,t,i,r){ri().then((function(f){f.handleAssetDeleted(u,n,t,i,r)}))}));var s=d.startTrace("DashboardRevealed"),e=o.getDashboardIdFromUri(),f=this._dashboardMgr=
d.create({services:this._services,lifetime:this._lifetime});return i.then((function(n){r.startboardSettingsLoaded=kt.fx.getTimestamp();var t,h=n&&n[li]||{},i=n&&n[er]||{},o=pr(i);return(r.dayZero=!i[ni])?(u._startBoard=b.create(u._createCompositionServices()),u._view.composeStartBoard(u._startBoard),u._populateStartBoardFromManifests().then((function(){u._startboardPartsLoadedDeferred.resolve()})),u._initDeferred.resolve()):(t=pi(o,e),u.load(h,i,t&&t.id)),f.initDashboardIdFromStore=o?o.id:"",f.initialize(u._startBoard,t,e,s,r).finally((function(){r.dashboardManagerInitialized=kt.fx.getTimestamp();u._dashboardMgrDeferred.resolve(f);u._initDeferred.resolve()}))})),Q(this._initDeferred.promise())},h.prototype.resetStartBoard=function(n){var t=this,i;return i=n?Q(6):this._services.getService("DialogManager").then((function(n){return n.showModalDialog({title:c.Startboard.resetConfirmationTitle,description:c.Startboard.resetConfirmationText,buttons:rr.YesNo})})),i.then((function(n){var r,i;if(n===6){
for(r=t.startBoard.children,i=r.length-1;i>=0;i--)t.removeTile(r[i].id,{force:!0});t._populateStartBoardFromManifests()}}))},h.prototype._populateStartBoardFromManifests=function(){var n=this,t;return this._dashboardMgr.resetLayout(this._startBoard),this.save(),t=this._services.extensionManager.getExtensions().map((function(t){var r=n._extensionsMetadata.first((function(n){return st.isEqualDescriptor(n,t)})),i=r.startBoardParts;if(r.isTestExtension||i&&i.length)return t.getManifestAsync().then((function(t){n._addStartBoardPartsFromManifest(t,i);n.save()}))})).filter((function(n){return!!n})),Q.allSettled(t)},h.prototype._getExtensionEmailAddress=function(n){var t=this._extensionsMetadata.first((function(t){return t.name===n}));return t&&t.feedbackEmail},h.prototype.getCurrentBladeInfo=function(){var n=this._getBreadCrumb(),i=this._getExtensionEmailAddress(yt),r=n[n.length-1],t=r&&r.extensionName||"",u=t?this._getExtensionEmailAddress(t):i;return{extensionName:t,feedbackTo:u,feedbackCC:i,breadcrumb:
n.map((function(n){return n.title})).join(" > ")}},h.prototype._getBreadCrumb=function(){var t=this.getActiveJourney(),n;return t?(n=t.children,!n||!n.length)?[]:n.map((function(n){return{title:n.isDefaultTitle()?n.id:n.title(),extensionName:n.locator.getExtensionLocator().name,id:n.id}})):[]},h.prototype.createJourney=function(t,i,r){var e=this,s=this._startBoard.children.first((function(n){return n.id===t})),o;return s?(o=ft.Deferred(),r||(r=ci(),this._loadingJourneyGuid=r,this._createNewJourneyPromise=o.promise()),o.promise().finally((function(){e._loadingJourneyGuid===r&&(e._loadingJourneyGuid=null,e._createNewJourneyPromise=null)})),et(Q(s.awaitComposed()),(function(){if(e.tryDeactivateJourney(r)){f(e).trigger(it.journeyCreating,i);var t=e._createCompositionServices(),u=ii(dt,gt.JourneyOpened,wi(s));et(lt(lr,n),(function(r){return e.setActiveJourney(r.create(t,s)),et(lt(yi,n),(function(n){var r=n.create(t,i,e._startBoard),s=e._activeJourney;s.addChild(r);e._view.composeJourney(s);e._startBoard.
detailContainers=[r];e._view.addBlade(r,{assetType:i.originAssetType,focus:!0,reusableWidget:i.reusableWidget}).catch((function(n){p.error(n)}));e._triggerActiveJourneyChanged();e.save();o.resolve(s);f(e).trigger(vi);ct.completeTrace(u);Q.nextTick((function(){e.save()}))}))})).catch((function(n){o.reject(n)}))}else o.reject("tryDeactivateJourney returned false")})),o.promise()):(p.error(rt.noTileInDesktop.format(t)),p.verbose(u.toJSON(this.getDiagnosticsData(),null,2)),ft.Deferred().reject())},h.prototype.createJourneyForBlade=function(n,t){return this._createJourneyWithHiddenPart(yt,bt,n,t,bt,this._hubsCloudName,n.cloudName,n.defaultMenuItemId)},h.prototype.createJourneyForAsset=function(n,t,i){return this._createJourneyWithHiddenPart(yt,wt,{extensionName:n.extension,assetType:n.assetType,assetId:i},t,wt,this._hubsCloudName,n.cloudName,n.defaultMenuItemId,n.assetType)},h.prototype._createJourneyWithHiddenPart=function(n,t,r,u,e,o,s,h,c){var l=this,y,p,a,v;return this._loadingJourneyGuid!==u?Q(
):(y=ii(dt,gt.JourneyOpened,e,c),ki.addToModel(s,r),p=ai(n,o).withPartType(t),a=this.addPartToStartBoard({originPartLocator:p,model:r,defaultMenuItemId:h,reuseExistingPart:!1,dontSetupWidget:!0}),a.isComposed&&a.isSelected()&&this._activeJourney&&this._activeJourney.originTile===a?(this.portalWidget.showJourney(),v=Q()):v=a.selectOnReady((function(){return l._loadingJourneyGuid!==u?!1:!a.isSelected()&&l.tryDeactivateJourney(u)}),{timeoutInMilliseconds:9e4}).then((function(n){n&&(l.save(),f(l).trigger(vi),ct.completeTrace(y))})),i.tryImmediateFinally(v,(function(){l._loadingJourneyGuid===u&&(l._loadingJourneyGuid=null)})))},h.prototype.openSingleBlade=function(n,t){return this._openBlade(n,t,(function(n,i){return i===0&&n.locator.equals(t.locator)}))},h.prototype.openMultipleBlades=function(n,t){var u=this,i=ft.Deferred(),r;return t&&t.length!==0?(r=t.map((function(t){return u._openBlade(n,t,(function(n){return n.locator.equals(t.locator)&&t.model&&n.getViewModel()&&y.deepSubset(n.getViewModel(),
t.model)}))})),f.when.apply(f,r).done((function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];i.resolve(t)})).fail((function(){i.reject()}))):i.resolve([]),i.promise()},h.prototype.confirmBladesCanClose=function(n){var t=this,o=(n||[]).first((function(n){return!t.canCloseBlade(n)})),r,u,f,e;return o?(r=this.activeJourney(),u=[],n.forEach((function(n){var i=t._findFirstItemIndex(r.children,n,rt.noBladeInJourney.format(n));u.push(r.children[i])})),f=[],i.pushUnique(f,i.mapMany(u,(function(n){return t._getAlertMessageRecursive(n)}))),e=f.join("\n"),this._view.showConfirmDialog(e||ht.confirmEditScopeDiscard)):!0},h.prototype.forceCloseBlade=function(n,t,i){var e,r,u=this._activeJourney,f,o,s;if(!u)throw new Error(rt.noActiveJourney);e=this._findFirstItemIndex(u.children,n,rt.noBladeInJourney.format(n));r=u.children[e];this._startBoard.detailContainers.length===1&&this._startBoard.detailContainers[0].id===r.id?this.forceDiscardJourney(u.id,t):(f=r.masterContainer,f&&(o=f.detailContainers,
s=o.indexOf(r),s>=0&&(o.splice(s,1),i&&i.openBlade||f.onDetailContainersChanged())),this._closeBladeRecursive(r,e,t));this._triggerActiveJourneyChanged();this.save()},h.prototype.tryCloseBlade=function(n,t){var i=this.confirmBladesCanClose([n]);return i&&this.forceCloseBlade(n,t),i},h.prototype.closeChildBlades=function(n){var i=this.discardEditsOfBlade(n,{includeSelf:!1,includeDescendants:!0}),t;if(i.successful)for(t=n.detailContainers.length-1;t>=0;t--)this.forceCloseBlade(n.detailContainers[t].id,1);return i},h.prototype.discardEditsOfPart=function(n,t){var r=n.getPartsContainer();return this._discardEditsOfContainer(r,t.force,(function(u){var s=u.path,l=n.journeyPath,e=r.journeyPath,h=hi(s,l),c=!1,f,o;if(!h&&s.length>e.length){try{f=i.parseSortedString(u.path[e.length])}catch(a){p.error("Failed to parse journey path segment for blade '{0)'. Path: '{1}'. Error: '{2}'.".format(r.toString(),JSON.stringify(e),a.message))}c=f&&f.master&&f.master.part===n.id}return o=u.value,o&&o.editScope&&
(t.includeSelf&&h||t.includeDescendants&&c)}))},h.prototype.discardEditsOfBlade=function(n,t){return this._discardEditsOfContainer(n,t.force,(function(i){var r=i.value,u=i.path,f=n.journeyPath,e=hi(u,f),o=!e&&(r.type===ot.Blade||u.length>=f.length+2);return r&&r.editScope&&(t.includeSelf&&e||t.includeDescendants&&o)}))},h.prototype._discardEditsOfContainer=function(n,t,i){var o=this,u=[],s=n,h=n instanceof b.Instance||s.isInitialized,r={confirmationRequired:!1,successful:!1},e=this._activeJourney,f;if(!e)throw new Error(rt.noActiveJourney);return f=e.ambientSettings,h&&(u=f.getItemsInPath(n.journeyPath).filter(i)),r.confirmationRequired=!t&&u.filter((function(n){var t=n.value.editScope;return t.dirty&&!t.saving})).length>0,(!r.confirmationRequired||this._view.showConfirmDialog(ht.confirmEditScopeDiscard))&&(r.successful=!0,u.forEach((function(n){f.removeItem(n.path);o._services.editScopeManager.onEditScopeDisposed(n.value.editScope.editScopeId)}))),r},h.prototype.canCloseBlade=function(n){var
t=this._activeJourney,r=this._findFirstItemIndex(t.children,n,rt.noBladeInJourney.format(n)),u=t.children[r],i=function(n){if(n.shouldAlertOnClose()||n.isInitialized&&!n.children.some((function(n){return n.children.some((function(n){return n.suppressAlert()}))}))&&t.ambientSettings.getItemsInPath(n.journeyPath).some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving})))return!0;var r=n.detailContainers;return!r||r.length===0?!1:(r||[]).some((function(n){return i(n)}))};return!i(u)},h.prototype.addPartToStartBoard=function(n){var i,t,r,u,f;if(!n){p.error("options should be specified for adding a part to the startboard.");return}if(!n.originPartLocator){p.error("options.originPartLocator should be specified for adding a part to the startboard.");return}return i=this._createCompositionServices(),r=n.model,n.reuseExistingPart!==!1&&(t=this._startBoard.children.first((function(t){return t.matchesLocatorAndModel(i.finder,n.originPartLocator,r,n.defaultMenuItemId)}))),t||(t=k.create(
i,n.originPartLocator,r,{modelContainsSensitiveData:n.modelContainsSensitiveData,isOnSharedDashboard:this._dashboardMgr&&this._dashboardMgr.isCurrentDashboardShared()}),t.dontSetupWidget=!!n.dontSetupWidget,u=n.defaultMenuItemId,u&&(t.defaultMenuItemId=u),oi[n.initialSize]&&(t.initialSize=n.initialSize,n.initialSize===oi.Custom&&(t.initialHeight=n.initialHeight,t.initialWidth=n.initialWidth)),f=t.id,this._isStartBoardPartLoaded(f)||(this._isStartBoardPartLoaded(f,!0),this._startBoard.addChild(t,undefined,!t.dontSetupWidget),this._view.addPartToStartBoard(t),t.save(),this.save())),t},h.prototype.pinMultipleParts=function(n,t,i,r){var u=this,f=this._createCompositionServices();return ri().then((function(e){return e.pinMultipleParts(u,f.finder,n,t,i,r)}))},h.prototype.removeTile=function(n,t){var e=this._startBoard,i=e.children.first((function(t){return t.id===n})),r,u;if(i){r=void 0;u=this._activeJourney;u&&u.originTile===i&&(r=u.id);var f=i.editScopeId()&&this._services.editScopeManager.getStateObservable(
i.editScopeId()),s=!f||f()===si.NotDirty||f()===si.DirtyAndSaving,h=!r||this._canDiscardJourney(r),o=t&&t.force||s&&h;(o||this._view.showConfirmDialog(ht.confirmEditScopeDiscard))&&(r&&this.forceDiscardJourney(r),i.clearIdentitySettings(),ui(e,i,t&&t.skipSave),o||i.dontSetupWidget||p.warning("Part '{0}' is removed from the start board.".format(i)),this.save())}},h.prototype.replacePart=function(n,t,i){var o=this,f=n&&n.id,r,s=this._createCompositionServices(),u=ft.Deferred(),h=!0,c,l,e;return i=i||{},br(n,t,i.newPartContainerModel,(function(n){l=n}))?(n instanceof k.Instance?(r=k.create(s,t,i.newPartContainerModel,{id:f,doNotSaveSettings:i.doNotSaveSettings,overridesModel:i.newPartOverridesModel}),e=n,r.dontSetupWidget=e.dontSetupWidget,h=!e.dontSetupWidget):r=w.create(s,t,f,i.newPartContainerModel,i.newPartOverridesModel),r.originalPartLocator=n.originalPartLocator||n.locator,c=n.getPartsContainer(),n.dispose(!0),n.parent.replaceChild(n,r),r instanceof k.Instance&&this._activeJourney&&this.
_activeJourney.originTile===n?this.tryDiscardJourney(this._activeJourney.id):c.getPartsContainer().detailContainers.slice(0).reverse().forEach((function(n){n.masterPartId===f&&o.tryCloseBlade(n.id,1)})),r.widgetState(n.widgetState()),r.save(),h?(r.widget=n.widget,r.recompose(n.parent.widget)):r.compose(n.parent.widget),r.widget.element.trigger(y.fxreplacedpartcomposing,{part:r}),r.awaitComposed().then((function(){u.resolve(r);!i.preventNewPartActivation&&r.partDefinition.details&&r.partDefinition.details.length>0&&r.selectOnReady((function(){return!o._activeJourney}),{timeoutInMilliseconds:15e3})}),(function(){u.reject("Unable to compose the mutated part.")}))):u.reject(l),u.promise()},r.defineProperty(h.prototype,"portalWidget",{get:function(){return this._view.portalWidget},enumerable:!0,configurable:!0}),h.prototype.getDashboardManager=function(){return this._dashboardMgrDeferred.promise},h.prototype.getSettingCollections=function(){var i={},r={},n=this._activeJourney,t=[];return i[ni]=JSON.
parse(JSON.stringify(this)),t.push({store:4,settings:i}),n&&n.children&&(r[n.id]=JSON.parse(JSON.stringify(n)),t.push({store:li,settings:r})),t},h.prototype.dispose=function(){this._lifetime&&(this._lifetime.dispose(),this._lifetime=null);this._onShowStartBoard&&(this.portalWidget.element.off(pt.fxshowstartboard,this._onShowStartBoard),this._onShowStartBoard=null)},h.prototype.save=function(){var n=this;this._initDeferred.promise().finally((function(){n.getSettingCollections().forEach((function(t){n._services.settings.setSettings(t)}))}))},h.prototype.load=function(n,t,i){var r=this,s=this._createCompositionServices(),u=t[ni],e=!1,h,o;u&&u.startBoardId&&t[u.startBoardId]?(h=t[u.startBoardId],e=!!i,e&&(t=yr(t,this._sharedSettings)),this._startBoard=b.Instance.fromJSON(s,t,h)):(p.error("Unable to load StartBoard state from user settings, setting does not exist. Creating a default StartBoard."),this._startBoard=b.create(s));this._removeOrphanedStartboardParts();this._view.composeStartBoard(this.
_startBoard);e||this._initDeferred.resolve();o=this._view.portalWidget.element;o.on(pt.fxshowstartboard,this._onShowStartBoard=function(){var n=r._startBoard.children.slice();n.forEach((function(n){r._displayPartOnStartBoardIfAvailable(n)}));r._startBoard.discardWidgetStateOfUnusedChildren();r._startboardPartsLoadedDeferred.resolve();o.off(pt.fxshowstartboard,r._onShowStartBoard);r._loadingJourneyGuid=null});f(this).trigger(cr)},h.prototype._removeOrphanedStartboardParts=function(){var n=this.startBoard;n.children.slice(0).forEach((function(t){t.dontSetupWidget&&ui(n,t)}))},r.defineProperty(h.prototype,"startBoard",{get:function(){return this._startBoard},enumerable:!0,configurable:!0}),h.prototype.getActiveJourney=function(){return this._activeJourney},h.prototype.setActiveJourney=function(n){this.activeJourney(n);this._activeJourney=n;this.portalWidget.hasActiveJourney=!!n;n&&e.isFullscreen()&&e.exitFullscreen()},h.prototype.generateLoadingJourneyGuid=function(){return this._loadingJourneyGuid=
ci(),this._loadingJourneyGuid},h.prototype.tryDeactivateJourney=function(n){var t=this._activeJourney,r,i,e,u;if(t){if(!this.confirmBladesCanClose(t.children.map((function(n){return n.id}))))return!1;for(r=t.children.filter((function(n){return!n.isRestorable()})),i=r.length-1;i>=0;i--)this.forceCloseBlade(r[i].id);e=t.id;u=ii(dt,gt.JourneyDeactivated,wi(t.originTile));t.save();this._closeActiveJourney(!0);this.save();f(this).trigger(sr);ct.completeTrace(u)}else this._startBoard&&(this._startBoard.detailContainers=[]);return this._loadingJourneyGuid=n||null,!0},h.prototype.tryDiscardJourney=function(n){var t=!1;return(this._canDiscardJourney(n)||this._view.showConfirmDialog(ht.confirmEditScopeDiscard))&&(this.forceDiscardJourney(n),t=!0),t},h.prototype._triggerActiveJourneyChanged=function(){var n=this._activeJourney,t=n?JSON.stringify(n):"";this._previousActiveJourney!==t&&(f(this).trigger(it.activeJourneyChanged),this._previousActiveJourney=t)},h.prototype._canDiscardJourney=function(n){var
t=this._activeJourney&&this._activeJourney.id===n&&this._activeJourney,i=t&&t.ambientSettings.getItems().some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving&&t.disposeOnJourneyDiscard}));return!t||!i},h.prototype.forceDiscardJourney=function(n,t){var i=!1;this._deleteJourneySettings(n);this._activeJourney&&this._activeJourney.id===n&&(this.isJourneyLoading||this.portalWidget.showStartBoard(),this._closeActiveJourney(!1,t),i=!0);i&&(this._triggerActiveJourneyChanged(),this.save(),f(this).trigger(hr))},h.prototype._deleteJourneySettings=function(n){this._sharedSettings.deleteSettings({store:8,keys:[n]})},h.prototype._disposeEditScopes=function(n){var t=this;(n||[]).forEach((function(n){if(n.disposeOnJourneyDiscard)t._services.editScopeManager.onEditScopeDisposed(n.editScopeId)}))},h.prototype.toJSON=function(){return{startBoardId:this._startBoard?this._startBoard.id:null}},h.prototype._addStartBoardPartsFromManifest=function(n,t){var r=this,i=n.startBoardParts,u=ai(
n.name,n.cloudName);t||(t=i.map((function(n){return n.name})));i&&i.length&&t.forEach((function(n){var t=i.first((function(t){return t.name===n})),f;t&&(f=u.withStartboardPartInstance(t.name),r.addPartToStartBoard({originPartLocator:f,initialSize:t.initialSize}))}))},h.prototype._createCompositionServices=function(n){return n?i.extend2(this._services,{finder:n,desktop:this,sharedSettings:this._sharedSettings}):this._thisCompositionServices||(this._thisCompositionServices=i.extend2(this._services,{finder:new fr(this._services.extensionManager),desktop:this,sharedSettings:this._sharedSettings}))},h.prototype._findPartContainer=function(n){var t,i=this._startBoard;if(i&&i.id===n)t=i;else if(this._activeJourney)t=this._findFirstItem(this._activeJourney.children,n,rt.noBladeInJourney.format(n));else throw new Error(rt.noActiveJourney);return t},h.prototype._openBlade=function(t,i,r){var s=this,o=this._findPartContainer(t),v=o instanceof b.Instance,h=ft.Deferred(),e,c,y=this._createCompositionServices(
),l,a;return o?((o.detailContainers||[]).forEach((function(n,t){n.locator.equals(i.locator)&&n.masterPartId===i.masterPartId&&n.masterInvocationProperty===i.masterInvocationProperty&&r(n,t)&&(e=n,h.resolve(e))})),e?(a=e.containerWidget,a&&a.setFocus(),g.isTraceEnabled&&p.verbose("[DesktopManager] Found a previously opened detail blade."+"\n  Existing blade: {0}. Model: {1}.".format(e.toString(),u.toJSON(e.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(u.toJSON(i)))):(f(this).trigger(it.bladeOpening,{masterContainerId:t,bladeDescriptor:i}),l=function(){v&&o.detailContainers.length===0?s.createJourney(i.masterPartId,i).finally((function(n){n&&n.children&&n.children.length>0?h.resolve(n.children[0]):h.reject()})):et(lt(yi,n),(function(n){return et(Q(),(function(){e=n.create(y,i,o);o.detailContainers.unshift(e);o.onDetailContainersChanged();c=v?0:1+s._findFirstItemIndex(s._activeJourney.children,o.id,rt.noBladeInJourney.format(o.id));s._activeJourney.addChild(e,c);s._view.addBlade(
e,{assetType:i.originAssetType,alignToStart:!!(i.flags&8),index:c,reusableWidget:i.reusableWidget,focus:!i.reusableWidget}).catch((function(n){p.error(n)}));s._triggerActiveJourneyChanged();s.save();h.resolve(e)}))})).catch((function(n){h.reject(n)}))},this._createNewJourneyPromise?this._createNewJourneyPromise.always((function(){l()})):l())):h.reject(),h.promise()},h.prototype._closeBladeRecursive=function(n,t,i,r){this._removeBladesFromUIRecursive(n);this._disposeBladesRecursive(n,t,r);r||n.parent.save();r||f(this).trigger(it.bladeClosed,{id:n.id,reason:i})},h.prototype._getAlertMessageRecursive=function(n){var t=function(n){var t=n.detailContainers,r;return t&&t.length!==0?(r=i.mapMany(t,(function(n){return n.getAlertOnCloseMessages()})),i.union(n.getAlertOnCloseMessages(),r)):n.getAlertOnCloseMessages()};return t(n)},h.prototype._removeBladesFromUIRecursive=function(n){for(var i=n.detailContainers,t=i.length-1;t>=0;t--)this._removeBladesFromUIRecursive(i[t]);this._view.removeBlade(n)},h.prototype.
_disposeBladesRecursive=function(n,t,i){var f=this,r=n.parent,u=r.children.indexOf(n,t);i?n.dispose(!0):r.removeChildAt(u,undefined);n.detailContainers.forEach((function(n){f._disposeBladesRecursive(n,u,i)}))},h.prototype._closeActiveJourney=function(n,t){var u=this,i=this._activeJourney,r;this.setActiveJourney(null);this._startBoard.detailContainers=[];i&&(i.children.slice(0).forEach((function(i){i.isDisposed()||u._closeBladeRecursive(i,0,t,n)})),r=i.originTile,r&&r.dontSetupWidget&&!n&&this.removeTile(r.id),i.dispose(n));this._view.removeAllBlades((function(n){p.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(n))}))},h.prototype._findFirstItem=function(n,t,i){var r=this._findFirstItemIndex(n,t,i);return n[r]},h.prototype._findFirstItemIndex=function(n,t,i){var r=n.firstIndex((function(n){return n.id===t}));if(r===-1){p.verbose(u.toJSON(this.getDiagnosticsData(),null,2));throw new Error(i);}return r},h.prototype.
pinPartComposition=function(n){this._startBoard.addChild(n);this._view.addPartToStartBoard(n);n.save();this.save()},h.prototype._isStartBoardPartLoaded=function(n,t){return typeof t=="boolean"?this._loadedStartBoardPartIds[n]=t:!!this._loadedStartBoardPartIds[n]},h.prototype._displayPartOnStartBoardIfAvailable=function(n){var r=this;if(!this._isStartBoardPartLoaded(n.id)){this._isStartBoardPartLoaded(n.id,!0);var t=n.locator,i=t.getExtensionLocator(),u=function(t,i){if(p.warning(t.format(n)),i){var u=r._startBoard;ui(u,n);u.removeChildWidget(n.id)}},f=function(t,i){var f=!1;return t===0?(i||r._view.addPartToStartBoard(n),f=!0):t===1&&(u("[Definition Change] Part '{0}' is not working because it no longer exists in pre-loaded extension definition"),f=!0),f},e=function(i,f){(i.startBoardParts||[]).some((function(n){return n.name===t.name}))?f||r._view.addPartToStartBoard(n):u("[Definition Change] Part '{0}' is not working because it no longer exists in force-loaded extension definition.")};
this._extensionsMetadata.some((function(n){return st.isEqualDescriptor(n,i)}))?f(n.definitionExists(),n.isComposed||n.dontSetupWidget)||(this._view.addPartToStartBoard(n),t.type===ot.StartboardPartInstance?this._services.extensionManager.getManifestByName(i.name,i.cloudName).then((function(n){e(n,!0)})):this._services.extensionManager.getExtensionByName(i.name,i.cloudName).then((function(n){var r=s.PinPrefix,u=t.name,f,i;if(ti(u,r))return f=u.substr(r.length),n.getBladeDefinition(f);for(i=t;i;i=i.parent)if(i.type===ot.Blade)return n.getBladeDefinition(i.name);if(t.type===ot.PartType)return n.getPartDefinition(t.name)})).then((function(){f(n.definitionExists(!0),!0)}))):u("[Definition Change] Part '{0}' will be removed because the extension it belongs to is no longer known by the portal.",!0)}},h.prototype.getDiagnosticsData=function(){var n=this._startBoard,t=this._activeJourney;return{startboard:n&&n.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}},h.prototype.getAssetDiagnosticsData=
function(){var n=this._activeJourney;return n?ri().then((function(t){return t.dumpCompositionAssets(n)})):Q.resolve("No journey")},h.prototype._setupOrganizeModeComponents=function(n){var t=this,i=this._lifetime,r=i.createChildLifetime();this.mode.subscribe(r,(function(u){u===1&&ut.require(n.dragDrop).then((function(n){n.create(i,t,t.portalWidget.element);r.dispose()}))}))},h})();t.DesktopManagerImpl=fi})(it||(it={})),it}));define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","f","o","$","../Interactions/Interactions.DismissHandler","MsPortalImpl/Base/JQueryHelper","../Widgets/Widgets.WidgetBase","../Widgets/Widgets.FlowLayout","../Widgets/Widgets.UIElementBase"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){function yt(n,i){var o=n.target,r=u(o),h;c&&c.htmlTarget!==o||(c={htmlTarget:o,elementObject:r,width:r.outerWidth(!1),height:r.outerHeight(!1)},c&&c.htmlTarget!==o)||(a=y=t=nt(r.closest(it),s.Widget),w.appendTo(r.parent()),h=w.parent(
),i.helper.css({position:"fixed",top:i.offset.top,left:i.offset.left,marginTop:0-h.scrollTop(),marginLeft:0-h.scrollLeft(),pointerEvents:"none"}),e.hide(r),k=l=g(i.helper),f.register(ot,!0))}function pt(n,i){var r=c.elementObject,u=r.draggable("option","revert");f.unregister(ot);u&&r.draggable({revert:!1});rt();u?ht():st(i.helper);e.unhide(r);t?t===y?gt(i.helper):ni(i.helper):dt();w.remove();ct()}function wt(){c.elementObject.draggable({revert:!0}).trigger(b.mouseup)}function bt(n,i){var r;(st(i.helper),t)&&(r=g(i.helper),r.col!==l.col||r.row!==l.row)&&(rt(),l=r,(a!==t||t.dropPlaceholder===null)&&(a&&a.disposeDropPlaceholder(),t.createDropPlaceholder(c.width,c.height),a=t),t.moveDropPlaceholder(r),p=ut.setTimeout((function(){p=null;e.unhide(c.elementObject);t.moveChild(c.elementObject,l.col,l.row,!1);e.hide(c.elementObject)}),at))}function rt(){p&&(ut.clearTimeout(p),p=null)}function st(n){var i=kt(n);t&&t!==i&&ht();t=i}function ht(){t&&(rt(),t.refreshLayout())}function kt(n){var t=n.offset(
),i=w.parent(),r=i.scrollTop(),f=i.scrollLeft(),e=t.left-f+Math.floor(d*v.GridSpacingWidth),o=t.top-r+Math.floor(d*v.GridSpacingHeight),h=u(document.elementFromPoint(e,o)),c=h.closest(it);return nt(c,s.Widget)}function g(n){var i=t.element,r=i.offset(),u=n.offset(),f=u.left-r.left+i.scrollLeft(),e=u.top-r.top+i.scrollTop(),o=Math.floor((f+d*v.GridSpacingWidth)/v.GridSpacingWidth),s=Math.floor((e+d*v.GridSpacingHeight)/v.GridSpacingHeight);return{col:o,row:s}}function dt(){y.moveChild(c.elementObject,k.col,k.row,!0)}function gt(n){l=g(n);y.moveChild(c.elementObject,l.col,l.row,!0)}function ni(n){t.refreshLayout();l=g(n);var i=h.Widget.getId,r=i(c.elementObject),u=y.element.closest(et),f=t.element.closest(et),e=i(u),o=i(f);t.element.trigger(b.fxrearrange,{partId:r,sourceId:e,targetId:o,col:l.col,row:l.row})}function ct(){a&&a.disposeDropPlaceholder();y=null;t=null;k=null;l=null;a=null;c=null}function lt(){var t=u(it),n=[];return t.each((function(t,i){var r=nt(u(i),s.Widget),f=r.options;f.
allowReorder&&!f.locked()&&n.push(r.element.findByClassName("fxs-flowlayout-childcontainer"))})),n}var b=i.Base.EventTypes,v=i.Widgets.AzureGrid,ut=window,nt=o.Widget.getWidget,ft="fxs-drag-disableTouchAction",tt=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",it=".fxs-flowlayout",et=".fxs-lens",ot={dismissFn:function(){wt()},shouldDismissOnMouseDownFn:u.noop,shouldDismissOnMouseWheelFn:u.noop,logName:"flowlayoutdragdrop"},c,y,t,a,k,l,p,at=250,d=.33,w=u("<div class='fxs-drag-surface'><\/div>"),vt={start:yt,drag:bt,stop:pt,cursor:"move",helper:"clone",appendTo:w,opacity:.65,distance:3,cancel:"input,textarea,button,select,option,.fxs-tile-actionbar-contextmenu"},ti=(function(){function n(){if(n._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");n._singleton=this}return n.prototype.dispose=function(){this.disableDragDropTargets();ct();n._singleton=null},r.defineProperty(n,"Instance",{get:function(
){return n._singleton||(n._singleton=new n),n._singleton},enumerable:!0,configurable:!0}),n.prototype.enableDragDropOnSingleTarget=function(n){n.draggable("instance")||n.filter(tt).addClass(ft).draggable(vt)},n.prototype.enableDragDropTargets=function(){var n=this;lt().forEach((function(t){t.on(b.mouseenter,tt,(function(t){var i=u(t.currentTarget);if(i.draggable("instance")){i.draggable("option","handle",!1);return}n.enableDragDropOnSingleTarget(i)}))}))},n.prototype.disableDragDropTargets=function(){lt().forEach((function(n){n.off(b.mouseenter,tt)}));u(".ui-draggable:not(.ui-draggable-dragging)").removeClass(ft).draggable("destroy")},n})();n.FlowLayoutDragDrop=ti})(c||(c={})),c}));define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;-ms-touch-action:none;touch-action:none}.fxs-desktop-normal .fxs-hide-in-normal,.fxs-desktop-normal .fxs-portal-contextpane-left,.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay,.fxs-desktop-organize .fxs-sidebar,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-actions,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration{display:none}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay:hover{border-width:1px;border-style:solid;box-sizing:border-box}.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide.fxs-tile-selected .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-blade-locked .fxs-tile .fxs-tile-overlay:hover{border:none}.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}")})
);define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","f","o","$","../Base/Base.Events","../Interactions/Interactions.DismissHandler","../Interactions/Interactions.FlowLayoutDragDrop","../Widgets/Widgets.WidgetBase","../Widgets/Widgets.Tile","../../_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){function nt(n,r,f){var e=n.desktop,a=new l(e,r,n,f),p=function(n){var t=u(n.target).closest(k);return s.Widget.getWidget(t,h.Widget)},w=r.element,v=r.getPanorama().getStartBoardArea();w.on(t.fxexitorganizemode,(function(){e.mode(0)}));v.on(t.fxenterorganizemode,(function(n,t){n.stopPropagation();var r=p(n);t=u.extend({},t);i.isNullOrUndefined(t.trigger)&&(t.trigger=r?0:1);a.startPartManagment(t);r&&(r.options.selected(!0),a.updateTileSelection(r),r.showTileManagementContextMenu())}));v.on(t.click,b,(function(n){var i=p(n),t=i&&i.options;t&&!t.locked()&&(t.selected(!t.selected()),a.updateTileSelection(i))}));v.
on(t.click,c,(function(n){if(e.mode()===1){var i=p(n),t=i&&i.options;!t||t.locked()||t.selected()||(t.selected(!0),a.updateTileSelection(i))}}));v.on(t.mouseenter,c,(function(n){var r,u,i;if(e.mode()!==1&&(r=p(n),u=r&&r.options,u&&!u.locked()&&!u.selected())){i=r.element;o.FlowLayoutDragDrop.Instance.enableDragDropOnSingleTarget(i);i.hasClass(y)&&i.draggable("option","handle",c);i.one(t.mouseleave,(function(){e.mode()!==1&&o.FlowLayoutDragDrop.Instance.disableDragDropTargets()}))}}));v.on(t.dragstart,d,(function(n){e.mode()!==1&&(e.mode(1),u(n.target).draggable("option","handle",!1));var t=p(n),i=t&&t.options;i&&!i.selected()&&(i.selected(!0),a.updateTileSelection(t))}));v.on(t.fxpartcreated,(function(n,t){n.stopPropagation();var i=t.widget;i.options.selected(!0);a.updateTileSelection(i)}));return a}var p=i.Base,t=p.EventTypes,w=MsPortalImpl.Resources.Images,a=s.Widget.widgetRemoveEvent,b="."+h.overlayClassName,k="."+h.widgetClassName,c="."+h.actionBarContainerClassName,v="fxs-desktop-normal",y=
"ui-draggable",d="."+y,g="fxs-partgallery-container",l;(function(){var t=w.getFlowLayout().gridShadow,i=".fxs-desktop-organize .fxs-flowlayout-childcontainer {"+("background: url("+t+");")+"}",n=document.createElement("style");n.setAttribute("type","text/css");n.appendChild(document.createTextNode(i));document.head.appendChild(n)})();n.organizeModeClassName="fxs-desktop-organize";n.createDesktopModeManager=nt;l=(function(){function t(n,t,i,r){var f=this;this._wasContextPaneCollapsed=!1;this._dismissHandle={dismissFn:function(){f._desktop.mode(0)},shouldDismissOnMouseDownFn:u.noop,shouldDismissOnMouseWheelFn:u.noop,logName:"desktopmodemanager"};this._desktop=n;this._portalWidget=t;this._services=i;this._lifetime=r;this._userSettingsManager=i.settings;this._contextPane=i.leftContextPane;this._partMgmtStarted=!1;this._selectedTile=null;this._handleModeChange(n,r)}return r.defineProperty(t.prototype,"selectedTile",{get:function(){return this._selectedTile},enumerable:!0,configurable:!0}),t.
prototype.updateTileSelection=function(n){var t=this;if(this._deselectCurrentTile(),n.options.selected()&&(this._selectedTile=n),this._selectedTile)this._selectedTile.element.on(a,this._tileRemoveHandler=function(n){n.target===t._selectedTile.element[0]&&t._deselectCurrentTile()})},t.prototype.startPartManagment=function(n){var t=this,r;return this._partMgmtStarted?Q():(this._partMgmtStarted=!0,this._desktop.mode(1),r=this._contextPane,Q.all([i.require("MsPortalImpl/UI/UI.PartGalleryManager"),r.tryOpen(this)]).spread((function(i){var u=t._partGalleryManager,f=t._partGallery;u||(u=t._partGalleryManager=i.createPartGalleryManager(t._lifetime.createChildLifetime(),t._services,f),u.load(5,n));f.setFocus();n.expandTileGallery&&r.collapsed(!1)})))},t.prototype.onAddingContent=function(n){var t=this;return i.require("MsPortalImpl/Widgets/Widgets.PartGallery").then((function(i){t._partGallery||(t._partGallery=i.create(u("<div class='"+g+"'><\/div>")),n.addChild(t._partGallery.element))}))},t.prototype.
onRemovingContent=function(){this._partMgmtStarted=!1},t.prototype._enterOrganizeMode=function(){var i=this._portalWidget,r=i.element,t;return(r.addClass(n.organizeModeClassName),r.removeClass(v),t=i.getTopBarWidget(),t&&t.options.isInOrganizeMode(!0),e.register(this._dismissHandle),o.FlowLayoutDragDrop.Instance.enableDragDropTargets(),this._wasContextPaneCollapsed=this._contextPane.collapsed(),!this._partMgmtStarted)?this.startPartManagment({}):Q()},t.prototype._exitOrganizeMode=function(){var r=this._portalWidget,u=r.element,t,i;o.FlowLayoutDragDrop.Instance.disableDragDropTargets();u.removeClass(n.organizeModeClassName);u.addClass(v);t=r.getTopBarWidget();t&&t.options.isInOrganizeMode(!1);i=this._contextPane;i.close(!0);i.collapsed(this._wasContextPaneCollapsed);this._deselectCurrentTile();this._userSettingsManager.flushSettings();e.unregister(this._dismissHandle)},t.prototype._handleModeChange=function(n,t){var i=this;n.mode.subscribe(t,(function(n){switch(n){case 1:i._services.getService(
"DialogManager").then((function(n){n.dismissOpenDialog()}));i._enterOrganizeMode();f.isFullscreen()&&f.exitFullscreen();break;case 0:default:i._exitOrganizeMode()}}))},t.prototype._deselectCurrentTile=function(){this._selectedTile&&(this._selectedTile.element.off(a,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)},t})();n.DesktopModeManagerImpl=l})(c||(c={})),c}));define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","f","i","../../Base/Base.Router","../../Services/Services.AssetManagement","../../Services/Services.AssetTypes","../../Services/Services.GeneralSettings","../../Services/Services.Permissions","../../Base/Themes","../Hubs/UI.BrowseManager","../Commands/UI.CommandManager","../UI.ContextPane","../UI.DesktopManagerImpl","../UI.DesktopModeManager","../Hubs/UI.NotificationManager","../../Widgets/Widgets.WidgetBase","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";
var k;return (function(t){function nt(t,o,nt,tt,it,rt,ut){var st=r.Rpc.client,et=o.extensionManager,ot=e.createAssetTypeService(et),vt=f.createAssetManager(et,o.settings,ot),ht=s.createPermissionsManager(et,ot);i.isFeatureEnabled("whatsnew")&&nt.whatsNewEnabledKey()&&b.WhatsNew.showWhatsNewModal.register(st,[d],(function(n){i.require("MsPortalImpl/Widgets/Widgets.WhatsNew").then((function(t){var i=n.items.map((function(n){var t=!n.published?"":new Date(n.published).toLocaleString();return n.description+="\r\n"+t,n}));new t.Widget($("<div />"),new w.ViewModel,i,it.element)}))}));var yt=c.createBrowseManager(et,ot,ht,tt),ct=h.createManager(t,g,nt["fxs-theme"],nt.highContrastKey),lt=a.create(it.getRightContextPane(),t),pt=a.create(it.getLeftContextPane(),t),wt=window.fx.environment.features.notificationspane==="true"?it.getToastVM():it.getNotificationMenuWidget().getToastVM(),ft={rpcClient:st,storageService:o.storageService,themeManager:ct,redirect:rt,settings:o.settings,editScopeManager:o.editScopeManager,
extensionManager:et,extensionVersionCache:o.extensionVersionCache,hubsMetadata:o.hubsMetadata,openWindow:o.openWindow,assetManager:vt,permissionsManager:ht,assetTypeService:ot,browseManager:yt,desktop:null,modeManager:null,portalFormTarget:null,contextPane:lt,leftContextPane:pt,getService:null,router:null,notificationManager:null},at=ft.desktop=v.createDesktopManager(it,ft),bt=ft.getService=i.memoizeQ((function(t){switch(t){case"DialogManager":return ut();case"ResourceMapManager":return k("../Hubs/UI.ResourceMapManager",n).then((function(n){return n.createResourceMapManager(et,ot)}));case"FeedbackPane":return k("../../Widgets/Widgets.FeedbackPane",n).then((function(n){return{amdModule:n,widget:new n.FeedbackPane(lt,wt,function(){return at.getCurrentBladeInfo()})}}));case"ThemeManager":return Q(ct)}throw new Error("Invalid service type '{0}' specified.".format(t));})),kt=ft.portalFormTarget=l.createCommandManager(ft.desktop).startListeningForEvents();return ft.notificationManager=p.createNotificationManager(
ft),ft.router=u.createRouter(ft),ft.modeManager=y.createDesktopModeManager(ft,it,t),t.registerForDispose([at,kt,ft.router,bt,]),ft}function tt(){return k("MsPortalImpl/UI/UI.DialogManager")}var d=r.Extension.getHubsWindowId(),it=o.settings,k=i.require,g=$("body");t.initialize=nt;t.getDialogManagerModule=tt})(k||(k={})),k}));define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager",["require","exports","f","a","./CodeComponentSideLoadModels","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.Storage","../UI/Compositions/UI.Composition.Services"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){var v=i.Base,y=v.Diagnostics,p=i.ViewModels.Dialogs.MessageBoxButtons,w=jQuery,s=y.createLog(n),u=f.Shell.Dialogs,c=0,a=1,h=0,b=1,k=2,l=u.loadOnlySafeExtensionsButtonText,d=(function(){function n(n,t,i,r,u,f,e,o,s,h,c,l){this._temporaryTestCodeComponents=[];this._trustedCodeComponents=n;this._normalizeCodeComponents(this._trustedCodeComponents);this._settingsManager=
t;this._storageService=i;this._getDialogManager=r;this._dialogContainer=u;this._canModifyCodeComponents=f;this._acceptWithoutPrompt=e;this._storageServiceKey=o;this._hashQueryStringKey=s;this._createFunction=h;this._componentType=c;this._settingsKey=l}return n.prototype.getCodeComponentsMetadata=function(){var n=this,t=null,i=null;return Q().then((function(){var i=JSON.parse(JSON.stringify(n._trustedCodeComponents));return t=i.map((function(t){return n._createFunction(t)})),n.loadFromServer(t)})).then((function(i){return i.length>0&&n._merge(t,i),t}),(function(){return t})).then((function(t){return i=t,n._loadUntrustedCodeComponentsIfAllowed()})).then((function(t){if(t.length>0){var r=function(n){n.logUsageWarning()};n._merge(i,t,r)}return i})).then((function(n){return n.filter((function(n){return n.isValid()}))}))},n.prototype.loadFromServer=function(){throw new Error("This is an abstract method that must be overridden by all subclasses.");},n.prototype.listTestCodeComponents=function(){var t=this,n=
this._temporaryTestCodeComponents.slice(0);return this._settingsManager.querySetting(c,this._settingsKey).then((function(i){return i=i&&i.map((function(n){return t._createFunction(n)})),r.isArray(i)&&(n=n.concatUnique(i,(function(n,t){return n.isEqual(t)}))),n.filter((function(n){return n.isValid()}))})).then(null,(function(n){return s.error("Error listing code components",2,n),[]}))},n.prototype.registerTestCodeComponent=function(n,t){var i=this;return n.isValid()?t?(this._addOrUpdateCodeComponent(this._temporaryTestCodeComponents,n),Q.resolve(null)):this.listTestCodeComponents().then((function(t){return i._addOrUpdateCodeComponent(t,n),i._settingsManager.setSetting(c,i._settingsKey,t),i._settingsManager.flushSettings()})).catch((function(t){s.error("Error registering code component",4,{codeComponent:n,error:t})})):Q.reject()},n.prototype.unregisterTestCodeComponent=function(n){var t=this;return this._removeCodeComponent(this._temporaryTestCodeComponents,n),this.listTestCodeComponents().then((function(
i){if(t._removeCodeComponent(i,n))return t._settingsManager.setSetting(c,t._settingsKey,i),t._settingsManager.flushSettings()})).catch((function(n){s.error("Error unregistering code component.",6,{name:name,error:n})}))},n.prototype.unregisterAll=function(){this.clearTemporaryTestCodeComponents();var n=this._settingsManager;return n.deleteSettings({store:c,keys:[this._settingsKey]}),n.flushSettings().catch((function(n){s.error("Error registering all code components",5,n)}))},n.prototype.clearTemporaryTestCodeComponents=function(){var n=this._temporaryTestCodeComponents;n.splice(0,n.length)},n.prototype._loadUntrustedCodeComponentsIfAllowed=function(){var n=this,t=this._canModifyCodeComponents;return t?this.listTestCodeComponents().then((function(i){return i.length===0?(t&&s.verbose("No untrusted code components were found. Will load the portal in normal mode.",3),[]):n.prompt().then((function(t){return t?(i.forEach((function(t){n._componentType===h&&t.markAsTestExtension()})),i):[]}))})):Q([])},n.
prototype.prompt=function(){var s=this,i=e.ComponentName.ExtensionManager,r=this._storageServiceKey,f=this._storageService,c=f.getValue(i,r,a),n,t;if(c||this._acceptWithoutPrompt)return Q(!0);n=null;t=null;switch(this._componentType){case h:n=u.untrustedExtensionsTitle;t=u.untrustedExtensionsDescriptionFmt.format(l);break;case b:n=u.untrustedGalleryPackageTitle;t=u.untrustedGalleryPackageDescriptionFmt.format(l);break;case k:n=u.untrustedPatchTitle;t=u.untrustedExtensionsDescriptionFmt.format(l);break;default:throw new Error("Unsupported componentType");}return o.getDialogManagerModule().then((function(e){var o=w("<div />"),h=new e.MessageBox(n,t,p.OKCancel);return s._dialogContainer.prepend(o),h.defaultButtonText=l,h.cancelButtonText=u.loadUnsafeExtensionsButtonText,s._getDialogManager().then((function(n){return n.showDialog(o,h,null).then((function(t){var u=t===1;return n.dismissOpenDialog(),o.remove(),u?f.setValue(i,r,"true",a):f.clearValue(i,r,a),u}))}))}))},n.prototype._registerTestCodeComponentFromUri=
function(n){return n.isValid()?this.registerTestCodeComponent(n,!0):null},n.prototype._removeCodeComponent=function(n,t){this._componentType===h&&t.normalizeCloudName();var i=-1;return i=n.firstIndex((function(n){return n.isEqual(t)})),i>=0?(n.splice(i,1),!0):!1},n.prototype._normalizeCodeComponents=function(n){var t=this;n.forEach((function(n){t._componentType===h&&n.normalizeCloudName()}))},n.prototype._merge=function(n,t,i){var r=this;n!==null&&t!==null&&t.forEach((function(t){i&&i(t);r._addOrUpdateCodeComponent(n,t)}))},n.prototype._addOrUpdateCodeComponent=function(n,t){this._componentType===h&&t.normalizeCloudName();var i=n.first((function(n){return n.isEqual(t)}));i?i.updateWith(t):n.push(t)},n})();t.CodeComponentSideLoadManagerImpl=d})(s||(s={})),s}));define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function f(i){t||(t=!0,n.uploadSettingsManager=i,Q(i.querySettings({store:12})).then((function(n)
{var t=!1;for(var r in n){t=!0;break}t&&u().then((function(n){return n.init(i)}))})))}var r="MsPortalImpl/Services/Services.FileUploadSettings",u=i.memoizeQ((function(){return i.require(r).then((function(n){return n.fileUploadResumableTrackerInstance()}))})),t=!1;n.init=f})(r||(r={})),r}));define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports","f","u","a","ko"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function o(n,t){d(n,(function(n,i){i!==r&&t(n,i)}))}function g(n){var r=new c,i=r.errors;return n?(o(n,(function(r,u){switch(r){case"name":t("Extension name",u,i);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":t(r,u,i);break;case"isPreview":l(r,u,i);break;case"assetTypes":e(r,u,i);break;case"blades":nt(n,u,i);break;case"startBoardParts":ft(u,i);break;case"partsCatalog":yt(u,i);break;case"commandsCatalog":vt(u,i);break;case"commandGroups":lt(u,i);break;case"htmlTemplates":ot(u,i);break;case"styleSheets":st(u,i);
break;case"galleryService":ht(u,i);break;case"dashboardProvider":ct(u,i);break;case"requireConfig":break;default:i.push("Unexpected attribute '{0}' on definition.".format(r))}})),r):(i.push("Definition is null or undefined."),r)}function t(n,t,i){typeof t!="string"&&i.push("{0} is not a valid string.".format(n))}function l(n,t,i){typeof t!="boolean"&&i.push("{0} is not a valid boolean.".format(n))}function e(n,t,i){var r=u.isArray(t);return r||i.push("The '{0}' property is not a valid array.".format(n)),r}function nt(n,t,i){t&&e("blades",t,i)&&t.forEach((function(t,r){a(n,t,r,i)}))}function a(n,t,i,r){var u=t.name;t.inputs&&e("Blade: {0}. Property: blades[{1}].inputs".format(u,i),t.inputs,r);t.optionalInputs&&e("Blade: {0}. Property: blades[{1}].optionalInputs".format(u,i),t.optionalInputs,r);e("Blade: {0}. Property: blades[{1}].lenses".format(u,i),t.lenses,r)&&t.lenses.forEach((function(n,t){var f="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(u,n.name,i,t);n.partInstances&&
e(f,n.partInstances,r)&&n.partInstances.forEach((function(f,e){var o="Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(u,n.name,f.name,i,t,e);y(o,f,r)}))}));t.permissions&&e("Blade: {0}. Property: blades[{1}].permissions".format(u,i),t.permissions,r)&&t.permissions.forEach((function(n,t){s("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(u,i,t),n,t,r)}));tt(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(u,i),r);it(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(u,i),r)}function tt(n,t,i){n&&(n.source?v(n.source,t+".source",i):i.push("Source not specified for toolbar. "+t))}function it(n,t,i){n&&n.source&&v(n.source,t+".source",i)}function v(n,i,r){n.property&&t(i+".property",n.property,r);n.optional&&typeof n.optional!="boolean"&&r.push("The attribute 'optional' should be of type boolean. "+i);n.isIdentityInput&&typeof n.isIdentityInput!="boolean"&&r.push("The attribute 'isIdentityInput' should be of type boolean. "+
i);e(i+".valuesFrom",n.valuesFrom,r)&&n.valuesFrom.forEach((function(n,t){rt(i+".valuesFrom[{0}]".format(t),n,r)}))}function rt(n,i,r){switch(i.referenceType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;default:r.push("Unknown reference type '{0}' found for {1}.referenceType.".format(i.referenceType,n))}t(n+".property",i.property,r);i.part&&t(n+".part",i.part,r)}function ut(n,i,r){switch(i.sourceType){case 0:i.providerKey&&r.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(n));break;case 1:i.providerKey||r.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(n));t(n+".providerKey",i.providerKey,r);break;case 2:i.providerKey||r.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(n));t(n+".providerKey",i.providerKey,r);break;default:r.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".
format(i.sourceType,n))}t(n+".property",i.property,r)}function s(n,i,r,u){var f,o;switch(i.permissionType){case 0:f=i;f.extensionName&&t(n+".extensionName",f.extensionName,u);t(n+".assetType",f.assetType,u);f.assetId?ut(n+".assetId",f.assetId,u):u.push("Permission missing assetId found for {0}.assetId.".format(n));t(n+".action",f.action,u);break;case 1:o=i;switch(o.requirement){case h.All:case h.Any:break;default:u.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(o.requirement,n))}e(n+".permissions",o.permissions,u)&&o.permissions.forEach((function(t,i){s("{0}.permissions[{1}]".format(n,i),t,i,u)}));break;default:u.push("Unknown permission type '{0}' found for {1}.permissionType.".format(i.permissionType,n))}}function ft(n,t){e("startBoardParts",n,t)&&n.forEach((function(n,i){y("startBoardParts[{0}]".format(i),n,t)}))}function y(n,t,i){t.reference||t.inline?t.reference&&t.inline?i.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".
format(n)):t.reference&&!t.reference.partTypeName?i.push("'partTypeName' property is required on part reference. Property: {0}".format(n)):t.inline&&p(n,t.inline,i):i.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(n))}function p(n,t,i){t&&(et(n,t.partState,i),t.permissions&&e("{0}.permissions".format(n),t.permissions,i)&&t.permissions.forEach((function(t,r){s("{0}.permissions[{1}]".format(n,r),t,r,i)})))}function et(n,t,i){if(t){var e=t.inputIdentityProperties||[],f=t.sharedProperties||[],o=e.concat(f.map((function(n){return n.property}))),s=f.map((function(n){return n.key})),r=w(o),u=w(s);r&&r.length>0&&i.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(r),n));u&&u.length>0&&i.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(u),n))}}function w(n){var t={},i=[];return(n||[])
.forEach((function(n){!t[n]||i.push(n);t[n]=!0})),i}function ot(n,i){o(n,(function(n,r){typeof r!="string"&&(t("htmlTemplates['{0}'].file".format(n),r.file,i),t("htmlTemplates['{0}'].content".format(n),r.content,i))}))}function st(n,i){u.isArray(n)?n.forEach((function(n,r){t("StyleSheet at position {0}".format(r),n,i)})):i.push("Invalid type for 'styleSheets' property on definition.")}function ht(n,i){var r;o(n,(function(n,t){switch(n){case"serviceViewModel":r=t;break;default:i.push("Unexpected properties on 'galleryService' property of definition.")}}));t("galleryService.serviceViewModel",r,i)}function ct(n,t){var i=n.viewModel;i&&typeof i=="string"||t.push("The view model of dashboard provider must be non-empty string.")}function lt(n,t){n&&e("commandGroups",n,t)&&n.mapMany((function(n){return n.commands})).forEach((function(n){n.reference&&at(n,t)}))}function at(n,t){if(n&&n.reference){var i=!1;o(n,(function(n){n!=="name"&&n!=="bindings"&&n!=="reference"&&(i=!0)}));i?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".
format(f.toJSON(n))):n.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(f.toJSON(n)))}}function vt(n,t){n&&e("commandsCatalog",n,t)&&n.forEach((function(n){var i="Commands in 'commandsCatalog' ";n.name||t.push(i+"must have names.");!n.reference||t.push(i+"cannot specify a 'reference' property.")}))}function yt(n,t){n&&e("partsCatalog",n,t)&&n.forEach((function(n){b(n,t)}))}function pt(n,i){t("name",n.name,i);t("moduleId",n.moduleId,i)}function b(n,t){n.inputDefinitions&&e("PartType: {0}. Property: inputDefinitions".format(n.name),n.inputDefinitions,t);n.reference&&wt(n,t);p("PartType: {0}".format(n.name),n,t)}function wt(n,t){(n.reference.bindings||[]).forEach((function(i){(i.valuesFrom||[]).forEach((function(i){i.referenceType!==7&&i.referenceType!==9&&i.referenceType!==5&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".format(n.name))}))}))}var k=i.Extension,h=k.SetRequirement,
d=i.forEachKey,c=(function(){function n(){this.errors=[]}return n.prototype.valid=function(){return!this.errors.length},n})();n.ValidationResult=c;n.validateDefinition=g;n.validateIsString=t;n.validateIsBoolean=l;n.validateIsArray=e;n.validateBlade=a;n.validateControl=pt;n.validatePartType=b})(e||(e={})),e}));define("MsPortalImpl/Extension/Extension.Manifest",["require","exports","f","./Extension.DefinitionValidator","../Services/Services.Storage"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function a(n){var t=new r.ValidationResult,i,u;return n?((typeof n.name!="string"||o(n.name)||n.name.indexOf("!")>=0)&&(u="The extension manifest should specify a valid name. This name is obtained from the <Extension> tag in PDL. This name should be a string and cannot be empty or whitespace. It also cannot contain the ! character. The recommended naming convention for an extension name is to follow the pattern {Company}_{BrandOrSuite}_{ProductOrComponent} (e.g. Microsoft_Azure_Insights).",
t.errors.push(u)),n.assetTypes&&r.validateIsArray("manifest.assetTypes",n.assetTypes,t.errors)&&n.assetTypes.forEach((function(i){v(i,n.name,t.errors)})),t):(i="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the FxExtension.register/FxExtension.registerAmd call that is used to register your extension with the portal.",t.errors.push(i),t)}function t(n,t,i,r){n.push(t.format(i,r))}function v(n,r,u){var f=n.name;if(o(f)&&t(u,"The name for the asset type in manifest '{0}' was not specified.",r),n.browseType!==undefined&&typeof n.browseType!="number"&&t(u,"The browse type for the asset type '{0}' in manifest '{1}' was not a number.",f,r),n.browseServiceViewModel&&typeof n.browseServiceViewModel!="string"&&t(u,"The browse service view model for the asset type '{0}' in manifest '{1}' was not a string.",f,r),n.browseLinkUri&&typeof n.browseLinkUri!="string"&&t(u,"The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.",f,r),n.privateBrowse!==
undefined&&typeof n.privateBrowse!="boolean"&&t(u,"The private browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",f,r),n.browseRequiresRdfe!==undefined&&typeof n.browseRequiresRdfe!="boolean"&&t(u,"The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",f,r),n.browseRequirements!==undefined&&typeof n.browseRequirements!="number"&&t(u,"The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.",f,r),n.browseType!==undefined){switch(n.browseType){case 0:n.browseServiceViewModel||t(u,"The browse for the asset type '{0}' in manifest '{1}' is set to use a service view model but there was no service view model.",f,r);break;case 1:n.browseServiceViewModel&&t(u,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's resource type but there was a service view model.",f,r);break;case 2:n.browseServiceViewModel&&t(u,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's blade but there was a service view model.",
f,r);break;case 3:n.browseLinkUri||t(u,"The browse for the asset type '{0}' in manifest '{1}' is set to be a service link but there was no link URI.",f,r);break;case 4:n.browseLinkUri||t(u,"The browse for the asset type '{0}' in manifest '{1}' is set to be an instance link but there was no link URI.",f,r)}n.privateBrowse!==undefined&&n.browseType===undefined&&t(u,"The private browse flag was present for the asset type '{0}' in manifest '{1}' but there was browse type.",f,r);n.browseType!==0&&n.browseServiceViewModel&&t(u,"The asset type '{0}' in manifest '{1}' has a browse service but doesn't have service view model browse type.",f,r);o(n.pluralDisplayName)&&o(n.text)&&t(u,"The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",f,r);i.isNullOrUndefined(n.icon)&&t(u,"The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",f,r)}else n.browseServiceViewModel!==undefined?n.browseType=
0:n.privateBrowse!==undefined&&t(u,"The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.",f,r);n.gridColumnsServiceViewModel&&typeof n.gridColumnsServiceViewModel!="string"&&t(u,"The grid columns service view model for the asset type '{0}' in manifest '{1}' was not a string.",f,r);n.dynamicBladeServiceViewModel&&typeof n.dynamicBladeServiceViewModel!="string"&&t(u,"The dynamic blade service view model for the asset type '{0}' in manifest '{1}' was not a string.",f,r);n.propertyProviderServiceViewModel&&typeof n.propertyProviderServiceViewModel!="string"&&t(u,"The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.",f,r)}var o=i.isNullOrWhiteSpace,f=u.ComponentName.ManifestVersions,s="latest",h="expired",e=0,c=i.forEachKey,l=(function(){function n(n){var t,i;this._storage=n;t=n.getValue(f,s,e);this._latestVersions=JSON.parse(t||"{}");i=n.getValue(f,h,e);this._expiredVersions=JSON.parse(i||"{}")}return n.prototype.
getLatest=function(n){var t=n.toLowerCase();return this._latestVersions[t]||""},n.prototype.setLatest=function(n){var t=this;c(n,(function(n,i){var r=n.toLowerCase(),u=i.manifest,f=(u&&u.pageVersion||"").toLowerCase(),e=t._expiredVersions[r]||[];e.indexOf(f)!==-1||(t._latestVersions[r]=f)}));this._storage.setValue(f,s,JSON.stringify(this._latestVersions),e)},n.prototype.expireLatest=function(n){var i=n.toLowerCase(),r=this._latestVersions[i],t;if(r){if(this._latestVersions[i]="",t=this._expiredVersions[i],t){while(t.length>=5)t.pop();t.splice(0,0,r)}else this._expiredVersions[i]=[r];this._storage.setValue(f,s,JSON.stringify(this._latestVersions),e);this._storage.setValue(f,h,JSON.stringify(this._expiredVersions),e)}},n})();n.ExtensionVersionCache=l;n.validate=a})(f||(f={})),f}));define("MsPortalImpl/_generated/Common/Relex.Channel",["require","exports"],(function(){"use strict";var n;return (function(n){var t,i,r;n.signature="###CHANNEL###",(function(n){n[n.None=0]="None";n[n.Auth=1]="Auth";n[
n.AuthAck=2]="AuthAck";n[n.ExtensionLoad=3]="ExtensionLoad";n[n.ExtensionReload=4]="ExtensionReload";n[n.ExtensionUnload=5]="ExtensionUnload";n[n.Boot=6]="Boot";n[n.Rpc=7]="Rpc";n[n.Telemetry=8]="Telemetry";n[n.Connection=9]="Connection"})(n.MessageKind||(n.MessageKind={}));t=n.MessageKind,(function(n){n[n.Disconnected=1]="Disconnected"})(n.ConnectionEventType||(n.ConnectionEventType={}));i=n.ConnectionEventType,(function(n){n[n.None=0]="None";n[n.FetchManifest=1]="FetchManifest";n[n.Proxy=2]="Proxy"})(n.ExtensionHostMode||(n.ExtensionHostMode={}));r=n.ExtensionHostMode})(n||(n={})),n}));define("MsPortalImpl/Extension/Extension",["require","exports","f","i","o","ko","../UI/Compositions/UI.Composition.CloudName","../Extension/DefinitionPreprocessor","./Extension.DefinitionValidator","../Extension/Extension.Definition.Locator","../Extension/Extension.Manifest","MsPortalFx/Globalization","MsPortalImpl/Resources/ImplScriptResources","../Base/Languages","../Parts/Parts","../_generated/Common/Relex.Channel",
"../UI/Compositions/UI.Composition.BladeOpenerBase","../UI/Hubs/UI.NotificationManager","../Extension/ViewModelManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";var d;return (function(t){function iu(n){var t=[];return tu(n,(function(n,i){t.push({lower:n.toLowerCase(),key:n,val:i})})),t.sort((function(n,t){return n.lower.localeCompare(t.lower)}))}function ii(n){return n&&n.formatCulture===dt&&n.displayLanguage===kt}function ri(n){var i=ni.format(n),t;try{t=JSON.parse(it.localStorage.getItem(i))}catch(r){tt.error(r,4,n)}return t}function ru(n){var t=ni.format(n);try{it.localStorage.removeItem(t)}catch(i){tt.warning(i,4,n)}}function uu(n,t,i){var r=i.useRelex(n),u=r?new er(i):new oi;return new fi(n,t,u,r)}function fu(n){return ui[n]||(ui[n]={})}function eu(n){for(var r=di["*"].slice()||[],t=n.obsoleteBundlesBitmask,u=0,f;t;)t%2&&(f=di[u],i.pushUnique(r,f)),t=t>>1,u++;return r}function rr(n,i,r){if(r)return i;var f=fu(n.name),u=f[i];return u?u:(u=f[i]=[],i&yt.ExtensionScripts&&
u.push.apply(u,eu(n)),i&yt.PostScripts&&(t.patchUris&&t.patchUris.length&&u.push.apply(u,t.patchUris),u.push.apply(u,gr)),u)}function ur(n){var t=$("<iframe/>").addClass("fxs-extension-frame").attr({tabindex:-1,"aria-hidden":!0});return n||t.attr({sandbox:"allow-same-origin allow-scripts"}),t.appendTo(ar),t}function ou(n,t,i){for(var r=[],u=Q(),f=function(){r.length<t&&(u=u.then((function(){if(r.length<t)return i().then((function(n){r.push(n)})).catch((function(n){tt.error(n,6)}))})))},e=0;e<t;e++)f();return{getItem:function(){return Q.delay(dr).then(f),r.pop()},size:function(){return r.length}}}function su(n,t,i){n.styleSheets&&y.injectStyles(t,{extensionWindowId:i,styleSheets:n.styleSheets.map((function(n){return{file:"",content:n}}))})}var ut=r.Extension,or=r.TelemetryContext,ft=i.Base,ct=ft.Constants,sr=ct.ExtensionNames.Hubs,wt=ft.Diagnostics,hr=wt.Telemetry,bt=r.Rpc,cr=i.Hubs.Notifications.NotificationStatus,hi=ft.tryParseVersion,ci=i.Helpers.Deferred,ir,yt,g,nt,pt,ui,fi,ht,ei,fr,oi,er,si;
t.frameRemovalDelay=1e3;t.patchUris=[];var it=window,lt=it.fx.getTimestamp,et=bt.client,li=i.isNullOrUndefined,lr=$("head"),ar=$("body"),tt=wt.createLog(n),d=it.fx.environment,ot=d.cdn,ai="FxCdnIndex"+ot.index,vr=d.features,kt=l.displayLanguage,dt=l.formatCulture,yr=kt+v.localeDelimiter+dt,pr=!!d.trace.extensionmanager,hu=pr?function(n){tt.verbose(n)}:i.noop,vi=ft.getVersionFromString,at=vi(d.sdkVersion),yi=vr.extloadtimeout,gt=yi&&parseInt(yi)||9e4,pi=d.relex,wi=a.Shell,wr="data-extensionname",st="ExtensionManager",ni="EXTENSIONMANIFEST_{0}",ti=3,vt=(ti+1)*2,rt=hr,br=or,kr=d.bootReturnConst,bi=2e4,dr=4e3,ki=3,di=d.extensionScripts,gr=d.postScripts,gi=0,nr=0,nu=lt(),tu=i.forEachKey,tr=i.startTimer;ir=iu(d.extensionFlags);t.canUseManifest=ii;t.getCachedManifestFromLocalStorage=ri,(function(n){n[n.None=0]="None";n[n.ExtensionScripts=1]="ExtensionScripts";n[n.PostScripts=2]="PostScripts"})(t.RequiredScripts||(t.RequiredScripts={}));yt=t.RequiredScripts;t.initialRetryDelay=gt,(function(n){n[n.
NotLoaded=0]="NotLoaded";n[n.FirstResponseReceived=1]="FirstResponseReceived";n[n.ManifestReceived=2]="ManifestReceived";n[n.Initialized=3]="Initialized";n[n.Error=4]="Error"})(t.ExtensionReadyState||(t.ExtensionReadyState={}));g=t.ExtensionReadyState,(function(n){n[n.None=0]="None";n[n.FirstResponseNotReceived=1]="FirstResponseNotReceived";n[n.ManifestNotReceived=2]="ManifestNotReceived";n[n.InvalidExtensionName=3]="InvalidExtensionName";n[n.InvalidManifest=4]="InvalidManifest";n[n.InvalidDefinition=5]="InvalidDefinition";n[n.FailedToInitialize=6]="FailedToInitialize";n[n.TooManyRefreshes=7]="TooManyRefreshes";n[n.TooManyBootGets=8]="TooManyBootGets";n[n.TimedOut=9]="TimedOut";n[n.MaxRetryAttemptsExceeded=10]="MaxRetryAttemptsExceeded";n[n.HomePageTimedOut=11]="HomePageTimedOut";n[n.Unexpected=12]="Unexpected"})(nt||(nt={})),(function(n){n[n.Default=0]="Default";n[n.Part=1]="Part"})(t.ViewModelType||(t.ViewModelType={}));pt=t.ViewModelType;t.create=uu;ui={};t.getScriptUris=rr;fi=(function()
{function n(n,t,r,u){var e=this,k;this.initializedExtension=f.observable();this._readyState=g.NotLoaded;this._errorState=nt.None;this._manifests=new i.Map;this._initializedDeferred=Q.defer();this._manifestLoaded=Q.defer();this._perfData={};this._initializeRequired=!1;this._bootGetCount=0;this._scriptErrors=[];this._bladeRedirectMap={};this._memoizedRPCEndPoint=i.memoizeQ((function(){var n=e.getWindowId();return Q(ut.initializeEndPoint.invoke(et,n,undefined)).then((function(t){i.extend(e._perfData,t);var r=t&&t._msPortalFxDef;return r&&delete e._perfData._msPortalFxDef,r||ut.getDefinitionEndPoint.invoke(et,n,undefined)})).then((function(n){var c=e.getManifest("assetTypes"),r=s.validateDefinition(n),t;if(r.valid()){var u=o.preprocessDefinition(n,c,h.redirects()),l=e._perfData.totalTime=e._loadTimer(),f=new fr(e,u,l);su(u,document,e.getWindowId());e._transitionStateTo(g.Initialized);e._clearExtensionReloadHandle();e._extensionInitializedTraceKey=rt.startTrace({source:st,action:"ExtensionInitialized",
name:e.name});e.initializedExtension(f);e._initializedDeferred.resolve(f)}else return t="The extension definition has validation errors. Errors: {0}".format(JSON.stringify(r.errors)),e._onError(nt.InvalidDefinition,t),Q.reject(new i.Errors.Error(t))})).catch((function(n){return e._reloadFrame("message: {0}, stack: {1}".format(n.message,n.stack),nt.FailedToInitialize),Q.reject(n)}))}));this._memoizedAcquireWindow=i.memoizeQ((function(){return bt.internalClient.acquireWindow(e.getWindowId(),0),e._manifestLoaded.promise.isPending()||(e._manifestLoaded=Q.defer()),e._manifestLoaded.promise}));this.metadata=n;this._hostingContext=r;this._useRelex=u;var p=n.name,v=new ft.UriBuilder(n.uri),c=v.query,y=n.cacheability||0,l=[];v.fragment=d.sessionId;d.passThroughVariables&&(l=l.concat(d.passThroughVariables));y===0?l.push(d.clientSessionIdName):y===2?t=d.pageVersion:c.setParameter("cacheability",y);c.setParameter("region",it.fx.bootEnvironment&&it.fx.bootEnvironment.region||"unknown");d.extensionQueryParameters&&
(l=l.concat(d.extensionQueryParameters));l.forEach((function(n){var t=d[n];li(t)||c.setParameter(n,t)}));var ht=p.toLowerCase(),w={},a=d.userTypeHint||"",b=ht+"_";ir.forEach((function(n){var r=n.lower,t,i;r.startsWith(b)&&(t=n.val,i=r.substr(b.length),i==="clean"&&t.toLowerCase()==="true"?e._clean=!0:i==="clientoptimizations"?c.setParameter(i,t):i==="usertype"?a+="("+t+")":c.setParameter(n.key,t),w[i]=t)}));a&&(k=a.substr(1,a.length-2),c.setParameter("feature.userType",k));this.effectiveFeatureFlags=i.extend2(d.features,w);c.setParameter("pageVersion",t);c.setParameter("l",yr);var tt=pi.portalUri,ct=this._useRelex&&tt?tt:it.location.href,lt=new ft.UriBuilder(ct).getAuthority();c.setParameter("trustedAuthority",lt);c.setParameter("extensionName",p);ut.multiCloudEnabled&&c.setParameter("cloudName",this.cloudName);ot.forceDisable||this._useRelex?c.setParameter(ot.disableParameter,!0):ot.forceIndex&&c.setParameter(ot.indexParameter,ot.forceIndex);this._uri=v.toString()}return u.defineProperty(
n.prototype,"cloudName",{get:function(){return this.metadata.cloudName},enumerable:!0,configurable:!0}),n.prototype.getVersion=function(){return this._extVersion},u.defineProperty(n.prototype,"initializeRequired",{get:function(){return this._initializeRequired},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"unloaded",{get:function(){return!this._currentWindow},enumerable:!0,configurable:!0}),n.prototype.useRelex=function(){return this._useRelex},u.defineProperty(n.prototype,"name",{get:function(){return this.metadata.name},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isTestExtension",{get:function(){return!!this.metadata.isTestExtension},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isTestStamp",{get:function(){return!!this.metadata.isTestStamp},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"readyState",{get:function(){return this._readyState},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"uri",{get:function(
){return this._uri},enumerable:!0,configurable:!0}),n.prototype.getBladeRedirect=function(n){return this._bladeRedirectMap[n&&n.toLowerCase()]},n.prototype.onManifestReceived=function(n){var t=this,i=function(){t._startExtensionLoadListener&&(it.removeEventListener("message",t._startExtensionLoadListener),t._startExtensionLoadListener=null)};i();(n.redirects||[]).forEach((function(n){var i=n.fromBlade;i&&(t._bladeRedirectMap[i.toLowerCase()]=n)}));this.getWindow().postMessage({boot:kr,stopListening:!0,scripts:rr(this.metadata,yt.PostScripts,this.useRelex())},this.getTrustedHost());this._startExtensionLoadListener=function(r){if(r.data){var u=r.data,f=u.signature===p.signature&&u.kind===p.MessageKind.Boot&&u.windowId===t.getWindowId()&&u.data&&u.data.kind===ki,e=r.data.kind===ki&&t.getWindow()===r.source;(f||e)&&t._startExtensionLoadListener&&(i(),t._acceptManifestAndInitializeIfRequired(n))}};it.addEventListener("message",this._startExtensionLoadListener,!1)},n.prototype.getManifest=function(
n){return this._manifests.get(n)},n.prototype.setManifest=function(n,t){var i=t;return i.cloudName=this.cloudName,this._manifests.set(n,i),i},n.prototype.ensureInitialize=function(){this._initializeRequired=!0},n.prototype.getManifestAsync=function(){return this._manifestLoaded.promise},n.prototype.whenInitialized=function(){return this._initializedDeferred.promise},n.prototype._acceptManifestAndInitializeIfRequired=function(n){var t=this._validateAndSetManifest(n,!1);t&&(this._addManifestToCache(),this._initializeRequired?this._initialize():this.dispose(),this._initializeRequired=!0)},n.prototype._initialize=function(){var n=this;return this._memoizedRPCEndPoint()},n.prototype.getOrLoadWindow=function(){var n=this;if(!this._currentWindow){this._bootGetCount=0;this._retryAttempt=0;this._initialResponseTraceKey=rt.startTrace({source:st,action:"InitialExtensionResponse",name:this.name});this._loadTraceKey=rt.startTrace({source:st,action:"LoadExtensions",name:this.name});var t=this.metadata,
i=t.features,u=d.trace.nonsecure||i&&i.nonsecure==="true",r=0;this._currentWindow=this._hostingContext.createRpcWindow({getWindowId:function(){return ut.getWindowId(t)},trustedHost:t.trustedHost,frameUri:this._uri,createIframe:function(){return ur(u)},onLoad:function(){return n._readyState=g.NotLoaded,n._errorState=nt.None,r++,r>vt?(n._onError(nt.TooManyRefreshes,"The iframe for extension '{0}' refreshed/reloaded more than '{1}' times and has been unloaded.".format(n.name,vt)),!1):!0},onError:function(){n._reloadFrame("Extension Index page failed to load timed out in '{0}'ms.".format(bi),nt.HomePageTimedOut)}});this._currentWindow.onDispose((function(){var i,t;n._clearExtensionReloadHandle();i=n._initializedDeferred.promise;n._initializedDeferred=Q.defer();n.initializedExtension(void 0);n._memoizedRPCEndPoint.clear();n._memoizedAcquireWindow.clear();rt.trace({source:st,action:"ExtensionUnloaded",name:n.name,data:{currentState:n._readyState}});n._extensionInitializedTraceKey&&(rt.completeTrace(
n._extensionInitializedTraceKey),n._extensionInitializedTraceKey=null);t="style[{0}='{1}']".format(wr,n.name);lr.remove(t);n._currentWindow=null}));this._loadTimer=tr();this._startTime=lt();this._extensionReloadHandle=it.setTimeout((function(){n._reloadFrame()}),gt)}return this._currentWindow},n.prototype.noteScriptError=function(n){this._scriptErrors.push(n)},n.prototype._reloadFrame=function(n,t){var r=this,i;if(!this.unloaded&&this._readyState!==g.Initialized){if(!n&&!t){t=nt.None;n="Failed to load extension after {1} attempts over {0} secs.";switch(this._readyState){case g.NotLoaded:t=nt.FirstResponseNotReceived;n="First response was not received after a time of {0} secs.";break;case g.FirstResponseReceived:t=nt.ManifestNotReceived;n="Manifest not received after {0} secs.";break;case g.ManifestReceived:t=nt.TimedOut;n="Manifest was received, however failed to initialize the extension after {0} secs."}}this._retryAttempt>=ti&&(t=nt.MaxRetryAttemptsExceeded);n=n.format(Math.round(this._loadTimer(
)/1e3),this._retryAttempt+1);this._clearExtensionReloadHandle();this._retryAttempt<ti?(this._loadTimer=tr(),this._startTime=lt(),i=new ft.UriBuilder(this._uri),this._retryAttempt++,i.query.setParameter(d.retryAttemptName,this._retryAttempt),this._currentWindow.refresh(i.toString()),this._onExtensionLoadingRetry&&this._onExtensionLoadingRetry(),this._extensionReloadHandle=it.setTimeout((function(){r._reloadFrame()}),gt),tt.warning("Reloading extension '{0}' from '{1}'. Retry attempt: {4}. ErrorState: {2}. Error: {3}.".format(this.name,this.uri,nt[t],n,this._retryAttempt))):this._onError(t,n)}},n.prototype.getWindow=function(){var n=this._currentWindow;return n&&n.getValue()},n.prototype.getTrustedHost=function(){var n=this._currentWindow;return n&&n.getTrustedHost()},n.prototype.getWindowId=function(){return ut.getWindowId(this)},n.prototype.loadAsync=function(n){var e=this,t,i,r,u,f;return this.unloaded?((!n||this._clean)&&(n={}),t=ri(this.getWindowId()),i=n.manifest,ii(t)&&(r=hi(t&&t.extVersion),
u=hi(n.version),r&&u&&r.compareTo(u)>=0&&(i=t.manifest)),i&&this._validateAndSetManifest(i,!0)?this.ensureInitialize():f=this._memoizedAcquireWindow(),this._initializedDeferred.promise):this.whenInitialized()},n.prototype.dispose=function(){this._currentWindow&&(this._currentWindow.dispose(),this._currentWindow=null)},n.prototype.processBootGetMessage=function(n,t){var i,r;try{i=vi(n)}catch(u){tt.error("Invalid version information '{0}' specified by '{1}'.".format(n,this.name),0,u)}return(i&&at.major===i.major&&at.minor===i.minor||(r="The '{0}' extension at '{1}' was compiled with version '{2}' of the SDK, whereas the shell is running on version '{3}'. You may see unexpected results.",tt.warning(r.format(this.name,this.uri,i,at))),this._readyState===g.NotLoaded&&(this._readyState=g.FirstResponseReceived,this._initialResponseTraceKey&&(this._perfData.initialExtensionResponse=rt.completeTrace(this._initialResponseTraceKey),this._initialResponseTraceKey=null),this._manifestLoadTraceKey=rt.
startTrace({source:st,action:"ManifestLoad",name:this.name,data:{fxcdn:ai}})),this._bootGetCount++,this._bootGetCount>vt)?(this._onError(nt.TooManyBootGets,"The iframe '{0}' sent more than '{1}' handshake messages over '{2}' attempts without making progress. it has been unloaded.".format(this.name,vt,this._retryAttempt)),!1):!this._tryLoadCachedManifest(t)},n.prototype._tryLoadCachedManifest=function(n){var i=!1,r,t;return this._extVersion=n,this.initializeRequired||!n||(r=this.getWindowId(),t=ri(r),ii(t)&&n===t.extVersion&&(i=this._validateAndSetManifest(t.manifest,!0),this.dispose(),this.ensureInitialize()),i||ru(r)),i},n.prototype._addManifestToCache=function(){var n=this.getManifest("assetTypes"),t=this._extVersion,i,r,u;if(n)if(t)if(n.sdkVersion)try{r=ni.format(this.getWindowId());u={manifest:n,formatCulture:dt,displayLanguage:kt,extVersion:t,sdkVersion:at};it.localStorage.setItem(r,JSON.stringify(u))}catch(f){tt.warning(f,4,this.getWindowId())}else i="Unable to add manifest for '{0}' to cache since it has not specified the SDK version on which it was compiled. Specified version was '{1}'.",
tt.warning(i.format(this.name,n.sdkVersion),102);else tt.warning("Unable to add manifest for '{0}' to cache since it has not specified a valid version. Specified version was '{1}'.".format(this.name,t),101);else tt.warning("Unable to add manifest for '{0}' to cache since it is unavailable.".format(this.name))},n.prototype._validateAndSetManifest=function(n,t){var l=this,r=!1,e=c.validate(n),o,s,u,h,f;if(e.valid())if(this.name.toLowerCase()!==n.name.toLowerCase())o="The extension name defined in the manifest '{0}' (obtained from the <Extension> tag in PDL) does not match the name '{1}' used to identify the extension with the portal. Ensure that the name you specify in the <Extension> tag in PDL matches the one used in the extensions.json file to identify the extension with the portal.",this._onError(nt.InvalidExtensionName,o.format(n.name,this.name));else{this._readyState!==g.NotLoaded&&this._readyState!==g.FirstResponseReceived&&(s="Extension manifest for '"+this.name+"' received at an incorrect point in time. "+
("Current extension state: ExtensionReadyState."+g[this._readyState]+". ")+"This method should be called when the extension state is ExtensionReadyState.NotLoaded or ExtensionReadyState.FirstResponseReceived. "+("Callstack: "+i.getCurrentCallStack()),tt.error(s,5));try{li(n.isPreview)&&(u=this.metadata.features,n.isPreview=(u&&u.preview||"").toLowerCase()==="true");t||i.forEachKey(pi.cachedManifestTypes,(function(t){l.setManifest(t,n)}));h=this.setManifest("assetTypes",n);this._transitionStateTo(g.ManifestReceived);this._manifestLoaded.resolve(h);r=!0}catch(a){f="_validateAndSetManifest throws";tt.error(new i.Errors.Error({message:f,data:n,innerErrors:a}));this._onError(nt.Unexpected,f)}}else e.errors.forEach(tt.error,tt),this._onError(nt.InvalidManifest,"The extension manifest has validation errors.");return(r||!t)&&this._manifestLoadTraceKey&&(this._perfData.manifestLoad=rt.completeTrace(this._manifestLoadTraceKey),this._manifestLoadTraceKey=null),r},n.prototype._onError=function(n,t){
var u=this,i="Failed to initialize extension '{0}' at '{1}'. ErrorState: {2}. Error: {3}.".format(this.name,this.uri,nt[n],t),r;tt.error(i,1,{previousState:this._readyState,hasLoadTraceKey:this._loadTraceKey?1:0,hasInitializeTraceKey:this._initializeTraceKey?1:0,successfulExtensionLoads:nr,failedExtensionLoads:gi,timeThisFileLoaded:nu,scriptErrors:this._scriptErrors,timeThisExtensionStartedLoading:this._startTime,timeThisExtensionFailed:lt(),timeToFail:this._loadTimer()});wt.Upload.flush();this._memoizedRPCEndPoint.clear();this._memoizedAcquireWindow.clear();this._manifestLoaded.reject(i);this._initializedDeferred.reject(i);this._readyState!==g.Error&&(this._transitionStateTo(g.Error,n),r=b.getNotificationManager(),r&&r.addClientNotification({title:wi.extensionError,description:wi.loadingError.format(this.name),status:cr.Error,timestamp:new Date,cloudName:ct.DefaultCloudName}));this.dispose()},n.prototype._transitionStateTo=function(n,t){var i=this;this._readyState=n;n===g.ManifestReceived?
(this._loadTraceKey&&(rt.completeTrace(this._loadTraceKey),this._loadTraceKey=null),this._initializeRequired&&(this._initializeTraceKey=rt.startTrace({source:st,action:"InitializeExtensions",name:this.name,data:{fxcdn:ai}}))):n===g.Initialized?this._initializeTraceKey&&(rt.completeTrace(this._initializeTraceKey,this._perfData),this._initializeTraceKey=null,nr++):n===g.Error&&(gi++,this._loadTraceKey&&(rt.cancelTrace(this._loadTraceKey),this._loadTraceKey=null),this._initializeTraceKey&&(rt.cancelTrace(this._initializeTraceKey,{errorState:t}),this._initializeTraceKey=null),this._initialResponseTraceKey&&(rt.cancelTrace(this._initialResponseTraceKey),this._initialResponseTraceKey=null),this._manifestLoadTraceKey&&(rt.cancelTrace(this._manifestLoadTraceKey),this._manifestLoadTraceKey=null));t&&(this._errorState=t)},n.prototype._clearExtensionReloadHandle=function(){this._extensionReloadHandle&&(it.clearTimeout(this._extensionReloadHandle),this._extensionReloadHandle=null)},n})();t.ExtensionImpl=
fi;ht=ct.BladeNames.Hubs.ResourceMenuBlade;ei={};ei[sr]=[{partName:ht+"$"+ht,locator:h.resourceMenu.withLens(ht).withPartInstance(ht),getPartDefinition:function(n){return n.getBladeDefinition(ht).then((function(n){return n.lenses[0].partInstances[0].inline}))}}];fr=(function(){function n(n,t,u){var o=this,s,h;this.outstandingObjectCount=f.observable(0);this.metadataCount=f.observable(0);this._proxiedObjects=[];this._pools={};this._bladeDefMap={};this._partDefMap={};this._controlDefMap={};s=this._lifetime=new r.TriggerableLifetimeManager;s.registerForDispose(this._extension=n);this.cloudName=n.cloudName;h=this.name=n.name;this.definition=t;this.loadTime=u;(ei[h]||[]).forEach((function(n){o._pools[n.locator.toString()]=ou(s,5,(function(){return n.getPartDefinition(o).then((function(t){var r=t.details;return Q(o.getPartViewModel(n.partName,{initialState:{},createSelectable:w.needContainerSelectable(r),createHubsInternalCloudNameProperty:e.needInternalProperty(h,r),partSize:t.initialSize,partLocation:
i.ViewModels.PartLocation.Blade,collapsed:null,containerType:0}))}))}))}))}return u.defineProperty(n.prototype,"extension",{get:function(){return this._extension},enumerable:!0,configurable:!0}),n.prototype.canUseInputsSetParameters=function(n){var t=this._pools[n.toString()];return!t||!t.size()},n.prototype.getBladeRedirect=function(n){return this._extension.getBladeRedirect(n)},n.prototype.getWindow=function(){return this._extension.getWindow()},n.prototype.processMessages=function(){return ut.pingEndPoint.invoke(et,this._extension.getWindowId(),undefined)},n.prototype.dispose=function(){this._lifetime.dispose()},n.prototype.getManifest=function(n){return this._extension.getManifest(n)},n.prototype.getBladeDefinition=function(n){var f=this,r=this.definition,t=n.toLowerCase(),u=r.bladeMap[t],i;return u?Q(u):(i=this._bladeDefMap,i[t]||(i[t]=Q(ut.getBladeDefinitionEndPoint.invoke(et,this._extension.getWindowId(),n)).then((function(n){return o.processBlade(r,f.getManifest("assetTypes"),n,h.redirects(
))})).then((function(n){var t=[];if(s.validateBlade(r,n,null,t),t.length)throw new Error("Invalid blade definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]}))))},n.prototype.getPartDefinition=function(n){var f=this,r=this.definition,t=n.toLowerCase(),u=r.partTypeMap[t],i;return u?Q(u):(i=this._partDefMap,i[t]||(i[t]=Q(ut.getPartDefinitionEndPoint.invoke(et,this._extension.getWindowId(),n)).then((function(n){return o.processPart(r,f.getManifest("assetTypes"),n,h.redirects())})).then((function(n){var t=[];if(s.validatePartType(n,t),t.length)throw new Error("Invalid part type definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]}))))},n.prototype.getControlDefinition=function(n){var i=this,t=this._controlDefMap;return t[n]||(t[n]=Q(ut.getControlDefinitionEndPoint.invoke(et,this._extension.getWindowId(),n)).then((function(n){return o.processControl(i.definition,i.getManifest("assetTypes"),n)})).then((function(n){var t=[];if(s.validateControl(n,t),t.length)
throw new Error("Invalid control definition. Errors: "+t.join("\n"));return n})).catch((function(i){return delete t[n],Q.reject(i)})))},n.prototype.getViewModel=function(n,t){return this._getViewModel(pt.Default,n,t)},n.prototype.getPartViewModel=function(n,t){var f,r,u;return t&&t.locator&&(f=this._pools[t.locator.toString()])&&!t.onInputsSetParameters&&!i.keysLength(t.initialState)&&(r=f.getItem(),r)?(u=t&&t.onViewModelAcquired,u&&u(r),ci().resolve(r).promise()):this._getViewModel(pt.Part,n,t)},n.prototype._getViewModel=function(n,t,i){var o=this,u,r,e;return(i=i||{},u=k.resolve(this,t,i.initialState,i.createSelectable),u)?u.then((function(n){if(i.onViewModelAcquired)i.onViewModelAcquired(n);return typeof i.partSize=="number"&&n&&n.content&&f.isObservable(n.content.size)&&n.content.size(i.partSize),i.onInputsSetParameters&&n&&n.updatePartInputValues&&(n.onInputsSetPromise=Q().then((function(){return n.updatePartInputValues(i.onInputsSetParameters.inputs,i.onInputsSetParameters.settings,i.
onInputsSetParameters.traceOptions)}))),n})):(r=ci(),e=n===pt.Part?ct.ViewModelTypes.PartViewModel:ct.ViewModelTypes.ViewModel,ut.getViewModelsDefinition.acquireObject(et,this._extension.getWindowId(),{type:e,containerType:i.containerType||0,name:t,initialState:i.initialState,createSelectable:i.createSelectable,createHubsInternalCloudNameProperty:i.createHubsInternalCloudNameProperty,telemetryContext:br.getState(),partSize:i.partSize,partLocation:i.partLocation,onInputsSetParameters:i.onInputsSetParameters,collapsed:i.collapsed,flags:i.flags},i.onViewModelAcquired&&function(n){return i.onViewModelAcquired(n&&n.getValue())}).then((function(n){return o._proxiedObjects.push(n),n.getValue()})).then((function(n){r.resolve(n)}),(function(n){r.reject(n)})),r.promise())},n.prototype.releaseViewModel=function(n){i.disposeDisposable(n);var t=i.findIndex(this._proxiedObjects,(function(t){return t.getValue()===n}));t!==-1&&this._proxiedObjects.splice(t,1)[0].dispose()},n.prototype.isPreview=function(){return this.
getManifest("assetTypes").isPreview},n})();oi=(function(){function n(){}return n.prototype.createRpcWindow=function(n){var i=(n.createIframe||ur)(),r=it.setTimeout((function(){n.onError()}),bi),e,o,u,f;i.on("load",e=function(t){r&&(it.clearTimeout(r),r=null);n.onLoad(t.originalEvent)});i.on("error",o=function(n){var t=n.originalEvent;tt.error(t.error,3,{message:t.message,filename:t.filename,colno:t.colno,lineno:t.lineno})});i.attr("src",n.frameUri);u=i[0].contentWindow;f=new si({source:u,window:u,trustedHost:n.trustedHost||"*",initializationFunc:undefined},function(n){i.attr("src",n)});f.onDispose((function(){i.off("load",e);i.off("error",o);setTimeout((function(){i.remove()}),t.frameRemovalDelay)}));return f},n})();t.BrowserHostingContext=oi;er=(function(){function n(n){this._relexConfig=n}return n.prototype.createRpcWindow=function(n){return this._relexConfig.createRpcWindow(n)},n})();si=(function(n){function t(t,i){n.call(this,t);this.refresh=i}return __extends(t,n),t})(bt.RpcWindow);t.RpcWindow=
si})(d||(d={})),d}));define("MsPortalImpl/Extension/ExtensionManager",["require","exports","f","i","o","$","../_generated/Common/Relex.Channel","./Extension","./Extension.Definition.Locator","MsPortalFx/Globalization","../Base/Languages","../Services/Services.GeneralSettings","../Services/Services.Storage","../Base/Telemetry"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return (function(t){function ft(n){return u.keys(n||{}).filter((function(t){var i=n[t];return i&&!!i.manifest})).length}function ct(n,t,i){it.Log.writeEntry2(2,n,t,i)}function lt(n){var t=new et(location.href);return t.setRelativePath(n),t.toString()}function tt(n){return n.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")}function ii(n){return new at.ExtensionManagerImpl({createExtension:o.create,extensionVersionCache:n,storageService:a.create()})}var vt=r,d=vt.Extension,w=i.Base,yt=w.Constants.ExtensionNames.Hubs,it=w.Diagnostics,pt=it.Telemetry,g=r.Rpc,et=w.UriBuilder,rt=v.Source,b=window,ut=b.fx,ot=ut.early,p=it.createLog(
n),wt=n.normalize(undefined),y=ut.environment,st=y.bootMessageSignature,bt=y.bootGetConst,ht=y.bootReturnConst,k=pt.trace,kt=ut.getTimestamp,dt=i.startTimer,gt=tt(lt(y.extensionTraceUri)),ni=tt(lt(y.extensionTelemetryUri)),ti=tt(y.shellVersion),nt,at;(function(n){function r(n,i){var r={};return n&&(r["x-ms-effective-locale"]=n),Q(w.Net2.ajax({uri:t.getUri(n,i),performRetry:!0,type:"GET",dataType:"json",contentType:"application/json",headers:r}))}function u(r){var u;return u=r==="assetTypes"?i=i||Q(t.promise).catch((function(n){return p.warning(n,6),null})).then((function(t){return ft(t)?t:n.getManifestsAjax(undefined,r)})):n.getManifestsAjax(undefined,r),u.then((function(n){return n||{}})).catch((function(n){return p.error(n,7),{}}))}var t=ot.manifestCache,i;n.getManifestsAjax=r;n.getManifests=u})(nt=t.Relex||(t.Relex={}));t.escapeSingleQuote=tt;t.create=ii,(function(n){function ii(n){var t=JSON.stringify(n.effectiveFeatureFlags);return"(function() {var global = window;var env = global.fx.environment;"+
("env.activeFlights = "+ut+";")+("env.extensionTraceUri = '"+gt+"';")+("env.shellVersion = '"+ti+"';")+("env.extensionTelemetryUri = '"+ni+"';")+("env.fxRequireConfig = "+lt+";")+("var extFeatures = "+t+";")+"var features = env.features = env.features || {};Object.keys(extFeatures).forEach(function(key) {    features[key] = extFeatures[key];});var impl = global.FxImpl || {};((impl.startBoot) || MsPortalFx.Internal.startBoot)();})();"}function ri(n){var t=document.createElement("a");return t.href=n,t.href}function tt(n,t,i){return n.count=i.count-t.count,n.chars=i.chars-t.chars,n}var ut=JSON.stringify(y.activeFlights),lt=JSON.stringify(y.fxRequireConfig),at=h.displayLanguage,vt=h.formatCulture,pt=at+c.localeDelimiter+vt,ui=(function(){function n(n){var e=this,u;this.initializedExtensions=[];this._messageHandlers=[];this._isRpcStarted=!1;this._callbacksMap=new i.Map;this._callbacks=f.Callbacks();this._unloadCallbacks=f.Callbacks();this._allManifestsLoaded=Q.defer();this._manifestLoadStarted=
Q.defer();this._relexDisconnected=Q.defer();this._lifetimeManager=new r.TriggerableLifetimeManager;this.manifestLoadComplete=!1;this._manifestsMap={};this._initializedExtensionMap={};this._createExtension=n.createExtension;this._extensionVersionCache=n.extensionVersionCache;n.skipRegisterManifest||d.registerManifestDefinition.register(g.client,null,(function(n,t){e._getExtensionByWindowId(t.srcWindowId).onManifestReceived(n)}));this._addExtensionBootReceiver();u="false";y.features.relex?u=y.features.relex:y.features.showrelexdialog&&(u=n.storageService.getValue(a.ComponentName.Relex,"Enabled",0)==="Enable"?"*":"false");this._relexConfig=new t(u);u&&u!=="false"&&this._addRelexReceiver();this.getHubsExtension=function(){return e.getExtensionByName(yt,d.getHubsCloudName())}}return u.defineProperty(n.prototype,"lifetimeManager",{get:function(){return this._lifetimeManager},enumerable:!0,configurable:!0}),n.prototype.isRelexEnabled=function(){return this._relexConfig.enabled()},n.prototype.getExtension=
function(n,t){return this._getExtensionByDescriptor({cloudName:t,name:n})},n.prototype.getManifestByName=function(n,t){var u=this,i=this._manifestsMap,r=JSON.stringify([].slice.call(arguments));return i[r]||(i[r]=this._manifestLoadStarted.promise.then((function(){return u.getExtension(n,t).getManifestAsync()})).catch((function(n){return delete i[r],Q.reject(n)})))},n.prototype.getExtensionByName=function(n,t,i){var f=this,r,u;return i=i||{},r=this._initializedExtensionMap,u=JSON.stringify([].slice.call(arguments)),r[u]||(r[u]=this._manifestLoadStarted.promise.then((function(){var e=f._getExtensionByDescriptor({cloudName:t,name:n}),o;if(!e)throw new Error("extension {0}, in cloud {1} was not found".format(n,t));return e.unloaded&&!i.onlyIfLoaded&&e.loadAsync(),e.ensureInitialize(),o=e.whenInitialized(),i.timeout>0&&(o=Q(o).timeout(i.timeout,"Timed out waiting for extension '{0}' to load.".format(n))),o.then((function(){var n=f._getLoadedExtensionByWindowId(e.getWindowId()),t;return n&&(t=f.lifetimeManager.
createChildLifetime(),n.extension.initializedExtension.subscribe(t,(function(n){n||(delete r[u],t.dispose())}))),n}))})).catch((function(n){return delete r[u],Q.reject(n)})))},n.prototype.initialize=function(n){var t=this,f=n.onRelexDisconnected,u,c,r,l;f&&this._relexDisconnected.promise.then((function(){f()}));this._extensionsMap={};var a=this._createExtension,e={},y=i.isFeatureEnabled("extensionredirect")?n.extensions.filter((function(n){return!(e[n.name]=n.redirectTo)})):n.extensions,p=function(n){var r=n&&i.remove(t.initializedExtensions,n).length;r&&t._unloadCallbacks.fire(n);n&&(t.initializedExtensions.push(n),t._callbacks.fire(n))},h=y.map((function(n){var i=a(n,t._extensionVersionCache.getLatest(n.name),t._relexConfig),r=i.getWindowId().toLowerCase();if(t._getExtensionByWindowId(r))throw new Error("Extension with window ID '"+r+"' has already been registered.");return i.initializedExtension.subscribeAndRun(t.lifetimeManager,p),t._extensionsMap[r]=i}));return s.redirects(e),this.startRpc(),
u=this._getExtensionByWindowId(d.getHubsWindowId()),u&&g.internalClient.acquireWindow(u.getWindowId()),c=dt(),n.useCachedManifests?(r=nt.getManifests("assetTypes"),this._callbacksMap.has("assetTypes")||this._callbacksMap.set("assetTypes",{initialPromise:r,callbacks:new w.Callbacks})):r=Q({}),r.then((function(n){k({source:"ExtensionManager",action:"CachedManifestCount",actionModifier:v.ActionModifier.Default,data:ft(n),duration:c()});t._extensionVersionCache.setLatest(n);h.forEach((function(t){var i=n[t.name],r;i&&i.manifest||(r=o.getCachedManifestFromLocalStorage(t.getWindowId()),o.canUseManifest(r)&&r.manifest&&(i={manifest:r.manifest,version:r.extVersion}));(t.isTestExtension||t.isTestStamp)&&(i=null);t.loadAsync(i)}))})),l=h.map((function(n){var i=n.getManifestAsync();return i.then((function(n){t._callbacksMap.has("assetTypes")&&t._callbacksMap.get("assetTypes").callbacks.fire(n)})),i})),this._manifestLoadStarted.resolve(),Q.any([Q.allSettled(l),Q.delay(6e4)]).then((function(){t._allManifestsLoaded.
resolve();t.manifestLoadComplete=!0}))},n.prototype.startRpc=function(){var n=this;this._isRpcStarted||(this._isRpcStarted=!0,g.start({originId:"fx",loadWindow:function(t){var i=n._getExtensionByWindowId(t);if(!i)throw new Error("Failed to load extension '{0}'.".format(t));return i.getOrLoadWindow()},parentWindow:b}))},n.prototype.pinExtensions=function(n){var t=this;return this._manifestLoadStarted.promise.then((function(){n.forEach((function(n){if(n){var i=t._getExtensionByWindowId(n);i&&g.internalClient.acquireWindow(i.getWindowId())}}))}))},n.prototype.unloadExtension=function(n){n.dispose()},n.prototype.on=function(n,t){var u=this,f,i,r;return this._callbacksMap.has(n)||(f=void 0,f=y.relex.cachedManifestTypes[n]?nt.getManifests(n).then((function(t){k({source:"ExtensionManager",action:"CachedManifestTypeCount",actionModifier:n,data:ft(t)});var i=u.getExtensions().map((function(i){var e=i.isTestExtension||i.isTestStamp?null:t[i.name],r=e&&e.manifest,f;if(r)i.setManifest(n,r),u._callbacksMap.
get(n).callbacks.fire(r);else return i.loadAsync(),f=i.getManifestAsync(),f.then((function(t){u._callbacksMap.get(n).callbacks.fire(t)})),f.timeout(2e3)})).filter((function(n){return!!n}));return Q.allSettled(i)})):this._allManifestsLoaded.promise,this._callbacksMap.set(n,{initialPromise:f,callbacks:new w.Callbacks})),i=this._callbacksMap.get(n),t&&(r=function(n){try{t(n)||i.callbacks.remove(r)}catch(u){p.error(u,11)}},i.callbacks.add(r),this.getExtensions().forEach((function(t){var i=t.getManifest(n);i&&r(i)}))),i.initialPromise},n.prototype.onLoad=function(n){var i=this,r=this.initializedExtensions.slice(0),t=function(r){try{n(r)||i._callbacks.remove(t)}catch(u){p.error("onLoad event callback has thrown an exception.",2,u)}};this._callbacks.add(t);r.forEach((function(t){n(t)}))},n.prototype.onUnload=function(n){var i=this,t=function(r){try{n(r)||i._unloadCallbacks.remove(t)}catch(u){p.error("onUnload event callback has thrown an exception.",3,u)}};this._unloadCallbacks.add(t)},n.prototype.refreshManifests=
function(n){return nt.getManifestsAjax(n)},n.prototype.dispose=function(){this._lifetimeManager.dispose();this._messageHandlers&&(this._messageHandlers.forEach((function(n){b.removeEventListener("message",n)})),this._messageHandlers=[])},n.prototype._getExtensionByWindowId=function(n){var t=this._extensionsMap;return t&&t[n.toLowerCase()]},n.prototype._getExtensionByDescriptor=function(n){return this._getExtensionByWindowId(d.getWindowId(n))},n.prototype._getLoadedExtensionByWindowId=function(n){return this.initializedExtensions.first((function(t){return t.extension.getWindowId()===n}))},n.prototype._getExtensionByWindow=function(n){return this.getExtensions().first((function(t){return t.getWindow()===n}))},n.prototype.getExtensions=function(){var n=this;return u.keys(this._extensionsMap||{}).map((function(t){return n._extensionsMap[t]}))},n.prototype._addExtensionBootReceiver=function(){var n=this,t=function(t){var r=t,i=t.data,u;i&&i.signature===e.signature&&i.kind===e.MessageKind.Boot&&(u=n.
_getExtensionByWindowId(i.windowId),r={data:i.data,origin:t.origin,source:u.getWindow()});n._onBoot(r);n._onBootGetRequested(r)};b.addEventListener("message",t,!1);this._messageHandlers.push(t)},n.prototype._onBoot=function(n){var t=this._getExtensionByWindow(n.source),r=n.data,u,e,f,l,a;if(r&&r.signature===st){if(u=b.location.origin,!t&&n.origin!==u){e=this.getExtensions().map((function(n){return n.name}));p.error("Received a boot message from '"+n.origin+"' which is not associated to an extension("+e+"). ShellOrigin: ("+u+")",9,r);return}var s=t&&"/"+t.getWindowId(),h=wt+s,c=function(){t&&t.noteScriptError({kind:r.kind,error:r.data})},y=t?r.kind:-1;switch(y){case 0:f=r.data;l=t.processBootGetMessage(f.sdkVersion,f.extVersion);l&&t.getWindow().postMessage({signature:st,kind:1,data:{stopListening:!0,scripts:[{kind:1,data:ii(t)}]}},"*");break;case 2:a="{0} Origin: {1}".format(JSON.stringify(r.data),n.origin);ct(h,a,10);c();break;case 4:ct(h,r.data,8);k({source:rt.Shell,action:v.Action.UnhandledExtensionError,
actionModifier:v.ActionModifier.Default,extension:s,data:o.ExtensionReadyState[t.readyState]});case 5:c();break;case 3:break;default:p.error(new i.Errors.Error({message:"Received a boot message from a source that isn't a recognized extension. Will ignore. Origin: "+n.origin,data:{ext:t,origin:n.origin,data:n.data}}))}}},n.prototype._onBootGetRequested=function(n){var i=n.data,t,r,u;i&&i.boot===bt&&(t=this._getExtensionByWindow(n.source),t?(r=t.processBootGetMessage(i.sdkVersion,i.extVersion),r&&(u={boot:ht,stopListening:!1,scripts:o.getScriptUris(t.metadata,o.RequiredScripts.ExtensionScripts,t.useRelex())},t.getWindow().postMessage(u,"*"))):p.error("_onBootGetRequested receieve invalid evt.source. Origin:"+n.origin+" \n Data:"+JSON.stringify(i)))},n.prototype._addRelexReceiver=function(){var n=this,t;this._m={sent:{count:0,chars:0,startOffBy:0},recv:{count:0,chars:0}};t=function(t){var i=t.data,r=i&&i.messageTelemetry;if(r&&(n._m=r,delete i.messageTelemetry,r.sent.startOffBy=n._relexConfig.
messagesSent-r.sent.count),i&&i.signature===e.signature)switch(i.kind){case e.MessageKind.Telemetry:k(i.data);break;case e.MessageKind.Connection:n._handleConnectionMessage(i.data)}};b.addEventListener("message",t,!1);this._messageHandlers.push(t)},n.prototype._handleConnectionMessage=function(n){n.type===e.ConnectionEventType.Disconnected&&this._relexDisconnected.resolve()},n.prototype.getMessageTelemetry=function(n){var t=this._m;return n&&t?{sent:tt({startOffBy:n.sent.startOffBy,stopOffBy:t.sent.startOffBy},n.sent,t.sent),recv:tt({},n.recv,t.recv)}:t},n})(),t,it;n.ExtensionManagerImpl=ui;t=(function(){function n(n,t){var r=this;this.multiComm=!1;this.devMode=!1;this.messagesSent=0;this._allExtensionsOnRelex=!1;this._extensionMap={};n!=="false"&&(n==="true"&&(n="*,HubsExtension"),n.toLowerCase().split(",").forEach((function(n){n==="*"?r._allExtensionsOnRelex=!0:n==="multicomm"?r.multiComm=!0:n==="devmode"?r.devMode=!0:r._extensionMap[n]=!0})),this._instancePromise=Q().then((function(){var
n;if(r.devMode)return l.processor.initialized.then((function(n){var t=n.relexHost(),i=t.split("/"),r=location.protocol+"//"+i[2];return{uri:t,trustedHost:r}}));n=new et(y.relex.instanceUri);n.path=i.ensureSuffix(n.path,"/")+"relexproxy";n.query.setParameter("verbose",y.isDevelopmentMode?"2":"0");var t=n.toString(),u=t.split("/"),f=location.protocol+"//"+u[2];return{uri:t,trustedHost:f}})),t||(t=function(n){return new it(n)}),this.multiComm?this._createChannel=t:this._channelSingleton=t(this))}return n.prototype.enabled=function(){return this._allExtensionsOnRelex},n.prototype.getInstance=function(){return this._instancePromise},n.prototype.createRpcWindow=function(n){var t;return t=this.multiComm?this._createChannel(this):this._channelSingleton,t.createRpcWindow(n)},n.prototype.useRelex=function(n){return!n.isTestExtension&&this._allExtensionsOnRelex!==Boolean(this._extensionMap[n.name.toLowerCase()])},n})();n.DefaultRelexConfig=t;it=(function(){function n(n){var u=this,t,r,i;this._config=n;
t=ot.relex;t?(this._readyPromise=Q(t.loadPromise),this._frame=f(t.frame),this._trustedHost=t.trustedHost,r=t.initRelexDelay):(i=Q.defer(),this._readyPromise=i.promise,r=kt(),n.getInstance().then((function(n){u._trustedHost=n.trustedHost;u._frame=f(MsPortalEarly.Relex.initializeRelexFrame(n,(function(n){i.resolve(n)}),(function(n){i.reject(n)})))})));k({action:"InitRelexDelay",actionModifier:"complete",source:rt.Shell,duration:r});this._readyPromise.then((function(n){k({action:"RelexClientPageLoad",actionModifier:"complete",source:rt.Shell,duration:n})}))}return n.prototype.createRpcWindow=function(n){var t=this,i=n.getWindowId(),u,r;this._readyPromise.then((function(){n.onLoad(null)&&t._postMessage(i,e.MessageKind.ExtensionLoad,{uri:ri(n.frameUri),locale:pt})}));u=this._frame[0].contentWindow;r=new o.RpcWindow({source:u,window:{postMessage:function(n){var r=n&&n.boot===ht?e.MessageKind.Boot:e.MessageKind.Rpc;t._postMessage(i,r,n)}},trustedHost:this._trustedHost,initializationFunc:undefined},function(
){});r.onDispose((function(){t._postMessage(i,e.MessageKind.ExtensionUnload,{});t._config.multiComm&&setTimeout((function(){t.dispose()}),o.frameRemovalDelay)}));return r},n.prototype.dispose=function(){this._frame&&(this._frame.remove(),this._frame=null)},n.prototype._postMessage=function(n,t,i){var r={signature:e.signature,windowId:n,kind:t,data:i};this._frame[0].contentWindow.postMessage(r,this._trustedHost);this._config.messagesSent++},n})()})(at=t.Internal||(t.Internal={}))})(y||(y={})),y}));define("MsPortalImpl/Extension/ExtensionMetadataSource",["require","exports","f","i","o","../CodeComponentSideLoad/CodeComponentSideLoadManager","../CodeComponentSideLoad/CodeComponentSideLoadModels","../Services/Services.Settings.Schema","../Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function rt(n,t,i,r,u){var f=new l(n,t,i,r,u,b,p.isDevelopmentMode);return MsPortalImpl.Extension=f,f}var a=i.Base,d=a.Diagnostics,h=e.ExtensionMetadataExt,v=r.Extension,y=window,
g=d.createLog(n),p=y.fx.environment,w="testExtensions",nt="loadUntrustedExtensions",tt=o.testExtensionsKey,it=5e3,b=e.canModifyExtensions,k="Reload the portal with the query parameter ?feature.canmodifyextensions=true to load the test extension.",c=h.create,l;t.initializeTestExtension=rt;l=(function(n){function t(t,i,r,u,f,e,o){n.call(this,t,i,r,u,f,e,o,nt,w,c,0,tt)}return __extends(t,n),t.prototype.registerTestExtension=function(n,t){var i=c(n);return this.registerTestCodeComponent(i,t).then((function(){console.log(k)}))},t.prototype.registerTestExtensionsFromUri=function(n,t){var o=this,l=new s.Uri(n),c=l.getHashQueryStringValue(w),r,f;return c?(r=JSON.parse(decodeURIComponent(c)),f=u.keys(r),!b&&f.length&&console.warn(k),Q.allSettled(f.map((function(n){var u=new h,c,f,s,l;return u.name=n,u.cloudName=t,c=v.getWindowId(u),f=i.find(o._trustedCodeComponents,(function(n){return v.getWindowId(n)===c})),f&&(u.obsoleteBundlesBitmask=f.obsoleteBundlesBitmask),s=u.uri=r[n],e.isLocalhostUri(s)?o._registerTestCodeComponentFromUri(
u):(l="Invalid extension: '{0}', only allowed on 'localhost'.".format(s),g.error(l,1),null)})))):Q(null)},t.prototype.unregisterTestExtension=function(n,t){var i=new h;return i.name=n,i.cloudName=t,this.unregisterTestCodeComponent(i)},t.prototype.listTestExtensions=function(){return this.listTestCodeComponents()},t.prototype.clearTemporaryTestExtensions=function(){this.clearTemporaryTestCodeComponents()},t.prototype.loadFromServer=function(n){var i=p.extensionsUri,r,t;return i?(t=y.location.search,t&&(i.indexOf("?")!==-1&&(t="&"+t.substr(1)),i+=t),r=a.Net2.postJSON({uri:i},n).then((function(n){return n.map((function(n){return c(n)}))})).timeout(it,"Timed out fetching extension metadata from the server.")):r=Q([]),r},t})(f.CodeComponentSideLoadManagerImpl);t.ExtensionMetadataSourceImpl=l})(h||(h={})),h}));define("MsPortalImpl/GalleryPackage/GalleryPackageLoader",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function o(n){return new t(n)}var f=i.Base,r=f.Constants,
u=r.ExtensionNames,e=i.Services.Rpc,t;n.initialize=o;t=(function(){function n(n){this._extensionManager=n}return n.prototype.loadGalleryPackages=function(n){if(n&&n.length>0)return this._extensionManager.getExtensionByName(u.Marketplace,r.DefaultCloudName).then((function(){e.invokeCallback(u.Marketplace,"loadGalleryPackages",n)}))},n})();n.GalleryPackageLoaderImpl=t})(r||(r={})),r}));define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-keyboardshortcuts{padding:0 25px;width:355px}.fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts-shortcut{display:-webkit-flex;display:flex}.fxs-keyboardshortcuts-key{-webkit-flex:0 0 auto;flex:0 0 auto;width:70px}")}));define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","f","$","MsPortalImpl/Resources/ImplScriptResources","../Base/Base.KeyboardHelper","../Base/Telemetry","../../_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],
(function(n,t,i,r,u,f,e){"use strict";var o;return (function(t){function it(n){var t=n.isJourneyVisible()&&n.getPanorama();return t&&t.getJourneyWidget()}function a(n){var t=it(n),r=t&&t.getFocusedBlade();return r?r:t&&i.last(t.getBlades())}function rt(n,t,i,r,u){return new v(n,t,i,r,u)}var h=i.Base.Diagnostics,y=h.Telemetry,c=i.Base.EventTypes,p=window,l="#blade/HubsExtension/Resources",w=l+"/resourceType/",b="fxs-sidebar-collapse-button",k="fxs-topbar-home",o=u.KeyboardShortcuts,s=o.GoTo,d=h.createLog(n),g=y.trace,nt=[49,50,51,52,53,54,55,56,57,48],tt=[97,98,99,100,101,102,103,104,105,96],v;t.setup=rt;v=(function(){function n(n,t,i,r,u){this._disposables=[];this._keyShortcuts={};this._goToShortcuts={};this._errorLoggingFunc=u||function(n){d.error(n)};this._addKeyShortcuts(n);this._addGoToShortcuts(t.router,n);this._registerSpecialShortcut(o.showDiagnostics,i,65);this._registerSpecialShortcut(o.showDebugHelper,r,68);this._attachEventHandlers()}return n.prototype.dispose=function(){this._removeEventHandlers(
)},n.prototype._attachEventHandlers=function(){var t=this,n;this._removeEventHandlers();n=!1;this._disposables.push(r(p.document).setEvents([c.keydown,function(i){var u,h=f.getModifierKeys(i),s,o;if(i.keyCode===71&&h===0){n=!0;return}(s=n?t._goToShortcuts[i.keyCode]:t._keyShortcuts[i.keyCode],o=s&&s[h],o)&&((u=r(document.activeElement),u.length>0&&(u.is("input")||u.is("textarea")||["azc-editableControl","fxc-editor","fxc-console","fxc-consolev2"].some((function(n){return u.closest("."+n).length>0}))))||(o.handler(),g({source:e.Source.KeyboardShortcuts,action:e.Action.KeyboardShortcutExecuted,name:o.id}),i.preventDefault()))}],[c.keyup,function(t){var i=f.getModifierKeys(t);t.keyCode===71&&i===0&&(n=!1)}]))},n.prototype._removeEventHandlers=function(){i.disposeDisposable(this._disposables);this._disposables=[]},n.prototype._registerShortcut=function(n,t,i,r){r===void 0&&(r=0);var u=this._keyShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r),e={description:n,handler:t,id:f};u?u[r]&&this.
_errorLoggingFunc("Duplicate shortcut: "+f):this._keyShortcuts[i]=[];this._keyShortcuts[i][r]=e},n.prototype._addKeyShortcuts=function(n){this._registerGotoShortcut(o.toggleFocusSideAndTopBar,(function(){var n=r(document).findByClassName(k)[0];r(document.activeElement)[0]===n?r(document).findByClassName(b)[0].focus():n.focus()}),190);this._registerGotoShortcut(o.moveFocusToCommandBar,(function(){var t=a(n),i=t&&t.getContentWidget();i&&i.setFocusOnCommandBar()}),188);this._registerShortcut(o.bladeSearch,(function(){var t=a(n);t&&t.focusSearchBox()}),191,8)},n.prototype._registerGotoShortcut=function(n,t,i){var r=0,u=this._goToShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r,!0),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate goto shortcut: "+f):this._goToShortcuts[i]=[];this._goToShortcuts[i][r]=e},n.prototype._registerSpecialShortcut=function(n,t,i){r.isFunction(t)&&this._registerShortcut(n,t,i,9)},n.prototype._addGoToShortcuts=function(n,t){var r=this,i;this.
_registerGotoShortcut(o.browse,(function(){t.getSideBarWidget().toggleFlyout()}),66);this._registerGotoShortcut(o.new,(function(){t.getSideBarWidget().openCreate()}),78);this._registerGotoShortcut(o.search,(function(){t.getSearchWidget().setFocus()}),191);[[s.allResources,l,65],[s.resourceGroups,w+"Microsoft.Resources%2Fsubscriptions%2FresourceGroups",82],].forEach((function(t){r._registerGotoShortcut(t[0],(function(){n.route(t[1])}),t[2])}));this._registerGotoShortcut(s.dashboard,(function(){t.handleStartButtonClick()}),68);i=function(n,i){var u=i+1;r._registerGotoShortcut(s.sideBarItem+u,(function(){t.options.sideBar.openFavorite(i)}),n)};nt.forEach(i);tt.forEach(i)},n.prototype._generateIdForKeyboardShortcut=function(n,t,i){i===void 0&&(i=!1);var r=i?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),t&8&&(r+="CTRL+"),t&1&&(r+="ALT+"),t&2&&(r+="WIN/CMD+"),r+f.mapKeyCodeToString((t&4)==4,n)},n.prototype.getShortcuts=function(){return{key:this._keyShortcuts,goTo:this._goToShortcuts}}
,n})()})(o||(o={})),o}));define("MsPortalImpl/Services/Services.AzureStorage",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function c(){s.register(f.client,[r.Extension.getWindowId({name:"Microsoft_Azure_Scheduler",cloudName:t.Constants.DefaultCloudName})],l)}function l(n){var t={isBackgroundTask:!1,uri:h};return o.postJSON(t,n).then((function(n){return n.data}))}var t=i.Base,u=t.Resources,f=r.Rpc,e=r.InternalAzure,o=t.Net2,s=e.getSasUriForQueueEndPoint,h=u.getAppRelativeUri("api/Storage/getsasuriforqueue");n.registerSasEndPoint=c})(u||(u={})),u}));define("MsPortalImpl/Services/Services.BrowseCuration",["require","exports","f","i","MsPortalImpl/Resources/ImplScriptResources","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function p(n){if(n&&!nt.test(n)){e.warning("Invalid curation file name: <"+n+">, skipping this curation file.");return}return n}function ut(n,t,i){return{base:s(n,!1),associated:h.apply(h,t),infoTextOverride:
i}}function s(n,t){var i,r;if(n&&!(n.length<2)&&n[0].length&&n[1].length)return i={extensionName:n[0],assetType:n[1]},t||n[n.length-1]===!1&&(i.isHidden=!0),n.length>2&&(r=n[2],r&&typeof r=="string"&&(i.kind=r)),i}function h(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];return t.map((function(n){return s(n)})).filter((function(n){return!!n}))}function ft(n){return i.require("MsPortalImpl/Services/BrowseCuration/"+n).then((function(n){return n.getCuration()}))}function b(){return o||(o=ft(w),o.catch((function(n){var t="Failed to get the browse curation file <"+w+">";return n&&n.statusText?e.warning(t+": "+(n.status||"")+" ("+n.statusText+")"):n&&n.message?e.warning(t+": "+n.message):e.warning(t),l.ClientNotification.publish({title:v.noCurationTitle,description:v.noCuration,status:l.NotificationStatus.Warning}),{}}))),o}function k(){var n=u.SearchTypeDisplayText,t=u.SearchTypeKeywords,i=u.SearchTypeSubText;return b().then((function(r){var u=(r&&r.search||[]).map((function(r){var u=(r.
id||"").toLowerCase(),f=u&&n[u];if(f)return{id:r.id,displayName:f,subText:i[u],keywords:(t[u]||"").split(","),icon:typeof r.icon=="string"?c.Images.ImageUri(r.icon):r.icon,link:(r.link||"").format({accountPortal:a.links.accountPortal})}})).filter((function(n){return!!n}));return{searchCuration:u,resourceTypesExcludedFromBrowse:y(r&&r.resourceTypesExcludedFromBrowse),mergedAssetTypes:y(tt&&r&&r.mergedAssetTypes)}}))}function et(){f.Curation.getSharedCurationEndpoint.register(d.client,[r.Extension.getHubsWindowId()],(function(){return k()}))}var c=i.Base,d=r.Rpc,l=i.Hubs.Notifications,g=window,a=g.fx.environment,e=c.Diagnostics.createLog(n),nt=/^[a-z\_]+[a-z\d\-\_]*$/i,v=u.BrowseCuration,tt=i.isFeatureEnabled("mergedassets"),y=i.lowerCaseAllStrings,it=p(i.getFeatureValue("browsecuration")),rt=p(a.browseCuration),w=it||rt||"default",o;t.getMergedAssetType=ut;t.getAssetType=s;t.getAssetTypes=h;t.getBrowseCuration=b;t.getSharedCuration=k;t.initializeRpc=et})(e||(e={})),e}));define("MsPortalImpl/Services/Services.Controller",
["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function u(n){var i=[n?n.flushSettings():Q(),r.flush(),t.Upload.flush()],u=i.every((function(n){return!Q.isPending(n)}));return u?Q():Q.all(i)}var t=i.Base.Diagnostics,r=t.Telemetry;n.flush=u})(r||(r={})),r}));define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function s(){e||(e=!0,u.uploadActionEndPoint.register(t.client,null,(function(n){return f().then((function(t){return t.invokeUploadAction(n.uploadKey,n.action,n.context)}))})),u.getUploadInfosEndPoint.registerObjectFactory(t.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){return f().then((function(t){return t.getUploadInfos(n.uploadKeys,n.category,n.resumable)}))}}))}var t=r.Rpc,u=r.FileUpload,o="MsPortalImpl/Services/Services.FileUploadManager",f=i.memoizeQ((function(){return i.require(o).then((function(n){return n.fileUploadManagerInstance(
)}))})),e=!1;n.registerFileUploadEndpoints=s})(u||(u={})),u}));define("MsPortalImpl/Services/Services.GalleryEndpoints",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){var t=r.Extension,e=i.Base,o=e.Constants.ExtensionNames,s=window,u=s.fx.environment,f=u.features,h=(function(){function n(n,i,r){var e=this;this._registeredEndpoints=[];this._extensionManager=i;this._extensionMetadataSource=r;t.getLocalGalleryPackagesEndpointsDefinition.register(n,null,(function(n,i){var r=t.getDescriptor(i.srcWindowId).name.toLowerCase();return r===o.Marketplace.toLowerCase()?e._ensureAllTestExtensionsAreLoaded().then((function(){return e._registeredEndpoints.slice(0)})):null}));t.registerLocalGalleryPackagesEndpointDefinition.register(n,null,(function(n){if(u.isDevelopmentMode||f&&f.canmodifyextensions){var t=e._registeredEndpoints;t.indexOf(n)<0&&t.push(n)}}))}return n.prototype._ensureAllTestExtensionsAreLoaded=function(){var n=this;return this._extensionMetadataSource.listTestExtensions(
).then((function(t){return Q.allSettled(t.map((function(t){return n._extensionManager.getExtensionByName(t.name,t.cloudName)})))}))},n})();n.GalleryEndpointsService=h})(u||(u={})),u}));define("MsPortalImpl/Services/Services.FavoritesSettings",["require","exports","ko","./Services.SettingsProcessor"],(function(n,t,i,r){"use strict";var u;return (function(n){function o(i){if(u&&!e.isTestMode)throw new Error(t+" has already been called.");u=!0;n.processor.init(i,n.settings,f,t,!0)}var f=10,t="InitializeFavoritesSettingsInternal",e=window.fx.environment,u=!1;n.processor=new r.SettingsProcessor;n.settings={favorites:i.observable(""),version:i.observable(0)};n.init=o})(u||(u={})),u}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-commandBar-form{padding:0}.fxs-messagebox,.fxs-progressbox{font-size:14px;box-sizing:border-box;box-shadow:0 5px 15px 2px rgba(0,0,0,.3);border:1px solid}.fxs-messagebox h2,.fxs-progressbox h2{font-size:110%;padding:24px 27px 7px;margin:0;line-height:14px;border-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-messagebox .fxs-messagebox-html,.fxs-messagebox .fxs-messagebox-text,.fxs-messagebox .fxs-progressbox-text,.fxs-progressbox .fxs-messagebox-html,.fxs-progressbox .fxs-messagebox-text,.fxs-progressbox .fxs-progressbox-text{padding:0 27px;word-wrap:break-word}.fxs-messagebox .fxs-progressbox-progressbar,.fxs-progressbox .fxs-progressbox-progressbar{padding:7px 27px 24px}.fxs-messagebox .fxs-messagebox-buttons,.fxs-progressbox .fxs-messagebox-buttons{border-top-width:1px;border-top-style:solid}.fxs-messagebox .fxs-messagebox-buttons button,.fxs-progressbox .fxs-messagebox-buttons button{margin-right:5px}.fxs-messagebox .msportalfx-form,.fxs-progressbox .msportalfx-form{padding:0;margin:27px 0 0}.fxs-messagebox .msportalfx-form div,.fxs-progressbox .msportalfx-form div{padding:15px 27px}.fxs-messagebox-confirmation{padding:10px 27px 0;display:block}.fxs-messagebox-confirmation input{vertical-align:-2px}")})
);define("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","../../Interactions/Interactions.DismissHandler","../../Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Base/JQueryHelper","../Widgets.WidgetBase","../../../_generated/Less/Viva.Controls/Controls/Forms/Viva.Button.css","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(t){function l(n){return"button[value='"+n+"']"}function ei(n){var i=n.closest("."+y),t;i.length>0&&(t=c.Widget.getWidget(i,b),t.cancelButton&&t.cancelButton.click())}function oi(n){var i=n.closest("."+y),t;i.length>0&&(t=c.Widget.getWidget(i,b),t.options.confirmationRequired?t.element.find("input").focus():t.defaultButton&&t.defaultButton.focus())}var pt=i.Base.Diagnostics,rt=i.Base.EventTypes,wt=i.ViewModels.Dialogs,a=wt.MessageBoxButtons,bt=pt.createLog(n),ut=i.newGuid,v=e.Dialogs.
ButtonText,ft="fxs-portal-bg-txt-br",k="azc-button",kt="fxs-portal-button-primary",et="fxs-button-default",y="fxs-messagebox",d="fxs-messagebox-text",ot="fxs-messagebox-buttons",dt='<h2 data-bind="text: data.title" class="fxs-messagebox-title msportalfx-tooltip-overflow"><\/h2><!-- ko if: data.modal -->'+('<div data-bind="sanitizedHtml: data.text" class="'+d+'"><\/div>')+"<!-- /ko --><!-- ko ifnot: data.modal -->"+('<div data-bind="text: data.text" class="'+d+'"><\/div>')+"<!-- /ko --><!-- ko if: data.confirmationRequired --><label class=\"fxs-messagebox-confirmation\"><input type=\"checkbox\" data-bind='checked: func._confirmed'><span data-bind='sanitizedHtml: data.confirmationMessage'><\/span><\/label><!-- /ko -->"+('<div class="'+["msportalfx-form",ot,"fxs-portal-border"].join(" ")+'"><\/div>'),st="<button value='ok'>"+v.ok+"<\/button>",ht="<button value='retry'>"+v.retry+"<\/button>",g="<button value='cancel'>"+v.cancel+"<\/button>",ct="<button value='yes'>"+v.yes+"<\/button>",lt="<button value='no'>"+
v.no+"<\/button>",gt="<div><button value='abort'>"+v.abort+"<\/button>"+ht+"<button value='ignore'>"+v.ignore+"<\/button><\/div>",ni="<div>"+st+"<\/div>",ti="<div>"+st+g+"<\/div>",ii="<div>"+ht+g+"<\/div>",ri="<div>"+ct+lt+"<\/div>",ui="<div>"+ct+lt+g+"<\/div>",p=u.observable,at="abort",vt="retry",fi="ignore",nt="ok",w="cancel",tt="yes",it="no",yt,b;t.cancelMessageBox=ei;t.setFocusOnMessageBox=oi;yt=(function(n){function t(){n.apply(this,arguments);this.title=p();this.text=p();this.modal=!1;this.buttons=p(a.OK);this.confirmationRequired=!1}return __extends(t,n),r.defineProperty(t.prototype,"onButtonClick",{get:function(){return this._buttonClick},set:function(n){if(this._buttonClick)throw new Error("The onButtonClick callback has already been set.");this._buttonClick=n},enumerable:!0,configurable:!0}),t})(c.ViewModel);t.ViewModel=yt;b=(function(n){function t(t,i){var r=this,c,l,a,e,v,w;n.call(this,t,i);this._confirmed=p();t.html(dt).addClass(y).addClass(ft);c=this.ltm;l=document.activeElement;
i.buttons.subscribeAndRun(c,(function(n){t.findByClassName(ot).empty().append(r._getButtonHtml(n))}));a=function(n){var t=r.element[0];return!r.options.modal&&!(t===n)&&!f.contains(t,n)};e={dismissFn:function(){r.cancelButton&&r.cancelButton.click()},shouldDismissOnMouseDownFn:a,shouldDismissOnMouseWheelFn:a,restoreFocus:function(){o.validatePreviousFocusedElement(e,l)&&l.focus()},logName:"messagebox"};this._bindDescendants();this._setAria();this.defaultButton&&this.defaultButton.addClass(k).addClass(kt).focus();this.cancelButton&&this.cancelButton.addClass(k).addClass(et);this.noButton&&this.noButton.addClass(k).addClass(et);t.on(rt.click,"button",v=function(n,t){r._buttonHandler(n,t);e.restoreFocus()});w=new s.KeyboardNavigation(t,2);o.register(e);c.registerForDispose((function(){t.off(rt.click,"button",v);w.dispose();o.unregister(e)}));this._confirmed(!i.confirmationRequired);u.reactor(c,(function(){var n=r.defaultButton;n&&h.toggle(n,r._confirmed())}))}return __extends(t,n),t.prototype.dispose=
function(){this._cleanElement(y,ft);n.prototype.dispose.call(this)},t.prototype._getButtonHtml=function(n){var i=this.options,t,r;switch(n){case a.AbortRetryIgnore:t=f(gt);this.cancelButton=t.find(l(at));break;case a.OK:t=f(ni);this.defaultButton=this.cancelButton=t.find(l(nt));break;case a.OKCancel:t=f(ti);this.defaultButton=t.find(l(nt));r=this.cancelButton=t.find(l(w));break;case a.RetryCancel:t=f(ii);this.defaultButton=t.find(l(vt));this.cancelButton=t.find(l(w));break;case a.YesNo:t=f(ri);this.defaultButton=t.find(l(tt));this.cancelButton=t.find(l(it));break;case a.YesNoCancel:t=f(ui);this.defaultButton=t.find(l(tt));this.cancelButton=t.find(l(w));this.noButton=t.find(l(it));break;default:throw new Error("Could not locate message box button of type {0}.".format(n));}return this.defaultButton&&this.defaultButton.length&&i.defaultButtonText&&this.defaultButton.text(i.defaultButtonText),r&&r.length&&i.cancelButtonText&&r.text(i.cancelButtonText),t},t.prototype._setAria=function(){var
t="aria-labelledby",i="aria-describedby",n=this.element,r=ut(),u=ut();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName(d).attr({id:r,role:"document",tabindex:0});this.ltm.registerForDispose((function(){n.removeAttr("role "+t+" "+i)}))},t.prototype._buttonHandler=function(n){var i=f(n.target).attr("value"),t;switch(i){case at:t=0;break;case w:t=1;break;case fi:t=2;break;case it:t=3;break;case nt:t=4;break;case vt:t=5;break;case tt:t=6;break;default:bt.error("Unknown command message box button was clicked. Button value is {0}.".format(i));return}if(typeof this.options.onButtonClick=="function")this.options.onButtonClick(t)},t})(c.Widget);t.Widget=b})(l||(l={})),l}));define("MsPortalImpl/Services/Services.PortalTips",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.GeneralSettings","../../Viva.Controls/Controls/Viva.Balloon","../Widgets/Dialogs/Widgets.MessageBox"],(function(n,t,i,r,u,f,e){"use strict";var o;
return (function(n){function s(n,t,i,r){return t.then((function(){h(n,i);u.settings.whatsNewVersion(r)}))}function h(n,r){var s=n.createChildLifetime(),h=function(){s.isDisposed()||s.dispose()},c=o.DefaultView,u=new e.ViewModel;u.buttons(i.ViewModels.Dialogs.MessageBoxButtons.OK);u.title(c.title);u.text(c.description.format(t.browseLabel));u.onButtonClick=h;u.disabled(!1);Q.delay(500).then((function(){var n=new f.ViewModel,t;r.push(t=function(i){if(i.length&&r.indexOf(t)>=0){r.removeAll([t]);n.box((function(){return f.getBox($(i[0]))}));n.content('<div class="fxs-portal-tip-content"><\/div>');n.position(2);var o=$(".fxs-portal-tip:first"),c=new f.Widget(o,n,{isTrusted:!0});s.registerForDispose([c,new e.Widget(o.find(".fxs-portal-tip-content:first"),u),]);n.visible(!0);n.visible.subscribe(s,(function(n){n||h()}))}})}))}var t=window.fx.environment.branding,o=r.PortalTips;n.setup=s})(o||(o={})),o}));define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","i"],(function(n,t,i){"use strict";
var r;return (function(n){function o(){u.getSharedSettingsEndPoint.register(f.client,null,(function(){return r()}))}function r(){return Q.fcall((function(){return{links:{accountPortal:t.accountPortal,classicPortal:t.classicPortal,createSupportRequest:t.createSupportRequest,helpAndSupport:t.helpAndSupport,manageSupportRequests:t.manageSupportRequests,giveFeedback:t.giveFeedback,privacyAndTerms:t.privacyAndTerms,learnRelatedResources:t.learnRelatedResources,resourceGroupOverview:t.resourceGroupOverview}}}))}var u=i.Extension,f=i.Rpc,e=window,t=e.fx.environment.links;n.initializeRpc=o;n.getSharedSettings=r})(r||(r={})),r}));define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(t){function pt(){var n=a.getItem(v);return t.authState=JSON.parse(n),a.removeItem(v),t.authState}function wt(n){t.authState=n}function bt(){t.authState&&a.setItem(v,JSON.stringify(t.authState))}function kt(n){return n.refreshToken?new y(new
rt,n):new ut(n)}function dt(n,t,i){return new p(st.client,n,t,i)}function gt(n,t,i){var r=n&&n.authHeader,u,f;return r?(u=n.expiresInMs||1,f=t+u,function(){var n=h();return n<f?Q(r):(i(o,n),Q.reject(s))}):function(){return Q.reject(s)}}var c=r,l=c.Extension,u=i.Base,w=u.Net2,ft=u.Constants,et=u.Constants.ExtensionNames.Hubs,b=u.Diagnostics,k=b.Telemetry,ot=u.Resources,st=r.Rpc,ht=u.Security,ct=c.Security,d=window,a=d.sessionStorage,g=b.createLog(n),lt=ot.getAppRelativeUri("/api/DelegationToken"),f=ct.tokenErrors,e="",o=ft.Shell.toLowerCase(),at=f.accessDenied,nt=f.unknown,tt=f.sessionEnded,s=f.credentialsExpired,vt=f.networkError,yt=f.nullToken,h=Date.now,it=l.getWindowId,v=d.fx.environment.bootstrapAuthorizationKey,rt,y,ut,p;t.extractAndClearAuthState=pt;t.updateAuthState=wt;t.writeAuthState=bt;t.createOAuthTokenProvier=kt;t.createSecurityTokensManager=dt;rt=(function(){function n(){}return n.prototype.getToken=function(n,t,i,r){var f={extensionName:n,resourceName:i,tenant:t,portalAuthorization:
r},e=k.start({source:"Services.SecurityTokens",action:"Get",name:n}),u;return w.postJSON({uri:lt,dataType:"json",setAuthorizationHeader:!1},f).catch((function(t){return u="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(n,i,t.jqXHR.status,t.textStatus,t.errorThrown),Q.reject(t.jqXHR)})).finally((function(){k.endTrace(e,!u,u||i)}))},n})();y=(function(){function n(n,t){var r=this._refreshToken=t.refreshToken,i;this._pendingAuthorization=Q.resolve(r);this._client=n;i=this._user=t.user;this._tenant=i&&i.tenantId}return n.prototype.getToken=function(n,t){var i=this;return this._pendingAuthorization.then((function(r){var u=i._client.getToken(n,i._tenant,t||e,r).catch((function(n){var t=c.Azure.buildSimplifiedError(n),i=t.status,u;return u=400<=i&&i<500?s:i?nt:vt,{portalAuthorization:r,value:{authHeader:null,expiresInMs:0,refreshToken:null,error:u,errorMessage:"code: {0}, statusText: {1}, message: {2}, stack: {3}".format(i,t.statusText,t.message,t.stack||"")}}}));return i.
_pendingAuthorization=u.then((function(n){return i._refreshToken=n.portalAuthorization||r})),u}))},n.prototype.getRefreshToken=function(){return this._refreshToken},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();t.OAuthTokenProviderImpl=y;ut=(function(){function n(n){this._token=n.oAuthToken;this._user=n.user}return n.prototype.getToken=function(){return Q.resolve({value:this._token,portalAuthorization:""})},n.prototype.getRefreshToken=function(){return""},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();p=(function(){function n(n,t,i,r){this._extensionTokenSettings={};this._sessionEnded=!1;this._extensionTokenFailures=[];this._hubsWindowId=l.getHubsWindowId();this._tokenProvider=t;this._rpcClient=n;this._sessionEndedHandler=i;this._tokenFailedHandler=r}return n.prototype.initializeSecurityForShell=function(n){var t=n||{},i=t.oAuthToken,f=t.refreshToken,r=t.createdOn||h(),u=f?this._createShellTokenFunc(i,r):gt(i,r,this._sessionEndedHandler);return this.
_enableShellTokenAccess(),w.initialize(u),u},n.prototype.registerGetAuthorizationTokenEndpoint=function(n){var t=this;this._extensionTokenSettings=i.convertArrayToMap(n,(function(n){var t=n.cloudName;return it({name:n.name.toLowerCase(),cloudName:t?t.toLowerCase():undefined},{forceCloudName:!0}).toLowerCase()}),(function(n){return n.tokenSettings}));this._enableShellTokenAccess();l.getAuthorizationTokenEndPoint.register(this._rpcClient,null,(function(n,i){var r,u=n.cloudName;return r=i.srcWindowId===t._hubsWindowId?it({name:et,cloudName:u},{forceCloudName:!0}):i.srcWindowId,t._getSecurityToken(u,r,n.resourceName||e,n.isBackground)}))},n.prototype.getDiagnosticsData=function(){return this._tokenProvider.getDiagnosticsData()},n.prototype._getSecurityToken=function(n,t,r,u){var f=this,a=t.toLowerCase(),l=this._extensionTokenSettings[a],c=this._shellTokenCache;return r&&l&2?Q({error:at}):this._sessionEnded?Q({error:tt}):c&&!r&&l&1?c.getToken({cloudName:n,resourceName:""}).then((function(n){return{
token:n}})):this._tokenProvider.getToken(t,r,u).then((function(l){var p=f._extensionTokenFailures,w=h(),a=l&&l.value||{},v=a?a.error:yt,d=a.errorMessage,b,y,it,k;return!v&&a.authHeader?(i.remove(p,t),{token:{header:a.authHeader,expiresAt:w+a.expiresInMs}}):(b=v===s,(v===tt||b)&&(f._sessionEnded=!0,y=void 0,b||!c?y=w:(it=t===o?r:e,y=c.getTokenExpiresAt(n,it)),f._sessionEndedHandler(t,y||w)),u||(i.pushUnique(p,[t]),f._tokenFailedHandler(p.join(", ")),k="Failed to get token for {0} & {1}. Error:{2}. Message:{3}".format(t,r,v,d),v===nt?g.error(k):g.verbose(k)),{error:v,errorMessage:d})}))},n.prototype._createShellTokenFunc=function(n,i){var u=this,f={},r,s;return n&&(r=n.expiresInMs||1,f[e]={header:n.authHeader,expiresAt:r>0?i+r:-1}),s=this._shellTokenCache=ht.createAuthTokenCache((function(n){return u._getSecurityToken(n.cloudName,o,n?n.resourceName:e,n.isBackground).then((function(i){var o=(i||{}).token,s;if(!!o&&n.resourceName===e){var r=t.authState||{},c=h(),f=r.oAuthToken||{};f.authHeader=
o.header;f.expiresInMs=o.expiresAt-c;s=u._tokenProvider.getRefreshToken();s&&(f.refreshToken=s);r.createdOn=c;r.oAuthToken=f;t.authState=r}return i}))}),f),function(n){return s.getToken(n).then((function(n){return n&&n.header}))}},n.prototype._enableShellTokenAccess=function(){this._extensionTokenSettings[o]=0},n})();t.SecurityTokensManagerImpl=p})(u||(u={})),u}));define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","f","i","u","../Extension/Extension.Definition.Locator"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function w(n){return c||(c=new s(n.desktop,n.rpcClient))}var l=f.Locator,e=r.Extension,a=e.CloudName,o=r.ViewModels.ParameterCollectionV3,v=i.Base,y=v.Diagnostics,p=i.Parts.PartSize,h,c,s;t.promiseCleanupDelay=3e4;h=y.createLog(n);t.create=w;s=(function(){function n(n,t){this.provisioningPromisesLookup={};this._desktopManager=n;this._registerRpcCallbacks(t)}return n.prototype.processProvisioningRequest=function(n,r){var e=this,c=!0,o="Provisioning request is ",
f,s,h;if(!n)throw new Error(o+" undefined.");if(f=n.provisioningRefKey,!f)throw new Error(o+"missing the provisioningReferenceKey.");if(!n.provisioningPromise)throw new Error(o+"missing the provisioningPromise.");if(!i.isFeatureEnabled("removecreatepin")&&n.startboardInfo){if(this.provisioningPromisesLookup[f])throw new Error("Provisioning promise already exists with the same key.");this.provisioningPromisesLookup[f]={promise:n.provisioningPromise,wasAcquired:!1,data:u};s=function(n){e.provisioningPromisesLookup[f].data=n};n.provisioningPromise.progress(s).then(s).finally((function(){setTimeout((function(){e.provisioningPromisesLookup[f]&&!e.provisioningPromisesLookup[f].wasAcquired&&e._logWarning("Provisioning operation with ref key "+f+" wasn't aquired by the provisioning part. Deleted at "+new Date+".");delete e.provisioningPromisesLookup[f]}),t.promiseCleanupDelay)}));this._addProvisioningPart(n,r)}else n.provisioningPromise.catch((function(n){var t=(n||{}).error||n;e._logWarning("Provisioning promise rejected. "+
(t.message||JSON.stringify(t)))})),n.provisioningConfig&&!!n.provisioningConfig.dontDiscardJourney&&(c=!1);return c&&(h=this._desktopManager.getActiveJourney(),h&&this._desktopManager.forceDiscardJourney(h.id)),n.provisioningPromise},n.prototype._addProvisioningPart=function(n,t){this._desktopManager.addPartToStartBoard({originPartLocator:l.forExtension(n.startboardInfo.provisioningPart.extension,t).withPartType(n.startboardInfo.provisioningPart.name),model:a.addToModel(t,{initialData:{provisioningConfig:n.provisioningConfig,provisioningRefKey:n.provisioningRefKey,startboardPart:n.startboardInfo.startboardPart}}),initialSize:p.Normal})},n.prototype._registerRpcCallbacks=function(n){var t=this;o.initiateProvisioningRequestEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(i,r){var s,u=r.srcWindowId,f;return(s=u!==e.getHubsWindowId()?e.getDescriptor(u).cloudName:i.cloudName,f="Can't initiate the provisioning request. ",!i.provisionerId)?Q.reject(f+
"provisionerId unspecified."):i.provisioningRefKey?(o.getProvisioningRequestEndPoint.acquireObject(n,u,i).then((function(n){var i=n.getValue();t.processProvisioningRequest(i,s).finally((function(){n.dispose()}))}),(function(n){throw new Error(n);})),Q(i)):Q.reject(f+"provisioningRefKey unspecified.")}});o.getProvisioningOperationEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){if(!n)return Q.reject("Can't return provisioning operation. provisioningRefKey unspecified.");var i=t.provisioningPromisesLookup[n],r=i&&i.promise;return r&&(t.provisioningPromisesLookup[n].wasAcquired=!0),Q({provisioningPromise:r,data:i&&i.data})}})},n.prototype._logWarning=function(n){h.warning(n)},n})();t.ShellProvisionerImpl=s})(e||(e={})),e}));define("MsPortalImpl/Services/Services.TelemetrySharing",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function h(n){return f.registerExtensionUnloadCallback(n),f}var e=r.Extension,o=i.Base,u=
o.Constants,t=r.Rpc,s=(function(){function n(){var n=this;this._extensions={};t.client.registerRpcEndPoint(u.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:function(){n._extensions[t.messageContext.srcWindowId]=!0}})}return n.prototype.registerExtensionUnloadCallback=function(n){var t=this;n.onUnload((function(n){var i=e.getWindowId(n);return t._extensions[i]&&delete t._extensions[i],!0}))},n.prototype.trace=function(n){var i=n.extension,r=n.data&&n.data.srcExtension,f=u.TelemetrySharing.TraceTelemetry;this._extensions[i]&&t.client.invokeRpc(f,i,n);i!==r&&this._extensions[r]&&t.client.invokeRpc(f,r,n)},n.prototype.flush=function(){return i.Helpers.Deferred().resolve().promise()},n})(),f=new s;n.getProcessor=h})(u||(u={})),u}));define("MsPortalImpl/Services/Services.Util",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function o(t,i){n.hmacShaEndPoint.register(t,null,s);n.pinPartsEndPoint.register(t,null,(function(n,t){var u=r.Extension.getDescriptor(
t.srcWindowId),f=n.options?n.options.notify:!0;return i.pinMultipleParts(n.parts,u.name,u.cloudName,f)}))}function s(n){var t={isBackgroundTask:!1,uri:u};return e.postJSON(t,n).then((function(n){return n.data}))}var f=i.Base.Resources,t=r.Rpc,e=i.Base.Net2,u;n.hmacShaEndPoint=new t.FuncEndPointDefinition(r.Constants.RpcMethods.getHmacSha256);n.pinPartsEndPoint=new t.FuncEndPointDefinition(r.Constants.RpcMethods.pinParts);u=f.getAppRelativeUri("api/Utilities/gethmacsha256");n.registerEndPoints=o})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",["require","exports","f","i","../../../Extension/ViewModelManager"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function h(n){var e=t+"All.Part",i,r;u.registerWithState("Browse$BrowseAllBlade$ServicesListPartViewModel",e,(function(t,i){return f.composePartViewModel((function(r){return new t.ServicesListPartViewModel(r,i,n)}),{initialState:i,logArea:e})}));u.registerWithState("Browse$BrowseServiceBladeViewModel",
t+"Service.Blade",(function(t,i){var r=new s,u=new t.BrowseServiceBladeViewModel(r,i,n);return new o(r,u,i)}));i=t+"Service.Part";u.registerWithState("Browse$BrowseServiceBlade$ServiceItemsListPartViewModel",i,(function(t,r){return f.composePartViewModel((function(i){return new t.ServiceItemsListPartViewModel(i,r,n)}),{logArea:i})}));r=t+"Service.PinnedPart";u.registerWithState("Browse$BrowseServiceTileViewModel",r,(function(t,i){return f.composePartViewModel((function(r){return new t.BrowseServiceTileViewModel(r,i,n)}),{createHubsInternalCloudNameProperty:!0,logArea:r})}))}var e=r.ViewModels,o=e.CompositionViewModel,f=e.Part,s=i.ViewModels.Internal.ContainerViewModel,t="./MsPortalImpl/UI/Hubs/ViewModels/UI.Browse";n.registerViewModels=h})(f||(f={})),f}));define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","f","i","o","ko","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.AssetTypes","../Hubs/UI.BrowseManager","./UI.NotificationManager","../../Services/Services.BrowseCuration"],
(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(t){function ni(n,t,r,u){var e=f.computed(n,t,i.identity),o;e.extend(et);o=e.subscribe(n,r);u&&o.callback(e())}function ot(n,t){var r=(t||"").toLowerCase(),i=n.assetTypeManifest.resourceType;return(t&&i&&i.kinds||[]).first((function(n){return n.name.toLowerCase()===r}))}function p(n,t,i,r){i===w.BrowseResourceGroupBlade&&(i=w.ResourceGroups);var u=b.getWindowId({name:t,cloudName:n},{forceCloudName:!0});return vt.getAssetTypeOrResourceTypeIdByWindowId(u,i)+(r?"."+r.toLowerCase():"")}function st(n,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||tt.assetPlusKindFormat.format(n.compositeDisplayName.service,t.name))||n.compositeDisplayName.service}function ht(n,t){return t&&t.icon||n.icon}function ct(n,t){return t&&t.keywords||n.assetTypeManifest.keywords}function ti(n,t){return d(n.cloudName,t.cloudName)&&n.extensionName===t.extension&&n.assetType===t.assetTypeManifest.name}function lt(n,t,i){var e,r,u=t.indexOf("."),
f;return u>0&&(r=t,t=r.substring(0,u),e=r.substring(u+1)),f=n.first((function(n){return n.id===t})),f&&g(f,e,i,[],r)}function ii(n,t,i){var o=[],u=[[],["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard","Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport",],["Microsoft_Azure_Expert_AzureAdvisor",],["HubsExtension_Dashboard",],],r;if(i&&n.version()<u.length-1){var f=n.favorites,s=f().toLowerCase(),e=l(f());for(r=(n.version()||0)+1;r<u.length;r++)u[r].forEach((function(n){var t=n.toLowerCase();s.indexOf(t)<0&&(r===3?e.unshift(n):e.push(n),o.push(n))}));f(y(e))}t(o);n.version(u.length-1)}function g(n,t,i,r,u){var o=n.assetTypeManifest,h=o.browseType===3,e=ot(n,t),s=st(n,e),c=n.id.toLowerCase(),l=!!k(r,(function(n){return n.toLowerCase()===c}));return{id:u||n.id,image:ht(n,e),isFavorite:f.observable(!1),isHome:f.observable(!1),opensDashboard:o.name===w.Dashboard&&n.extension===a.ExtensionNames.Hubs,
isFilteredOut:f.observable(!1),isHidden:f.observable(l),label:f.observable(s),labelId:f.observable(s.replace(rt,"")),keywords:ct(n,e),matches:f.observable(),uri:i.assetTypeService.getAssetTypeDeepLink(n,t),opensExternal:h,cloudName:b.normalizeCloudName(n.cloudName),isPreview:n.isPreview,assetType:n,kind:t}}function ri(n){var t=[];return n.forEach((function(n){t=i.union(t,(n.associated||[]).map((function(n){return p(n.cloudName||v,n.extensionName,n.assetType,n.kind)})))})),t}function ui(n){return new at(n)}var nt=i.Base,a=nt.Constants,w=a.AssetNames,b=r.Extension,vt=r.Assets,yt=r.TriggerableLifetimeManager,pt=i.Hubs.Notifications.NotificationStatus,wt=nt.Diagnostics,tt=e.Favorites,it=tt.Notification,bt=window,fi=bt.fx.environment,ei=wt.createLog(n),oi=i.clone,v=a.DefaultCloudName,l=JSON.parse,y=JSON.stringify,si=i.isFeatureEnabled("mergedassets"),kt="uncurated",rt=/\s+/g,k=i.find,hi=i.remove,ut=i.stableSort,d=b.isEqualCloudName,ft=s.compareAssetTypeForSort,dt=i.isFeatureEnabled("userdefineddefaultview"),
gt={},et,at;r.getAssetTypeMappingData=function(){return gt};et={deferred:!0};t.connectDebouncedObservable=ni;t.calculateHiddenAssetTypes=ri;t.createFavoritesManager=ui;at=(function(){function n(n){var t=this;this.categories=f.observableArray();this.categoriesLookup={};this.showCategories=f.observable(!1);this.possibleFavorites=f.observableArray();this.possibleFavoritesLookup={};this.favorites=f.observableArray();this.selectedCloud=f.observable();this._notificationsForItems=f.observable();this._lifetime=new yt;this._extensionToDefaultCategoryMap={};this._missingFavoritesWithIndex={};this._hiddenAssetTypes=[];this._cloudNames=[];this._assetTypesPerCloudMap=r.getCloudMap();this._assetTypesForSelectedCloud=f.observable();this._favLoaded=!1;this._initialFavorites=[];this._categoriesInitialized=!1;this.remove=function(n){var i=t._savedFavorites().length&&l(t._savedFavorites())||[],r=i.indexOf(n);r!==-1&&(i.splice(r,1),t._savedFavorites(y(i)))};this.add=function(n){var i=l(t._savedFavorites())||
[],r=i.indexOf(n);r===-1&&(i.push(n),t._savedFavorites(y(i)))};this.move=function(n){var i=l(t._savedFavorites())||[],r=t.favorites(),u=r[n],f=i.indexOf(u.id);i.splice(n,0,i.splice(f,1)[0]);t._savedFavorites(y(i))};this._services=n;this._savedFavorites=f.observable("")}return n.prototype.initializeFavorites=function(n,t){var r=this,s=this._savedFavorites=n.favorites,y=s&&s().length,k,c;if(this._cloudNames=o.getCloudNames(),y?(i.isFeatureEnabled("skipfavoritesupgrade")||ii(n,this._notificationsForItems,y),this._initialFavorites=l(s())):(k=function(n,t,i,u){r._initialFavorites.push(p(n||v,t,i,u))},this._cloudNames.forEach((function(n){k(n,a.ExtensionNames.Hubs,w.Dashboard)}))),dt){var h=i.find(this._initialFavorites,(function(n){return t.some((function(t){t.name===a.ExtensionNames.Hubs&&(t={name:t.name,cloudName:r._cloudNames[0]});var u=b.getWindowId(t,{forceCloudName:!0});return i.startsWith(n,u+"_")}))})),u=Q.defer(),e=f.observable(!1),d=this._lifetime.createChildLifetime();return u.promise.
finally((function(){d.dispose()})),this.favorites.subscribeAndRun(d,(function(){h&&(!r.favorites().length||r.favorites()[0].id!==h||e())||e(!0)})),this._registerDependency(),f.reactor(this._lifetime,[this._assetTypesForSelectedCloud,e],(function(n,t){n&&n.length&&!r._favLoaded&&(r.loadFavorites().catch((function(n){return Q.isPending(u.promise)&&u.reject(n),Q.reject(n)})),t=e());Q.isPending(u.promise)&&r._favLoaded&&t&&u.resolve()})),c=3e4,u.promise.timeout(c,new Error("initializeFavorites timeout trying to find "+h+". Timeout: "+c))}return this._registerDependency(),this.loadFavorites()},n.prototype.initializeCategories=function(){var n=this,t=this._curationPromise?this._curationPromise:c.getBrowseCuration();return this._categoriesInitialized=!0,t.then((function(t){var s,u;n._discoveryPolicy=t.discoveryPolicy||0;var e=function(t,i){var r={id:t,showLabel:f.observable(!0),isFilteredOut:f.observable(!1),isHidden:f.pureComputed((function(){var t=n.selectedCloud();return!r.possibleFavorites().some((function(
n){return!n.isHidden()&&!n.isFilteredOut()&&d(n.cloudName,t)}))})),label:o.provideCategoryName(t),possibleFavorites:f.observableArray(),sourceCategory:i};return r},h=t.categories||[],r=h.map((function(n){return e(n.id,n)}));r&&r.length&&(s=n._uncuratedCategory=e(kt),r.push(s));n.categories(r);n.possibleFavorites().forEach((function(t){var r=ot(t.assetType,t.kind),u=t.assetType,f=st(u,r);t.label(f);t.labelId(f.replace(rt,""));t.image=ht(u,r);t.keywords=ct(u,r);t.isHidden(t.isHidden()&&!!i.find(n._hiddenAssetTypes,(function(n){return n===t.id})))}));u={};t.categories.forEach((function(t){t.discoveryExtensions&&t.discoveryExtensions.forEach((function(i){u[i]=k(r,(function(n){return n.id===t.id}))||n._uncuratedCategory}))}));n._extensionToDefaultCategoryMap=u;n._loadFlyoutMenu()}))},n.prototype.loadFavorites=function(){var n=this,t=this._savedFavorites&&this._savedFavorites().length&&l(this._savedFavorites())||[],i=[],f=this._services.assetTypeService.allManifestsLoaded(),r,u;return this._favLoaded=!0,r=
function(t,r){var u=lt(n._assetTypesForSelectedCloud(),t,n._services);u?(u.isHome(!r),u.isFavorite(!0),i.push(u)):n._missingFavoritesWithIndex[t]=r},u=function(){var t=n._notificationsForItems()||[],r=t.slice(0);t.forEach((function(n){var t=k(i,(function(t){return n===t.id})),u,f;t&&(u=it.titleFmt.format(t.label()),f=t.assetType.assetTypeManifest||{},h.getNotificationManager().addClientNotification({title:u,description:it.Description[(f.name||"").toLowerCase()]||u,status:pt.Information,timestamp:new Date,cloudName:v,uri:t.uri}),r.remove(n))}));n._notificationsForItems(r);n.favorites(i)},t.length?(t.forEach((function(n){n&&r(n,t.indexOf(n))})),u(),Q()):(this._curationPromise=c.getBrowseCuration(),this._curationPromise.then((function(t){var f=t.favorites,i=n._initialFavorites;f.forEach((function(n){var t=p(n.cloudName||v,n.extensionName,n.assetType,n.kind);i.push(t)}));n._initialFavorites.forEach((function(n){r(n,i.indexOf(n))}));n._savedFavorites(y(i));u()})))},n.prototype.dispose=function(){var n=
this._lifetime;n&&n.dispose();this._lifetime=null},n.prototype._registerDependency=function(){var n=this,t,i;this._assetTypesForSelectedCloud(this._assetTypesPerCloudMap.get(this.selectedCloud())||[]);this.selectedCloud.subscribe(this._lifetime,(function(t){n._assetTypesForSelectedCloud(n._assetTypesPerCloudMap.get(t)||[]);n._assetTypesForSelectedCloud().length&&(n.possibleFavorites([]),n.possibleFavoritesLookup={},n.loadFavorites(),n._loadFlyoutMenu())}));t=this._services.browseManager;i=t.registerAssetTypesUpdateCallback((function(){n._createPerCloudAssetTypes();n._assetTypesForSelectedCloud(n._assetTypesPerCloudMap.get(n.selectedCloud())||[]);n._updateFavorites(n._assetTypesForSelectedCloud());n._categoriesInitialized&&n._loadFlyoutMenu()}));this._lifetime.registerForDispose((function(){t.unregisterAssetTypesUpdateCallback(i)}))},n.prototype._createPerCloudAssetTypes=function(){var t=this,n=this._services.browseManager.getFilteredAssetTypes()||[];n.length&&this._cloudNames.forEach((function(
i){var r=n.filter((function(n){return d(n.cloudName,i)}));t._assetTypesPerCloudMap.set(i,r)}))},n.prototype._updateFavorites=function(n){var t=this;i.forEachKey(this._missingFavoritesWithIndex,(function(i,r){if(r!==-1){var u=lt(n,i,t._services);u&&(u.isHome(!r),u.isFavorite(!0),t.favorites.splice(r,0,u),t._missingFavoritesWithIndex[i]=-1)}}))},n.prototype._addBrowseMenuItem=function(n,t){var u=p(n.cloudName,n.extension,n.assetTypeManifest.name,t),i=g(n,t,this._services,this._hiddenAssetTypes,u),f=this.possibleFavoritesLookup[u],r;f||(this.possibleFavorites().push(i),r=this.favorites().first((function(n){return n.id===i.id})),r&&(i.isFavorite=r.isFavorite,i.isHome=r.isHome),this.possibleFavoritesLookup[i.id]=i)},n.prototype._addBrowseMenuItemToCategory=function(n,t,i,r,u){var s=p(n.cloudName,n.extension,n.assetTypeManifest.name,i),f=g(n,i,this._services,this._hiddenAssetTypes,s),e,o;u.some((function(n){return n.id===s}))||(e=this.possibleFavoritesLookup[f.id],e&&(f.isFavorite=e.isFavorite,f.isHome=
e.isHome,o=f.isHidden=e.isHidden,o(o()||r)),u.splice(t,0,f))},n.prototype._loadFlyoutMenu=function(){var n=this,f=this.possibleFavoritesLookup,e,t,i,r,o,s;this._assetTypesForSelectedCloud().forEach((function(t){n._addBrowseMenuItem(t,undefined)}));e={};t=this.categories();this.showCategories(!!t.length);i=u.keys(f).slice(0);t.forEach((function(t){var r=t.possibleFavorites,s=e[t.id]=r(),u=t.sourceCategory,f=u&&u.items||[],o=[];f.length&&(f.forEach((function(t,r){var u=-1,f,e;n._assetTypesForSelectedCloud().some((function(n){var i,o,s;return t.cloudName=t.cloudName||v,ti(t,n)&&(i=n.assetTypeManifest.resourceType,o=(t.kind||"").toLowerCase(),o&&(s=(i&&i.kinds||[]).some((function(n){return n.name.toLowerCase()===o})),s&&(e=t.kind)),u=r,f=n),u>-1}));u>-1&&(e&&n._addBrowseMenuItem(f,e),i.remove(f.id),n._addBrowseMenuItemToCategory(f,u,e,!!t.isHidden,o))})),r(o))}));r=this._uncuratedCategory;o=[];r&&(s=ut(i.map((function(n){return f[n]})),(function(n,t){return ft(n.label(),t.label())})),s.forEach((function(
t){var f=t.assetType,u=n._extensionToDefaultCategoryMap[f.extension],s=u||r,h=!u&&n._discoveryPolicy===1,e=s.possibleFavorites,i=[];i=u?e():o;n._addBrowseMenuItemToCategory(f,i.length,undefined,h,i);e(i)})));this.possibleFavorites(ut(this.possibleFavorites(),(function(n,t){return ft(n.label(),t.label())})))},n})()})(l||(l={})),l}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration",["require","exports","f","../../../Extension/ViewModelManager"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(){r.register("Gallery$CsmCommand","./MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",(function(n){return new n.CsmCommand(t.DefaultCloudName)}))}var t=i.Base.Constants;n.registerViewModels=u})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks",["require","exports","i","FxHubs/HubsSettingsSchema"],(function(n,t,i,r){"use strict";var u;return (function(n){function f(n,i){var u=Q.defer(),r={},f={store:t,keys:i};return n.querySettings(f).then((function(
n){i.forEach((function(t){r[t]=t in n?n[t]:undefined}));u.resolve(r)})),u.promise}function e(n,i,r){n.setSettings({store:t,settings:i},r)}function o(n){var t=n.settings,i=n.rpcClient,o=[u.getHubsWindowId()];r.readHubsUserSettings.register(i,o,(function(n){return f(t,n)}));r.writeHubsUserSettings.register(i,o,(function(n){return e(t,n.settings,n.priority),undefined}))}var u=i.Extension,t=6;n.registerRpcCallbacks=o})(u||(u={})),u}));define("MsPortalImpl/UI/UI.NpsHelper",["require","exports","f","../Base/Telemetry"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(r,u,c,l,a){return t||!h&&s&&!n.npsShownInSession?i.require("MsPortalImpl/Widgets/Widgets.Nps").then((function(t){f.Diagnostics.Telemetry.trace({source:o.ToastTray,action:e.NPSShown,data:i.extend({productId:c},l)});t.showSurvey(r,u,c,a);n.npsShownInSession=!0})):Q(null)}function a(n,i){var r=i(),f=Date.now()-l,e=r<f&&Math.random()<c;return t||e?u(n,null,null,{surveyLastCompleted:r},(function(){i(Date.now())})):Q(null)}var f=
i.Base,e=r.Action,o=r.Source,t=i.isFeatureEnabled("testnps"),s=i.isFeatureEnabled("nps"),h=i.isFeatureEnabled("ci"),c=(parseFloat(i.getFeatureValue("npspercent"))||1)/100,l=(parseInt(i.getFeatureValue("npsintervaldays"))||90)*864e5;n.npsShownInSession=!1;n.showNps=u;n.showPortalNps=a})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/UI.ResourceMapManagerRpc",["require","exports","FxHubs/RpcEndPoints"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i){var e=r.getHubsWindowId(),f=function(n){return r.getDescriptor(n.srcWindowId).cloudName};r.mapAssetIdToResourceIdEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapAssetIdToResourceId(n,f(r))}))}));r.mapResourceIdToAssetIdEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToAssetId(n,f(r))}))}));u.mapResourceIdToAssetIdEndPoint.register(n,[e],(function(n){return i.getService(t).then((function(t){return t.mapResourceIdToAssetId(n.resourceId,n.
cloudName)}))}));r.mapResourceIdToDynamicSelectionAndIconEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToDynamicSelectionAndIcon(n.resourceId,f(r),{reason:"mapResourceIdToDynamicSelectionAndIcon",extension:r.srcWindowId})}))}));u.mapResourceIdToDynamicSelectionAndIconEndPoint.register(n,[e],(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToDynamicSelectionAndIcon(n.resourceId,n.cloudName,{reason:"mapResourceIdToDynamicSelectionAndIcon",extension:r.srcWindowId})}))}));r.getResourceAssetInformationEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceAssetInformation(n,f(r),{reason:"getResourceAssetInformation",extension:r.srcWindowId})}))}));u.getResourceAssetInformationEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceAssetInformation(n.data,n.cloudName,{reason:"getResourceAssetInformationForHubs",extension:r.srcWindowId})})
)}));r.getResourceEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResource(n.resourceId,!1,f(r),{reason:n.caller+":getResource",extension:r.srcWindowId})}))}));r.signalResourcesChangedEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return Q(t.signalResourcesChanged(n,f(r)))}))}));u.signalResourcesChangedEndPoint.register(n,null,(function(n){return i.getService(t).then((function(t){return Q(t.signalResourcesChanged(n.resourceIds,n.cloudName))}))}));u.mapAssetIdToResourceIdEndPoint.register(n,[e],(function(n){return i.getService(t).then((function(t){return t.mapAssetIdToResourceId(n.assetTriplet,n.cloudName)}))}));i.assetManager.onAssetDeleted((function(n,r,u){i.getService(t).then((function(t){t.processAssetDeletion(n,r,u)}))}))}var f=FxImpl,r=f.Extension,u=i.AssetTypes,t="ResourceMapManager";n.setupResourceMapManagerRpc=e})(r||(r={})),r}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports",
"f","i","../../../Extension/ViewModelManager"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function y(n){var i=u.registerWithState,h,r,c,y;i(l+"ViewModel",t+(f+"Blade"),(function(n,t){var i=new s,r=new n.SettingsBladeViewModel(i,t);return new o(i,r,t)}));h=t+(f+"SettingsPart");i(l+"$SettingsPartViewModel",h,(function(t,i){return e((function(r){return new t.SettingsPartViewModel(r,i,n)}),{createHubsInternalCloudNameProperty:!0,logArea:h})}));i(a+"ViewModel",t+(f+"LanguageSelectionBlade"),(function(n,t){var i=new s,r=new n.LanguageSelectionBladeViewModel(i,t);return new o(i,r,t)}));r=t+(f+"LanguageGrid");i(a+"$LanguageGridViewModel",r,(function(n,t){return e((function(i){return new n.LanguageGridViewModel(i,t)}),{logArea:r})}));i(v+"ViewModel",t+(f+"LocaleSelectionBlade"),(function(n,t){var i=new s,r=new n.LocaleSelectionBladeViewModel(i,t);return new o(i,r,t)}));c=t+(f+"LocaleGrid");i(v+"$LocaleGridViewModel",c,(function(n,t){return e((function(i){return new n.LocaleGridViewModel(i,t)}),{logArea:
r})}));y=t+(f+"DiagnosticsPart");i("Help$HelpAndSupportBlade$DiagnosticsPartViewModel",y,(function(t,i){return e((function(r){return new t.DiagnosticsPartViewModel(r,i,n)}),{logArea:r})}))}var c=r.ViewModels,o=c.CompositionViewModel,e=c.Part.composePartViewModel,s=i.ViewModels.Internal.ContainerViewModel,t="./MsPortalImpl/UI/Hubs/ViewModels/",h="Settings$",l=h+"SettingsBlade",a=h+"LanguageSelectionBlade",v=h+"LocaleSelectionBlade",f="UI.Settings.";n.registerViewModels=y})(f||(f={})),f}));define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.SecurityTokens","../Base/Telemetry"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function y(n,t){return(n&t)===t}function h(n,t,i,r){ut.ClientNotification.publish({title:n,description:t,status:i||k.Information,descriptionAsHtml:r})}function ot(n,t,i,r,u){return new p(n,t,i,r,u)}var c=i.Base,w=c.Diagnostics,b=w.Telemetry,rt=i.ViewModels.Dialogs,s=rt.MessageBoxButtons,
ut=i.Hubs.Notifications,k=i.Hubs.Notifications.NotificationStatus,o=f.Action,d=f.Source,ft=window,l=w.createLog(n),g=c.Constants.Shell,nt=r.Shell,a=nt.Notifications,e=nt.Dialogs,v=a.SessionEnding,tt=a.TokenFailure,it=a.VersionChanged,et=[12e5,6e5],p;t.create=ot;p=(function(){function n(n,t,i,r,u){this._pageBlockingPrompt=!1;this._isDialogVisible=!1;this._unknownNetworkErrorCount=0;this._unknownNetworkErrorCanceled=!1;this._getDialogManager=n;this._extensionVersionCache=t;this._initializationPromise=i;this._redirectFunc=r;this._showSplashScreenFunc=u}return n.prototype.onLastTokenRefresh=function(n,t){var i=Date.now();if(t<=i)this.onStatus({code:2},n);et.forEach((function(n){var r=t-n;ft.setTimeout((function(){var t=Math.floor(n/6e4),i=t>10?v.messageFmt.format(t):v.message;h(v.title,i)}),r-i)}))},n.prototype.onStatus=function(n,t){var ut=this,r=Q.resolve(null),rt,u,v,y;if(!n||this._pageBlockingPrompt)return r;var p=t===g,f=p||t===c.Constants.ExtensionNames.Hubs,a=n.data||{},w=a.uri||"",nt=function(
n){var u=w,r;return i.isUriAbsolute(u)||(u="//"+t+i.ensurePrefix(u,"/")),r=document.createElement("a"),r.text=n,r.title=r.href=u,r.outerHTML};switch(n.code){case 0:break;case 1:p||this._extensionVersionCache.expireLatest(t);f?r=this._showDialog(t,o.ShellVersionChanged,e.newVersionMessageTitle,e.newVersionMessageDescription,e.newVersionDefaultButtonText,null,3e4,s.OKCancel,5):(b.trace({source:d.Shell,action:o.ExtensionVersionChanged,data:t}),l.warning("Extension reporting incompatible server version. {0}:{1}".format(t,a.version)),h(it.title,it.messageFmt.format(t)));break;case 2:rt=o.ExtensionSignedOut;f?r=this._showDialog(t,rt,e.signedOutTitle,e.signedOutDescription,e.signedOutDefaultButtonText,null,0,s.OK,7):h(tt.title,tt.messageFmt.format(t));break;case 4:if(l.verbose("Received a status code zero from extension {0} for URL '{1}'.".format(t,w)),!f)break;if(this._unknownNetworkErrorCount>3||this._isDialogVisible||this._unknownNetworkErrorCanceled)break;this._unknownNetworkErrorCount++;
r=this._showDialog(g,o.UnknownNetworkError,e.connectionErrorMessageTitle,e.connectionErrorMessageDescription.format(nt(e.connectionErrorMessagePlaceHolder)),null,e.connectionErrorCancelButtonText,0,s.OKCancel,0).then((function(n){ut._unknownNetworkErrorCanceled=n===1}));break;case 5:r=this._showDialog(t,o.RelexDisconnected,e.relexDisconnectedMessageTitle,e.relexDisconnectedMessageDescription,e.relexDisconnectedDefaultButtonText,null,0,s.OKCancel,1);break;case 6:u=e.tooManyRequestsDescription.format(nt(e.tooManyRequestsLink));v=a.retryAfter;v&&(u=u+" "+e.tooManyRequestsRetry.format(v));h(e.tooManyRequestsTitle,u,k.Warning,!0);break;default:y="Received unknown extension event '{0}' for extension '{1}'.".format(n.code,t);r=Q.reject(y);l.error(y)}return r},n.prototype._showDialog=function(n,t,i,r,f,e,o,s,h){var a=this,v,k=this._redirectFunc,p=y(h,2),c,w,l;return this._pageBlockingPrompt=y(h,1),t&&b.trace({source:d.Shell,action:t,data:n}),p&&u.updateAuthState(null),c=function(n){k({skipFlushBuffers:
p,delayPromise:n&&o?Q.delay(o):null})},w=y(h,4)&&Q.isPending(this._initializationPromise),w?(v=Q.defer().promise,c(!1)):(l=Q.defer(),this._isDialogVisible=!0,v=this._getDialogManager().then((function(n){return n.showModalDialog({title:i,description:r,defaultButtonText:f,cancelButtonText:e,buttons:s,uiShield:{hidePromise:l.promise}})})).then((function(n){return a._pageBlockingPrompt?(a._showSplashScreenFunc(),l.resolve(),c(!0)):n===4?c(!1):l.resolve(null),n})).finally((function(){a._isDialogVisible=!1}))),v},n})();t.StatusHandlerImpl=p})(e||(e={})),e}));define("MsPortalImpl/UI/UI.ViewTimeTelemetry",["require","exports","f","../Base/Base.Events","../Base/Telemetry"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function st(n,i){e=n.desktop;tt=i&&i.increment||b;it=i&&i.tooSmall||k;nt=e.activeJourney.subscribe((function(n){n?c():o(l)}));e.getDashboardManager().then((function(n){p=n.currentDashboardId.subscribe((function(n){c();v=n;o(l)}));v=n.currentDashboardId()}));a(t.blur,d=function(){c()}
);a(t.focus,g=function(){o(l)});a(t.mousemove,y=function(){h(t.mousemove,y);o()})}function ht(){h(t.blur,d);h(t.focus,g);h(t.mousemove,y);nt.dispose();p&&p.dispose();c()}function o(n){f||e.activeJourney()||(n&&(ut=0,++rt),ft=Date.now(),f=setTimeout((function(){et();f=null;o()}),tt))}function c(){f!==null&&(clearTimeout(f),et());f=null}function et(){var n=Date.now()-ft;n>=it&&ot.trace({source:u.Source.Shell,action:u.Action.DashboardViewTime,data:{target:"Dashboard",trackId:v,timespan:n,sequenceId:rt,sequence:++ut,tileCount:e.startBoard.children.filter((function(n){return!n.dontSetupWidget})).length,fullscreen:!!r.isFullscreen()}})}var w=i.Base,ot=w.Diagnostics.Telemetry,t=w.EventTypes,s=window,l=!0,b=3e5,k=1e4,a=s.addEventListener.bind(s),h=s.removeEventListener.bind(s),e,v="",y,d,g,nt,p,tt=b,it=k,rt=0,ut=0,f=null,ft;n.start=st;n.stop=ht})(f||(f={})),f}));define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require","exports","f","$"],(function(n,t,i,r){"use strict";var u;return (function(
n){function l(n){var i=n.originalEvent,t=i&&i.touches,r=t&&t.length===1,u=t&&t[0];return r?u:null}function y(){var n={width:0,height:0,top:t.targetY,left:t.targetX};f.css(n);r("body").append(f);f.animate({width:e,height:e,top:"-="+(e/2+5),left:"-="+e/2},75)}function p(n){if(n){var t={opacity:.2},i={opacity:1};f.animate(t,25).animate(i,25).animate(t,25).animate(i,25)}f.animate({width:0,height:0,top:"+="+e/2,left:"+="+e/2},75,(function(){f.detach()}))}function s(n,i){i.off(o);h.clearTimeout(c);p(n);t={startTime:0,target:null,targetX:0,targetY:0}}function w(n){s(!0,r(n.currentTarget))}function b(i){var u=l(i),f=r(i.currentTarget),e=Math.abs(t.targetX-u.clientX),o=Math.abs(t.targetY-u.clientY);(e>n.MoveTolerancePixels||o>n.MoveTolerancePixels)&&s(!0,f)}function k(i){var e=r(i.currentTarget),h,f;t.startTime&&(h=Math.abs(Date.now()-t.startTime),h>=n.ReactionDelayMillis&&(e.off(u.contextmenu+o),f=r.Event(u.contextmenu),f.clientX=t.targetX,f.clientY=t.targetY,r(t.target).trigger(f)));s(!1,e)}function a(
i){var f=l(i),e=r(i.currentTarget);if(!f){s(!0,e);return}if(!t||t.startTime===0){t={startTime:Date.now(),target:i.target,targetX:f.clientX,targetY:f.clientY};c=h.setTimeout((function(){y()}),n.ReactionDelayMillis);e.on(u.contextmenu+o,(function(){return!1})).on(u.touchmove+o,b).on(u.touchcancel+o,w).on(u.touchend+o,k)}}function d(n){n.on(u.touchstart,a)}function g(n){n.off(u.touchstart,a);s(!0,n)}var u=i.Base.EventTypes,h=window;n.ReactionDelayMillis=550;n.MoveTolerancePixels=10;n.HintClassIdentifier="fxs-contextMenuTouchHint";var v="<div class='"+n.HintClassIdentifier+"' style='position: fixed;z-index: 500border: 2px solid grey;box-sizing: border-box;background-color: rgba(255, 255, 255, 0.2);pointer-events: none;'><\/div>",f=r(v),e=110,o=".cmtevt",c,t={startTime:0,target:null,targetX:0,targetY:0};n.register=d;n.unregister=g})(u||(u={})),u}));define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Generated/SvgStartupDefinitions",
"MsPortalImpl/Base/JQueryHelper","./Widgets.Common","./Widgets.UIElementBase","MsPortalImpl/Base/Base.SvgHelper","../../_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){var t=i.Base.EventTypes,y=e.Content.SvgStartup,a=o.findByClassName,v=f.ContextPane,p="fxs-contextpane",nt="fxs-contextpane-visible",tt="fxs-contextpane-loading",l="fxs-contextpane-close",r="fxs-contextpane-expand",w="fxs-progress-dots",b="fxs-contextpane-button-inner",k="fxs-contextpane-content",d="fxs-portal-bg-txt-br",it=i.isFeatureEnabled("skipautofocus"),rt=(function(n){function t(){n.call(this,"fxs-contextpane-identifier");this.opened=u.observable(!1);this.loading=u.observable(!1)}return __extends(t,n),t})(h.ViewModel),g;n.ViewModel=rt;g=(function(n){function i(t,i){n.call(this,t,i);var u='<button type="button" class="'+r+' fxs-display-none"><div class="'+b+' fxs-portal-svg">'+c.getSvgReferenceOrFallBackToData(y.hamburger)+"<\/div><\/button>"+
('<button type="button" class="'+l+' fxs-display-none" title="'+v.close+'"><div class="'+b+' fxs-portal-svg">'+c.getSvgReferenceOrFallBackToData(y.close)+"<\/div><\/button>")+('<div class="'+w+'">')+"<div><\/div><div><\/div><div><\/div><\/div>";t.addClass(p).addClass(d).attr("role","complementary").append(u);this._$closeButton=a(t,l);this._$expandButton=a(t,r);this._$progress=a(t,w);this._init();this._attachEventHandlers(i)}return __extends(i,n),i.prototype.dispose=function(){this._cleanElement(p,d);this.element.removeAttr("role");n.prototype.dispose.call(this)},i.prototype.hasContent=function(){return!!this._$content},i.prototype.addChild=function(n){var e,t,i,r,u,f;if(!n)throw new Error("Can't add null child.");this.hasContent()&&this.removeChild(null);e=this.element;t=this._$content=n.element?n.element:n;t.addClass(k).insertBefore(this._$progress);i=!t.hasClass("fxs-blade")&&!t.hasClass("fxs-partgallery-container");r=this._$closeButton;o.toggle(r,i);u=t.hasClass("fxs-partgallery-container");
f=this._$expandButton;o.toggle(f,u)},i.prototype.insertChild=function(n){this.addChild(n)},i.prototype.removeChild=function(n,t){return this._$content?(t?this._$content.detach():this._$content.remove(),this._$content.removeClass(k),this._$content=null,!0):!0},i.prototype.clear=function(n){return this.removeChild(null,n)},i.prototype.setFocus=function(){if(!it){var n=this._$content;n&&s.waitForBindings(this.element[0]).then((function(){n.findFirstTabbable().focus()}))}},i.prototype._init=function(){var n=this.ltm,t=this.element,i=this.options;u.reactor(n,(function(){var n=i.opened();t.toggleClass(nt,n)}));u.reactor(n,(function(){var n=i.loading();t.toggleClass(tt,n)}))},i.prototype._attachEventHandlers=function(n){var u=this.element,i=u.findByClassName.bind(u),f,e;i(l).on(t.click,f=function(){u.trigger(t.fxcontextpaneclosing)});i(r).on(t.click,e=function(){n.collapsed(!n.collapsed())});n.collapsed&&n.collapsed.subscribe(this.ltm,(function(n){i(r).attr({title:n?v.expand:v.collapse,"aria-expanded":
!n})})).callback(n.collapsed());this.ltm.registerForDispose((function(){i(l).off(t.click,f);i(r).off(t.click,e)}))},i})(h.Widget);n.Widget=g})(l||(l={})),l}));define("_generated/Templates/WidgetsNotificationMenu",["require","exports","f"],(function(){"use strict";return function(){return'<!-- ko if: data.menuOpen --> <div class="fxs-notificationmenu-dropdown"> <!-- ko ifnot: data.notifications && data.notifications() && data.notifications().length --> <div tabindex="0" class="fxs-notificationmenu-notification-nodata"> <div class="fxs-notificationmenu-notification-nodata-content" data-bind="text: data.text.noNewNotifications, title: data.text.noNewNotifications"/> <\/div> <!-- /ko --> <!-- ko if: data.notifications && data.notifications() && data.notifications().length --> <div class="fxs-notificationmenu-list-system"> <ul class="fxs-notificationmenu-list" data-bind="foreach: data.notifications"> <li> <a href="" role="button" class="fxs-portal-hover fxs-notificationmenu-notificationclick"> <!-- ko if: status === MsPortalFx.Hubs.Notifications.NotificationStatus.InProgress --> <div class="fxs-notificationmenu-notification"> <div class="fxs-notificationmenu-notification-title"> <div class="fxs-notificationmenu-notification-title-icon" data-bind="image: $root.func._getIcon($data)"/> <div class="fxs-notificationmenu-notification-title-progresstext msportalfx-tooltip-overflow" data-bind="text: title"><\/div> <div data-bind="if: $data.percentComplete"> <div class="fxs-notificationmenu-notification-title-subtitle fxs-portal-title" data-bind="text: $root.func._getPercentCompleteStr($data.percentComplete)"><\/div> <\/div> <\/div> <div class="fxs-notificationmenu-notification-progressbar" data-bind="pcProgressBar: $root.func._getProgressBarViewModel($data.percentComplete)"><\/div> <\/div> <!-- /ko --> <!-- ko ifnot: status === MsPortalFx.Hubs.Notifications.NotificationStatus.InProgress --> <div class="fxs-notificationmenu-notification"> <div class="fxs-notificationmenu-notification-title"> <div class="fxs-notificationmenu-notification-title-icon" data-bind="image: $root.func._getIcon($data)"/> <div class="fxs-notificationmenu-notification-title-text fxs-portal-text msportalfx-tooltip-overflow" data-bind="text: title"><\/div> <time class="fxs-notificationmenu-notification-title-subtitle fxs-portal-title" data-bind="attr: { datetime: $root.func._timestampToString(timestamp) }, text: $root.func._timestampToString(timestamp)"><\/time> <\/div> <div class="fxs-notificationmenu-notification-description fxs-portal-title msportalfx-tooltip-overflow" data-bind="text: description"><\/div> <\/div> <!-- /ko --> <\/a> <\/li> <\/ul> <\/div> <!-- /ko --> <\/div> <!-- /ko -->'}
}));define("_generated/Templates/WidgetsNotificationMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-button fxs-trim-hover fxs-trim-svg fxs-notificationmenu-button"> <div class="fxs-notificationmenu-icon" data-bind="image: data.icon"><\/div> <!-- ko if: data.unreadNotificationsCount --> <div class="fxs-notificationmenu-button-unreadcount" data-bind="text: data.unreadNotificationsCount, css: data.unreadCountClass"><\/div> <!-- /ko --> <\/div>'}}));define("MsPortalImpl/Widgets/Widgets.ToastViewModel",["require","exports","o","a","ko","MsPortalImpl/Resources/ImplScriptResources","./Widgets.WidgetBase"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function o(n){var i=u.unwrap(n&&n.timeoutID);i&&t.clearTimeout(i)}var t=window,i;n.clearItemTimeout=o;i=(function(n){function i(t){t===void 0&&(t={});n.call(this);this.displayCount=4;this.displayTime=u.observable(5e3);this.shouldShowToasts=u.observable(!0);this._items=u.observableArray(
);this.eventHandlers=u.observableArray();this.displayCount=t.displayCount||this.displayCount;this.displayTime=t.displayTime||this.displayTime;this.shouldShowToasts=t.shouldShowToasts||this.shouldShowToasts}return __extends(i,n),i.prototype.addToasts=function(n){var t=this,i=r.isArray(n)?n:[n];i.length&&i.forEach((function(n){var s=t._items(),h=n.icon,c=n.title,l=n.description,a=n.uri,v=n.time,r=n.ids||[],y=n.inProgress||!1,p=n.progressBar||null,w=n.data||null,e=n.stayOpen||!1,b=n.htmlContent||"",k=n.clickable===undefined?!0:n.clickable,d=n.descriptiveText||f.Toast.description.format(n.title),i,o;r.length>0&&(i=s.first((function(n){var t=n.ids();return r.some((function(n){return t.indexOf(n)>-1}))})));i?(i.icon(h),i.title(c),i.description(l),i.uri(a),i.time(v),i.ids(r),i.inProgress(y),i.progressBar(p),i.data(w),i.stayOpen(e),i.clickable(k),i.htmlContent(b),i.descriptiveText(d)):(o={icon:u.observable(h),title:u.observable(c),description:u.observable(l),uri:u.observable(a),time:u.observable(v),
ids:u.observableArray(r),inProgress:u.observable(y),progressBar:u.observable(p),stayOpen:u.observable(e),data:u.observable(w),htmlContent:u.observable(b),timeoutID:u.observable(null),clickable:u.observable(k),onDismissFn:n.onDismissFn,descriptiveText:u.observable(d)},s.length>=t.displayCount&&t._removeLastRemoveableItem(),t._items.unshift(o),e||t.startRemoveTimer(o))}))},i.prototype._removeLastRemoveableItem=function(){for(var t,i=this._items(),n=i.length-1;n>=0;n--)if(t=i[n],!t.stayOpen()){this.removeToast(t);return}},i.prototype.removeToast=function(n){t.clearTimeout(n.timeoutID());this._items.remove(n)},i.prototype.removeAllToasts=function(){this._items().forEach((function(n){t.clearTimeout(n.timeoutID())}));this._items.removeAll()},i.prototype.startRemoveTimer=function(n){var r=this,i;typeof n.timeoutID=="function"&&(i=t.setTimeout((function(){r._items.remove(n)}),this.displayTime()),n.timeoutID(i))},i})(e.ViewModel);n.ViewModel=i})(o||(o={})),o}));define("_generated/Templates/WidgetsToast",
["require","exports","f"],(function(){"use strict";return function(){return'<ul role="presentation" class="fxs-toast" data-bind="visible: data.shouldShowToasts, foreach: func._uiItems"> <li class="fxs-toast-item fxs-popup fxs-portal-bg-txt-br" role="alert" aria-live="polite" aria-atomic="true" data-bind="attr: { \'aria-label\': descriptiveText }"> <!-- ko ifnot: htmlContent --> <a class="fxs-toast-link" aria-hidden="true" data-bind="href: clickable ? \'#\' : null"> <div class="fxs-toast-header"> <div class="fxs-toast-icon" data-bind="image: icon"/> <div class="fxs-toast-title fxs-portal-text" data-bind="text: title"><\/div> <div class="fxs-toast-time fxs-portal-title" data-bind="attr: { datetime: time }, text: time"><\/div> <\/div> <!-- ko ifnot: inProgress --> <div class="fxs-toast-description fxs-portal-title" data-bind="sanitizedHtml: description"><\/div> <!-- /ko --> <!-- ko if: inProgress --> <div class="fxs-toast-progressbar" data-bind="pcProgressBar: progressBar"><\/div> <!-- /ko --> <\/a> <!-- /ko --> <!-- ko if: htmlContent --> <div class="fxs-toast-content" aria-hidden="true" data-bind="unsanitizedHtml: htmlContent"><\/div> <!-- /ko --> <button class="fxs-toast-close fxs-portal-svg" aria-hidden="true" data-bind="image: MsPortalFx.Base.Images.Shell.Close()"><\/button> <\/li> <\/ul> '}
}));define("MsPortalImpl/Widgets/Widgets.Toast",["require","exports","f","o","ko","../Base/Telemetry","./Widgets.WidgetBase","../../_generated/Templates/WidgetsToast","./Widgets.ToastViewModel","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){var t=i.Base.EventTypes,l=i.Base.Diagnostics.Telemetry,b=window,r=".fxs-toast-item",h=".fxs-toast-link",c=".fxs-toast-close",a=f.Source.ToastTray,v=f.Action,y=l.trace,p=s.clearItemTimeout,w=(function(n){function f(t,r){n.call(this,t,r);this._uiItems=u.computed(this.ltm,r._items,i.identity).extend({deferred:!0});this.element.html(o());this._attachEventHandlers();this._bindDescendants()}return __extends(f,n),f.prototype._attachEventHandlers=function(){var n=this.element,i=this.options,f=this.ltm,e,o,s=function(n){var t=u.dataFor(n.currentTarget);p(t)},l=function(n){var t=u.dataFor(n.currentTarget);t.stayOpen&&!t.stayOpen()&&i.startRemoveTimer(t)};n.on(t.focusin,r,s);n.on(
t.focusout,r,l);n.on(t.mouseenter,r,s);n.on(t.mouseleave,r,l);n.on(t.click,h,e=function(r){var f=u.dataFor(r.currentTarget);f.clickable()&&(r.preventDefault(),y({source:a,action:v.ToastClicked}),n.trigger(t.fxtoastclick,f.data()),i.removeToast(f))});n.on(t.click,c,o=function(n){n.preventDefault();var t=u.dataFor(n.currentTarget);t.onDismissFn&&t.onDismissFn();i.removeToast(t)});i.eventHandlers.map(f,(function(t,i){n.on(i.events,i.selector,i.data,i.handler);t.registerForDispose((function(){n.off(i.events,i.selector,i.handler)}))}));f.registerForDispose((function(){n.off(t.focusin,r);n.off(t.focusout,r);n.off(t.mouseenter,r);n.off(t.mouseleave,r);n.off(t.click,h,e);n.off(t.click,c,o)}))},f})(e.Widget);n.Widget=w})(h||(h={})),h}));define("MsPortalImpl/Widgets/Widgets.NotificationMenu",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.GeneralSettings","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Widgets.WidgetBase","./Widgets.DropMenu",
"../../_generated/Templates/WidgetsNotificationMenu","../../_generated/Templates/WidgetsNotificationMenuButton","./Widgets.ToastViewModel","./Widgets.Toast","../../_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";var p;return (function(t){function fi(n,t){g({source:ot,action:d.NotificationMenuNotificationClick});t.trigger(it.fxnotificationclickinmenu,n)}var k=i.Base,tt=k.Diagnostics,wt=tt.Telemetry,it=k.EventTypes,w=k.Images.StatusBadge,r=i.Hubs.Notifications.NotificationStatus,rt=i.ViewModels.Controls.Visualization.ProgressBar.StatusType,bt=i.ViewModels.Controls.Visualization.ProgressBar.ViewModel,kt=r.Information,dt=r.Warning,gt=r.Error,ni=r.Success,ut=r.InProgress,b=f.NotificationMenu,ft=window,ti=ft.fx.environment,et=ti.features.rapidtoasts,ot=s.Source.TopBar,d=s.Action,g=wt.trace,st=it.click,p="fxs-notificationmenu",ht=p+"-dropmenu",ct=p+"-dropdown",lt=p+"-menu",at=p+"-toast",vt=p+"-button-unreadcount",ii=vt+"-oval",
ri=vt+"-circle",nt="a."+p+"-notificationclick",ui=b.title,yt,pt;t.iconMap={};t.iconMap[kt]=w.Info();t.iconMap[dt]=w.Warning();t.iconMap[gt]=w.Error();t.iconMap[ut]=w.Pending();t.iconMap[ni]=w.Success();ft.Intl||tt.createLog(n).warning("Intl polyfill not loaded");yt=(function(n){function t(){n.apply(this,arguments);this.unreadNotificationsCount=u.observable("");this.unreadCountClass=u.observable("");this.text=b;this.icon=o.Content.SvgStartup.notifications;this.menuOpen=u.observable(!1);this.toastsEnabled=e.settings.notificationToastEnabledKey}return __extends(t,n),t})(h.ViewModel);t.ViewModel=yt;pt=(function(n){function e(t,i){var r=this,f,e,s,o;n.call(this,t,i);this._lastMenuOpenedTime=new Date;t.addClass(ht);t.append("<div class='"+lt+"'><\/div>"+("<div class='"+at+"' data-bind='stopBindings: true'><\/div>"));f=this.ltm;e=this._dropMenuViewModel=new c.ViewModel(a(),l());e.menuWidth=355;e.buttonTooltip(ui);s=u.computed(this.ltm,(function(){return!i.menuOpen()&&i.toastsEnabled()&&et!=="0"}));
o=this._toastViewModel=new v.ViewModel({shouldShowToasts:s});et==="true"&&o.displayTime(50);f.registerForDispose(this._dropMenuWidget=new c.Widget(t.findByClassName(lt),this._dropMenuViewModel));f.registerForDispose(new y.Widget(t.findByClassName(at),o));this._bindDescendants();u.reactor(this.ltm,(function(){r._dropMenuWidget.options.isMenuOpen()?r._openMenu():r._closeMenu()}))}return __extends(e,n),e.prototype.getToastVM=function(){return this._toastViewModel},e.prototype.register=function(n){var i=this,r=this.options,u=this.ltm;r.notifications=n;n.subscribe(u,(function(n){var u=n.filter((function(n){return n.timestamp>i._lastMenuOpenedTime})),t=u.length;i._dropMenuWidget.options.buttonLabel(b.overflowTitle.format(t)||b.overflowTitle.format(0));t>20?(r.unreadCountClass(ii),r.unreadNotificationsCount(b.overflowCountMessage)):(r.unreadCountClass(ri),r.unreadNotificationsCount(t?t.toString():""))}));n.subscribeArrayBulkChanges(u,(function(n){if(r.toastsEnabled()){var u=[];n.forEach((function(n){
if(n.timestamp>i._lastMenuOpenedTime){var r=i._timestampToString(n.timestamp),e=n.description||"",o=i._getProgressBarViewModel(n.percentComplete),s=n.status===ut?!0:!1,h=f.Toast.description.format(n.title),c=n.correlationIds;u.push({icon:t.iconMap[n.status],title:n.title,description:e,time:r,ids:c,inProgress:s,progressBar:o,descriptiveText:h,data:n})}}));u.length&&i._toastViewModel.addToasts(u)}}))},e.prototype._getIcon=function(n){return t.iconMap[n.status]},e.prototype._timestampToString=function(n){var t="numeric";return n.toString({hour:t,minute:t})},e.prototype._getProgressBarViewModel=function(n){var u=!0,i=0,r=rt.Indeterminate,t;return n&&(u=!1,i=n,r=rt.InProgress),t=new bt(this.ltm),t.valuePercentage(i),t.status(r),t},e.prototype._getPercentCompleteStr=function(n){return this.options.text.percentComplete.format(n)},e.prototype.dispose=function(){this._removeEventHandlers();this._dropMenuWidget.dispose();this._cleanElement(ht);n.prototype.dispose.call(this)},e.prototype.getDropMenuWidget=
function(){return this._dropMenuWidget},e.prototype._removeEventHandlers=function(){var n=this._notificationClickEventHandler;n&&(this.element.findByClassName(ct).off(st,nt,n),this._notificationClickEventHandler=null)},e.prototype._openMenu=function(){var o=this,n=this.element,t=this.options,f,e;if(g({source:ot,action:d.NotificationMenuOpen}),f=n.findByClassName(nt)[0],f&&f.focus(),t.menuOpen(!0),this._toastViewModel.removeAllToasts(),e=t.notifications().filter((function(n){return n.isRecommendation&&n.timestamp>o._lastMenuOpenedTime})),e.forEach((function(n){var t=n.additionalProperties||{};i.extend(t,{status:r[n.status],correlationId:n.correlationIds&&n.correlationIds.join(",")});g({source:s.Source.NotificationHub,action:d.RecommendationSurfaced,data:t})})),this._lastMenuOpenedTime=new Date,t.unreadNotificationsCount(""),!this._notificationClickEventHandler)n.findByClassName(ct).on(st,nt,this._notificationClickEventHandler=function(t){t.preventDefault();var i=u.dataFor(t.currentTarget);fi(
i,n)})},e.prototype._closeMenu=function(){this.options.menuOpen(!1);this._removeEventHandlers()},e})(h.Widget);t.Widget=pt})(p||(p={})),p}));define("_generated/Templates/WidgetsPanorama",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-target" aria-labelledby="startboard-title"><\/div> <div class="fxs-journey-target"><\/div>'}}));define("MsPortalImpl/Widgets/Widgets.Panorama",["require","exports","f","o","$","MsPortalImpl/Resources/ImplScriptResources","./Widgets.WidgetBase","../../_generated/Templates/WidgetsPanorama","./Widgets.StartBoard","./Widgets.UIElementBase","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){var y=i.Base,t=y.EventTypes,c=window,nt=c.fx.environment.features,r="fxs-panorama",p=r+"-previewbadge",w=r+"-previewbadge-text",b="fxs-startboard-target",k="fxs-journey-target",d="fxs-journey-layout",l=i.htmlEncode(f.Portal.preview),a="Can't add null child.",
g=(function(n){function t(t,i){n.call(this,t);this.rotateThemeEvent=null;this.applyViewSettings(i)}return __extends(t,n),t.prototype.getViewSettings=function(){return{}},t.prototype.applyViewSettings=function(){return},t})(h.ViewModel),v;n.ViewModel=g;v=(function(n){function i(t,i){n.call(this,t,i);t.addClass(r).html(o());t.findByClassName(p).attr("title",l).findByClassName(w).text(l);this._attachEventHandlers()}return __extends(i,n),i.prototype.dispose=function(){this._cleanElement(r);n.prototype.dispose.call(this)},i.prototype.addChild=function(n){if(!n)throw new Error(a);this.getJourneyWidget().addChild(n)},i.prototype.insertChild=function(n,t){if(!n)throw new Error(a);this.getJourneyWidget().insertChild(n,t)},i.prototype.removeChild=function(n){var t=this.getJourneyWidget();return t&&t.removeChild(n)},i.prototype.getStartBoardArea=function(){return this.element.findByClassName(b)},i.prototype.getJourneyArea=function(){return this.element.findByClassName(k)},i.prototype.getStartBoardWidget=
function(){return e.Widget.getWidget(this.getStartBoardArea(),s.Widget)},i.prototype.getJourneyWidget=function(){var n=e.Widget.getWidgets(this.getJourneyArea());if(n.length>1)throw new Error("The journey target has been initialized with more than one widget.");return n[0]},i.prototype.saveViewSettings=function(){return this.options.getViewSettings()},i.prototype.ensureElementInViewport=function(n,t){var i,r,y;if(n&&u.contains(this.element[0],n.element[0])){if(i=n.element,r=this.element,t){this._snapElementToEdge(i);return}var f,c=i.outerWidth(),l=r.outerWidth(),o=r.scrollLeft(),a=o+l,e=i.position().left,v=e+c;if(e<o){if(f=e,y=n,y.options.isMenuBlade()){var p=this.getJourneyWidget(),s=p&&p.getBlades(),h=s&&s[s.length-2];h&&h.options.usingActivationStyle()&&(f=h.element.position().left)}}else v>a&&(f=c>l?e:o+(v-a));r.scrollLeft(f)}},i.prototype._attachEventHandlers=function(){var i=this,n=this.element,f,e;n.on(t.doubleclick,f=function(n){var f=u(n.target),e=f.hasClass(r),o=f.hasClass("fxs-startboard-layout"),
s=f.hasClass("fxs-flowlayout-childcontainer"),h=f.hasClass(d);(e||o||s||h)&&(n.preventDefault(),n.stopPropagation(),c.getSelection().removeAllRanges(),i.trigger(t.fxrotatetheme))});n.on(t.fxensureviewportvisible,e=function(n,t){n.stopPropagation();i.ensureElementInViewport(t.widget,t.alignStart)});this.ltm.registerForDispose((function(){n.off(t.doubleclick,f);n.off(t.fxensureviewportvisible,e)}))},i.prototype._snapElementToEdge=function(n){var t=this;n&&n.length!==0&&n.handleTransitionEndOnce("width",200,(function(){var i=t.element,r;i.width()>=n.width()&&(r=n.position().left,i.scrollLeft(r))}))},i})(h.Widget);n.Widget=v})(c||(c={})),c}));define("_generated/Templates/WidgetsSearch",["require","exports","f"],(function(){"use strict";return function(){return'<div class="fxs-search" role="search" data-bind="css: { \'fxs-search-expanded\': data.isExpanded(), \'fxs-search-no-journeys\': !data.journeysShown() }"> <div class="fxs-box-wrapper" data-bind="css: { \'fxs-searching\': data.showSearching() }"> <div class="fxs-icon msportalfx-svg-flip-horizontal" data-bind="image: MsPortalFx.Base.Images.Search()"><\/div> <div class="fxs-searchbox fxs-topbar-input"><\/div> <div class="fxs-indicator"> <div><\/div><div><\/div><div><\/div> <\/div> <div role="presentation" class="fxs-cross">&times;<\/div> <\/div> <a href="#" class="fxs-search-icon fxs-topbar-button fxs-trim-svg fxs-trim-hover"> <div class="msportalfx-svg-flip-horizontal" data-bind="image: MsPortalFx.Base.Images.Search()"><\/div> <\/a> <div class=\'fxs-menu fxs-popup fxs-portal-bg-txt-br fxs-dropmenu-content\' data-bind=\'visible: data.showMenu()\' title=\'\'><\/div> <\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","../../Viva.Controls/Controls/Forms/Viva.TextBox","./Widgets.WidgetBase","../../_generated/Templates/WidgetsSearch","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){var c=i.Base,t=c.EventTypes,h;n.searchClass="fxs-search";n.searchBoxClass="fxs-searchbox";var l="fxs-search-icon",a="fxs-hidden-important",r=f.Search,v=(function(n){function t(){n.apply(this,arguments);this.journeysShown=u.observable(!1);this.isExpanded=u.observable(!1);this.showMenu=u.observable(!0);this.showResults=u.observable(!1);this.showSearching=u.observable(!1);this.showExternalColumn=u.observable(!1);this.showAllSubscriptionsSearch=u.observable(!1);this.showChangeSubscriptions=u.observable(!1);this.text=r;this.filter=u.observable();this.searchInFilterText=u.observable();this.subscriptionSummary=u.observable();this.
mruItems=u.observableArray();this.results=u.observableArray()}return __extends(t,n),t})(o.ViewModel);n.ViewModel=v;h=(function(f){function o(o,h){var c=this,w;f.call(this,o,h);this._initialized=Q.defer();w=n.searchClass;o.addClass(w).html(s());window.fx.environment.chrome.hideSearchBox&&o.addClass(a);this._bindDescendants({text:h.text});var nt=o.findByClassName(n.searchBoxClass),b=this._textWidget=new e.Widget(nt,{placeholder:u.observable(r.placeholder),readonly:u.observable(!1)}),tt=this._textField=$(b._getElementToFocus()),p,k,d,v=t.focusin,g=t.mousedown,y=o.findByClassName(l);o.on(v,p=function(){o.off(v,p);var n=c._initOptions;(n&&n()||Q(!0)).then((function(){i.require("MsPortalImpl/Widgets/Widgets.SearchDefered").then((function(n){c._initialized.resolve();n.initialize(c,tt)}))}))});y.on(v,k=function(n){n.preventDefault();c.setFocus()});y.on(g,d=function(n){n.preventDefault();c.setFocus()});this.ltm.registerForDispose((function(){b.dispose();o.off(v,p);y.off(v,k);y.off(g,d)}))}return __extends(
o,f),o.prototype.setFocus=function(){this.options.isExpanded(!0);this._textField.focus()},o.prototype.initOptions=function(n){this._initOptions=n},o.prototype.isDropdownInitialized=function(){return this._initialized.promise},o})(o.Widget);n.Widget=h})(h||(h={})),h}));define("_generated/Templates/WidgetsSideBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-sidebar-bar fxs-trim fxs-trim-text" role="navigation"> <div class="fxs-sidebar-top"> <button class="fxs-sidebar-collapse-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="image: data.icons.hamburger"><\/button> <!-- ko if: data.cloudOptions().length > 1 --> <!--TODO 7288579 cscro: remove fxs-blade-trim when bug--> <div class="fxs-sidebar-cloudFilter" data-bind=\'formElement: func.cloudDropDown\'><\/div> <!-- /ko --> <button class="fxs-sidebar-create fxs-trim-hover fxs-trim-border" role="button" data-bind="attr: { title: data.createTooltip }, visible: !data.hideCreateButton()"> <div class="fxs-sidebar-button-flex"> <div class="fxs-sidebar-create-icon fxs-fill-success" data-bind="image: data.icons.plus"><\/div> <div class="fxs-sidebar-create-label fxs-sidebar-show-if-expanded fxs-trim-text" data-bind="text: data.createText"><\/div> <\/div> <\/button> <\/div> <div class="fxs-sidebar-middle"> <ul class="fxs-sidebar-favorites"> <!-- ko foreach: func._favorites --> <li class="fxs-sidebar-item fxs-trim-hover fxs-sidebar-draggable fxs-sidebar-droppable fxs-trim-border" draggable="true"> <a href="" class="fxs-sidebar-item-link fxs-trim-text" data-bind="attr: { href: uri, title: label, role: opensExternal ? \'link\' : \'button\' }"> <div class="fxs-sidebar-icon fxs-trim-svg" data-bind="image: image"><\/div> <div class="fxs-sidebar-label fxs-sidebar-show-if-expanded" data-bind="text: label"><\/div> <div class="fxs-sidebar-external fxs-sidebar-show-if-expanded"> <!-- ko if: $data.opensExternal --> <div class="fxs-trim-svg-secondary" data-bind="image: $root.data.icons.hyperlink"><\/div> <!-- /ko --> <\/div> <div class="fxs-sidebar-handle fxs-trim-svg-secondary" data-bind="image: $root.data.icons.ellipsis"><\/div> <\/a> <\/li> <!-- /ko --> <\/ul> <\/div> <div class="fxs-sidebar-bottom"> <div class="fxs-sidebar-browse fxs-trim-hover fxs-menu-browse" tabindex="0" role="button" data-bind="attr: { title: data.browseTooltip }"> <div class="fxs-sidebar-button-flex"> <div class="fxs-sidebar-browse-label fxs-trim-text fxs-sidebar-show-if-expanded" data-bind="text: data.browseText"><\/div> <div class="fxs-sidebar-browse-icon fxs-trim-svg" data-bind="image: data.icons.caretUp"><\/div> <\/div> <\/div> <div class="fxs-sidebar-flyout fxs-popup fxs-portal-bg-txt-br fxs-sidebar-flyout-is-hidden" aria-expanded="false"><\/div> <\/div> <\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","f","i","o","ko","../Base/Base.Router","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.KeyboardHelper","../Services/Services.GeneralSettings","../Generated/SvgStartupDefinitions","../UI/Hubs/UI.FavoritesManager","../Base/Telemetry","./Widgets.WidgetBase","../../_generated/Templates/WidgetsSideBar","../../_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";var w;return (function(n){function g(n,t,i){pt.trace({source:v.Source.SideBar,name:t,action:n,data:i})}function hi(n,i,r,f){var e=f?u.expand:u.collapse;n.toggleClass(ni,f);i.attr({title:e,"aria-expanded":!f});n.handleTransitionEndOnce("width",150,(function(){$(it).trigger(t.resize)}))}function ci(n){var i=n.isCollapsed,f=i(),t=!f,r=n.saveCollapseState,u=n.getStartboardVisible;u&&u()&&r&&r(t);i(t);g(d.SideBarViewChanged,"",t?"collapsed":"expanded")}function ct(
n,t,i){if(t){var u=i.favorites,r=u.indexOf(n),f=u.indexOf(t);if(r||!t.opensExternal)return g(d.SideBarFavoriteMoved,t.id,{oldIndex:f,newIndex:r}),u.splice(r,0,u.splice(f,1)[0]),i.favoritesManager().move(r),r}return-1}function lt(n,t,i){var u=$(document.activeElement).parent(),e=i?u.next(ht)[0]:u.prev(ht)[0],o,r,s,h;e&&(o=f.dataFor(e),r=ct(o,n,t),r>=0&&(s=t.favorites()[r].uri,h=$("."+st+" [href|='"+s+"']"),h.focus()))}var tt=i.Base,vt=i.ViewModels.Obsolete.Forms.DropDown,yt=vt.ViewModel,t=tt.EventTypes,pt=tt.Diagnostics.Telemetry,wt=l.Content.SvgStartup,it=window,rt=it.fx.environment,w=t.click,bt=rt.branding,kt="fxs-sidebar-collapse-button",dt="fxs-sidebar-create",gt="fxs-sidebar-draggable",nt=".fxs-sidebar-droppable",ni="fxs-sidebar-is-collapsed",ti=".fxs-sidebar-item a",ii=r.Extension.getHubsWindowId()+"_Dashboard",b="fxs-sidebar-entered",k=".fxs-sidebar-entered",ut="fxs-sidebar-flyout",ft=40,ri=38,et=t.keydown,ot=t.keyup,ui={deferred:!0},li=c.settings,st="fxs-sidebar-bar",fi="fxs-sidebar-browse",
ei="fxs-sidebar-browse-shown",ht="li.fxs-sidebar-item",u=o.SideBar,d=v.Action,oi=i.isFeatureEnabled("userdefineddefaultview"),si=(function(n){function t(){n.call(this);this.browseText=i.htmlEncode(bt.browseLabel);this.closeText=u.close;this.browseTooltip=this.browseText;this.createText=u.create;this.createTooltip=u.create;this.favorites=f.observableArray();this.isCollapsed=f.observable(!0);this.onFavoritesChanged=f.observableArray([]);this.possibleFavorites=f.observableArray();this.previewText=u.preview;this.icons=wt;this.cloudOptions=f.observableArray();this.selectedCloud=f.observable();this.favoritesManager=f.observable();this.goToDashboard=function(){return Q()};this.hideCreateButton=f.observable(!0);this.hideCreateButton(rt.chrome.hideCreateButton)}return __extends(t,n),t.prototype.openFavorite=function(n,t,i){var r;if(typeof n=="number"){var u=this.favoritesManager(),f=u&&u.favorites||this.favorites,e=f();n||e.length?r=f()[n]:(r=this.possibleFavorites().first((function(n){return n.id===
ii})),r?this.favorites.push(r):this.goToDashboard())}else r=n;if(r){if(r.opensExternal)return this.openExternal(r.uri),!0;if(!t&&!i)return r.opensDashboard?this.goToDashboard():this.launchBlade(r.uri),!0}},t.prototype.openExternal=function(n){window.open(n,"_blank")},t.prototype.attachFavoritesManager=function(n){this.favoritesManager(n)},t.prototype.initLifetime=function(n){var t=this;this.favoritesManager.subscribeAndRun(n,(function(i){i&&(a.connectDebouncedObservable(n,t.selectedCloud,i.selectedCloud,!0),a.connectDebouncedObservable(n,i.favorites,t.favorites))}))},t})(y.ViewModel),at;n.ViewModel=si;at=(function(n){function r(t,r){var e=this,l,v,o,c,h;n.call(this,t,r);t.html(p());oi&&t.addClass("fxs-sidebar-defaultviewenabled");this._createButton=t.findByClassName(dt);this._flyout=t.findByClassName(ut);this._browseLink=t.findByClassName(fi);l=this._collapseButton=t.findByClassName(kt);this._sideBar=t.findByClassName(st);v=i.getUniqueId();o=this.ltm;r.initLifetime(o);c=this._favorites=r.favorites.
filter(o,(function(n){return n&&n.cloudName===r.selectedCloud()}));c.extend(ui);this.cloudDropDown=new yt(o,{label:f.observable(u.cloud),options:r.cloudOptions});h=this.cloudDropDown.value;r.cloudOptions.subscribe(o,(function(n){n.length>0&&!h()&&h(n[0].value)}));h.subscribe(o,(function(n){r.selectedCloud(n);r.favoritesManager().selectedCloud(n)}));this._bindDescendants();this._attachEventHandlers(o,t,r);f.computed(o,r.onFavoritesChanged,(function(n){if(n.length){var r=c(),i=s.findByClassName(t,"fxs-sidebar-favorites:first .fxs-sidebar-item");n.slice().forEach((function(n){n(i)}))}}));this._getSidebarFlyout=i.memoizeQ((function(){return i.require("MsPortalImpl/Widgets/Widgets.SideBarFlyout").then((function(n){var i=new n.ViewModel,t=new n.Widget(e.element.findByClassName(ut),i,e.options.favoritesManager());return e._initOptions&&e._initOptions().then((function(){t.options.openFeedbackPane=e.options.openFeedbackPane})),t.options.launchBlade=e.options.launchBlade,t.options.openFavorite=e.options.openFavorite,
a.connectDebouncedObservable(e.ltm,e.options.selectedCloud,t.options.selectedCloud,!0),t}))}));r.isCollapsed.subscribeAndRun(o,(function(n){hi(t,l,r,n)}))}return __extends(r,n),r.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement()},r.prototype.initOptions=function(n){this._initOptions=n},r.prototype.toggleFlyout=function(){this._getSidebarFlyout().then((function(n){n.toggle()}))},r.prototype.openCreate=function(){g(d.SideBarNewMenuOpened);this.options.launchBlade(e.getGalleryDeepLink("hub","",this.cloudDropDown.value()))},r.prototype._attachEventHandlers=function(n,i,r){var e=this,l=this._flyout,a=this._sideBar,u=function(t,i,r,u){t.on(i,r,u);n&&n.registerForDispose((function(){t.off(i,r,u)}))},o,s,c;u(this._createButton,w,null,(function(){e.openCreate()}));o=this._browseLink;s=function(){l.addClass(ei);e.toggleFlyout()};u(o,w,null,s);u(o,ot,null,(function(n){if(n.keyCode===13)return s(),!1}));u(i,w,ti,(function(n){var t=f.dataFor(n.target);g(d.SideBarItemOpened,t.id,{isFavorite:
t.isFavorite(),isHome:t.isHome()});e.options.openFavorite(t)&&n.preventDefault()}));u(this._collapseButton,w,null,(function(){ci(r)}));f.reactor(n,r.favorites,(function(n){n.forEach((function(n,t){n.isHome(!t)}))}));c=h.getModifierKeys;u(a,et+" "+ot,null,(function(n){var t=n.keyCode,i;(t===ft||t===ri)&&c(n)===5&&(n.preventDefault(),n.type===et?e._dragItem=f.dataFor(n.target):(i=e._dragItem,t===ft?lt(i,r,1):lt(i,r,0)))}));u(i,t.dragstart,"."+gt,(function(n){var t=n.originalEvent.dataTransfer;t.setData("text","foo");t.effectAllowed="move";e._dragItem=f.dataFor(n.target)}));u(i,t.dragover,null,(function(n){n.preventDefault()}));u(i,t.dragenter,null,(function(n){var t=$(n.target),i=t.closest(nt),r=t.closest(k);r.length===0&&($(k).removeClass(b),i.length&&i.addClass(b))}));u(i,t.dragleave,null,(function(n){var t=$(n.target).closest(nt).length===0?!0:!1;t&&$(k).removeClass(b)}));u(i,t.drop,null,(function(n){var t=n.target,i=$(t).closest(nt),u=f.dataFor(t);n.preventDefault();$(k).removeClass(b);i.length&&ct(u,
e._dragItem,r)}))},r})(y.Widget);n.Widget=at})(w||(w={})),w}));define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","f","o","ko","$","../Interactions/Interactions.ContextMenuTouch","../Interactions/Interactions.OverflowAutoTooltip","../Services/Services.GeneralSettings","../Base/Telemetry","./Widgets.WidgetBase","./Widgets.ContextPane","./Widgets.NotificationMenu","./Widgets.Panorama","./Widgets.Search","./Widgets.SideBar","./Widgets.ToastViewModel","./Widgets.TopBar"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";var k;return (function(n){var r=i.Base.UriBuilder,rt=i.Base.Diagnostics.Telemetry,ut=i.Base.EventTypes,f=window,k=ut,d=f.fx.environment.features,g=d.rapidtoasts,ft="fxs-topbar-notifications",et="fxs-topbar-search",ot="fxs-topbar-toast",t="fxs-show-journey",nt="fxs-show-startboard",st="fxs-portal-content",ht="fxs-portal-contextpane-left",ct="fxs-portal-contextpane-right",lt="fxs-sidebar",at="fxs-topbar",tt,it;u.components.register("fxs-progress",{template:
'<div class="fxs-progress-dots"><div><\/div><div><\/div><div><\/div><\/div>'});tt=(function(n){function t(){n.apply(this,arguments);this.topBar=new b.ViewModel;this.sideBar=new p.ViewModel}return __extends(t,n),t})(c.ViewModel);n.ViewModel=tt;it=(function(n){function c(t,f){var rt=this,h,c,k,it,nt,tt;n.call(this,t,f);this.hasActiveJourney=!1;h=this.ltm;c=f.sideBar;this._topBarWidget=new b.Widget(t.findByClassName(at),f.topBar,t.findByClassName("fxs-portal-console"));this._panoramaContainer=t.findByClassName(st);this._panorama=new v.Widget(this._panoramaContainer,new v.ViewModel("fxs-panorama-instanceid"));k=new l.ViewModel;k.collapsed=c.isCollapsed;this._leftContextPaneWidget=new l.Widget(t.findByClassName(ht),k);this._rightContextPaneWidget=new l.Widget(t.findByClassName(ct),new l.ViewModel);e.register(t);o.register(t);this._searchWidget=new y.Widget(t.findByClassName(et),new y.ViewModel);d.notificationspane==="true"?(it=u.computed(h,(function(){return s.settings.notificationToastEnabledKey(
)&&g!=="0"})),nt=this._toastViewModel=new w.ViewModel({shouldShowToasts:it}),g==="true"&&nt.displayTime(50),i.require("MsPortalImpl/Widgets/Widgets.Toast").then((function(n){h.registerForDispose(new n.Widget(t.findByClassName(ot),nt))}))):h.registerForDispose(this._notificationMenuWidget=new a.Widget(t.findByClassName(ft),new a.ViewModel));c.getStartboardVisible=function(){return rt.isStartBoardVisible()};this._sideBarWidget=new p.Widget(t.findByClassName(lt),c);tt=s.settings;u.computed(h,(function(){var t=tt.animationEnabledKey&&tt.animationEnabledKey(),n=new r(location.href).query.getParameter("enableAnimations");n}));h.registerForDispose((function(){e.unregister(t);o.unregister(t)}))}return __extends(c,n),c.prototype.dispose=function(){this._panorama.dispose();this._cleanElement();n.prototype.dispose.call(this)},c.prototype.getPanorama=function(){return this._panorama},c.prototype.getLeftContextPane=function(){return this._leftContextPaneWidget},c.prototype.getRightContextPane=function(){return this.
_rightContextPaneWidget},c.prototype.getNotificationMenuWidget=function(){return this._notificationMenuWidget},c.prototype.getSearchWidget=function(){return this._searchWidget},c.prototype.getSideBarWidget=function(){return this._sideBarWidget},c.prototype.getToastVM=function(){return this._toastViewModel},c.prototype.getTopBarWidget=function(){return this._topBarWidget},c.prototype.isStartBoardVisible=function(){return!this.element.hasClass(t)},c.prototype.isJourneyVisible=function(){return this._hasJourneyWithContent()&&this.element.hasClass(t)},c.prototype.showStartBoard=function(){this._sideBarWidget.options.isCollapsed(s.settings.sideBarCollapsedKey());this.element.removeClass(t).addClass(nt);this.options.topBar.dashboardVisible(!0);this.trigger(k.fxshowstartboard);var n=this.getPanorama().getStartBoardWidget();n&&n.setFocus()},c.prototype.showJourney=function(){if(!this.isJourneyVisible()){this.element.removeClass(nt).addClass(t);this.options.topBar.dashboardVisible(!1);var n=this.
getPanorama().getJourneyWidget();n&&n.setFocus()}},c.prototype._hasJourneyWithContent=function(){var n=this.getPanorama(),t=n&&n.getJourneyWidget(),i=this.getRightContextPane();return t&&t.hasChildren()||i&&i.options.opened()},c.prototype.handleStartButtonClick=function(){var t=h.ActionModifier.PortalScrolled,i=new r(f.location.href),u=!i.fragment,n;this.isStartBoardVisible()||(this._hasJourneyWithContent()&&u&&!this.hasActiveJourney?(n=this._panorama.getJourneyWidget(),n&&n.close()):(this.element.trigger(k.fxhomebuttonclick),t=h.ActionModifier.StartBoardRestored));rt.trace({source:h.Source.Desktop,action:h.Action.HomeButtonClicked,actionModifier:t})},c})(c.Widget);n.Widget=it})(k||(k={})),k}));define("_generated/Templates/WidgetsHelpMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fx-dropmenu-dropdown"> <div class="fxs-dropmenu-list-system"> <ul role="presentation"> <li class="fxs-portal-hover" data-bind="visible: !!data.links.createSupportRequest" role="presentation"> <a class="fxs-helpmenu-support-request" role="menuitem" href="" target="_blank" data-bind=\'attr: {href: data.links.createSupportRequest || "", title: data.text.newSupportRequestLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.newSupportRequestLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.add"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.manageSupportRequests" role="presentation"> <a class="fxs-helpmenu-manage-support-requests" role="menuitem" href="" target="_blank" data-bind=\'attr: {href: data.links.manageSupportRequests || "", title: data.text.manageSupportRequestsLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.manageSupportRequestsLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="visible: data.links.manageSupportRequests && !data.links.manageSupportRequests.startsWith(\'#\'), image: data.icons.hyperlink"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" role="presentation" data-bind="visible: data.showGuidedTour"> <a class="fxs-helpmenu-welcomesequence" role="menuitem" href="" target="_blank" data-bind=\'attr: {title: data.text.welcomesequencePaneLabel}\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.welcomesequencePaneLabel"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.helpAndSupport" role="presentation"> <a class="fxs-helpmenu-support" role="menuitem" href="" target="_blank" data-bind=\'attr: {href: data.links.helpAndSupport || "", title: data.text.supportLabel}\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.supportLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="visible: data.links.helpAndSupport && !data.links.helpAndSupport.startsWith(\'#\'), image: data.icons.hyperlink"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" role="presentation" data-bind="visible: data.showKeyboardShortcuts"> <a href="" class="fxs-helpmenu-keyboardshortcuts" role="menuitem" data-bind="attr: { title: data.text.keyboardshortcutsPaneLabel, \'aria-haspopup\': true }"> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.keyboardshortcutsPaneLabel"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" role="presentation" data-bind="visible: !!data.links.privacyAndTerms, css: { \'fxs-portal-border fxs-dropmenu-line-separator\': !!data.links.createSupportRequest || !!data.links.manageSupportRequests || !!data.links.helpAndSupport }"> <a class="fxs-helpmenu-legal" role="menuitem" href="" target="_blank" data-bind=\'attr: {href: data.links.privacyAndTerms || "", title: data.text.legalLabel}\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.legalLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="visible: data.links.privacyAndTerms && !data.links.privacyAndTerms.startsWith(\'#\'), image: data.icons.hyperlink"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" role="presentation"> <a href="" class="fxs-helpmenu-show-diagnostics" role="menuitem" data-bind="attr: { title: data.text.showDiagnosticsLabel, \'aria-haspopup\': true }"> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.showDiagnosticsLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.hyperlink"><\/div> <\/a> <\/li> <\/ul> <\/div> <\/div>'}
}));define("_generated/Templates/WidgetsHelpMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-button fxs-trim-hover fxs-trim-svg" data-bind="image: data.icons.help"><\/div>'}}));define("MsPortalImpl/Widgets/Widgets.HelpMenu",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Widgets.WidgetBase","./Widgets.DropMenu","../../_generated/Templates/WidgetsHelpMenu","../../_generated/Templates/WidgetsHelpMenuButton"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a;return (function(n){function ot(n,t){(!t||t.startsWith("#"))&&n.preventDefault()}function p(n){i.Base.Diagnostics.Telemetry.trace({source:o.Source.TopBar,action:n})}function a(n,t,i){p(n);i&&i.startsWith("#")&&t.route(i)}var w=i.Base.EventTypes,et=window,b=et.fx.environment,v=b.chrome,t=b.links,r=o.Action,k=w.click,d="fxs-dropmenu",g="fxs-helpmenu-legal",nt="fxs-helpmenu-support",tt="fxs-helpmenu-welcomesequence",
it="fxs-helpmenu-keyboardshortcuts",y="fxs-helpmenu-support-request",rt="fxs-helpmenu-manage-support-requests",ut="fxs-helpmenu-show-diagnostics",st=(function(n){function r(){n.apply(this,arguments);this.showGuidedTour=u.observable(i.isFeatureEnabled("guidedtour"));this.showKeyboardShortcuts=!v.hideShortcuts;this.legal=null;this.text=f.HelpMenu;this.links=t;this.icons=e.Content.SvgStartup}return __extends(r,n),r})(s.ViewModel),ft;n.ViewModel=st;ft=(function(n){function e(t,i,r,e,o){var a=this,s;if(n.call(this,t,i),t.addClass(d),this._portal=r,this._userSettingsManager=e,s=this._dropMenuViewModel=new h.ViewModel(l(),c()),this._dropMenuWidget=new h.Widget(t,s),s.buttonTooltip(f.HelpMenu.supportLabel),!v.hideShortcuts)$(document).on(w.fxopenshortcutslegend,(function(n){i.openKeyboardShortcutsPane();n.preventDefault()}));this._bindDescendants();u.reactor(this.ltm,(function(){a._removeEventHandlers();s.isMenuOpen()&&a._openMenu(o)}))}return __extends(e,n),e.prototype.dispose=function(){this._removeEventHandlers(
);this._dropMenuWidget.dispose();this._cleanElement(d);n.prototype.dispose.call(this)},e.prototype.getDropMenuWidget=function(){return this._dropMenuWidget},e.prototype.initialize=function(n,u,f,e){var o=this.options,s;v.hideShortcuts||(s=i.memoizeQ((function(){return i.require("MsPortalImpl/Widgets/Widgets.KeyboardShortcutsPane").then((function(n){return n.create(e,f)}))})),o.openKeyboardShortcutsPane=function(){s().then((function(n){p(r.HelpMenuOpenKeyboardShortcuts);n.toggle()}))});o.openHelpAndSupport=function(){return a(r.HelpBladeOpen,n,t.helpAndSupport)};o.openSupportRequestBlade=function(){return a(r.HelpMenuOpenSupportRequest,n,t.createSupportRequest)};o.openManageSupportRequestsBlade=function(){return a(r.HelpMenuOpenManageSupportRequest,n,t.manageSupportRequests)};o.openPrivacyAndTerms=function(){return a(r.HelpMenuOpenLegal,n,t.privacyAndTerms)};o.showDiagnostics=u},e.prototype._removeEventHandlers=function(){var t=this,n=function(n,i){return i&&t.element.findByClassName(n).off(k,
i),null};this._shortcutsHandler=n(it,this._shortcutsHandler);this._legalHandler=n(g,this._legalHandler);this._supportRequestHandler=n(y,this._supportRequestHandler);this._welcomeSequenceHandler=n(tt,this._welcomeSequenceHandler);this._helpBladeHandler=n(nt,this._helpBladeHandler);this._manageRequestsHandler=n(rt,this._manageRequestsHandler);this._diagnosticsHandler=n(ut,this._diagnosticsHandler)},e.prototype._openMenu=function(n){var f=this.element,u=this.options,i;f.findByClassName(y)[0].focus();p(r.HelpMenuOpen);i=function(n,t,i){var r=function(n){t(n);ot(n,i)};f.findByClassName(n).on(k,r);return r};this._shortcutsHandler=i(it,u.openKeyboardShortcutsPane);this._legalHandler=i(g,u.openPrivacyAndTerms,t.privacyAndTerms);this._supportRequestHandler=i(y,u.openSupportRequestBlade,t.manageSupportRequests);this._welcomeSequenceHandler=i(tt,n);this._helpBladeHandler=i(nt,u.openHelpAndSupport,t.helpAndSupport);this._manageRequestsHandler=i(rt,u.openManageSupportRequestsBlade,t.manageSupportRequests);
this._diagnosticsHandler=i(ut,u.showDiagnostics)},e})(s.Widget);n.Widget=ft})(a||(a={})),a}));define("_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxpart-itemsummary{height:100%;background:#00f;display:block;color:#fff}.fxpart-itemsummary-name{font-size:19px;padding:20px;text-transform:uppercase}.fxpart-itemsummary-sourceControl{font-size:16px;padding:0 20px}")}));define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,'.msportalfx-specpicker-footer-value,.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode,.msportalfx-specpicker-table .msportalfx-specpicker-feature-name,.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker:after,.msportalfx-specpicker:before{content:"";position:absolute;z-index:-1;top:10px;bottom:10px;left:0;right:0;border-radius:10px}.msportalfx-specpicker:after{right:10px;left:auto;transform:skew(8deg) rotate(3deg)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.fxs-mode-dark .msportalfx-specpicker{box-shadow:0 1px 4px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1) inset}.fxs-mode-dark .msportalfx-specpicker:after,.fxs-mode-dark .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(255,255,255,.8)}.fxs-mode-light .msportalfx-specpicker{box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset}.fxs-mode-light .msportalfx-specpicker:after,.fxs-mode-light .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(0,0,0,.8)}.msportalfx-specpicker-star{width:14px;height:14px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{text-transform:uppercase;padding-left:11px}.msportalfx-specpicker-header .msportalfx-specpicker-header-title{opacity:.8;padding-left:6px}.msportalfx-specpicker-header-text{width:161px;position:absolute}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade1{background-color:#8a2da5}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(138,45,165,.2)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(138,45,165,.1)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade1{background-color:#7fba00}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(127,186,0,.2)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(127,186,0,.1)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade1{background-color:#ffb900}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade2{background-color:rgba(255,185,0,.2)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade3{background-color:rgba(255,185,0,.1)}.msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-size:12px;margin-left:6px}.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-size:17px}.msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:12px;padding-top:6px;margin-left:6px;line-height:normal}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;font-size:22px;line-height:22px;letter-spacing:-.025em}.msportalfx-specpicker-footer-details{font-size:10px;line-height:14px;text-transform:uppercase;color:#8f9ca8}.msportalfx-specpicker-footer-channelMessage,.msportalfx-specpicker-footer-statusMessage{color:#8f9ca8;margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;overflow:hidden;text-overflow:ellipsis;max-height:32px}.msportalfx-specpicker-footer-channelMessage::after,.msportalfx-specpicker-footer-channelMessage::before{position:absolute;background-color:inherit}.msportalfx-specpicker-footer-channelMessage::before{content:\'\\02026\';top:16px;right:0}.msportalfx-specpicker-footer-channelMessage::after{content:\'\';height:100%;width:100%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline;color:#fff}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-filtersContainer.ext-hubs-specPicker-filtersContainer{margin-top:0}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions{font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#00bcf2;fill:#00bcf2}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:0;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus{outline-style:dotted;outline-width:1px}')})
);define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle{text-align:center;float:initial}")})
);define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","f","./Parts","../../_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","../../_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","../../_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],(function(n,t,i,r){"use strict";var u;return (function(n){var t=i.Parts.PartKind,u=i.Parts.PartSize,h=u.Mini,o=u.Small,e=u.Normal,f=u.Wide,c=u.Large,l=u.Tall,a=u.HeroWide,v=u.HeroTall,w=u.HeroWideFitHeight,y=u.FullWidthFitHeight,b=u.FitToContainer,s="<div data-bind='{0}: $root'><\/div>",p={defaultSize:y,supportedSizes:[y],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]};n.parts=[{kind:t.Asset,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",(function(n,t,i,r,u){return new n.AssetPart(t,i,r,u)}),{defaultSize:o,supportedSizes:[h,o,e]})},{kind:t.Button,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",(function(n,t,i,r,u){return new n.ButtonPart(
t,i,r,u)}),{supportedSizes:[h,o,e,f]})},{kind:t.Chart,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Chart",(function(n,t,i,r,u){return new n.Chart(t,i,r,u)}),{supportedSizes:[o,e,l,f,c,a,v,w,y,b]})},{kind:t.Collection,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",(function(n,t,i,r,u){return new n.CollectionPart(t,i,r,u)}),{supportedSizes:[h,o,e,f,l,c,a,v,w,b,y]})},{kind:t.CollectionSummary,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",(function(n,t,i,r,u){return new n.Part(t,i,r,u)}),{supportedSizes:[h,o,e,f]})},{kind:t.DiffEditor,factory:r.createPartFactory(s.format("pcDiffEditor"))},{kind:t.Donut,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Donut",(function(n,t,i,r,u){return new n.Donut(t,i,r,u)}),{supportedSizes:[e,a,f,c,l,v,]})},{kind:t.Editor,factory:r.createPartFactory(s.format("pcEditor"))},{kind:t.Grid,factory:r.createPartFactory(s.format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems","content.selectableData.activatedItems",
"content.selectableData.itemsWithChildEdits"]})},{kind:t.InfoList,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.InfoList",(function(n,t,i,r,u){return new n.InfoListPart(t,i,r,u)}),p)},{kind:t.ItemSummary,factory:r.createPartFactory("<div class='fxpart-itemsummary'><div class='fxpart-itemsummary-name' data-bind='text: name'><\/div><\/div>")},{kind:t.LogStream,factory:r.createPartFactory(s.format("pcLogStream"))},{kind:t.Properties,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",(function(n,t,i,r,u){return new n.PropertiesPart(t,i,r,u)}),p)},{kind:t.Provisioning,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Provisioning",(function(n,t,i,r,u){return new n.ProvisioningPart(t,i,r,u)}),{supportedSizes:[e,f]})},{kind:t.QuickStart,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",(function(n,t,i,r,u){return new n.QuickStartPart(t,i,r,u)}),{defaultSize:o,supportedSizes:[h,o,e,f]})},{kind:t.QuotaGauge,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuotaGauge",
(function(n,t,i,r,u){return new n.QuotaGauge(t,i,r,u)}),{supportedSizes:[e,c,f,l,v,a]})},{kind:t.ResourceSummary,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",(function(n,t,i,r,u){return new n.ResourceSummaryPart(t,i,r,u)}),p)},{kind:t.Settings,factory:r.createPartFactory(s.format("pcSettings"),{defaultSize:f,supportedSizes:[f]})},{kind:t.SingleSetting,factory:r.createPartFactory(s.format("pcSingleSetting"))},{kind:t.SingleValueGauge,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.SingleValueGauge",(function(n,t,i,r,u){return new n.SingleValueGauge(t,i,r,u)}),{supportedSizes:[e,c,f,l]})},{kind:t.Unavailable,factory:r.createPartFactory("<div><\/div>")}];n.parts.forEach((function(n){r.registerFactory(t[n.kind],n.factory)}))})(u||(u={})),u}));define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-part-buttonpart-assetname,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart{height:100%;width:100%;box-sizing:border-box}.fxs-part-buttonpart-inner{display:-webkit-flex;display:flex;position:relative;height:100%;box-sizing:border-box;text-align:center;-webkit-align-items:center;align-items:center;-webkit-flex-direction:column;flex-direction:column}.fxs-part-buttonpart-inner-pad{padding-top:28px}.fxs-part-buttonpart-iconcontainer{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-size:12px;line-height:18px}.fxs-part-buttonpart-assetname{margin:0;font-family:az_ea_font,wf_segoe-ui_semibold,\"Segoe UI Semibold\",\"Segoe WP Semibold\",\"Segoe UI\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-size:10px;line-height:10px;text-transform:uppercase}.fxs-part-buttonpart-title{margin:10px 0 5px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-mini .fxs-part-buttonpart-title,.fxs-tilesize-small .fxs-part-buttonpart-title{margin:0}.fxs-part-buttonpart-title::after,.fxs-part-buttonpart-title::before,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{position:absolute;background-color:inherit}.fxs-part-buttonpart-title::before{content:'\\02026';top:18px;right:0}.fxs-part-buttonpart-title::after{content:'';height:100%;width:100%}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart-inner,.fxs-tilesize-wide .fxs-part-buttonpart-inner{padding-top:0;text-align:left;-webkit-flex-direction:row;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>svg{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{-webkit-flex:0 1 auto;flex:0 1 auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:center;justify-content:center}.fxs-tilesize-mini{font-size:12px;line-height:normal}.fxs-tilesize-mini .fxs-part-buttonpart-inner{padding-top:5px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:32px;line-height:15px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:16px;right:0}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer{width:calc(100% - 51px)}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:18px;right:0}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{width:calc(100% - 85px)}.fxs-tilesize-wide .fxs-part-buttonpart-title{margin:0}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block;margin-top:10px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:90px}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after,.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{position:absolute;background-color:inherit}.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{content:'\\02026';top:72px;right:0}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after{content:'';height:100%;width:100%}.fxs-part-buttonpart-externallink{position:absolute;top:0;right:0;height:12px;width:12px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}.fxs-tilesize-mini .fxs-part-buttonpart-externallink{top:-5px;right:5px}.fxs-part-buttonpart,.fxs-part-buttonpart .fxs-part-buttonpart-desc,.fxs-part-buttonpart .fxs-part-buttonpart-inner,.fxs-part-buttonpart .fxs-part-buttonpart-textcontainer,.fxs-part-buttonpart .fxs-part-buttonpart-title{background-color:inherit}.fxs-part-buttonpart-adornment{position:absolute;top:0;left:33px;height:14px;width:14px}.fxs-tilesize-mini .fxs-part-buttonpart-adornment{position:absolute;top:0;left:17px;height:10px;width:10px}.fxs-tilesize-small .fxs-part-buttonpart-adornment{position:absolute;top:50% - 30px/2;left:0;height:10px;width:10px}.fxs-tilesize-wide .fxs-part-buttonpart-adornment{position:absolute;top:50% - 50px/2;left:0;height:14px;width:14px}html[lang^=ja] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=ko] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=zh] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title{font-size:11px;line-height:11px}")})
);define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","f","o","ko","../Generated/SvgStartupDefinitions","./Parts","MsPortalImpl/Base/Base.SvgHelper","../../_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var t=i.Parts.PartSize,s=f.Content.SvgStartup,r;n.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-inner'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon, css: { \"fxs-part-buttonpart-inner-pad\": _showTopPadding() }'><\/div><!-- ko if: $data.adornmentUri --><img alt='' class='fxs-part-buttonpart-adornment' data-bind='attr: { src: adornmentUri }' /><!-- /ko --><div class='fxs-part-buttonpart-textcontainer'><h4 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' data-bind='text: _displayTitle, css: { \"fxs-should-use-single-line\": _assetNameVisible(), \"fxs-can-use-multiline\": !_assetNameVisible() }'><\/h4><h5 data-bind='text: _assetName, visible: (_assetNameVisible())' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow fxs-portal-title'><\/h5><div data-bind='text: description, visible: ((size() === MsPortalFx.Parts.PartSize.Wide) && description())' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'><\/div><\/div><!-- ko if: _isExternalLink --><div class='fxs-part-buttonpart-externallink azc-fill-heavy'>"+
o.getSvgReferenceOrFallBackToData(s.hyperlink)+"<\/div><!-- /ko --><\/div><\/div>";r=(function(r){function f(){r.apply(this,arguments);this.template=n.template}return __extends(f,r),f.prototype._getContentForBinding=function(n,f){var y=this,o=f.content,s=f.container,e=s.clickableLink,c=function(n){return n.target()==="_self"||n.uri&&i.startsWith(n.uri(),"#")&&n.target()==="auto"},l=u.observable(!!e&&!c(e)),h=o.size,a,v;return u.computed(n,(function(){y.ariaLabel(o.title())})),a=e&&e.target,a&&a.subscribe(n,(function(){l(!c(e))})),v=e&&e.uri,v&&v.subscribe(n,(function(){l(!c(e))})),i.extend2(r.prototype._getContentForBinding.call(this,n,f),{_displayTitle:u.computed(n,(function(){var n=h&&h(),i=o.title();return n===t.Mini||n===t.Small?o.shortTitle()||i:i})),_assetName:s.assetName,_isExternalLink:l,_assetNameVisible:u.computed(n,(function(){return!y.inContainerOfSameAsset()&&s.assetName()})),_showTopPadding:u.computed(n,(function(){var n=h&&h();return n===t.Normal&&!s.partTitle()}))})},f})(e.PartImpl);
n.ButtonPart=r})(s||(s={})),s}));define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-part-collectionpart .azc-grid table td.azc-grid-cell:first-of-type,.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart-more-data,.fxs-part-collectionpart-rollup-count{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.fxs-part-collectionpart .azc-grid table thead tr th{height:28px;line-height:28px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td:last-child,.fxs-part-collectionpart .azc-grid table td:last-of-type{padding-right:15px}.fxs-part-collectionpart .azc-grid table .azc-grid-resizableColumn-handle{height:28px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{font-size:12px;line-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:absolute;right:0}.fxs-part-collectionpart-more-data:hover{text-decoration:underline}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-family:az_ea_font,wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:10px;line-height:10px;text-transform:uppercase;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^=ja] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=ko] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=zh] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}')})
);define("MsPortalImpl/Parts/Parts.Collection",["require","exports","f","o","ko","$","MsPortalImpl/Base/JQueryHelper","./Parts","MsPortalImpl/Resources/ImplScriptResources","../../_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){var t=i.Parts.PartSize,r=s.Parts,h='<div class="fxs-part-collectionpart" data-bind="css: {\'fxs-part-collectionpart-rollup-forceshow\': alwaysShowRollupCount()}"><div class="fxs-part-collectionpart-rollup-container"><span class="fxs-part-collectionpart-rollup-count" data-bind="text: rollupCount, visible: !noRollupCount()"><\/span><span class="fxs-part-collectionpart-rollup-label" data-bind="text: rollupCountLabel"><\/span><img class="fxs-part-collectionpart-rollup-icon" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }" alt=""/><div class="fxs-part-collectionpart-rollup-icon" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }"><\/div><h4 class="fxs-part-collectionpart-part-title fxs-display-none" data-bind="text: _partTitle"><\/h4><\/div><!-- ko if: emptyGrid() && noRowsHtml() --><div class="fxs-part-collectionpart-norowshtml fxs-display-none" data-bind="pcControl: noRowsHtml"><\/div><!-- /ko --><!-- ko if: !emptyGrid() || !noRowsHtml() --><!-- ko if: !!gridMode() --><div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"><\/div>'+
('<a class="fxs-part-collectionpart-more-data fxs-portal-text-primary" tabindex="0" data-bind="visible: hasMoreData">'+r.more+"<\/a>")+"<!-- /ko --><!-- /ko --><\/div>",c=(function(n){function r(t,i,r,u){n.call(this,t,i,r,u);this.template=h;var e=this._container=f(t);e.on("click keydown","a.fxs-part-collectionpart-more-data",(function(n){n.stopPropagation();var t=f.Event(n.type);t.keyCode=n.keyCode;f(n.delegateTarget).trigger(t)}))}return __extends(r,n),r.prototype._getContentForBinding=function(n,r){var f=this._container.findByClassName("fxs-part-collectionpart-part-title"),o=this._container.findByClassName("fxs-part-collectionpart-norowshtml");return u.computed(n,(function(){var n=r.content.size();e.toggle(f,n!==t.Mini||!!r.container.partTitle());e.toggle(o,n!==t.Mini&&n!==t.Small)})),i.extend2(r.content,{_partTitle:r.container.partTitle})},r})(o.PartImpl);n.CollectionPart=c})(h||(h={})),h}));define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports","f","u",
"o","ko","./UI.Composition.Part","./UI.Composition.PropertyBinding","./UI.Composition.CompositionBinder"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function g(n,t){var i=n.parent&&n.getPartsContainer(),u=i&&i.getCompatibleSourceReferences&&i.getCompatibleSourceReferences.bind(i),e=function(n){if(u){var t=u(n);return t&&t[0]}},f,r;return t=t||[],f=n.overridesModel,r=[],t.forEach((function(n){var i=n.name,t;t=o.getModelValue(f,i).exists?null:e(n);r.push(h(n,t))})),r}function v(n){if(n.adapter){var i=y(n),t={},r=p(n,!1);return r.forEach((function(n){var r,f=n.compositionBindingDefinition,u=f&&f.source,e;u&&u.modelType===a&&(e=u.property,r=i[e]);r||(r={bindingSources:[],activeBindingSourceName:null});t[n.targetProperty]=r})),t}return y(n)}function nt(n,t,i){function e(e,s){var y,b,l,a;t&&r.turnOnInputsSetSuppressionOn(t);r.turnOnInputsSetSuppressionOn(i);try{var k=e.inputs,p=e.settings,d=e.inputsMetadata,w=n.getSettingsModel(),h=n.partDefinition&&n.partDefinition.partState,
g=h?(h.inputIdentityProperties||[]).concat((h.sharedProperties||[]).map((function(n){return n.property}))):[],nt=u.keys(p);g.forEach((function(n){var r=f.unwrap(o.getModelValue(w,n).value),t=n.startsWith("content.")?n.slice(8):n,i=f.toJS(o.getModelValue(p,t).value);c(i,r)||(o.setModelValue(w,n,i),y=!0);nt.remove(t)}));l=v(n);u.keys(l).forEach((function(t){var i=l[t],r=d[t],u=k[t];it(n,t,i,r.activeBindingSourceName,u)&&(b=!0)}));b&&(n.widgetState.valueHasMutated(),tt(n),n.save())}finally{return a=(y?2:1)|(s?0:4),Q.all([t&&Q(r.turnOnInputsSetSuppressionOff(t,a,!0))||Q(),Q(r.turnOnInputsSetSuppressionOff(i,a,!0))])}}n.getViewModel().internal.updateConfigFn(e)}function tt(n){var t=n.widget;t&&t.element.trigger(e.fxpartinputchanged,{part:n})}function h(n,t){var r=n,i=n,f=i.targetProperty||r.name,o=!!n.optional,u;return t||(u=i.source&&i.source.property||r.name,t=e.createOverridesOrContainerModelSourceReference(u)),{targetProperty:f,optional:o,source:t,isDynamicBinding:!0}}function y(n){var t=n.parent&&
n.getPartsContainer(),i=t&&t.getCompatibleSourceReferences&&t.getCompatibleSourceReferences.bind(t),r=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,s=function(n){var u,t;return r&&i&&(t=r.first((function(t){return t.name===n})),t&&(u=i(t))),(u||[]).map((function(n){return{sourceReference:n,name:n.property,acceptsValueUpdates:!1}}))},u=n.overridesModel,h=function(n){if(!n||e.isDynamicBindingWithNonLocalSource(n))return!1;var t=n.source&&n.source.property;return u&&t&&o.getModelValue(u,t).exists},f={},c=p(n);return c.forEach((function(n){var r=n.targetProperty,u=s(r),t=n.compositionBindingDefinition,i=t&&t.source,e=!h(t)&&i&&(u||[]).first((function(n){var t=n.sourceReference;return t.modelType===i.modelType&&t.property===i.property}));f[r]={bindingSources:u,activeBindingSourceName:e&&e.name}})),f}function p(n,t){return t===void 0&&(t=!0),n.getNonDetailsContainerPropertyBindings(t).filter((function(n){var t=n.targetProperty;return!k.isBladeCallerInput(t)&&t!==w.EditScopeId})
)}function it(n,t,i,u,e){var y=u&&i.bindingSources.first((function(n){return n.name===u})),p,s,b,k,rt,ut,w,it;if(u&&!y){l.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".format(u,t));return}if(p=n.getInputPropertyBindings(),s=p.properties.first((function(n){return n.targetProperty===t})),y?(rt=i.activeBindingSourceName,y.name!==rt&&(b=!0)):(ut=f.unwrap(o.getModelValue(s.targetModel,s.targetProperty).value),c(f.toJS(e),ut)||(k=!0)),!(b||k))return!1;if(n.adapter){var ft=n.bindings.first((function(n){return n.targetProperty===t})),g=ft&&ft.source,et=g&&g.modelType===a&&g.property;if(et)w=et;else return l.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(n.toString(),t)),!1}else w=t;var nt=n.adapter?n.adapter.inputPropertyBindings:n.getInputPropertyBindings(),tt=nt.properties.first((function(n)
{return n.targetProperty===w})),ot=tt.compositionBindingDefinition,st=n.overridesModel,v;if(b){var ht=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,ct=ht.first((function(n){return n.name===w})),lt=y.sourceReference;v=h(ct,lt)}return k&&(o.setModelValue(st,tt.sourceProperty,f.toJS(e)),v=h(ot)),v&&(nt.removeProperty(tt),it=n.adapter?n.adapter.bindings:n.bindings,d(it,ot),r.setupPropertyBindings(n,nt,[v],n.bindAgainstOverridesOrContainerModel.bind(n)),it.push(v),n.adapter&&(p.removeProperty(s),r.setupPropertyBindings(n,p,s&&[s.compositionBindingDefinition],n.bindAdaptedInput.bind(n)))),!0}var w=i.Base.Constants.BladeParameterNames,b=i.Base.Diagnostics,k=i.ViewModels.Internal,r=s.CompositionBinder,d=i.remove,c=i.deepEquals,l=b.createLog(n),a=9;t.inferInitialBindingsForInputDefinitions=g;t.getConfigurableInputsMetadata=v;t.listenForConfigurationChanges=nt})(h||(h={})),h}));define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","o",
"ko","../../ViewModels/ViewModels.BladeCaller"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function e(n,t,u){var e=t.internal,f=r.observableArray([]);f.map(n,(function(n,t){r.ignoreDependencies((function(){o(n,t,e,u)}))}));r.computed(n,e.registeredSelectables,(function(n){n===void 0&&(n={});f.splice.apply(f,[0,f.peek().length].concat(i.keys(n)))})).extend({deferred:!0})}function o(n,i,e,o){var l=o.getBladeOpener(),h={invocationInputArguments:[{valuesFrom:[{referenceType:0,property:t+"."+i}]}]},c=r.unwrap(e.registeredSelectableOptions),s;c&&(s=c[i],s&&(s.parameterCollector&&u.addBladeCallerBindings(f+"."+i+".parameterCollector.bladeCaller",h,0),h.openInContextPane=s.openInContextPane,h.persistentContextPane=s.persistentContextPane));l.registerInvocationProperty(h,null,n)}var t="internal.registeredSelectables",f="internal.registeredSelectableOptions";n.listenForRegistrationChanges=e})(f||(f={})),f}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css",["require","exports",
"module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-formdialog{font-size:14px;border:1px solid}.fxs-formdialog h2{font-size:110%}.fxs-formdialog .fxs-formdialog-description{margin-top:-10px}.fxs-formdialog .fxs-formdialog-form{margin:20px 0 0;padding:15px 25px;width:448px}.fxs-formdialog .fxs-formdialog-buttons{margin-left:25px}.fxs-formdialog .fxs-formdialog-buttons>button{margin-right:5px;margin-bottom:25px}.fxs-formdialog-header{border-bottom:1px solid;margin:0 25px;padding-bottom:10px}")}));define("MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog",["require","exports","f","o","ko","$","MsPortalImpl.Controls/Fields/Base/FormValidation","../../Interactions/Interactions.DismissHandler","../../Interactions/Interactions.KeyboardNavigation","../Widgets.WidgetBase","../Widgets.Common","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){var r=i.ViewModels.Controls.Forms.Button.ViewModel,w=
i.ViewModels.Forms.Section,t=w.ViewModel,l=i.newGuid,a="fxs-formdialog",v="fxs-portal-bg-txt-br",y="fxs-popup",b="<div class='fxs-formdialog-header fxs-portal-border'><h2 data-bind='text: data.dialogOptions.title'><\/h2><div class='fxs-formdialog-description' data-bind='text: data.dialogOptions.description'><\/div><\/div><div class='fxs-formdialog-form msportalfx-form' data-bind='pcControl: func._formSection'><\/div><div class='fxs-formdialog-buttons'><button class='fxs-portal-button-primary fxs-formdialog-okbutton' data-bind='text: data.okButtonText, pcButton: func._okButton'><\/button><button class='fxs-button-default fxs-formdialog-cancelbutton' data-bind='text: data.cancelButtonText, pcButton: func._cancelButton'><\/button><\/div>",k=(function(n){function t(){n.apply(this,arguments);this.okButtonText=u.observable();this.cancelButtonText=u.observable();this.onOkClick=f.noop;this.onCancelClick=f.noop}return __extends(t,n),t})(h.ViewModel),p;n.ViewModel=k;p=(function(n){function i(t,i){var
e=this;if(n.call(this,t,i),!i.dialogOptions)throw new Error("dialogOptions must be specified for rendering a form dialog.");t.addClass(a+" "+y+" "+v).html(b);var u=document.activeElement,r=this._dismissHandle={dismissFn:function(){e._cancelButton&&i.onCancelClick()},shouldDismissOnMouseDownFn:f.noop,shouldDismissOnMouseWheelFn:f.noop,restoreFocus:function(){o.validatePreviousFocusedElement(r,u)&&u.focus()},logName:"formdialog"},h=new s.KeyboardNavigation(t,2);o.register(r);this.ltm.registerForDispose((function(){h.dispose();o.unregister(r)}));this._initializeViewModels();this._bindDescendants();this._setAria();this.setFocus()}return __extends(i,n),i.prototype.setFocus=function(){var n=this.element;c.waitForBindings(n[0]).finally((function(){var t=n.find("input:first");t.length===0&&(t=n.findByClassName("fxs-formdialog-okbutton:first"));setTimeout((function(){t.offsetParent()&&t.focus()}))}))},i.prototype.dispose=function(){this._cleanElement(a,y,v);n.prototype.dispose.call(this)},i.prototype.
_setAria=function(){var t="aria-labelledby",i="aria-describedby",n=this.element,r=l(),u=l();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName("fxs-formdialog-description").attr({id:r,role:"document",tabindex:this.options.dialogOptions.description()?0:-1});this.ltm.registerForDispose((function(){n.removeAttr(["role",t,i].join(" "))}))},i.prototype._initializeViewModels=function(){var k=this,n=this.ltm,l=this.options,i=l.dialogOptions,a=3,f=0,o=new t(n,{style:u.observable(a),children:u.observableArray()}),s=new t(n,{style:u.observable(a),children:u.observableArray()}),v,y,p,w,h,b,c;i.row1column1&&(v=new t(n,{style:u.observable(f),children:u.observableArray([i.row1column1])}),o.children.push(v));i.row1column2&&(y=new t(n,{style:u.observable(f),children:u.observableArray([i.row1column2])}),o.children.push(y));i.row2column1&&(p=new t(n,{style:u.observable(f),children:u.observableArray([i.row2column1])}),s.children.push(p));i.row2column2&&(w=new t(n,{
style:u.observable(f),children:u.observableArray([i.row2column2])}),s.children.push(w));h=this._formSection=new t(n,{children:u.observableArray()});o.children().length&&h.children.push(o);s.children().length&&h.children.push(s);b=this._cancelButton=new r(n);b.click=function(){l.onCancelClick()};c=this._okButton=new r(n);c.isDefault(!0);c.click=function(){e.ensureFormFieldValidation(k.element,!0).then((function(n){n&&l.onOkClick()}))};u.computed(n,(function(){c.disabled(!h.valid())}))},i})(h.Widget);n.Widget=p})(l||(l={})),l}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-listpopup{display:inline-block;cursor:default;position:absolute;left:0;width:200px;max-height:300px;z-index:200;overflow-y:auto;box-sizing:border-box}.fxs-listpopup .fxs-listpopup-list{list-style-type:none;padding:0;max-height:300px}.fxs-listpopup .fxs-listpopup-item{font-size:12px;line-height:normal;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto;white-space:nowrap;text-overflow:ellipsis;position:relative;box-sizing:border-box;padding:0 10px;border:0;overflow:visible;text-align:left;height:35px;cursor:pointer}")})
);define("MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup",["require","exports","f","o","ko","$","../../Interactions/Interactions.DismissHandler","../../Interactions/Interactions.KeyboardNavigation","../../Base/Base.KeyboardHelper","../Widgets.WidgetBase","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(t){var v=i.Base.Diagnostics,r="fxs-listpopup",y=v.createLog(n),c="fxs-portal-bg-txt-br",l="fxs-popup",p="<ul class='fxs-listpopup-list' data-bind='foreach: func._items'><li role='menuitem' class='fxs-listpopup-item fxs-portal-hover' data-bind='text: text, css: { \"fxs-listpopup-item-selected fxs-portal-selected fxs-br-primary\": text === $root.data.dialogOptions.selectedItem() }, event: { click: onClick, keydown: onKeyDown }, attr: { title: text }' tabindex='0'><\/li><\/ul>",w=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(h.ViewModel),a;t.ViewModel=w;a=(function(n){function t(
t,i){n.call(this,t,i);i.dialogOptions||y.error("dialogOptions must be specified for rendering a list popup.");var h=document.activeElement,v=function(n){if(n!==h&&!f.contains(h,n))return!(t[0]===n)&&!f.contains(t[0],n)},a=this._dismissHandle={dismissFn:function(){var n=i.onLostFocus;n&&n()},shouldDismissOnMouseDownFn:v,shouldDismissOnMouseWheelFn:v,restoreFocus:function(){e.validatePreviousFocusedElement(a,h)&&h.focus()},logName:"listpopup"};this._items=u.computed(this.ltm,(function(){var n=function(n){typeof i.onItemSelected=="function"&&(i.dialogOptions.selectedItem(n),i.onItemSelected(),a.restoreFocus())};return i.dialogOptions.listItems().map((function(t){return{text:t,onClick:function(i,r){r.stopPropagation();n(t)},onKeyDown:function(i,r){r.keyCode===13&&s.getModifierKeys(r)===0&&(r.stopPropagation(),n(t))}}}))}));this._keyboardNavigation=new o.KeyboardNavigation(t);e.register(a);t.addClass(r+" "+l+" "+c).html(p);this._bindDescendants()}return __extends(t,n),t.prototype.dispose=function(
){e.unregister(this._dismissHandle);this._cleanElement(r,l,c);this._keyboardNavigation&&(this._keyboardNavigation.dispose(),this._keyboardNavigation=null);this.element.removeAttr("tabindex");n.prototype.dispose.call(this)},t})(h.Widget);t.Widget=a})(c||(c={})),c}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-progressbox{color:#fff}")}));define("MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox",["require","exports","o","ko","MsPortalImpl/Resources/ImplScriptResources","../Widgets.WidgetBase","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var c=u.Dialogs.ProgressBar,i="fxs-progressbox",l="<h2 data-bind='text: data.title' class='fxs-progressbox-title'><\/h2><div data-bind='text: data.text' class='fxs-progressbox-text'><\/div><div data-bind='text: data.completionText' class='fxs-progressbox-progressbar'><\/div>",
e="fxs-popup",o="fxs-portal-bg-txt-br",t=r.observable,s=r.isObservable,a=(function(n){function i(i,u){var f=this;n.call(this);this.title=t();this.text=t();this.completionPercentage=t(-1);s(i)&&(this.text=i);s(u)&&(this.completionPercentage=u);this.completionText=r.computed((function(){var n=f.completionPercentage();return n<0||n>100?"":c.percentComplete.format(n)}))}return __extends(i,n),i})(f.ViewModel),h;n.ViewModel=a;h=(function(n){function t(t,r){n.call(this,t,r);this.element.html(l).addClass(i).addClass(e).addClass(o);this._bindDescendants()}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(i,e,o);n.prototype.dispose.call(this)},t})(f.Widget);n.Widget=h})(e||(e={})),e}));define("MsPortalImpl/UI/UI.DialogManager",["require","exports","f","o","../Widgets/Dialogs/Widgets.FormDialog","MsPortalImpl/Base/JQueryHelper","../Widgets/Dialogs/Widgets.ListPopup","../Widgets/Dialogs/Widgets.ProgressBox","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Compositions/UI.Composition",
"../Widgets/Widgets.WidgetBase","../Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/Base/Base.SvgHelper"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return (function(t){function y(n){return wt.format(n)}function bt(n){return k||(k=new ot(n)),k}function kt(){k=null}function et(n,t){var r=i.getUniqueId();return n.replaceAll(t,r).replaceAll("msportalfx-svg-c01",t).replaceAll(r,"msportalfx-svg-c01")}function dt(n,t,i){var r=new a.ViewModel;return r.title(t.title),r.text(t.text),r.buttons(t.buttons),r.onButtonClick=function(t){n(t)},r.modal=i,r.defaultButtonText=t.defaultButtonText,r.cancelButtonText=t.cancelButtonText,r.confirmationRequired=t.confirmationRequired,r.confirmationMessage=t.confirmationMessage,r}function gt(n,t){var i=new o.ViewModel(t.text,t.completionPercentage);return i.title(t.title),i}function ni(n,t){var i=new u.ViewModel;return i.dialogOptions=t,i.okButtonText(it.okButtonText),i.cancelButtonText(it.cancelButtonText),i.onOkClick=function(){n(4)},i.onCancelClick=
function(){n(1)},i}function ti(n,t){var i=new e.ViewModel;return i.dialogOptions=t,i.onItemSelected=function(){n(4)},i}function st(n){var t=n.closest(".fxs-tile").data(c.CompositionInstanceDataName),r;return t&&c.isPartComposition(t)?r=t.locator:at.error("Unable to determine the extension that opened the dialog. "+i.getCurrentCallStack(!0)),r}function ht(n){var r=n.closest(".fxs-bladecontent"),t=l.Widget.getWidgets(r),i;return t&&t.length&&(i=t[0],n=b(i.getForm())),n}function ct(n){tt.trace({source:rt,name:n&&n.toFriendlyString(),action:ut.DialogOpened,extension:n&&n.getExtensionLocator().name})}function p(n,t){tt.trace({source:rt,name:n&&n.toFriendlyString(),action:ut.DialogClosed,extension:n&&n.getExtensionLocator().name,data:t+""})}var d=i.Base,nt=d.Diagnostics,tt=nt.Telemetry,it=i.Resources.Strings.Dialogs,lt=i.ViewModels.Dialogs,w=s.Content.SvgStartup,b=jQuery,g=b("body"),at=nt.createLog(n),vt="<div class='fxs-portal-shield'><div class='fxs-portal-shield-icon fxs-portal-shield-icon-on-topbar'><\/div><div class='fxs-portal-shield-modaldialog'><div/><\/div><\/div>",
yt="fxs-portal-shield-icon-warning",pt="fxs-portal-shield-icon-error",wt="The {0} used to render the dialog was not specified.",rt=h.Source.Shell,ut=h.Action,k,ft=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(lt.MessageBox),ot;t.MessageBox=ft;t.getOrCreate=bt;t.dispose=kt;ot=(function(){function n(n){this._portalIdleSvc=n}return r.defineProperty(n.prototype,"hasOpenDialog",{get:function(){return!!this._dismissOpenDialog},enumerable:!0,configurable:!0}),n.prototype.dismissOpenDialog=function(){this._dismissOpenDialog&&(this._dismissOpenDialog(),this._dismissOpenDialog=null)},n.prototype.showModalDialog=function(n){var s=this,t=b(vt),r,a,h,e,c,u,l,y,o;return g.append(t),r=t.findByClassName("fxs-portal-shield-icon"),a=t.findByClassName("fxs-portal-shield-modaldialog"),n.showErrorIcon?(h=v.getSvgReferenceOrFallBackToData(i.extend2(w.error,{data:et(w.error.data,"msportalfx-svg-c22")})),e=pt):(h=v.getSvgReferenceOrFallBackToData(i.extend2(w.warning,{data:et(w.error.
data,"msportalfx-svg-c10")})),e=yt),r.html(h),r.addClass(e),c=g.findByClassName("fxs-topbar-content").width(),u=g.findByClassName("fxs-topbar-notifications").position(),c&&u&&(l=c-(u.left+40),r.css({top:u.top,right:l}),a.css({top:u.top+40,right:l})),this._currentCancelToken&&(this._currentCancelToken.cancel(),this._currentCancelToken=null),y=t.find(".fxs-portal-shield-modaldialog > div"),o=new ft(n.title,n.description,n.buttons),o.defaultButtonText=n.defaultButtonText,o.cancelButtonText=n.cancelButtonText,f.unhide(t),this._portalIdleSvc.signalIdle(),this._showDialog(y,o,!0,null).then((function(i){var u=n.uiShield&&n.uiShield.hidePromise;return u?(s._currentCancelToken=new d.Promises.CancelationToken,d.Promises.wrapWithCancelablePromise(u,s._currentCancelToken).then((function(){f.hide(t)}))):f.hide(t),r.removeClass(e),i})).finally((function(){s._portalIdleSvc.signalBusy()}))},n.prototype.showDialog=function(n,t,i){return n?t?(this.dismissOpenDialog(),this._showDialog(n,t,!1,i)):Q.reject(y("options")):
Q.reject(y("element"))},n.prototype.showDialogWithCallback=function(n,t,i,r){if(!n)throw new Error(y("element"));if(!t)throw new Error(y("options"));this.dismissOpenDialog();this._showDialogWithCallback(n,t,!1,i,r)},n.prototype.showShellDialog=function(n,t,r){var u=this;return t?r?n?(this.dismissOpenDialog(),i.require("MsPortalImpl.Controls/Controls/Balloon").then((function(i){var f=u._showDialog(b(t.getForm()),n,!0,null).then((function(n){return t.hideForm(),n})),e=i.getBox(r);return t.showForm(e),f}))):Q.reject(y("options")):Q.reject(y("sourceTarget")):Q.reject(y("formTarget"))},n.prototype._showDialog=function(n,t,i,r){var e=this,u=Q.defer(),o=function(n){u.resolve(n)},f;return r||i||(r=st(n)),t.type!==4&&(n=ht(n)),f=this._getWidget(n,t,i,o),ct(r),f?(this._dismissOpenDialog=function(){f.dispose();u.reject();p(r,"Dismissed")},u.promise.then((function(n){f.dispose();e._dismissOpenDialog=null;p(r,n)}))):(p(r,"InvalidDialogType"),u.reject("Invalid type specified in dialogOptions.")),u.promise}
,n.prototype._showDialogWithCallback=function(n,t,i,r,u){var o=this,f,e;u||i||(u=st(n));t.type!==4&&(n=ht(n));e=function(n){f&&f.dispose();o._dismissOpenDialog=null;p(u,n);r&&r(n)};f=this._getWidget(n,t,i,e);ct(u);f?this._dismissOpenDialog=function(){f.dispose();p(u,"Dismissed")}:p(u,"InvalidDialogType")},n.prototype._getWidget=function(n,t,i,r){var h=this,f,s;switch(t.type){case 1:f=new a.Widget(n,dt(r,t,i));break;case 2:f=new o.Widget(n,gt(null,t));break;case 4:s=ti(r,t);s.onLostFocus=function(){h.dismissOpenDialog()};f=new e.Widget(n,s);break;case 3:f=new u.Widget(n,ni(r,t))}return f},n})()})(y||(y={})),y}));define("MsPortalImpl/UI/UI.Initialize",["require","exports","f","i","a","ko","$","../Base/Base.KnockoutExtensions.FxParameterCollector","MsPortalImpl/Base/Base.BrowserDetection","../Base/Base.ImplUtils","../Base/ClaimsIdentity","../CodeComponentSideLoad/CodeComponentSideLoadModels","../Controls/ControlBindings.Async","../Base/Base.GenericPopup","../Extension/DefinitionPreprocessor",
"../Extension/Extension","../Extension/ExtensionMetadataSource","Fx/Feedback","../GalleryPackage/GalleryPackageLoader","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.DismissHandler","../Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Base/JQueryHelper","../Base/Languages","../../MsPortalImpl.Controls/Controls/ResourceFilterHelper","../Services/Services.AssetTypes","../Services/Services.AzureStorage","../Services/Services.BrowseCuration","../Services/Services.Controller","../Services/Services.FileUploadEndpointRegistration","../Services/Services.FileUploadInitialization","../Services/Services.GalleryEndpoints","../Services/Services.GeneralSettings","../Services/Services.FavoritesSettings","../Services/Services.PortalIdentity","../Services/Services.PortalTips","../Services/Services.SharedSettings","../Services/Services.Storage","../Services/Services.PortalIdleState","../Services/Services.SecurityTokens","../Services/Services.SelectedSubscriptions",
"../Services/Services.Settings","../Services/Services.ShellProvisioner","../Services/Services.TelemetrySharing","../Services/Services.Util","../Base/Telemetry","./Hubs/UI.BrowseManager","./Hubs/ViewModels/UI.Browse.ViewModelRegistration","../UI/Compositions/UI.Composition","./Compositions/UI.Composition.Services","./Hubs/UI.FavoritesManager","./Hubs/ViewModels/UI.Gallery.ViewModelRegistration","./Hubs/UI.HubsRpcCallbacks","./UI.NpsHelper","./Hubs/UI.ResourceMapManagerRpc","./Hubs/ViewModels/UI.Settings.ViewModelRegistration","./UI.StatusHandler","./UI.ViewTimeTelemetry","../Extension/ViewModelManager","../Widgets/Widgets.Portal","../Widgets/Widgets.HelpMenu","../Widgets/Widgets.WidgetBase","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed",
"MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi,yi,pi,wi,bi,ki,di){"use strict";var gi;return (function(t){function iu(n,t){t&&t.startsWith("#")&&n.route(t)}function le(n,t,i){return[n,t].forEach((function(n){var t=n.length;if(t!==1)throw new Error("Unexpected length '"+n.selector+"': "+t);})),new ff(n,t,i)}function rr(n,t,i){lr({source:n,action:t,data:i})}function hu(n,t){return Q(
).then(t).catch((function(n){ar.error(n)})).then((function(){return n.getCodeComponentsMetadata()}))}function ae(n){var e,o;if(n&&or&&or.getEntriesByType&&or.timing){var u=tr(),i=function(n,t,i){uf(n,{duration:t,endTime:Math.round(i+or.timing.navigationStart)})},f=or.getEntriesByType("resource").filter((function(n){var t=n.initiatorType;return t==="link"||t==="script"})),r=f.reduce((function(n,t){return Math.min(t.startTime,n)}),Infinity),t=f.reduce((function(n,t){return Math.max(t.responseEnd,n)}),0),s=t-r,h=t;return r=Math.max(r,n),t=Math.min(t,u),e=t-r,o=u-e-n,i("TotalTimeToSplashScreen",n,n),i("TotalStartupResourceDownload",s,h),i("StartupResourceDownload",e,t),i("StartupScriptExecution",o,u),pr.traceResourceDownloads(f),o}}function uf(n,t){t=t||{};var r=t.duration||tr(),i=t.data||{};return i.cdn="CdnIndex"+gr.index,i.bundling="Bundling"+gr.bundling,lr({timestamp:t.endTime,source:sr,action:n,actionModifier:yr.ActionModifier.Complete,duration:r,data:i}),r}function ve(n,t){var i=n.getValue(nf,
gu,dr);return t!==i&&n.setValue(nf,gu,t,dr),i}function ye(){wi.registerPrefix(y.PinVMPrefix,"./MsPortalImpl/Extension/PinBladeInferred",(function(n,t,i,r){return n.createViewModel(t,i,r)}))}function pe(n,t,i,r,u,f,e,o,s){var h=n.getTopBarWidget(),c=n.getSearchWidget(),a=n.getSideBarWidget(),l=h.options;be(h,t,i,o);ke(l,t);ge(c,a,t,u,o);de(l.breadCrumb,t.desktop,c,o);we(n,h,t,r,s)}function we(n,t,i,r,u){var f,o;if(du)yt("MsPortalImpl/Widgets/Widgets.NotificationsPane").then((function(n){var u=new n.ViewModel,f=new n.Widget(e("<div/>"),u,i,r);t.element.on(ur.fxnotificationsbuttonclick,(function(){lr({source:cr.TopBar,action:nr.NotificationMenuOpen});f.toggleNotificationsContextPane()}))}));else{f=n.getNotificationMenuWidget();f.register(u.notifications);f.element.on(ur.fxnotificationclickinmenu,(function(n,t){u.handleNotificationClick(t)}))}o={events:ur.fxtoastclick,handler:function(n,t){u.handleNotificationClick(t)}};r.eventHandlers.push(o)}function be(n,t,r,u){var f=i.memoizeQ((function(){return yt(
"MsPortalImpl/Widgets/Widgets.SettingsPane").then((function(n){var i=new n.ViewModel;return new n.Widget(e("<div/>"),i,t,r)}))}));u.registerForDispose(f);n.element.on(ur.fxsettingsbuttonclick,(function(){f().then((function(n){rr(cr.TopBar,nr.SettingsPaneOpen);n.toggleSettingsContextPane()}))}))}function ke(n,t){n.feedbackButtonClick=function(){t.getService("FeedbackPane").then((function(n){var t=n.widget;rr(br,nr.FeedbackSmileyClicked,{isPaneOpen:t.isVisible()});t.toggle()}))}}function de(n,t,i,r){n.clicksEventsHandlers.push((function(n,i){t.activeJourney().goToBlade(i.bladeId)}));f.computed(r,(function(){var r=t.activeJourney();i.options.journeysShown(!!r);n.breadCrumbs(r?r.getBreadCrumbs():[])})).extend({throttle:100})}function ge(n,t,i,r,u){var f=function(n){return yt("MsPortalImpl/Widgets/Widgets.SharedOptionsInit").then((function(t){n(t)}))};n.initOptions((function(){return f((function(t){t.initSearchWidgetOptions(u,n,i,r)}))}));t.initOptions((function(){return f((function(n){n.initSideBarWidgetOptions(
u,t,i)}))}))}var vr=r,ef=vr.Data,of=vr.Extension,sf=vr.TriggerableLifetimeManager,hr=i.Base,ru=hr.Constants,uu=hr.Diagnostics,yr=uu.Telemetry,ur=hr.EventTypes,pr=r.NetDiagnostics,hf=hr.Resources,cu=r.Rpc,cf=i.Hubs.Notifications,lu=cf.NotificationStatus,lf=vr.Hubs.Notifications,af=i.Services,au=i.ViewModels,vf=au.Dialogs,vu=vf.MessageBoxButtons,yf=au.ParameterCollection.Internal,yu=ru.DefaultCloudName,pu=hr.Net2,nr=ri.Action,cr=ri.Source,pf=i.Helpers,fr=MsPortalImpl.Performance,fu=hr.UriBuilder,er=window,or=er.performance,wu=er.fx,tr=wu.getTimestamp,lr=yr.trace,eu=cu.client,sr=cr.Shell,u=wu.environment,wf=u.chrome,wr=u.links,br=cr.TopBar,yt=i.require,bf=i.ensureSuffix,kf=i.pathJoin,kr=bf(hf.getAppRelativeUri("/"),"/"),df=er.console,ir=er.location,gi=u.features,ou=d.Shell,gf=d.Controls.FileUpload,ar=uu.createLog(n),ne=kr+"SignOut",te=kr+"signin/index",ie=u.errorPageUri,re=u.isDevelopmentMode,ue=gi.hideavatartenant==="true",fe=gi.consoletelemetry==="true",bu=gi.showbugreportlink,ee=wt.ComponentName.
Relex,ku=d.UiSettings.RelexToggleOption,oe=gi.ldnstrace==="true",du=gi.notificationspane==="true",gu="loadedPageVersion",nf=wt.ComponentName.Telemetry,dr=0,gr=u.cdn,se="fxs-topbar-helpmenu",he=i.forEachKey,tf=vt.getSignedInUser,ce=i.isFeatureEnabled("userdefineddefaultview"),nu=i.isFeatureEnabled("ci"),su=gi.waitforpendingchanges==="true",tu,rf=function(){ar.warning.apply(ar,arguments)},ff;pu.setAjaxLogFunc(rf);t.routeIfHash=iu;t.create=le;ff=(function(){function t(n,t,i){this._lifetime=new sf;this._disposed=!1;this._dependencies=i;this._element=n;this._$splashScreen=t;this._idleSvc=bt.createInstance()}return t.prototype.initialize=function(){var ot=this,y=this._lifetime,au=this._$splashScreen,wu=i.memoizeQ((function(){return oi.getDialogManagerModule().then((function(n){return n.getOrCreate(ot._idleSvc)}))})),ff,ge,no;y.registerForDispose(wu);var nf=function(n,t){return ot._redirect({uri:n,skipFlushBuffers:t})},hr=this._dependencies,bt=hr.settings,gu=hr.extensionManager,vr=hr.storageService,
cf=new fu(ir.href),ou=kt.extractAndClearAuthState(),gf,le=function(n,t,i){var r=new fu(n+ir.search+(i||"")),u=gr.forceIndex,f=r.query;u&&f.setParameter(gr.indexParameter,u);t&&he(t,(function(n,t){return f.setParameter(n,t)}));nf(r.toString())};if(!ou){le(kr,{reAuth:"true"},ir.hash);return}ou.createdOn||(ou.createdOn=Date.now(),kt.updateAuthState(ou));u.enableAnimations||e.enableAnimations(!1);ff=this._idleSvc;yr.initialize(sr);lt.init(bt);at.init(bt);dt.init(bt);var we=gt.queryStores(bt,[8,4,7]),be=u.pageVersion,ke=ve(vr,be),wi={defaultRoute:!1,splashScreen:fr.splashScreenLoadTime,initializeStart:tr(),cdnFailedIndex:hr.cdnFailedIndex,loadedSameVersion:be===ke,previousVersion:ke||""},t,vf=lt.processor.initialized.then((function(w){function ko(n,t){rr(br,t);iu(ti,n)}function lo(n){return c.getAvatarImage(yr.avatarUri,yr.defaultAvatarUri,vr,n)}var yo=cf.query.getParameter("l")!==undefined,af,ct,bo,yi,vf,fo,yf,dt,oo,so,he,lt,ti,ae,rf,ve,be,ef,st,co,ke,gt,ge,ao,vo;it.initialize(y,vr,w.rawLocale,
u.localeFromQuery,yo)&&(su=!1,nf(null,!0));Q.fcall((function(){i.isObject(u)&&df.log("Version: "+u.version+"\nSession: "+u.sessionId)}));wi.initializeGeneralSettings=tr();var to=it.currentLocaleContext,io=to.selectedDisplayLanguage,po=to.selectedFormatCulture;rr(sr,nr.PortalInitializeLanguage,{language:io,formatCulture:po||io});vt.initialize(ou.user);var yr=tf(),sf=yr.tenantId,wo=vt.getTenants(),uo=f.observable(!1);g.initialize();y.registerForDispose((function(){g.dispose()}));af=new bi.ViewModel;ct=new bi.Widget(ot._element,af);y.registerForDispose((function(){tt.hide(ot._element);er.setTimeout((function(){ct.dispose()}),100)}));t=oi.initialize(y,hr,w,uo,ct,nf,wu);a.initialize(t);bo=t.assetManager.assetMruList;yi=t.desktop;af.sideBar.goToDashboard=function(n){return ct.showStartBoard(),yi.getDashboardManager().then((function(t){var i=t.currentDashboardId();return t.switchDashboard({id:i,title:i},n||"SideBar")}))};rt.initialize(t.assetTypeService,y);vf=Q(vt.getSubscriptions());fo=vf.then((function(
n){bf(n);uo((n&&n.subscriptions||[]).some((function(n){return n.requireRdfe})))}));ot._notificationManager=t.notificationManager;of.extensionStatusEndPoint.register(eu,null,(function(n,t){n&&de(n,t.srcWindowId)}));yf=ct.options;dt=yf.topBar;i.isFeatureEnabled("azureconsole")&&(dt.getConsoleViewModel=function(){return yt("MsPortalImpl/Widgets/Widgets.Console").then((function(n){return new n.ViewModel({src:u.consoleUri,getAuthToken:gf})}))});dt.exitDevMode=function(){tt.unhide(au);MsPortalImpl.Extension.unregisterAll().then((function(){nf(kr)}))};var pi=function(){v.showPopup({provideText:function(){return ho().then((function(n){return JSON.stringify(n,null,2)}))}})},gr=i.memoizeQ((function(){return yt("../Base/Base.DebugInfo",n).then((function(n){return n.initialize(y,t)}))})),eo=wf.hideShortcuts?null:nt.setup(ct,t,pi,(function(){gr().then((function(n){return n.toggleStickys(tu)}))})),fu=ct.element,pu=function(){return yt("MsPortalImpl/Widgets/Widgets.WelcomeSequence").then((function(n){return new n.Widget(
e("<div />"),new di.ViewModel,fu,bt)}))};y.registerForDispose(pu);i.isFeatureEnabled("helpenabled")?(so=i.memoizeQ((function(){return yt("MsPortalImpl/Widgets/Widgets.HelpPane").then((function(n){var i=new n.ViewModel;return new n.Widget(e("<div/>"),i,t,pi.bind(ot),eo,bt,pu)}))})),y.registerForDispose(dt.helpButtonClick=function(){so().then((function(n){return rr(cr.TopBar,nr.HelpPaneOpen),n.toggle()}))})):(oo=new ki.Widget(fu.findByClassName(se),new ki.ViewModel,fu,bt,pu),oo.initialize(t.router,pi,eo,t.contextPane));var ho=function(){return Q.all([yt("MsPortalImpl/Base/Base.DiagnosticsPopup"),fo,co]).spread((function(n){return n.getDiagnosticsData(t,bf,kf,hf)}))},fe=sf==="72f988bf-86f1-41af-91ab-2d7cd011db47";return dt.canReportBug(bu==="force"||bu==="true"&&fe),dt.reportBug=function(){yt("./UI.Portal.Actions",n).then((function(n){n.reportBug(t,ho,cf)}))},he=si.createFavoritesManager(t),lt=yf.sideBar,lt.attachFavoritesManager(he),ti=t.router,lt.launchBlade=function(n){ti.route(n)},ae=!1,rf=hu(pf,
(function(){return pf.registerTestExtensionsFromUri(ir.href)})),l.canModifyExtensions&&(rf=rf.then((function(n){return yt("MsPortalImpl/Extension/ExtensionPatch").then((function(n){var i=n.initializeTestPatch([],t,au);return hu(i,(function(){return i.registerTestPatchesFromUri(ir.href).then((function(){return i.listTestPatches().then((function(n){n=n||[];p.patchUris=n.map((function(n){return n.uri}));ae=!!n.length}))}))}))})).then((function(){return n}))}))),wi.preGetExtensionMetadata=tr(),be=rf.then((function(n){var i,u;return(wi.getExtensionMetadata=tr(),ve=at.processor.initialized.then((function(t){wi.favoritesManagerInitialized=tr();var i=t.favorites(),r=i&&JSON.parse(i);return rr(cr.SideBar,"SideBarSettings",{collapsed:w.sideBarCollapsedKey(),favorites:r,favoritesCount:r.length}),he.initializeFavorites(t,n)})),i=[yu],r.Extension.multiCloudEnabled&&(i=n.map((function(n){return n.cloudName})).unique().filter((function(n){return n!==ru.HubsCloudName}))),ut.setCloudNames(i),lt.cloudOptions(i.map((function(n)
{return{text:f.observable(n),value:n}}))),gu.initialize({extensions:n,useCachedManifests:!0,onRelexDisconnected:ro}),hf.registerGetAuthorizationTokenEndpoint(n),vt.initializeRpc(n),pt.initializeRpc(),et.initializeRpc(),ft.registerSasEndPoint(),ii.registerEndPoints(cu.client,t.desktop),u=function(t){var i=n.some((function(n){return n.isTestExtension||n.isTestStamp}));return dt.inDevMode(i||t||ae),yi.initialize(n,we,wi)},l.canAddGalleryPackages)?yt("MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource").then((function(n){var i=n.initializeTestGalleryPackage([],t,au);return hu(i,(function(){return i.registerTestGalleryPackagesFromUri(ir.href)}))})).then((function(n){var t=k.initialize(gu);return t.loadGalleryPackages(n),n&&n.length>0})).then((function(n){return wi.galleryPackagesSideload=tr(),u(n)})):u(!1)})).then((function(){return wi.desktopAndExtensionManagerInitialize=tr(),ti.initialRoute((function(){return wi.defaultRoute=!0,ce?ve.then((function(){if(!lt.openFavorite(0))throw new Error("Couldn't open first favorite.");
})).catch((function(n){var t=ar.warning;return t.call(ar,new i.Errors.Error({message:"favoritesManagerInitialized failed",innerErrors:n})),lt.goToDashboard()})):lt.goToDashboard()}))})).then((function(){wi.setupInitialRoute=tr();tt.hide(au);fr.pageLoaded();wi.locationHash=cf.fragment;wi.hiddenTime=fr.getHiddenTime();var t={data:e.extend(wi,pr.traceDocumentNavigation())};gu.getHubsExtension().then((function(){tu=uf("TotalTimeToPortalReady",t);var r=1;!nu&&i.isFeatureEnabled("userdefineddefaultview")&&w.whatsNewVersion()<r&&yt("../Services/Services.PortalTips",n).then((function(n){n.setup(y,ve,lt.onFavoritesChanged,r)}))}));ot._idleHandle=ff.addCallbacks({onIdle:function(){var n=er.navigator;n&&n.onLine!==!1&&(st.avatarImage(lo(!0)),gi.prefetch!=="false"&&yt("MsPortalImpl/Services/Services.PortalPrefetch",null,!0).then((function(n){n.start(y,ff,vr,tu)})),u.useCachedManifests&&gu.refreshManifests().catch((function(){})),oe&&yt("ldns",null,!0),yt("MsPortalImpl/Services/Services.BrowserTelemetry",null,!0));
ff.removeCallbacks(ot._idleHandle)},onBusy:i.noop})})).catch((function(n){ot._redirect({uri:ie+"/LoadFailed?stack="+encodeURIComponent(n&&n.stack).substr(0,1e3)})})),we.then((function(n){var t="userDefaultDirectory",i=n[7],r=i&&i[t];r!==sf&&bt.setSetting(7,t,sf)})),be.then((function(){var n,r,f,e,t,o;if(!nu&&i.isFeatureEnabled("guidedtour")&&bt.querySetting(7,"WelcomeSequence").then((function(n){n||pu().then((function(){rr(ri.Action.PortalInitializeWelcome,ri.Source.Shell)}))})),ot._notificationManager.listenForClientNotifications(),ht.init(bt),gi.internalonly==="false"||gi.canmodifyextensions||fe||(n=u.trustedParentOrigin,r=n.replace(/^([^\/]+\/\/).+\.([^\.]+\.[^\.]+\.[^\.]+)$/,"$1$2"),n!==r&&(f=d.Portal,ot._notificationManager.addClientNotification({status:lu.Information,title:f.preview,description:f.unsupportedEnvironment.format(n),uri:r,timestamp:new Date,cloudName:null,uriAction:lf.ClientNotificationUriAction.OpenInCurrentTab}))),fe&&!nu&&Q.delay(6e4).then((function(){return yt("MsPortalImpl/UI/UI.AzureMobile").
then((function(n){n.publish()}))})),s.isSafari&&s.webKitVersion<602&&(e=d.Portal,wu().then((function(n){return n.showModalDialog({title:e.unsupportedBrowser,description:e.unsupportedBrowserDesc.format(wr.unsupportedBrowser),buttons:vu.OK,showErrorIcon:!0})}))),t=or&&or.timing,t&&!vr.getValue(ee,"Enabled",dr)&&gi.showrelexdialog==="true")return o=t.requestStart-t.fetchStart,(no>400||tu>7e3)&&o<300?wu().then((function(n){var t=d.EnableRelexDialog;return n.showModalDialog({title:t.title,description:t.description,buttons:vu.YesNo})})).then((function(n){var t=n===6?ku.enable:ku.disable;vr.setValue(wt.ComponentName.Relex,"Enabled",t,dr);n===6&&er.location.reload()})):void 0})),ut.setupAssetTypeServiceRpc(t),ai.setupResourceMapManagerRpc(eu,t),ni.create(t),uu.ErrorReporter.initialize((function(){ar.debug(yi.getDiagnosticsData())})),o.initialize(yi,t),ef=du?ct.getToastVM():ct.getNotificationMenuWidget().getToastVM(),pe(ct,t,vf,ef,lt.selectedCloud,pi,gr,y,ot._notificationManager),b.Internal.showNpsEndpoint.
register(t.rpcClient,null,(function(n,t){li.showNps(ef,n.productDisplayName,(t.srcWindowId||"")+"_"+n.productId)})),b.Internal.canShowNpsEndpoint.register(t.rpcClient,null,(function(){return!li.npsShownInSession})),li.showPortalNps(ef,w.npsTimeMs),st=dt.avatarMenu,st.userIdentity(yr),st.hideTenant(ue),vt.getUserInfo().then((function(n){st.userInfo(n)})),co=wo.then((function(n){var t=n.tenants;kf(t);st.listOfTenants(t)})),st.showDiagnostics=pi,st.signedOut=function(){kt.updateAuthState(null);nf(ne)},st.openAccountPortal=function(){var n=wr.accountPortal;ko(n.startsWith("#")?n:n+"subscriptions",nr.AvatarMenuOpenBilling)},st.avatarImage(lo()),lt.saveCollapseState=function(n){w.sideBarCollapsedKey(n)},st.giveFeedback=function(){rr(br,nr.AvatarMenuOpenFeedback);iu(ti,wr.giveFeedback)},st.showMyAccessBlade=function(){rr(br,nr.AvatarMenuOpenAccessDetails);iu(ti,wr.accessDetails)},st.switchedTenant=function(n,t){var i=h.getHashQueryStringSegment(ir.href);le(te+"/@"+t.tenant.domainName,null,"#"+i)},!nu&&
(re||u.clientOptimizations&&u.clientOptimizations!=="true"||gi.canmodifyextensions)&&gr().then((function(n){return n.startErrorDetection(y)})),y.registerForDispose(gr),!gi.nodirectory||st.dropMenu.isMenuOpen(!0),ke="data-click-telemetry",gt=fu[0],gt.addEventListener(ur.mousedown,vo=function(n){ge=n.target},!0),gt.addEventListener(ur.mouseup,ao=function(n){var i=ge,r,t;if(ge=null,n.target===i&&(r=e(i),t=r.closest("["+ke+"]",gt),t.length)){var o=t.attr(ke)+"",u=t.closest(".fxs-tile",gt).data(ei.CompositionInstanceDataName),f=u&&u.locator,s=f&&f.toFriendlyString()||sr;lr({source:s,action:nr.CustomClick,name:o})}},!0),y.registerForDispose((function(){gt.removeEventListener(ur.mousedown,vo,!0);gt.removeEventListener(ur.mouseup,ao,!0)})),t.browseManager.initialize(),fi.registerViewModels(t),hi.registerViewModels(),vi.registerViewModels({portalServices:t,securityTokensManager:hf,subscriptions:bf,tenants:kf}),ci.registerRpcCallbacks(t),ye(),ui.subscribeToMruItems(t),ui.registerRpcEndpoints(t),be})),
sf=yi.create(wu,hr.extensionVersionCache,vf,(function(n){ot._redirect(n)}),(function(){tt.unhide(au)})),to=function(n,t){return sf.onLastTokenRefresh(n,t)},io=function(n){sf.onStatus({code:2},n)},ro=function(){sf.onStatus({code:5},ru.Shell)},de=function(n,t){sf.onStatus(n,t)},hf=kt.createSecurityTokensManager(kt.createOAuthTokenProvier(ou),to,io),pf=w.initializeTestExtension(hr.extensionsMetadata.map((function(n){return l.ExtensionMetadataExt.create(n)})),bt,vr,wu,au),bf=f.observable(),kf=f.observableArray();return new ct.GalleryEndpointsService(eu,gu,pf),ef.registerTelemetrySubmissionHandler(),pr.registerTelemetrySubmissionHandler(),yf.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),pu.status.subscribe((function(n){de(n,sr)})),yr.addProcessor(ti.getProcessor(gu)),fe&&(ge=af.getConsoleTelemetryEventProcessor(),yr.addProcessor(ge)),MsPortalEarly.initializedTelemetry(lr),no=ae(fr.splashScreenLoadTime),vf.then((function(){pi.start(t)})).then((function(){function i(n){rf("Injecting {0}blockable untrusted content : {1} from {2}".
format(n.blockable?"":"un",n.tag,n.src));rr(sr,"UntrustedSource",n)}function t(t){var r=t.src,s=t.tag,u=r!=="document.write",f,e,o;return u&&s==="SCRIPT"&&(f=document.createElement("a"),f.href=r,r=f.href,e=/(.*?)[#\?]|$/.exec(r)[1]||r,o=!!n.filter((function(n){return!!~e.indexOf(n||null)})).length,u=!r||o||!!i(t)&&!1),u}var n=fr.allowList=fr.allowList.concat(u.cdnPrefixes);n.push(ir.host);n.push("about:blank");fr.sourceLogger=t;fr.sourceBacklog.forEach(t)})),y.registerForDispose(pi.stop),gf=hf.initializeSecurityForShell(ou),st.registerFileUploadEndpoints(),ht.uploadSettingsManager=bt,vf},t.prototype.dispose=function(){var n,t;this._disposed=!0;n=this._idleSvc;n&&(n.dispose(),this._idleSvc=null);vr.GlobalStateManager.resetGlobalState();t=this._lifetime;t&&(t.dispose(),this._lifetime=null);pr.resetTelemetryTimer();kt.writeAuthState()},t.prototype.beforeUnload=function(){var u=this,n=[],t,r,i;return su&&(t=ot.flush(this._dependencies.settings),r=t.isPending(),t.then((function(){var n=u._notificationManager;
n&&n.addClientNotification({title:ou.customizationsSavedLabel,description:ou.customizationsSavedDescription,status:lu.Success,timestamp:new Date,cloudName:yu})})),r&&n.push(ou.waitForPendingChangesMessage)),i=ht.hasFileUploads,i&&i()&&n.push(gf.unloadInfo),n.length?n.join("\n\n"):void 0},t.prototype._redirect=function(n){var t=n.uri,r=pf.Deferred(),i;tt.unhide(this._$splashScreen);lr({source:sr,action:nr.PortalRedirect,actionModifier:ri.ActionModifier.Redirect,data:t});i=function(){su=!1;r.resolve()};n.skipFlushBuffers?i():(ot.flush(this._dependencies.settings).finally(i),er.setTimeout(i,5e3));Q.allSettled([n.delayPromise,r]).finally((function(){if(!t){var n=new fu(ir.href);n.path=kf("/",n.path,tf().tenantId,"/");t=n.toString()}ir.href=t}))},t})()})(gi||(gi={})),gi}));define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14{fill:#7fba00}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.fxs-blade-header-icon .msportalfx-svg-c05,.fxs-sidebar-middle .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05,.msportalfx-inverted-theme .msportalfx-svg-c05{fill:#777}.fxs-blade-header-icon .msportalfx-svg-c07,.fxs-sidebar-middle .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07,.msportalfx-inverted-theme .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white>*,.msportalfx-svg-palette-white>g>*{fill:#fff}.msportalfx-svg-palette-blue>*,.msportalfx-svg-palette-blue>g>*{fill:#3999c6}.msportalfx-svg-palette-black>*,.msportalfx-svg-palette-black>g>*{fill:#1e1e1e}.msportalfx-svg-palette-green>*,.msportalfx-svg-palette-green>g>*{fill:#7fba00}.msportalfx-svg-palette-gray>*,.msportalfx-svg-palette-gray>g>*{fill:#a0a1a2}.msportalfx-svg-palette-inherit>*,.msportalfx-svg-palette-inherit>g *{fill:inherit!important}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:12px;min-width:12px}.msportalfx-svg-disabled{filter:grayscale(100%)}@-moz-document url-prefix(){.msportalfx-svg-disabled{filter:none}}.msportalfx-svg-disabled .msportalfx-svg-c01{fill:#fff}.msportalfx-svg-disabled .msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-disabled .msportalfx-svg-c03{fill:#a1a1a1}.msportalfx-svg-disabled .msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-disabled .msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-disabled .msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-disabled .msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-disabled .msportalfx-svg-c08{fill:#676767}.msportalfx-svg-disabled .msportalfx-svg-c09{fill:#6f6f6f}.msportalfx-svg-disabled .msportalfx-svg-c10{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c11{fill:#898989}.msportalfx-svg-disabled .msportalfx-svg-c12{fill:#c3c3c3}.msportalfx-svg-disabled .msportalfx-svg-c13{fill:#838383}.msportalfx-svg-disabled .msportalfx-svg-c14{fill:#5d5d5d}.msportalfx-svg-disabled .msportalfx-svg-c15{fill:#999}.msportalfx-svg-disabled .msportalfx-svg-c16{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c17{fill:#717171}.msportalfx-svg-disabled .msportalfx-svg-c18{fill:#767676}.msportalfx-svg-disabled .msportalfx-svg-c19{fill:#636363}.msportalfx-svg-disabled .msportalfx-svg-c20{fill:#4e4e4e}.msportalfx-svg-disabled .msportalfx-svg-c21{fill:#484848}.msportalfx-svg-disabled .msportalfx-svg-c22{fill:#7d7d7d}.msportalfx-svg-disabled .msportalfx-svg-c97{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c98{fill:#787878}.msportalfx-svg-disabled .msportalfx-svg-c99{fill:#8a8a8a}.msportalfx-svg-loading-square{-webkit-animation:ProgressFlagAnimation 1.45s infinite ease-in-out;animation:ProgressFlagAnimation 1.45s infinite ease-in-out}.msportalfx-svg-loading-square:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.msportalfx-svg-loading-square:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.msportalfx-svg-loading-square:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}@-webkit-keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}@keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scalex(-1)}.msportalfx-svg-rotate360{-webkit-animation:ImageRotation 1.45s infinite linear;animation:ImageRotation 1.45s infinite linear}@-webkit-keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}")})
);define("_generated/Less/MsPortalImpl/Themes/Themes.Universal.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,"a{color:#0058ad}.fxs-topbar{background-color:#1c1c1c;color:#fff}.fxs-topbar .fxs-bg-warning,.fxs-topbar.fxs-bg-warning{color:#000}.fxs-topbar .fxs-bg-warning svg,.fxs-topbar.fxs-bg-warning svg{fill:#000}.fxs-topbar-search .fxs-searchbox input{background-color:#444;color:#fff}.fxs-topbar-search .fxs-searchbox input::-webkit-input-placeholder{color:#bbb}.fxs-topbar-search .fxs-searchbox input:-ms-input-placeholder{color:#bbb}.fxs-topbar-search .fxs-searchbox input::-moz-placeholder{color:#bbb}.fxs-trim,.fxs-trim-text,.fxs-trim-text a,a.fxs-trim-text{color:#fff}.fxs-topbar-dashboard,.fxs-topbar-exit-customize{background-color:#8a2da5}.fxs-trim{background-color:#252525}.fxs-trim-btn{color:#fff;border-color:#fff}.fxs-trim-title{color:#bbb}.fxs-trim-selected{background-color:#444}.fxs-trim-hover:hover{background-color:#3d3d3d}.fxs-trim-border{border-color:#444}.fxs-trim-svg svg{fill:#fff}.fxs-trim-svg-secondary svg{fill:#bbb}.fxs-trim-text-primary a,a.fxs-trim-text-primary{color:#55b3ff}.fxs-sidebar-star.fxs-is-favorite svg{fill:#ffb900;stroke:#ffb900}.fxs-fill-white,.fxs-tile-actionbar-action{fill:#fff}.fxs-sidebar .azc-form-labelcontainer{color:#fff}.fxs-button-default{background-color:#8a8a8a;border-color:#8a8a8a;color:#fff}.fxs-button-default:hover:after{border-color:#787878}.fxs-button-default:focus:after{border-color:#e8e8e8}.fxs-button-default:active{background-color:#676767;border-color:#676767;outline-color:#676767}.fxs-portal-button-primary{background-color:#0058ad;border-color:#0058ad;color:#fff}.fxs-portal-button-primary:hover:after{border-color:#004e87}.fxs-portal-button-primary:focus:after{border-color:#b3ebfb}.fxs-portal-button-primary:active{background-color:#004e87;border-color:#004e87;outline-color:#004e87}.fxs-button-disabled{background-color:#ddd;border-color:#ddd;color:#b3b3b3}.fxs-button-disabled:active{background-color:#ddd;border-color:#ddd;outline-color:#ddd}.fxs-bg-white{background-color:#fff}.fxs-overlay{background:rgba(0,0,0,.7)}.fxs-highlight{color:#000;background-color:#fff100}.fxs-tile-actionbar{background-color:#9cd5f4}.fxs-tile-actionbar-action.fxs-tile-actionbar-action-pressed,.fxs-tile-actionbar-action:hover{background:#00bcf2}.fxs-tile-actionbar-action.fxs-tile-actionbar-command-unpinfromstartboard:hover{background:#ba141a}.fxs-portal .fxs-accent,.fxs-portal .fxs-popup{box-shadow:0 5px 15px 2px rgba(0,0,0,.3)}.fxs-portal .fxs-portal-main .azc-is-edited .azc-dockedballoon-validation{border-color:#8a2da5}.fxs-bladestyle-create .msportalfx-form .fxs-bg-dirty{background-color:#00bcf2!important}.fxs-blade-status-container,.fxs-blade-title-description{color:#000}.fxs-text-white{color:#fff}.fxs-br-primary{border-color:#00bcf2}.fxs-tile-selected .fxs-tile-overlay{background-color:transparent}.fxs-bg-overlay-dark{background:rgba(0,0,0,.7)}.fxs-bg-primary-10{background-color:rgba(0,188,242,.1)}.azc-is-edited.azc-has-focus{border-color:#7fba00}.azc-is-edited.azc-has-focus .azc-dockedballoon-validation{border-color:#00bcf2}.azc-is-edited .azc-dockedballoon-validation{border-color:#8a2da5}.azc-disabled:hover,.azc-row-disabled:hover{background-color:inherit}.azc-disabled,.azc-disabled:focus,.azc-disabled:hover,input.azc-disabled{cursor:default;outline:0}.fxs-part::after{border-color:#9cd5f4}.fxs-part.fxs-part-selected-command::after,.fxs-part.fxs-part-selected::after{border-color:#00bcf2}.fxs-portal .fxs-text-info,.fxs-portal .msportalfx-text-info{color:#0058ad}.fxs-portal .fxs-text-success,.fxs-portal .msportalfx-text-success{color:#7fba00}.fxs-portal .fxs-text-dirty,.fxs-portal .msportalfx-text-dirty{color:#8a2da5}.fxs-portal .fxs-text-warning,.fxs-portal .msportalfx-text-warning{color:#ff8c00}.fxs-portal .fxs-text-error,.fxs-portal .msportalfx-text-error{color:#e81123}.fxs-fill-info svg{fill:#0058ad!important}.fxs-fill-success svg{fill:#7fba00!important}.fxs-fill-dirty svg,.fxs-fill-upsell svg{fill:#8a2da5!important}.fxs-fill-warning svg{fill:#ff8c00!important}.fxs-fill-error svg{fill:#e81123!important}.msportalfx-fill-info{fill:#0058ad!important}.msportalfx-fill-success{fill:#7fba00!important}.msportalfx-fill-dirty{fill:#8a2da5!important}.msportalfx-fill-warning{fill:#ff8c00!important}.msportalfx-fill-error{fill:#e81123!important}.fxs-br-info,.msportalfx-br-info{border-color:#00bcf2!important}.fxs-br-success,.msportalfx-br-success{border-color:#7fba00!important}.fxs-br-dirty,.msportalfx-br-dirty{border-color:#8a2da5!important}.fxs-br-warning,.msportalfx-br-warning{border-color:#ff8c00!important}.fxs-br-error,.msportalfx-br-error{border-color:#e81123!important}.fxs-bg-info,.msportalfx-bg-info{background-color:#0058ad!important}.fxs-bg-success,.msportalfx-bg-success{background-color:#7fba00!important}.fxs-bg-dirty,.fxs-bg-upsell,.msportalfx-bg-dirty{background-color:#8a2da5!important}.fxs-bg-warning,.msportalfx-bg-warning{background-color:#ff8c00!important}.fxs-bg-error,.msportalfx-bg-error{background-color:#e81123!important}.fxs-blade-statusbg.fxs-bg-info{background-color:#d1e7f8!important}.fxs-blade-statusbg.fxs-bg-success{background-color:#d1ebd1!important}.fxs-blade-statusbg.fxs-bg-dirty,.fxs-blade-statusbg.fxs-bg-upsell{background-color:#e4d5f0!important}.fxs-blade-statusbg.fxs-bg-warning{background-color:#fff0d1!important}.fxs-blade-statusbg.fxs-bg-error{background-color:#f9b1b7!important}")})
);define("MsPortalImpl/Init",["require","exports","f","i","./Base/Base.Router","./Extension/ExtensionManager","./Extension/Extension.Manifest","./Services/Services.PortalIdentity","./Services/Services.EditScopeManagement","./Services/Services.Settings","./Base/Telemetry","./UI/UI.Initialize","./Services/Services.Storage","../_generated/Less/MsPortalImpl/Base/Base.Images.css","../_generated/Less/MsPortalImpl/Themes/Themes.Universal.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var v;return (function(){function nt(n){var t={fx:v.version};n||w.initializedExtensions.forEach((function(n){t[n.name]=n.extension.getVersion()}));et.custom("Session",st,ht++,ct,t)}var p=i.Base,rt=p.Diagnostics,ut=r.Rpc,ft=p.UriBuilder,y=a.ComponentName,c=window,v=c.fx.environment,et=rt.createLog(n),ot=v.cdn,t=a.create(),k=new p.UriBuilder(c.location.href),d=JSON.parse(t.getValue(y.Redirect,"BootParameters",0)||"{}"),g;t.clearValue(y.Redirect,"BootParameters",0);c.fx.bootEnvironment=d.environment;k.query=new
p.QueryStringBuilder(d.userQuery);u.history_replaceState(null,c.document.title,k.toString());ot.enabled||(g=t.clearValue(y.Cdn,"FailedIndex",1));t.clearValue(y.Redirect,"IdpRedirectCount",1);v.extensionUnloadTimeout&&(ut.timeToDelayWindowUnload=v.extensionUnloadTimeout);var st=1,ht=0,ct=t.clearValue(y.Redirect,"Referrers",1)||"";nt(!0);c.setInterval(nt,36e5);var tt=new e.ExtensionVersionCache(t),w=f.create(tt),it=h.createUserSettingsManager(t),b=l.create($("#web-container"),$("body").find("> .fxs-splashscreen"),{storageService:t,settings:it,extensionManager:w,extensionVersionCache:tt,editScopeManager:s.createEditScopeManager(w),extensionsMetadata:v.extensionsMetadata,hubsMetadata:v.hubsMetadata,openWindow:function(n){var t=c.open();return Q(n).then((function(n){if(n){var r=new ft(n),f=r.path,u=i.ensureSuffix(f,"/");i.localeCompareIgnoreCase(u,i.ensureSuffix(location.protocol+"//"+location.host,"/"))||(r.path=i.pathJoin("/",u,o.getSignedInUser().tenantId,"/"),n=r.toString())}t.location.href=
n}))},cdnFailedIndex:g});b.initialize();$(c).on("beforeunload",(function(){return b.beforeUnload()})).on("unload",(function(){it.dispose();b.dispose()}))})(v||(v={})),v}))